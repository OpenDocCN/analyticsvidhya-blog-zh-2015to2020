<html>
<head>
<title>Statistical Report of COVID-19 in India using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python制作印度新冠肺炎的统计报告</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/tracking-corona-virus-in-india-using-python-7f29e6b0b7e4?source=collection_archive---------21-----------------------#2020-04-12">https://medium.com/analytics-vidhya/tracking-corona-virus-in-india-using-python-7f29e6b0b7e4?source=collection_archive---------21-----------------------#2020-04-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1b32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">冠状病毒病(新冠肺炎)是一种由新发现的冠状病毒引起的传染病。</p><p id="fd33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大多数感染新冠肺炎病毒的人将经历轻度至中度的呼吸道疾病，无需特殊治疗即可康复。老年人以及那些患有心血管疾病、糖尿病、慢性呼吸系统疾病和癌症等潜在疾病的人更有可能患上严重疾病。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/73de76ce3ceb28ffbd14dbc3af82f707.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kflvv9XnAv3NvdWKlIMHQw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">最终web应用程序的快照。</figcaption></figure><p id="b983" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本帖中，我们将追踪印度的 <strong class="ih hj"> <em class="jt">冠状病毒</em> </strong> <em class="jt">，还将制作一个如上图所示的网络应用。web app的演示可以看</em> <a class="ae ju" href="https://covid-19-in-india.herokuapp.com/" rel="noopener ugc nofollow" target="_blank"> <em class="jt">这里</em> </a> <em class="jt">。</em></p><p id="7d18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">免责声明:此应用程序将开发用于教育目的，不应用作接收与新型冠状病毒相关的信息的官方途径。</strong></p><h1 id="c0fe" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">第一步。装置</h1><p id="02d8" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">我们将使用美丽的汤4从官方数据中收集数据。因此，让我们使用“pip”来安装它。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="a11a" class="ld jw hi kz b fi le lf l lg lh">pip install bs4</span></pre><p id="da8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用Pandas来分析收集到的数据。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="5bf5" class="ld jw hi kz b fi le lf l lg lh">pip install pandas</span></pre><p id="8fd2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用Dash来制作一个仪表板web应用程序。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="b6fb" class="ld jw hi kz b fi le lf l lg lh">pip install dash</span></pre><h1 id="024a" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">第二步。抓取数据</h1><p id="7e87" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">我们需要一个来源来收集数据。我们将使用从<a class="ae ju" href="https://www.mohfw.gov.in/" rel="noopener ugc nofollow" target="_blank">这里</a>(卫生和家庭福利部)检索的印度官方数据。</p><p id="ab27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建一个新的python文件，将其另存为scrape.py。</p><p id="039e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，让我们导入所有需要的库。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="13ee" class="ld jw hi kz b fi le lf l lg lh">import requests<br/>import re<br/>import os.path<br/>from os import path<br/>import bs4<br/>from bs4 import BeautifulSoup<br/>from datetime import datetime</span></pre><p id="88d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们定义一个方法，如果状态码是200(HTTP OK)，它就从URL获取内容。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="e59a" class="ld jw hi kz b fi le lf l lg lh">def getContents():<br/>    url = "<a class="ae ju" href="https://www.mohfw.gov.in/" rel="noopener ugc nofollow" target="_blank"><em class="jt">insert url here</em></a>"<br/>    r = requests.get(url)<br/>    txt = ""<br/>    <br/>    if r.status_code == 200:<br/>        txt = r.text<br/>        return txt</span></pre><p id="baae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们定义一个方法来抓取我们实际寻找的内容，即来自URL的状态数据，并将其解析到一个列表中。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="3cc2" class="ld jw hi kz b fi le lf l lg lh">def scrape_now():<br/>    <em class="jt">#list declarations</em><br/>    total_list = []<br/>    state_list = []<br/>    confirmed_list = []<br/>    recovered_list = []<br/>    death_list = []</span><span id="eac1" class="ld jw hi kz b fi li lf l lg lh"><em class="jt">    #parse starts<br/>    </em>txt = getContents()<br/>    soup = BeautifulSoup(txt, 'html.parser')</span><span id="fd9f" class="ld jw hi kz b fi li lf l lg lh">    <em class="jt">#get total stats first<br/>    </em>total = soup.find("div", {"class": "site-stats-count"})<br/>    for length in total.find_all("strong"):<br/>        total_list.append(length.getText())</span><span id="9510" class="ld jw hi kz b fi li lf l lg lh"><em class="jt">    #get states data<br/>    </em>states_data  = soup.find("section", {"id": "state-data"})<br/>    tables = states_data.find_all('tbody')<br/>    for row in tables[0].findAll("tr"):<br/>        col = row.findAll("td")<br/>        if((col[0].getText()).isnumeric()):<br/>            state_list.append(col[1].getText())<br/>            confirmed_list.append(int(col[2].getText()))<br/>            recovered_list.append(int(col[3].getText()))<br/>            death_list.append(int(col[4].getText()))</span><span id="4ab3" class="ld jw hi kz b fi li lf l lg lh">    return total_list, state_list, confirmed_list, recovered_list, death_list</span></pre><p id="7328" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的方法从<a class="ae ju" href="https://www.mohfw.gov.in/" rel="noopener ugc nofollow" target="_blank">这里的</a>抓取数据，并将结果解析为五个列表，即。、<em class="jt"> total_list </em>、<em class="jt"> state_list </em>、<em class="jt"> confirmed_list </em>、<em class="jt"> recovered_list </em>、<em class="jt"> death_list </em>，分别提供受影响总人数、州名列表、某州确诊电晕病例数列表、某州治愈人数列表、某州电晕死亡人数。这些数据可以用于以后的分析。</p><h1 id="eecb" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">第三步。处理数据</h1><p id="bb5d" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">我们需要处理收集到的数据，以便以一种有益的方式使用这些数据。</p><p id="dce1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建一个新的python文件，将其另存为resources.py</p><p id="cbae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，让我们导入所需的库和模块。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="0f78" class="ld jw hi kz b fi le lf l lg lh">import scrape<br/>import pandas as pd</span></pre><p id="7aac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jt">注意</em> </strong> <em class="jt">:不要忘记将scrape.py导入到新脚本中。</em></p><p id="3dbd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们知道，我们收集的数据是按字母顺序列出的，从受影响程度最高的状态到最低的状态查看数据更可取。因此，让我们把列表压缩到一个数据帧中，改变它的顺序，然后再把它放回到原来的列表中。在本例中，我们将只选择前10个受影响的州(否则，图表会变得拥挤)。这可以使用以下代码来完成:</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="5306" class="ld jw hi kz b fi le lf l lg lh">total_list, state_list, confirmed_list, recovered_list, death_list = scrape.scrape_now()</span><span id="7609" class="ld jw hi kz b fi li lf l lg lh"><em class="jt">#state_stats has the data of each state in a single dataframe</em> state_stats=pd.DataFrame(<br/>     list(zip(state_list,confirmed_list,death_list,recovered_list)),<br/>     columns=['State','Confirmed','Deaths','Recovered']<br/>)</span><span id="6e9b" class="ld jw hi kz b fi li lf l lg lh"><em class="jt">#states with highest confirmed cases are ordered first(resets index after sorting)<br/></em>state_stats = state_stats.sort_values(<br/>    by='Confirmed', ascending=False<br/>).reset_index(drop=True)</span><span id="3ff7" class="ld jw hi kz b fi li lf l lg lh"><em class="jt">#top 10 is choosed<br/></em>top_state_stats = state_stats.head(10)</span><span id="6a08" class="ld jw hi kz b fi li lf l lg lh"><em class="jt">#convert the processed dataframe to list to be fed into the graph<br/></em>state_list = top_state_stats['State'].values.tolist()<br/>confirmed_list = top_state_stats['Confirmed'].values.tolist()<br/>death_list = top_state_stats['Deaths'].values.tolist()<br/>recovered_list = top_state_stats['Recovered'].values.tolist()</span></pre><h1 id="5438" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">第四步。显示数据</h1><p id="0a41" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">现在我们已经处理了数据，但是我们需要以图表的形式显示它，并使dashboard应用程序具有视觉吸引力。</p><p id="8fb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建一个新的python文件，将其另存为app.py</p><p id="f818" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，让我们导入所需的模块和库</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="1a7a" class="ld jw hi kz b fi le lf l lg lh">import resources<br/>import dash<br/>import dash_bootstrap_components as dbc<br/>import dash_core_components as dcc<br/>import dash_html_components as html<br/>import dash_table<br/>from dash.dependencies import Input, Output</span></pre><p id="520e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jt">注</em> </strong> <em class="jt">:不要忘记将resources.py导入到新脚本中。</em></p><p id="da2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们设置一些用户界面参数，如背景颜色，字体大小等。，(这完全取决于您的创造力，我建议您在获得正确的参数之前一直使用它)。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="e0c5" class="ld jw hi kz b fi le lf l lg lh">colors = {'background':'#FFFFFF'}</span></pre><p id="e042" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们初始化应用程序。添加<em class="jt"> meta_tags </em>让web app移动响应。我使用dash的引导组件来使它看起来更好，如果你对它感到舒适，你也可以写你自己的CSS。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="3951" class="ld jw hi kz b fi le lf l lg lh">app = dash.Dash(<br/>    external_stylesheets=[dbc.themes.BOOTSTRAP],<br/>    meta_tags=[<br/>    {"name": "viewport", "content": "width=device-width, initial-scale=1"}]<br/>)</span></pre><p id="39fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们来做app的基本布局。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="ba31" class="ld jw hi kz b fi le lf l lg lh">app.layout = html.Div(<br/>    [<br/>        dcc.Location(id="url"),<br/>        dbc.NavbarSimple(<br/>            children=[<br/>                dbc.NavLink("Home", href="/page-1", id="page-1-link")<br/>            ],</span><span id="4ae8" class="ld jw hi kz b fi li lf l lg lh">            brand="COVID-19",<br/>            color="primary",<br/>            dark=True<br/>        ),</span><span id="24d3" class="ld jw hi kz b fi li lf l lg lh">        dbc.Container(id="page-content", className="pt-4"),<br/>        dbc.NavbarSimple(style={'color':'white'},children=[<br/>            dcc.Markdown('''<br/>                Built using Dash and Python<br/>                Data from Ministry of Health and Family Welfare<br/>            ''')<br/>            ],<br/>            brand="COVID-19",<br/>            color="primary",<br/>            dark=True<br/>        )<br/>    ]<br/>)</span></pre><p id="a751" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面只是构建了基本的布局，然而页面中什么也没有。所以<em class="jt">页</em>是一串布局中应该有的内容。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="5e3a" class="ld jw hi kz b fi le lf l lg lh"><em class="jt">#Page starts</em><br/>page = html.Div(className="container",<br/>    style={<br/>       'textAlign':'center',<br/>       'backgroundColor':colors['background']<br/>    },<br/>    children=[<br/>        html.H1("Case History of COVID-19"),<br/>        html.Div(className="main",children=[<br/>        html.Div(className="graphhead",children=[<br/>            html.H3("Statistical Report of COVID-19 in India"),<br/>    ]),</span><span id="5595" class="ld jw hi kz b fi li lf l lg lh">    html.P(html.Br()),</span><span id="3aca" class="ld jw hi kz b fi li lf l lg lh">    dcc.Markdown('''<br/>        #### **State-wise Bar Report**<br/>    '''),</span></pre><p id="4e68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">图表应该被绘制出来。这可以使用python dash中默认的plotly图形来完成。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="9621" class="ld jw hi kz b fi le lf l lg lh">   html.Div(className="graph",children=[<br/>        dcc.Graph(<br/>            id='bar-graph',<br/>            figure={<br/>                'data':[<br/>                    {<br/>                        'x':state_list,<br/>                        'y':confirmed_list,'type':'bar',<br/>                        'name':'Confirmed'<br/>                    },<br/>                    {<br/>                        'x':state_list,<br/>                        'y':death_list,<br/>                        'type':'bar',<br/>                        'name':'Deaths'<br/>                    },<br/>                    {<br/>                        'x':state_list,<br/>                        'y':recovered_list,<br/>                        'type':'bar',<br/>                        'name':'Recovered'<br/>                    }<br/>                ],                <br/>            },<br/>            config={'displayModeBar':False},<br/>        ),<br/>        html.P(html.Br()),<br/>        html.P("The above graph shows the states with the highest confirmed COVID-19 cases. Interact with the legend to get better information."),<br/>    ]),<br/>    html.P(html.Br()),</span></pre><p id="5631" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还需要查看表格以获得每个州的准确数字。让我们来展示这张表。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="637a" class="ld jw hi kz b fi le lf l lg lh">        dcc.Markdown('''<br/>            #### **State-wise Table Report**<br/>        '''),</span><span id="62a0" class="ld jw hi kz b fi li lf l lg lh">        html.Div(<br/>            className="tablehead",<br/>            style={'font-family':"SegoeUI"},<br/>            children=[<br/>                html.P("The below table gives us statewise reports"),<br/>            dash_table.DataTable(<br/>                id='table',<br/>                columns=[{"name": i, "id": i} for i in<br/>state_stats.columns],<br/>                data=state_stats.to_dict('records'),<br/>            ),<br/>            html.P(html.Br()),<br/>        ]),<br/>    ]),<br/>])</span><span id="395b" class="ld jw hi kz b fi li lf l lg lh"><em class="jt">#Page ends</em></span></pre><p id="89fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们运行服务器。</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="bcfc" class="ld jw hi kz b fi le lf l lg lh">if __name__ == "__main__":<br/>    app.run_server(debug=True)</span></pre><h1 id="db8c" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">第五步。执行</h1><p id="7be2" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">使用以下命令执行python脚本app.py:</p><pre class="je jf jg jh fd ky kz la lb aw lc bi"><span id="1549" class="ld jw hi kz b fi le lf l lg lh">python app.py</span></pre><p id="3e58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您一步一步地按照教程操作，应该不会出现错误，python脚本将被执行，应用程序将在<a class="ae ju" href="http://127.0.0.1:8050/" rel="noopener ugc nofollow" target="_blank"><em class="jt">http://127 . 0 . 0 . 1:8050/</em></a>上运行</p><h1 id="eeac" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">脚注</strong></h1><p id="5b86" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">谢谢你读到这里。在这篇文章中，我们学会了使用Beautiful Soup 4从网络上搜集冠状病毒的详细信息，使用Pandas处理它们，并使用Dash和Plotly图形将它们显示为仪表板应用程序。</p><p id="abd2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望这篇教程对你有用。我很好奇你是怎么想的，所以给我一些建议吧。如果你有任何问题，请在LinkedIn<a class="ae ju" href="https://www.linkedin.com/in/rahul-hegde-0955391a5/" rel="noopener ugc nofollow" target="_blank">上联系我或者写在下面的评论里。</a></p></div></div>    
</body>
</html>