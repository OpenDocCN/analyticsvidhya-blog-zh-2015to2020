<html>
<head>
<title>Show Off Your Machine Learning Project on Web Part 2: Dockerize You Streamlit App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Web上展示您的机器学习项目第2部分:Dockerize您简化应用程序</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/show-off-your-machine-learning-project-on-web-part-2-dockerize-you-streamlit-app-fab385d79ef9?source=collection_archive---------29-----------------------#2020-06-29">https://medium.com/analytics-vidhya/show-off-your-machine-learning-project-on-web-part-2-dockerize-you-streamlit-app-fab385d79ef9?source=collection_archive---------29-----------------------#2020-06-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="f95f" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">一天一个码头工人让你的老板远离你。</h2></div><blockquote class="ix iy iz"><p id="a937" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">点击进入<a class="ae jx" rel="noopener" href="/analytics-vidhya/show-off-your-machine-learning-project-on-web-part-1-streamlit-it-801bc0b6848f?source=friends_link&amp;sk=e64d0f6b0d101f8320465469d8812f35">第1部分</a>和<a class="ae jx" rel="noopener" href="/analytics-vidhya/show-off-your-machine-learning-project-on-web-part-3-deploy-onto-heroku-with-docker-b78fedb99ceb?source=friends_link&amp;sk=1fe1f8bd66f523d0efb569807d108091">第3部分</a>。</p><p id="1d9d" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">使用<a class="ae jx" rel="noopener" href="/analytics-vidhya/show-off-your-machine-learning-project-on-web-part-2-dockerize-you-streamlit-app-fab385d79ef9?source=friends_link&amp;sk=80ea34c77c509739f16c17530536a1eb">这个好友链接</a>传播这个帖子，无限制访问。</p><p id="99f4" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated"><em class="hi">TL；你可以在这里</em>  <em class="hi">得到</em> <a class="ae jx" href="https://github.com/Cuda-Chen/fish-yolo-grabcut" rel="noopener ugc nofollow" target="_blank"> <em class="hi">博士的例子项目。</em></a></p></blockquote><figure class="jz ka kb kc fd kd er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es jy"><img src="../Images/c22a0492d43df38bb73c0a1d68f625e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LrEGecX1WfZ0Lkgw6f-CAA.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx translated">对接您的应用程序，告别环境设置时间！</figcaption></figure><h1 id="8601" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">动机</h1><p id="0b2f" class="pw-post-body-paragraph ja jb hi jd b je lg ij jg jh lh im jj li lj jm jn lk ll jq jr lm ln ju jv jw hb bi translated">因此，您最终用streamlit完成了您的机器学习项目，但您觉得每次都必须在新计算机上创建虚拟环境很乏味。更糟糕的是，有时您的虚拟环境会因为您使用不同的操作系统而崩溃。</p><p id="91fe" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj li jl jm jn lk jp jq jr lm jt ju jv jw hb bi translated">希望我们可以使用Docker来缓解设置和部署环境的问题，并且您可以创建一个适合扩展的微服务。</p><h1 id="212a" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">本部分的目标</h1><p id="b688" class="pw-post-body-paragraph ja jb hi jd b je lg ij jg jh lh im jj li lj jm jn lk ll jq jr lm ln ju jv jw hb bi translated">对于这一部分，我将展示如何创建一个可行的streamlit + OpenCV Docker映像，并展示一些关于Docker的简单用法。</p><h1 id="e479" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">用一个例子深入研究</h1><p id="638a" class="pw-post-body-paragraph ja jb hi jd b je lg ij jg jh lh im jj li lj jm jn lk ll jq jr lm ln ju jv jw hb bi translated">长话短说，让我展示一下我的streamlit + OpenCV机器学习项目的Dockerfile:</p><figure class="jz ka kb kc fd kd"><div class="bz dy l di"><div class="lo lp l"/></div></figure><h1 id="d564" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">简化了一些Dockerfile命令的用法</h1><ol class=""><li id="b4ed" class="lq lr hi jd b je lg jh lh li ls lk lt lm lu jw lv lw lx ly bi translated"><code class="du lz ma mb mc b">FROM</code>:获取一个基础图像。就像你需要一个操作系统作为你应用的基础一样。</li><li id="259b" class="lq lr hi jd b je md jh me li mf lk mg lm mh jw lv lw lx ly bi translated"><code class="du lz ma mb mc b">MAINTAINTER</code>:显示该图片作者的相关信息。</li><li id="dc3f" class="lq lr hi jd b je md jh me li mf lk mg lm mh jw lv lw lx ly bi translated"><code class="du lz ma mb mc b">ENV</code>:将环境变量设置为某个值。</li><li id="84b0" class="lq lr hi jd b je md jh me li mf lk mg lm mh jw lv lw lx ly bi translated"><code class="du lz ma mb mc b">RUN</code>:执行命令。</li><li id="9825" class="lq lr hi jd b je md jh me li mf lk mg lm mh jw lv lw lx ly bi translated"><code class="du lz ma mb mc b">EXPOSE</code>:让你的容器在运行时监听特定的端口。</li><li id="4ed0" class="lq lr hi jd b je md jh me li mf lk mg lm mh jw lv lw lx ly bi translated"><code class="du lz ma mb mc b">WORKDIR</code>:设置工作目录。</li><li id="9c69" class="lq lr hi jd b je md jh me li mf lk mg lm mh jw lv lw lx ly bi translated"><code class="du lz ma mb mc b">COPY</code>:复制新文件/目录。</li><li id="8db2" class="lq lr hi jd b je md jh me li mf lk mg lm mh jw lv lw lx ly bi translated"><code class="du lz ma mb mc b">CMD</code>:执行容器时提供默认动作。</li></ol><p id="ab6a" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj li jl jm jn lk jp jq jr lm jt ju jv jw hb bi translated">欲了解更多信息，请访问<a class="ae jx" href="https://docs.docker.com/engine/reference/builder/" rel="noopener ugc nofollow" target="_blank">官方文档参考</a>。</p><h1 id="718e" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">关于此docker文件的一些提醒</h1><ol class=""><li id="0353" class="lq lr hi jd b je lg jh lh li ls lk lt lm lu jw lv lw lx ly bi translated">第13~16行的目的是让streamlit在Docker中正常运行。否则，streamlit将无法启动。</li><li id="5fea" class="lq lr hi jd b je md jh me li mf lk mg lm mh jw lv lw lx ly bi translated">第24行的目的是让OpenCV在Docker中正常运行。我遇到了一个问题，如果你不安装<code class="du lz ma mb mc b">libSM.so.6</code>然后在构建Docker镜像时导入OpenCV，你的容器会在执行时无声地崩溃并显示消息:<code class="du lz ma mb mc b">segmentation fault (core dumped)</code>。你可以在这里看到这种问题<a class="ae jx" href="https://github.com/NVIDIA/nvidia-docker/issues/864" rel="noopener ugc nofollow" target="_blank">。</a></li></ol><h1 id="7510" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">构建并执行这个容器</h1><p id="93e1" class="pw-post-body-paragraph ja jb hi jd b je lg ij jg jh lh im jj li lj jm jn lk ll jq jr lm ln ju jv jw hb bi translated">使用以下命令构建并执行该容器:</p><pre class="jz ka kb kc fd mi mc mj mk aw ml bi"><span id="bf29" class="mm kp hi mc b fi mn mo l mp mq">$ docker image build -t fish-yolo-grabcut:app .<br/>$ docker container run -p 8501:8501 --rm -d grabcut:app</span></pre><p id="5395" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj li jl jm jn lk jp jq jr lm jt ju jv jw hb bi translated">之后，在浏览器的网址中输入<code class="du lz ma mb mc b">localhost:8501</code>，app的内容就会显示出来。</p><p id="6b09" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj li jl jm jn lk jp jq jr lm jt ju jv jw hb bi translated">要关闭容器类型:</p><pre class="jz ka kb kc fd mi mc mj mk aw ml bi"><span id="f050" class="mm kp hi mc b fi mn mo l mp mq">$ docker kill &lt;weird id of fish-yolo-grabcut.app&gt;</span></pre><h1 id="4fa3" class="ko kp hi bd kq kr ks kt ku kv kw kx ky io kz ip la ir lb is lc iu ld iv le lf bi translated">翘起</h1><p id="730e" class="pw-post-body-paragraph ja jb hi jd b je lg ij jg jh lh im jj li lj jm jn lk ll jq jr lm ln ju jv jw hb bi translated">在这一部分，我展示了这个项目的Docker配置，并告诉你我在构建和执行我构建的容器时的两个问题。</p></div><div class="ab cl mr ms gp mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="hb hc hd he hf"><p id="1fde" class="pw-post-body-paragraph ja jb hi jd b je jf ij jg jh ji im jj li jl jm jn lk jp jq jr lm jt ju jv jw hb bi translated"><em class="jc">原载于2020年6月29日</em><a class="ae jx" href="https://cuda-chen.github.io/devops/2020/06/29/streamlit-docker-heroku-part-2.html" rel="noopener ugc nofollow" target="_blank"><em class="jc">https://cuda-Chen . github . io</em></a><em class="jc">。</em></p><figure class="jz ka kb kc fd kd"><div class="bz dy l di"><div class="my lp l"/></div></figure></div><div class="ab cl mr ms gp mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="hb hc hd he hf"><blockquote class="ix iy iz"><p id="55af" class="ja jb jc jd b je jf ij jg jh ji im jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">如果你有什么想法和问题要分享，请联系我<a class="ae jx" href="http://clh960524@gmail.com/" rel="noopener ugc nofollow" target="_blank"><strong class="jd hj">clh 960524【at】Gmail . com</strong></a>。另外，你可以查看我的<a class="ae jx" href="https://github.com/Cuda-Chen" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>的其他作品。如果你和我一样对机器学习、图像处理和并行计算充满热情，欢迎在LinkedIn上加我。</p></blockquote></div></div>    
</body>
</html>