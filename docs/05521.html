<html>
<head>
<title>Naive Bayes Classifier</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">朴素贝叶斯分类器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/naive-bayes-classification-aa381b00dd45?source=collection_archive---------4-----------------------#2020-04-24">https://medium.com/analytics-vidhya/naive-bayes-classification-aa381b00dd45?source=collection_archive---------4-----------------------#2020-04-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5d1c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">朴素贝叶斯是一种监督学习分类。它是基于贝叶斯定理的概率分类器。naive这个名称源于这样一个事实，即分类器假设特征对是独立的，因此大大简化了模型参数的训练要求。这简化了计算，这就是为什么它被称为“天真”。这也被称为类独立性。</p><p id="d704" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">条件概率:</strong> <br/>假设桶中有七个球，其中三个是蓝色的，四个是黑色的，那么从桶中取出蓝色球的概率是3/7，同样地，取出黑色球的概率是4/7。</p><p id="3060" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们应用这个条件，有两个桶。桶A和桶B<br/>在桶A中有两个黑球和两个蓝球，类似地，在桶B中有两个黑球和一个蓝球。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/ecdc4aa62e1c094bf83a63b1ef53e462.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*toZj7oH_x5Weix5-5TbaSQ.png"/></div></div></figure><p id="6339" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在桶B中得到蓝球的概率是<br/> P(蓝/桶B)=1/3 <br/>或<br/> P(蓝/桶B)=P(蓝和桶B)/P(桶B) <br/> P(蓝/桶B)=(1/7)/(3/7) <br/> P(蓝/桶B)=1/3</p><p id="e9d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的公式是基于c在x上的概率</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jp"><img src="../Images/f9e8192720e78385294ece60ba44b668.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*E9KFmjrKdGH0h0PFNnmU2g.png"/></div></figure><p id="058d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设h的概率的后验训练数据D遵循基本定理如下</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jp"><img src="../Images/b10597743625e86b5c1cd072f8902d7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*agOPFlEtIVuWK-J0HwalYA.png"/></div></figure><p id="c807" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中，<br/> P(h):假设的独立概率也叫先验概率<br/> P(D):给定数据集的独立概率<br/>P(D | h):D给定h的条件概率也叫似然概率<br/>P(h | D):h给定D的条件概率也叫后验概率</p><blockquote class="jq jr js"><p id="ec2b" class="if ig jt ih b ii ij ik il im in io ip ju ir is it jv iv iw ix jw iz ja jb jc hb bi translated"><strong class="ih hj">用scikit学习Python中的朴素贝叶斯算法</strong></p></blockquote><p id="633e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本例中，我们使用分班数据集来找出有多少学生被安排和有多少学生没有被安排。</p><p id="8fbb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我一般用google colab写个代码。这是一个令人惊叹的平台。为此，首先你必须将谷歌硬盘安装到谷歌实验室。这样我们就可以从google dive获取数据集。我们使用以下代码</p><pre class="je jf jg jh fd jx jy jz ka aw kb bi"><span id="2ed7" class="kc kd hi jy b fi ke kf l kg kh">from google.colab import drive<br/>drive.mount('/content/drive')</span></pre><p id="8cba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导入所需的库</p><pre class="je jf jg jh fd jx jy jz ka aw kb bi"><span id="d251" class="kc kd hi jy b fi ke kf l kg kh">import pandas as pd<br/>import numpy as np<br/>import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.metrics import classification_report, confusion_matrix, accuracy_score</span></pre><p id="ae44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">之后，我必须读取csv文件(dateset) <a class="ae ki" href="https://drive.google.com/file/d/1IlowRit-W0R2sDsEYvyeZNO_7y3kG3gc/view?usp=sharing" rel="noopener ugc nofollow" target="_blank">单击此处</a>下载数据集。</p><pre class="je jf jg jh fd jx jy jz ka aw kb bi"><span id="f3af" class="kc kd hi jy b fi ke kf l kg kh">df = pd.read_csv('/content/drive/My Drive/placement.csv')<br/>df</span></pre><p id="9c27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据预处理:</strong> <br/>首先我们要检查数据集是否包含空值，如果包含，我们要对其进行一些转换。</p><pre class="je jf jg jh fd jx jy jz ka aw kb bi"><span id="b1a6" class="kc kd hi jy b fi ke kf l kg kh">df.isnull().sum()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kj"><img src="../Images/c96094bb593886d91518e79300598eb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/1*ijecRK_fpQVJTmHk77kOPg.png"/></div></figure><p id="99fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">shape方法返回表示数据帧维数的元组。</p><pre class="je jf jg jh fd jx jy jz ka aw kb bi"><span id="03e1" class="kc kd hi jy b fi ke kf l kg kh">df.shape</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kk"><img src="../Images/5ac281cbba695a26a2be91a77164ed27.png" data-original-src="https://miro.medium.com/v2/resize:fit:406/format:webp/1*xsMKDjNLwAI_liqKys32aQ.png"/></div></figure><p id="91eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">info()用于打印数据帧的简明摘要</p><pre class="je jf jg jh fd jx jy jz ka aw kb bi"><span id="9313" class="kc kd hi jy b fi ke kf l kg kh">df.info()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kl"><img src="../Images/29c62267aeb2ca892108957c64e8e0b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*yK0xJdH6y5ssH1ZGPdqfAw.png"/></div></figure><p id="8953" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据可视化:</strong> <br/>它的目的是通过图形化的表示，清晰高效地传达数据&amp;。</p><pre class="je jf jg jh fd jx jy jz ka aw kb bi"><span id="0fc6" class="kc kd hi jy b fi ke kf l kg kh">sns.countplot(x=’status’,data=df)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es km"><img src="../Images/7a0f6c6f50d0d6850fbe8d78600ee3c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*UIklRedZyheL1sZbEd1tHQ.png"/></div></figure><pre class="je jf jg jh fd jx jy jz ka aw kb bi"><span id="d332" class="kc kd hi jy b fi ke kf l kg kh">sns.countplot(x=’status’,hue=’gender’,data = df)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kn"><img src="../Images/7afce5897c9629389599b6dd78d58449.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*dXibVenNtLp9JZIhvGmJVg.png"/></div></figure><p id="1398" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将分类变量转换为指示变量</p><pre class="je jf jg jh fd jx jy jz ka aw kb bi"><span id="c77e" class="kc kd hi jy b fi ke kf l kg kh">workexp= pd.get_dummies(df[‘workex’])<br/>workexp</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ko"><img src="../Images/ee0bde74b7edf689a344893b3fd26a21.png" data-original-src="https://miro.medium.com/v2/resize:fit:424/format:webp/1*MFldBu44H7dTir3aFeIdGw.png"/></div></figure><p id="4440" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将数据连接到原始数据集中。</p><pre class="je jf jg jh fd jx jy jz ka aw kb bi"><span id="6457" class="kc kd hi jy b fi ke kf l kg kh">df=pd.concat([df,workexp],axis=1)<br/>df</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kp"><img src="../Images/5a19bec1d120ce08413a09a64deaa114.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m7z5sgiZcqgXT32Scd9ETw.png"/></div></div></figure><pre class="je jf jg jh fd jx jy jz ka aw kb bi"><span id="bc45" class="kc kd hi jy b fi ke kf l kg kh">df.drop([‘sl_no’,’gender’,’ssc_b’,’hsc_b’,’hsc_s’,’degree_t’,’workex’,’specialisation’],axis=1,inplace=True)<br/>df</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kq"><img src="../Images/d2ea64fd063b543be091ac05801aaa6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*Rk9tpDPhSL8vP9S_uaxaFw.png"/></div></figure><p id="2957" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">培训和测试数据</p><pre class="je jf jg jh fd jx jy jz ka aw kb bi"><span id="5cd4" class="kc kd hi jy b fi ke kf l kg kh">X=df.drop(‘status’,axis=1)<br/>y=df[‘status’]<br/>X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=1)</span></pre><p id="93c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">应用朴素贝叶斯定理</p><pre class="je jf jg jh fd jx jy jz ka aw kb bi"><span id="19da" class="kc kd hi jy b fi ke kf l kg kh">from sklearn.naive_bayes import GaussianNB<br/>model = GaussianNB()<br/>model.fit(X_train,y_train)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kr"><img src="../Images/81462fd53e8489050b6249972f4c7586.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*tzsK41mh9tvYeXIkG011Lw.png"/></div></figure><p id="36af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">比较实际状态和预测状态</p><pre class="je jf jg jh fd jx jy jz ka aw kb bi"><span id="3072" class="kc kd hi jy b fi ke kf l kg kh">y_pred=model.predict(X_test)<br/>df1=pd.DataFrame({‘Actual Status’:y_test,’Predicted Status’:y_pred})<br/>df1</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ks"><img src="../Images/b6b918ac2614e5dd3ae02e87964a3c05.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*iudSPmGsWN3yOEVwzquEMg.png"/></div></figure><p id="98e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分类报告:<br/>分类报告用于衡量分类算法的预测质量。</p><pre class="je jf jg jh fd jx jy jz ka aw kb bi"><span id="9321" class="kc kd hi jy b fi ke kf l kg kh">print(classification_report(y_test, y_pred))</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kt"><img src="../Images/047f55b4aff6cda2330a6c86183e84af.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*_S3SbsoOlHiWAGMM6cXySg.png"/></div></figure><p id="ecb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">混淆矩阵:<br/>混淆矩阵是对一个分类问题的预测结果的总结。正确和错误预测的数量用计数值汇总，并按每个类别细分。</p><pre class="je jf jg jh fd jx jy jz ka aw kb bi"><span id="3703" class="kc kd hi jy b fi ke kf l kg kh">print(confusion_matrix(y_test,y_pred))</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ku"><img src="../Images/6bb85859c43092e1a9fc8aad5c0a3614.png" data-original-src="https://miro.medium.com/v2/resize:fit:276/format:webp/1*XLRZXS-fP5VDmQF92U9gQw.png"/></div></figure><p id="e0ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">准确度分数:</p><pre class="je jf jg jh fd jx jy jz ka aw kb bi"><span id="2c4c" class="kc kd hi jy b fi ke kf l kg kh">print(accuracy_score(y_test,y_pred)*100)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kv"><img src="../Images/46cdf437bf953d8ea2fc7ff772ad2a66.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*vBpaSdQikQ7_W0GVFWiUjw.png"/></div></figure><p id="54e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文研究了机器学习算法，即朴素贝叶斯分类。<br/>此外，我们使用scikit learn实现了朴素贝叶斯分类。</p><p id="3b98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望你们理解如何实现朴素贝叶斯分类。请在评论区告诉我你的疑问和建议。</p><p id="8177" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">快乐学习！！</p></div></div>    
</body>
</html>