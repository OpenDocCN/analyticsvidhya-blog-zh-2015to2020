<html>
<head>
<title>Predicting earth quake with Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用机器学习预测地震</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predicting-earth-quake-with-machine-learning-8946a19a500e?source=collection_archive---------27-----------------------#2020-03-29">https://medium.com/analytics-vidhya/predicting-earth-quake-with-machine-learning-8946a19a500e?source=collection_archive---------27-----------------------#2020-03-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a741" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在所有的自然灾害中，地震是发生频率最高的，造成的生命损失和财产损失高达十亿美元。从一项关于地震死亡人数的调查中，我们可以看到几年来死亡人数以十万计，这强调了受灾地区面临的破坏。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/6e13bf3fe912d7a1a865ef4b8617c94f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*ZVgasr9AqyJh9PUJqVTCFQ.png"/></div></figure><p id="9f41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，如果我们能找到一种提前预测地震的方法，那么我们就有机会拯救很多生命和基础设施。在考虑如何预测地震之前，让我们先了解什么是地震以及它是如何发生的。</p><p id="6e9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么是地震？</strong></p><p id="dbd9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">地球(地壳)的顶层被称为岩石圈，它不是像蛋壳一样包裹整个地球的连续块。它实际上是由被称为<a class="ae jd" href="https://spaceplace.nasa.gov/tectonics-snap" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">构造板块</strong> </a>的巨大拼图块组成的。</p><p id="91ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些<a class="ae jd" href="http://earthquake.usgs.gov/learn/glossary/?term=tectonic%20plates" rel="noopener ugc nofollow" target="_blank">构造板块</a>移动缓慢，但它们会因摩擦而卡在边缘。当边缘的<a class="ae jd" href="http://earthquake.usgs.gov/learn/glossary/?term=stress" rel="noopener ugc nofollow" target="_blank">应力</a>克服摩擦力时，就会发生地震，以波的形式释放能量，穿过地壳，导致我们感觉到的震动。</p><p id="ded2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此<strong class="ih hj">地震</strong>是地球表面的强烈震动。震动是由地球最外层的运动引起的。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jm"><img src="../Images/dab821d3e6eb9710d7392690d17fd5e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/format:webp/1*RwhPTYlwPqRj6lF0fA_t3w.png"/></div><figcaption class="jn jo et er es jp jq bd b be z dx translated">地球层</figcaption></figure><p id="9652" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">过去几十年来，人们一直在进行大量的研究，试图找到一种提前几个小时/几天预测地震的方法。但这似乎是一个比预期更复杂的问题。所以，让我们看看我们是否能提前几秒/几分钟发现地震，这样现代电力系统就能有自动防故障装置来减轻地震造成的损失。</p><p id="d9b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">卡格尔举办了一场比赛(<a class="ae jd" href="https://www.kaggle.com/c/LANL-Earthquake-Prediction" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/c/LANL-Earthquake-Prediction</a>)。)之类的，在这篇博客中，让我们来看看解决这个问题的机器学习生命周期中涉及的所有步骤。</p><p id="2947" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">关于比赛</strong></p><p id="b328" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这项挑战是由洛斯阿拉莫斯国家实验室主办的，在这项比赛中，你将回答地震何时会发生。具体来说，您将根据实时地震数据预测实验室地震发生前的剩余时间。</p><h1 id="be35" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">数据概述</strong></h1><p id="c11f" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">这些数据来自一个著名的用于研究地震物理的实验装置。我们给出了训练和测试数据集。在训练数据中，数据是从包含多个地震的单个连续实验中收集的，并且测试数据由包含许多小段的文件夹组成。内的数据<em class="ku">每个测试文件都是连续的，但测试文件并不代表一个连续的实验片段；因此，不能假设预测遵循在训练文件中看到的相同规则模式。</em></p><p id="caa7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练数据集包含6亿个数据点，具有两列acoustic_data和time_to_failure。声学数据是地震信号和从实时地震数据到实验室地震发生的剩余时间(失效时间，或TTF)</p><p id="377f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">到目前为止，我们知道我们的业务问题是什么，也有通过实验室实验收集的数据。现在，我们将它作为一个ML问题，并定义性能指标。</p><h1 id="1955" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">性能指标</strong></h1><p id="71a0" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">我们的目标是在实时地震发生之前找到TTF值(这是一个连续值)。因此，我们可以把它称为“回归”问题。主要限制是在运行时具有低延迟。使用的性能指标是平均绝对误差(MAE ),它测量两个连续变量之间的差异(在我们的例子中是预测值和观测值之间的差异)。</p><h1 id="e718" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">探索性数据分析</strong></h1><p id="1b61" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">在开始数据预处理/清理之前，让我们先看看给定数据的各个方面。由于给定的训练数据集有6亿条记录，即使在配置不错的系统上，如12GB RAM和i5处理器，也不容易加载和可视化完整的数据</p><p id="4a35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">处理这种情况的一种方法是只从数据集加载10%的数据并执行EDA，在我的情况下，我一直想尝试GCP(谷歌云平台)，所以我创建了一个帐户并创建了一个64GB RAM的实例，这对于处理如此庞大的数据来说绰绰有余。</p><p id="2e18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从下面的声音信号和TTF(训练数据)之间的图中，我们可以看到，在训练数据集中总共产生了16次人工地震。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kv"><img src="../Images/bad5b913b90bf553b9a9a09d7e34eac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*MOqu2V-ZyFBgBJLIswtVeA.png"/></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kv"><img src="../Images/df2b1ae756714cd68d2a1949bde1a11f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*jFb5-4EvpoxaHGGzq_xZtw.png"/></div></figure><p id="2198" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的图中，我们可以看到，就在TTF(即地震发生)之前，声学信号值有一个突然的尖峰。让我们看看声波信号在总体数据上的分布。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kw"><img src="../Images/aba248f75bedf98330abee9585e614ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*95x3ciWoHR-vb-1dWvlQlQ.png"/></div></figure><p id="fa11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分布以零为中心，因为除了地震发生的大部分时间，地震在零附近。</p><h1 id="097a" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">特征工程</strong></h1><p id="1176" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">作为数据验证的一个步骤，我检查了数据中是否有任何空条目或异常值，但是没有找到。因此，走向特征工程。给定数据的主要问题是我们有一个单一的特征，即我们有一个声音信号作为时间序列的输入。到目前为止，我主要处理文本数据，我总是试图减少特征的数量以提高整体性能，而这次相反，我们必须在给定单个特征的情况下生成多个特征。</p><p id="f1c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是从大约40个特征的给定输入中产生的一些重要特征。</p><p id="d467" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">梅尔频率倒谱系数(MFCC): </strong>这是一组20个特征，简明地描述了频谱包络的整体形状。</p><p id="0854" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">百分位数:</strong>百分位数是一种表示a值在数据集中位置的方式。</p><p id="47da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">过零点:</strong>这代表地震波过零点的次数。</p><p id="1ec4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">峰的数量:</strong>顾名思义，这个特性简单地统计一个窗口中的峰的数量。</p><p id="bd46" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Mean，std: </strong> Mean是给定段中地震信号的平均值，标准偏差用于测量平均值的数据分布。</p><p id="7d5b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">偏斜度，峰度:</strong>偏斜度用于测量声学信号中的不对称性，峰度测量分布的尾部沉重度。</p><p id="e66f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">快速傅立叶变换:</strong>傅立叶变换是一种将类似地震信号的信号分解成多个频率乘积的方法。</p><p id="83fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">斜率和截距:</strong>它取直线的斜率和截距项，我们试图用它们来拟合线段</p><h1 id="7a8f" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">功能选择</strong></h1><p id="0070" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">鉴于实时数据和准确性，低延迟在这种情况下同样重要。因此，最好使用像VIF(方差膨胀因子)这样的技术或使用模型特征重要性属性来移除不太重要的特征。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="kx ky l"/></div></figure><p id="f2dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我使用了随机森林的特征重要性属性，并考虑了进一步建模的前12个特征。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kz"><img src="../Images/075ed30dc498cf2ed81aba7defa0a4e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*PYtLtXQXQo-vDIQo617C2g.png"/></div></figure><h1 id="1418" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">造型</strong></h1><p id="dc82" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">一般来说，选择符合业务约束的正确模型同样重要。在我们的例子中，我们已经对数据进行了分段，并从1，50，000条记录的集合中生成了单个观察值，我们总共有大约5000条记录作为训练数据集，大约2600条记录作为测试数据集。</p><p id="80d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于最终的训练数据集不是太大，我们可以从简单的模型开始，如SVR和线性回归，以避免过度拟合问题。</p><p id="b307" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> SVR </strong></p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="kx ky l"/></div></figure><p id="6446" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，尝试了一些复杂的模型，如随机森林，GBDT等。，因为数据不太短。</p><p id="50e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> RF </strong> <br/>这是系综模型(Bagging)的一种形式，它在建模中自举聚合</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="kx ky l"/></div></figure><p id="01fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> GBDT </strong></p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="kx ky l"/></div></figure><h1 id="a784" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">结论</strong></h1><p id="a7f3" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">通过使用超参数调整，从所有上述模型中，发现随机森林正在产生更好的结果。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es la"><img src="../Images/ca7a4dbedbc492dc559c41cc933c061e.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*kdJwpzo9GQe7weLSiWhSmQ.png"/></div><figcaption class="jn jo et er es jp jq bd b be z dx translated">平均绝对误差分数</figcaption></figure><h1 id="50cd" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">未来工作</strong></h1><p id="8832" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">为了进一步提高模型的性能，我们可以尝试使用复杂的模型，如神经网络，即LSTM等，我们还可以包括从tsfresh库中自动提取相关特征</p><h1 id="00c1" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">参考文献</strong></h1><div class="lb lc ez fb ld le"><a href="https://www.usgs.gov/faqs/what-earthquake-and-what-causes-them-happen?qt-news_science_products=0#qt-news_science_products" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab dw"><div class="lg ab lh cl cj li"><h2 class="bd hj fi z dy lj ea eb lk ed ef hh bi translated">什么是地震，是什么导致了地震的发生？</h2><div class="ll l"><h3 class="bd b fi z dy lj ea eb lk ed ef dx translated">地震是由断层的突然滑动引起的。构造板块总是在缓慢移动，但它们会被卡住…</h3></div><div class="lm l"><p class="bd b fp z dy lj ea eb lk ed ef dx translated">www.usgs.gov</p></div></div><div class="ln l"><div class="lo l lp lq lr ln ls jk le"/></div></div></a></div><div class="lb lc ez fb ld le"><a href="https://www.appliedaicourse.com/lecture/11/applied-machine-learning-online-course/3082/bootstrapped-aggregation-bagging-intuition/4/module-4-machine-learning-ii-supervised-learning-models" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab dw"><div class="lg ab lh cl cj li"><h2 class="bd hj fi z dy lj ea eb lk ed ef hh bi translated">应用课程</h2><div class="ll l"><h3 class="bd b fi z dy lj ea eb lk ed ef dx translated">应用机器学习课程GATE CS混合课程面试准备课程AI Workshop AI案例研究</h3></div><div class="lm l"><p class="bd b fp z dy lj ea eb lk ed ef dx translated">www.appliedaicourse.com</p></div></div></div></a></div><div class="lb lc ez fb ld le"><a href="https://www.kaggle.com/c/LANL-Earthquake-Prediction/data" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab dw"><div class="lg ab lh cl cj li"><h2 class="bd hj fi z dy lj ea eb lk ed ef hh bi translated">LANL地震预测</h2><div class="ll l"><h3 class="bd b fi z dy lj ea eb lk ed ef dx translated">你能预测即将到来的实验室地震吗？</h3></div><div class="lm l"><p class="bd b fp z dy lj ea eb lk ed ef dx translated">www.kaggle.com</p></div></div><div class="ln l"><div class="lt l lp lq lr ln ls jk le"/></div></div></a></div><div class="lb lc ez fb ld le"><a rel="noopener follow" target="_blank" href="/prathena/the-dummys-guide-to-mfcc-aceab2450fd"><div class="lf ab dw"><div class="lg ab lh cl cj li"><h2 class="bd hj fi z dy lj ea eb lk ed ef hh bi translated">MFCC虚拟指南</h2><div class="ll l"><h3 class="bd b fi z dy lj ea eb lk ed ef dx translated">免责声明1:这篇文章只是一个MFCC功能的介绍，是为那些需要一个简单和…</h3></div><div class="lm l"><p class="bd b fp z dy lj ea eb lk ed ef dx translated">medium.com</p></div></div><div class="ln l"><div class="lu l lp lq lr ln ls jk le"/></div></div></a></div><p id="3bd2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://tsfresh.readthedocs.io/en/latest/text/list_of_features.html" rel="noopener ugc nofollow" target="_blank">https://ts fresh . readthe docs . io/en/latest/text/list _ of _ features . htm</a></p><p id="f9bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">https://spaceplace.nasa.gov/earthquakes/恩</p></div></div>    
</body>
</html>