<html>
<head>
<title>Basics of Pandas — Part 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫基础知识——第 3 部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/basics-of-pandas-part-3-dba6b5d06d03?source=collection_archive---------44-----------------------#2020-12-30">https://medium.com/analytics-vidhya/basics-of-pandas-part-3-dba6b5d06d03?source=collection_archive---------44-----------------------#2020-12-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="273c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我的上一篇文章中，我谈到了初学者在处理各种数据集时面临的一些常见查询。本文是我以前文章的延续。</p><p id="d730" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将继续使用本文第一部分和第二部分中使用的相同数据集(UFO)来演示进一步的概念。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/61837fb00a87afe852a2ec82da8d8521.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8qgAaLQOe-nd_D9h.png"/></div></div></figure><h2 id="32b1" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated"><strong class="ak">如何将分类特征转换为数字特征？</strong></h2><p id="5525" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">分类特征需要改为数字特征，以适应任何特定的模型。虽然使用标签编码器是有益和方便的，但是熊猫提供了一种使用<code class="du kp kq kr ks b">get_dummies</code>将分类特征转换为数字特征的方法。</p><pre class="je jf jg jh fd kt ks ku kv aw kw bi"><span id="a657" class="jp jq hi ks b fi kx ky l kz la">pd.get_dummies(ufo,columns=['City'])</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lb"><img src="../Images/41555424ab1dfc55cdfeb873fa454c0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*DCFzRbg-v8i0FH1bwQ6lVA.png"/></div><figcaption class="lc ld et er es le lf bd b be z dx translated">在实现 get_dummies 函数之前</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lg"><img src="../Images/d0981b61c2d9011242a3344715b9364d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1jThX3SqgURJvDkCSdxRQA.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">在实现 get_dummies 函数或方法后。</figcaption></figure><h2 id="8189" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">我如何将函数应用于熊猫系列或数据帧？</h2><p id="ec08" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">这可以通过三种方法来实现</p><ul class=""><li id="e7a8" class="lh li hi ih b ii ij im in iq lj iu lk iy ll jc lm ln lo lp bi translated"><code class="du kp kq kr ks b"><em class="lq">applymap</em></code>-对数据帧中的每个元素应用一个函数</li><li id="de73" class="lh li hi ih b ii lr im ls iq lt iu lu iy lv jc lm ln lo lp bi translated"><code class="du kp kq kr ks b"><em class="lq">apply</em></code>-对系列中的每个元素应用一个函数</li><li id="88d4" class="lh li hi ih b ii lr im ls iq lt iu lu iy lv jc lm ln lo lp bi translated"><code class="du kp kq kr ks b"><em class="lq">map</em></code>-将一个系列的现有值映射到一组不同的值</li></ul><p id="2237" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们在数据框中从给定的时间格式中分离出年份</p><pre class="je jf jg jh fd kt ks ku kv aw kw bi"><span id="a313" class="jp jq hi ks b fi kx ky l kz la">ufo['Time']=ufo['Time'].apply(lambda x:x.split('/')[2])<br/>#splits string using '/' as a separator <br/>ufo['Time']=ufo['Time'].apply(lambda x:x.split(' ')[0])<br/>#splits string using ' ' as a separator</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lw"><img src="../Images/d5ff3f5082dba27444366e1e2b0d5875.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*DdhcK_ragLoflvwf9t3tvA.png"/></div></figure><p id="3f47" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了演示地图和<code class="du kp kq kr ks b">applymap</code>方法，我创建了一个新的列，并命名为“new”(缺乏创造力)，包含值 0 和 1。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lx"><img src="../Images/89dd3366b48dfb039fb9762656746839.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*fnVnpm0XFhArHmUK_lppQA.png"/></div><figcaption class="lc ld et er es le lf bd b be z dx translated">修改的不明飞行物数据集</figcaption></figure><pre class="je jf jg jh fd kt ks ku kv aw kw bi"><span id="ffa0" class="jp jq hi ks b fi kx ky l kz la">ufo['Valid']=ufo.New.map({0:'No',1:'Yes'})</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ly"><img src="../Images/f8bfb93ba10e14d8497c932688f779ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*uv-7J_Dt4aHgMy_9zzUi3w.png"/></div><figcaption class="lc ld et er es le lf bd b be z dx translated">应用映射后</figcaption></figure><pre class="je jf jg jh fd kt ks ku kv aw kw bi"><span id="e7fa" class="jp jq hi ks b fi kx ky l kz la">ufo.loc[:,'Time':'New'].applymap(float)<br/>#apply map is only valid for DataFrame and not series object</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lz"><img src="../Images/632660a88392189045cf3799071c272c.png" data-original-src="https://miro.medium.com/v2/resize:fit:388/format:webp/1*FHwxAoNNTDx_4Nl9jVzK_Q.png"/></div><figcaption class="lc ld et er es le lf bd b be z dx translated">应用 applymap 方法后</figcaption></figure><h2 id="270f" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">我如何找到并删除熊猫中的重复行？</h2><p id="b000" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">您可以通过将<code class="du kp kq kr ks b">.duplicated()</code>归属于整个数据框来找出重复的行。也可以使用与系列对象相同的属性来检查列的相似值。</p><p id="7749" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kp kq kr ks b"><a class="ae ma" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.duplicated.html" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">duplicated</strong></a></code>逻辑:</p><ul class=""><li id="ef9d" class="lh li hi ih b ii ij im in iq lj iu lk iy ll jc lm ln lo lp bi translated"><code class="du kp kq kr ks b"><strong class="ih hj">keep='first'</strong></code>(默认):除第一次出现外，将重复项标记为真。</li><li id="0c35" class="lh li hi ih b ii lr im ls iq lt iu lu iy lv jc lm ln lo lp bi translated"><code class="du kp kq kr ks b"><strong class="ih hj">keep='last'</strong></code>:除最后一次出现外，将重复项标记为真。</li><li id="def8" class="lh li hi ih b ii lr im ls iq lt iu lu iy lv jc lm ln lo lp bi translated"><code class="du kp kq kr ks b"><strong class="ih hj">keep=False</strong></code>:将所有重复项标记为真。</li></ul><pre class="je jf jg jh fd kt ks ku kv aw kw bi"><span id="2c02" class="jp jq hi ks b fi kx ky l kz la">ufo.duplicated().sum()<br/>#checks the total no of rows that are identicle <br/>ufo.drop_duplicates(keep='first',inplace=True)<br/>#dropping duplicate entries keeping the very first of each</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mb"><img src="../Images/4262e971ec88a06d05da117d1b2f89ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*FrZ33-T80rBMzBHAT5_8KQ.png"/></div><figcaption class="lc ld et er es le lf bd b be z dx translated">重复条目</figcaption></figure><p id="714a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当然，在使用数据集时，人们最终会发现更多的技术，但我的系列文章强调了我在使用数据集时遇到的一些(如果不是所有的话)查询。希望你喜欢读我的文章</p><p id="7961" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这标志着“熊猫基础”系列的结束。希望你喜欢阅读它。在这里查看与本系列相关的另外两篇文章</p><p id="ae8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae ma" rel="noopener" href="/analytics-vidhya/basics-of-pandas-part-1-9eac7104fd3b">熊猫基础知识—第一部分</a></p><p id="9d31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae ma" rel="noopener" href="/analytics-vidhya/basics-of-pandas-part-2-d6f931dcce30">熊猫基础知识—第二部分</a></p><p id="1d9f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谢谢😉</p></div></div>    
</body>
</html>