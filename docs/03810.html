<html>
<head>
<title>Multi-Label Text Classification with StarSpace in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R空间中的多标签文本分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/multi-label-text-classification-with-starspace-in-r-c9d72d7b7146?source=collection_archive---------4-----------------------#2020-02-20">https://medium.com/analytics-vidhya/multi-label-text-classification-with-starspace-in-r-c9d72d7b7146?source=collection_archive---------4-----------------------#2020-02-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ac11caf9d808921cfe4dfc3ecbcd2eb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mTxrxh9M2IQDLkkZ"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">丹尼斯·德吉奥安尼在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="e5aa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本帖中，我们将根据描述电影情节的文本来预测电影类型。</p><p id="2d42" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="http://www.cs.cmu.edu/~ark/personas/" rel="noopener ugc nofollow" target="_blank">数据</a>来自每部电影的维基百科页面。我们使用的R包是使用脸书人工智能研究团队开发的方法创建的<a class="ae iu" href="https://cran.r-project.org/web/packages/ruimtehol/index.html" rel="noopener ugc nofollow" target="_blank"> ruimtehol </a>包(<a class="ae iu" href="https://research.fb.com/downloads/starspace/" rel="noopener ugc nofollow" target="_blank"> StarSpace </a>，<a class="ae iu" href="https://emnlp2014.org/papers/pdf/EMNLP2014194.pdf" rel="noopener ugc nofollow" target="_blank"> TagSpace </a>)。你可以在这里找到我这个项目<a class="ae iu" href="https://github.com/BenjaminPhillips22/movie_genres" rel="noopener ugc nofollow" target="_blank">的代码。</a></p><p id="b88d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">何时以及为什么使用标记空间？在这种情况下，我们有文本数据(电影情节)和大量的标签(类型),这些标签并没有完全一致地应用。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/eb86f48bdbb6d56556f212b8131b5df8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zQ8SSlNgDv1sDDNxhxVWbg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">看标签空间“引擎盖下”</figcaption></figure><p id="be94" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">TagSpace被设计成使用脸书帖子的自由文本来预测与这些帖子相关的标签。我们可以将他们的用例扩展到我们的。我们在情节描述中有文字，类型很像标签。</p><p id="8e69" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">StarSpace类似于TagSpace，但是更加一般化。标签空间允许我们从单词嵌入创建文档嵌入，而StarSpace允许我们为任何东西创建嵌入。例如，网站可能具有从网站上的文本生成的嵌入，而用户可能具有从他们访问的网站生成的嵌入。</p><p id="5187" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">我们开始吧！</strong></p><p id="c969" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以手动下载数据或使用以下代码。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="83d7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">加载必要的库。ruimtehol包为我们在r中使用StarSpace算法提供了框架。它是由Jan Wijffels创建的，他写道ruimtehol是“star space”在西佛兰芒语中的翻译。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="0951" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我们开始建模之前，有许多预处理步骤。我们需要将情节描述数据加入到类型数据中，并对它们进行清理。下面是使用的文本清理功能。有关清理和加入数据的更多细节，或项目的其他部分，请参见我的github repo <a class="ae iu" href="https://github.com/BenjaminPhillips22/movie_genres" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">我们使用一些流行的文本处理技术，如<a class="ae iu" href="https://en.wikipedia.org/wiki/Stemming" rel="noopener ugc nofollow" target="_blank">词干</a>和删除“停用词”(常见的词，如“the”、“a”和“to”)。还有其他常见的技术，如l <a class="ae iu" href="https://en.wikipedia.org/wiki/Lemmatisation" rel="noopener ugc nofollow" target="_blank"> emmatisation </a>可以用来代替词干。</figcaption></figure><p id="1994" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">电影《回到未来》已经标注了流派；科幻、冒险、喜剧、家庭电影。情节的第一行是“17岁的马蒂·小飞侠和他暗淡无光、毫无抱负的家人住在加利福尼亚州的希尔谷。”。处理后会是这样的；“17岁的马蒂·麦克弗莱住在荒凉的加州山谷”</p><p id="08d9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一点探索性的分析不会有坏处，而且经常会有帮助。</p><p id="2110" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">流派</strong></p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="44b2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以看到最受欢迎的类型标签是戏剧、喜剧和浪漫电影。在最不受欢迎的词中，可以看到喜剧和浪漫惊悚片的拼写错误。如果你想知道，浪漫惊悚片中的一部电影是宝莱坞电影，名为“血腥的伊瑟克”。因为有些类型出现的次数很少，所以在这个实验中，我们只预测前50个类型。</p><p id="672a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">标签并不完美。考虑与浪漫有关的类型。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="07c2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">电影《公主新娘》有标签；喜剧、喜剧、戏剧、喜剧、爱情电影、家庭电影和青少年电影。它被称为浪漫电影和戏剧，但不是浪漫戏剧。标记空间算法特别擅长处理这种模糊分类问题。</p><p id="c3da" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">情节描述中的词(删除停用词后)</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="057e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">“杀”似乎是电影情节描述中最常见的词。推断你对人性和/或电影文化的看法。</p><p id="aba0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有很多单词在整个数据集中只出现几次。我们需要在训练模型时考虑到这一点。</p><p id="92cd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">造型</strong></p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="32c2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因为我们想对文本进行分类，所以我们将使用embed_tagspace函数。我们来看看参数。</p><ul class=""><li id="f9e7" class="ka kb hi ix b iy iz jc jd jg kc jk kd jo ke js kf kg kh ki bi translated">x是模型将用作特征的已清理文本。它应该是一个向量，其中每个元素都是一个字符串。</li><li id="a424" class="ka kb hi ix b iy kj jc kk jg kl jk km jo kn js kf kg kh ki bi translated">y是模型将尝试和预测的标签。它应该是一个列表，列表中的每个元素都是流派的向量。</li><li id="ccfe" class="ka kb hi ix b iy kj jc kk jg kl jk km jo kn js kf kg kh ki bi translated">dim是为文本生成的文档嵌入的尺寸大小。每个绘图描述将被表示为长度为20的向量。</li><li id="aa82" class="ka kb hi ix b iy kj jc kk jg kl jk km jo kn js kf kg kh ki bi translated">历元是为模型定型的最大历元数。在内部，embed_tagspace函数创建一个训练和开发集。当开发集的性能在10个时期后没有提高时，训练就停止了。我们的模型通常运行大约15个时期。</li><li id="1865" class="ka kb hi ix b iy kj jc kk jg kl jk km jo kn js kf kg kh ki bi translated">lr是神经网络的学习速率。</li><li id="e00b" class="ka kb hi ix b iy kj jc kk jg kl jk km jo kn js kf kg kh ki bi translated">损失是损失函数。代替softmax的另一个选项是“铰链”。</li><li id="d2f2" class="ka kb hi ix b iy kj jc kk jg kl jk km jo kn js kf kg kh ki bi translated">negSearchLimit是抽样的负片标签数。</li><li id="ae7b" class="ka kb hi ix b iy kj jc kk jg kl jk km jo kn js kf kg kh ki bi translated">ws是模型查看文本的窗口大小。</li><li id="ce02" class="ka kb hi ix b iy kj jc kk jg kl jk km jo kn js kf kg kh ki bi translated">minCount是一个单词在整个语料库中出现的最小次数，以便模型为其创建嵌入并将其用作预测过程的一部分。出现次数少于此数量的单词对模型是不可见的。</li></ul><p id="9f11" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">评估模型。</strong></p><p id="fd0a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">模型的输出是文本嵌入和每个流派标签之间的相似性得分。相似性得分介于-1和1之间，得分越高意味着相似性越大。有许多方法可以衡量模型的准确性。在这种情况下，我们将采用模型输出，过滤以仅包含该电影最初标记的流派，并计算相似性得分的平均值。这样我们就不会因为不完美的标签而受到惩罚。另一个选择是查看<a class="ae iu" href="https://en.wikipedia.org/wiki/Precision_and_recall" rel="noopener ugc nofollow" target="_blank">精度并回忆</a>。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="f358" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">不适合我们。</p><p id="3d01" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们看看我们的模型做得好和不好的地方。clean _流派列是真实流派，top _ 5 _流派是该情节的前5个预测流派。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="0ce7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">下一步。</strong></p><p id="a6f3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了提高准确性，可能值得尝试模型的不同超参数。我们可以考虑增加嵌入尺寸或减少minCount。尝试使用铰链损耗而不是softmax作为损耗函数，增加窗口大小(ws)或尝试使用不同的negSearchLimit值。</p></div></div>    
</body>
</html>