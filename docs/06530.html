<html>
<head>
<title>Beginner Level Introduction to Three Keras Model APIs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">三种Keras模型API的初级介绍</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/beginner-level-introduction-to-three-keras-model-apis-24a45f7af3c9?source=collection_archive---------15-----------------------#2020-05-25">https://medium.com/analytics-vidhya/beginner-level-introduction-to-three-keras-model-apis-24a45f7af3c9?source=collection_archive---------15-----------------------#2020-05-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/292cb9823015d4d77d12f00c933fcc4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XMAV2AI67VdSr7WI"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae iu" href="https://unsplash.com/@michalico?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Michal Ico </a>拍摄的照片</figcaption></figure></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="e4f2" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi ka translated"><span class="l kb kc kd bm ke kf kg kh ki di"> T </span>他的文章主要面向初学者和那些有多余时间阅读另一篇关于Keras的文章的人。</p><p id="6b0d" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">在本文中，我们将从三种不同类型的模型(顺序、功能和子类)API的概述开始，我们可以用它们来创建Keras模型以解决不同的用例。还有其他方法来创建深度学习(DL)模型。然而，本文的范围是使用简单的数据和简单的模型为初学者演示DL概念。</p><p id="7153" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">使用的数据集:MNIST数据</p><p id="add7" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">使用的平台/库:TensorFlow 2.2、Keras和Python 3.x</p><figure class="kk kl km kn fd ij er es paragraph-image"><div class="er es kj"><img src="../Images/217ce33c01dbf4814e7debf569725c0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*NJqXlCBkncbGeMFP-mvj2w.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">TensorFlow库下的Keras API</figcaption></figure><p id="88b3" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">在深入细节之前，Keras是什么？</p><ul class=""><li id="6d63" class="ko kp hi je b jf jg jj jk jn kq jr kr jv ks jz kt ku kv kw bi translated">K是用Python编写的神经网络(NN)库。</li><li id="6693" class="ko kp hi je b jf kx jj ky jn kz jr la jv lb jz kt ku kv kw bi translated">用深度神经网络实现快速实验</li><li id="e958" class="ko kp hi je b jf kx jj ky jn kz jr la jv lb jz kt ku kv kw bi translated">可靠、模块化、可扩展，支持多后端和多平台</li><li id="474f" class="ko kp hi je b jf kx jj ky jn kz jr la jv lb jz kt ku kv kw bi translated"><strong class="je hj">一个</strong>广泛用于DL模型产品化的神经网络库</li><li id="3a7c" class="ko kp hi je b jf kx jj ky jn kz jr la jv lb jz kt ku kv kw bi translated">简单易学，易于使用</li></ul></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="efe1" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">【Keras有什么？</p><p id="e6ef" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">Keras有许多API来构建、训练、评估和可视化模型性能。下面列出了几个主要的API。</p><p id="c86b" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="je hj">模型API </strong></p><ul class=""><li id="cd22" class="ko kp hi je b jf jg jj jk jn kq jr kr jv ks jz kt ku kv kw bi translated">顺序、功能和子类</li></ul><p id="bec0" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="je hj">层API </strong></p><ul class=""><li id="1274" class="ko kp hi je b jf jg jj jk jn kq jr kr jv ks jz kt ku kv kw bi translated">密集，Conv，LSTM，GRU，辍学，汇集，Batchnorm等。</li></ul><p id="0ae2" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="je hj">损失API </strong></p><ul class=""><li id="bcf8" class="ko kp hi je b jf jg jj jk jn kq jr kr jv ks jz kt ku kv kw bi translated">类别交叉熵、均方误差、平均绝对误差等。</li></ul><p id="50e5" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="je hj">指标API </strong></p><ul class=""><li id="3fff" class="ko kp hi je b jf jg jj jk jn kq jr kr jv ks jz kt ku kv kw bi translated">精度、二进制精度、分类精度、top _ k _分类精度等。</li></ul><p id="1efd" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="je hj">优化器API </strong></p><ul class=""><li id="d9b1" class="ko kp hi je b jf jg jj jk jn kq jr kr jv ks jz kt ku kv kw bi translated">SGD，Adam，RMSprop。阿达格拉德、阿达德尔塔、阿达马克斯等。</li></ul><p id="8844" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="je hj">激活API </strong></p><ul class=""><li id="aaae" class="ko kp hi je b jf jg jj jk jn kq jr kr jv ks jz kt ku kv kw bi translated">Relu，tanh，sigmoid，elu，softmax，卢瑟等。</li></ul><p id="6f97" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="je hj">回调API </strong></p><ul class=""><li id="0062" class="ko kp hi je b jf jg jj jk jn kq jr kr jv ks jz kt ku kv kw bi translated">模型检查点，张量板，提前停止，历史等。</li></ul></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="fab7" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">上面的API是用于构建Keras模型的构建块(像乐高积木一样)。这些API使我们能够轻松地构建简单和复杂的模型。我们将使用上述大多数API来构建、训练和评估Keras模型。最后，我们可以可视化Keras模型的性能，以微调或生产模型。</p></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="49c2" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">任何DL问题都可以通过使用三个Keras模型API中的一个或多个来解决。让我们更深入地研究一下这些模型API，找出为什么我们有三个API，以及何时使用一个特定的API。</p><h1 id="e3b7" class="lc ld hi bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated"><strong class="ak"> 1。顺序模式:</strong></h1><p id="44db" class="pw-post-body-paragraph jc jd hi je b jf ma jh ji jj mb jl jm jn mc jp jq jr md jt ju jv me jx jy jz hb bi translated">简单地说，顺序模型由线性堆叠在模型中的Keras层组成。<strong class="je hj">这很简单，适用于约60–70%的应用，但有一个主要限制，即它仅适用于单输入和单输出。</strong>如果你的用例需要多个输入和/或输出，那么就使用功能性的或者子类化的模型API。</p><p id="6f55" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">您可以定义一个顺序模型，如下所示。</p><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><figure class="kk kl km kn fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/31571df9aeaf7e19805248068b8360da.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*p598kEC-ASLxXSPDW2PQ8w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">上述神经网络模型的架构</figcaption></figure></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><h1 id="6fa3" class="lc ld hi bd le lf mi lh li lj mj ll lm ln mk lp lq lr ml lt lu lv mm lx ly lz bi translated"><strong class="ak"> 2。功能型号:</strong></h1><p id="b1de" class="pw-post-body-paragraph jc jd hi je b jf ma jh ji jj mb jl jm jn mc jp jq jr md jt ju jv me jx jy jz hb bi translated">与顺序模型不同，功能模型不太复杂，但可以处理多个输入和输出。它可以处理具有非线性拓扑的模型，可以共享和重用层，并且是一个更灵活的模型，提供了更多的旋钮来提高性能。这个模型API可以用于开发能够服务于大多数用例的复杂模型。</p><p id="dcc1" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">您可以定义一个功能模型，如下所述。</p><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><h1 id="4aa3" class="lc ld hi bd le lf mi lh li lj mj ll lm ln mk lp lq lr ml lt lu lv mm lx ly lz bi translated"><strong class="ak"> 3。子类模型:</strong></h1><p id="a3ff" class="pw-post-body-paragraph jc jd hi je b jf ma jh ji jj mb jl jm jn mc jp jq jr md jt ju jv me jx jy jz hb bi translated">与上面两个模型API相比，这是最复杂的，但是在建模复杂用例时提供了更多的灵活性。这里，Keras模型类(<code class="du mn mo mp mq b">tf.keras.Model</code>)被子类化，这允许我们继承该类下的功能，例如fit/predict/eval等。</p><p id="dc83" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">子类模型和上面两个模型API的主要区别之一是前者是调用方法中的一段python代码，而后者是一个静态图。由于这种差异，保存和加载子类模型与其他模型API有很大的不同。</p><blockquote class="mr ms mt"><p id="f828" class="jc jd mu je b jf jg jh ji jj jk jl jm mv jo jp jq mw js jt ju mx jw jx jy jz hb bi translated">因为这篇文章是为初学者准备的，给定任何用例，尝试使用顺序的(对于单输入单输出)或者功能模型API(对于其他情况)。将来，当我们不再是初学者时，我们将处理子类模型。</p></blockquote><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><blockquote class="mr ms mt"><p id="7d90" class="jc jd mu je b jf jg jh ji jj jk jl jm mv jo jp jq mw js jt ju mx jw jx jy jz hb bi translated">下面是顺序模型API和功能模型API之间的主要区别</p></blockquote><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="mf mg l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">顺序与功能模型API</figcaption></figure></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><h1 id="92a0" class="lc ld hi bd le lf mi lh li lj mj ll lm ln mk lp lq lr ml lt lu lv mm lx ly lz bi translated"><strong class="ak">训练和可视化:简单顺序模型</strong></h1><p id="672e" class="pw-post-body-paragraph jc jd hi je b jf ma jh ji jj mb jl jm jn mc jp jq jr md jt ju jv me jx jy jz hb bi translated">由于我们不了解基础知识，所以让我们更深入地研究深度学习框架(Keras ),并检查更多用于训练、评估和可视化的API。<code class="du mn mo mp mq b">tf.keras</code>中有几个API，每个API都需要一篇单独的文章来深入研究。由于本文主要针对初学者，所以让我们在下面的代码中讨论一些重要的API和回调函数。</p><p id="6673" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">以下代码描述了</p><ul class=""><li id="8a4a" class="ko kp hi je b jf jg jj jk jn kq jr kr jv ks jz kt ku kv kw bi translated">定义简单的DL模型，下载MNIST数据，培训和评估绩效</li><li id="69c4" class="ko kp hi je b jf kx jj ky jn kz jr la jv lb jz kt ku kv kw bi translated">保存训练好的模型</li><li id="4d13" class="ko kp hi je b jf kx jj ky jn kz jr la jv lb jz kt ku kv kw bi translated">加载保存的模型并评估性能</li><li id="867b" class="ko kp hi je b jf kx jj ky jn kz jr la jv lb jz kt ku kv kw bi translated">检查几个回调API(<code class="du mn mo mp mq b">TensorBoard</code>、<code class="du mn mo mp mq b">ModelCheckpoints</code>、<code class="du mn mo mp mq b">History</code>)</li></ul><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="515d" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">模型的输出(只显示了一部分，以尽量缩短文章长度)</p><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="2f5d" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">保存并加载模型</p><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="bdb2" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">加载模型的性能如下</p><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="ac5b" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">您可以看到，保存前和加载后的模型性能完全相同。出于某种原因，如果你想重新训练模型，那么你可以使用<code class="du mn mo mp mq b">loaded_model</code>从上次离开的地方重新开始训练(不需要从头再来)。</p></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="b87b" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="je hj"> TensorBoard回调API </strong></p><p id="30e7" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">让我们使用<code class="du mn mo mp mq b">TensorBoard</code>来可视化这些图表。除了图形，你还可以检查模型，检查标量，分布，直方图等。</p><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><figure class="kk kl km kn fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es my"><img src="../Images/b34a3c8e23c347830bcca0d4441c8869.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bH6Nf5VKT7V5BrvX79fhEA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">TensorBoard检查图形，标量，分布，直方图</figcaption></figure></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="2874" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="je hj">历史回调API </strong></p><p id="3d23" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">您可以使用<code class="du mn mo mp mq b">model.history</code>回调来绘制训练和验证期间的准确度和损失。</p><figure class="kk kl km kn fd ij"><div class="bz dy l di"><div class="mf mg l"/></div></figure><figure class="kk kl km kn fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mz"><img src="../Images/cc3aa61ec4c4c8097375180f50dd785e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZJXjoqftbuYRjzBuaFIyhQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">培训和验证期间的准确性和损失</figcaption></figure><h1 id="cdf4" class="lc ld hi bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated"><strong class="ak">总结</strong></h1><ul class=""><li id="bf76" class="ko kp hi je b jf ma jj mb jn na jr nb jv nc jz kt ku kv kw bi translated">Keras是一个广泛使用的神经网络库，简单易学，易于使用，能够快速实验深度神经网络</li><li id="a0e9" class="ko kp hi je b jf kx jj ky jn kz jr la jv lb jz kt ku kv kw bi translated">有三种API(顺序、函数和子类)来构建模型</li><li id="f850" class="ko kp hi je b jf kx jj ky jn kz jr la jv lb jz kt ku kv kw bi translated">序列模型有一个主要的局限性，即它只适用于单输入单输出</li><li id="e8b1" class="ko kp hi je b jf kx jj ky jn kz jr la jv lb jz kt ku kv kw bi translated">顺序模型API是上述三种中最简单的，适用于大约60–70%的用例。然而，函数类和子类更加复杂，但却适用于任何用例。</li><li id="e6f7" class="ko kp hi je b jf kx jj ky jn kz jr la jv lb jz kt ku kv kw bi translated">初学者应该尽量使用顺序的(针对单输入单输出)或者函数模型API(针对其他情况)。</li><li id="4e8c" class="ko kp hi je b jf kx jj ky jn kz jr la jv lb jz kt ku kv kw bi translated">Keras有许多API来构建、训练、评估和可视化模型性能</li></ul></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="9829" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我认为这对一个初学者来说已经足够了。我们将在以后的文章中深入研究其中的一些API。</p><p id="8872" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">谢谢大家！如果你喜欢这篇文章，请分享它，以帮助他人找到它！如果你有任何不明白的地方或者想要更多的解释，请在下面留下你的评论。</p><p id="0d0e" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">你可以在<a class="ae iu" href="https://www.linkedin.com/in/vishnuvardhanjanapati/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae iu" href="https://stackoverflow.com/users/9936228/vishnuvardhan-janapati" rel="noopener ugc nofollow" target="_blank"> Stackoverflow </a>和<a class="ae iu" href="https://github.com/jvishnuvardhan" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到我</p></div></div>    
</body>
</html>