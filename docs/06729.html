<html>
<head>
<title>Logistic Regression — Practical Approach</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逻辑回归——实用方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/logistic-regression-practical-approach-a5546ad96d7d?source=collection_archive---------29-----------------------#2020-05-31">https://medium.com/analytics-vidhya/logistic-regression-practical-approach-a5546ad96d7d?source=collection_archive---------29-----------------------#2020-05-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="fe1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我的上一篇文章:<a class="ae jd" rel="noopener" href="/analytics-vidhya/logistic-regression-the-theoretical-way-1f22f273b840">逻辑回归:理论方法</a>中，我已经和你谈过逻辑回归的重要关键概念，在开始实际实施之前应该知道。我希望你已经了解了这些概念。如果没有，在阅读这篇文章之前，我想请你浏览一下我以前的文章。</p><p id="9707" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文将不仅仅涵盖逻辑回归，其主要目的是简单地讨论解决业务问题的关键方法。构建模型让我们着迷，但实际上分析师只花20%的时间。其余80%用于数据探索和处理。在处理和创建模型之前，必须了解数据。</p><p id="6cce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我将讨论以下内容:</p><ul class=""><li id="4e09" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">定义:问题陈述</li><li id="ac9f" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">对数据外观的一瞥</li><li id="107c" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">路线图或方法</li><li id="ec30" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">逻辑回归模型</li></ul><p id="3c7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我研究了移动性分析数据集。来源是AnakyticsVidhya Jantahack。<strong class="ih hj">*注意:在将该数据集用于商业目的之前，请联系AnalyticsVidhya！</strong></p></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><h2 id="51f0" class="jz ka hi bd kb kc kd ke kf kg kh ki kj iq kk kl km iu kn ko kp iy kq kr ks kt bi translated"><strong class="ak"> 1)问题陈述</strong>:</h2><p id="b0e0" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">XYZ是一个出租车聚合服务。他们的客户可以在智能手机上下载他们的应用程序，并在他们经营的城市的任何地方预订出租车。他们从各种服务提供商那里搜索出租车，并在所有可用选项中为客户提供最佳选择。他们从服务提供商那里获得了surge_pricing_type，这是本研究的关键变量！</p><p id="5d19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">目标是建立一个预测模型，这有助于积极预测价格上涨类型。这反过来会帮助他们快速有效地将合适的出租车与合适的客户匹配起来。</p></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><h2 id="a07b" class="jz ka hi bd kb kc kd ke kf kg kh ki kj iq kk kl km iu kn ko kp iy kq kr ks kt bi translated"><strong class="ak"> 2)数据一览</strong></h2><p id="5b9e" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">下图显示的是数据字典，即告诉我们数据集中每一列的内容。</p><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es kz"><img src="../Images/13ccfe4ed52024c4d9794d2b5e72099c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dR5GUM6e8QS4V2XOEh2vPQ.png"/></div></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">数据字典</figcaption></figure><p id="75b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">简单来说，数据如下图所示。在导入数据后检查数据是一个很好的做法。它给你一些关于数据的关键概念，比如有什么类型的变量和什么数据类型。</p><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lp"><img src="../Images/cbc744b58765ad5301e0df363bb01f77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1V2RF0KWwKeB-Dm7pg_z7g.png"/></div></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">数据集一览</figcaption></figure></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><h2 id="9111" class="jz ka hi bd kb kc kd ke kf kg kh ki kj iq kk kl km iu kn ko kp iy kq kr ks kt bi translated">3)让我们构建我们的路线图</h2><p id="b821" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">当我们导入数据时，我们应该首先检查一些关于数据集的信息图表。我们所说的<strong class="ih hj">信息图</strong>是指一些基本信息<strong class="ih hj">比如我们数据集的<strong class="ih hj">类型、性质</strong>和<strong class="ih hj">描述</strong>。</strong></p><ul class=""><li id="3073" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated"><strong class="ih hj">类型:</strong>每个变量的数据类型</li><li id="07d4" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">性质:</strong>变量类型——分类或连续</li><li id="afc0" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">描述:</strong>一些基本的数据统计</li></ul><p id="afb9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">探索数据类型至关重要。它告诉我们我们的变量是什么类型，例如，数字，字符串等。不仅如此，它还可以告诉我们数据中的一些潜在问题。例如:让我们以Trip_Distance变量为例，假设它是对象数据类型而不是float。距离应该是数字的，这是合乎逻辑的。因此，它告诉我们，变量中存在字符串，字符或符号。因此，我们将不得不处理这些值的变量。我们要么估算它们，要么放弃那一行。下图显示了数据集的数据类型。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es lq"><img src="../Images/1ff12b9d3b8945f470c71be0f5d8379a.png" data-original-src="https://miro.medium.com/v2/resize:fit:538/format:webp/1*qRVbomSTdLLS2aOmAgN5UA.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated"><strong class="bd kb">类型</strong></figcaption></figure><p id="0379" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一个必要的步骤是检查数据中变量的性质。我们可以通过查看数据集的一些行来实现。我们可以确定变量是连续的还是分类的。参考下图:</p><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lr"><img src="../Images/1930bbd2e365865b4c84302eae47116f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Cg-BdiwzNW44xxj0fLSTw.png"/></div></div><figcaption class="ll lm et er es ln lo bd b be z dx translated"><strong class="bd kb">自然</strong></figcaption></figure><p id="302a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们数据的描述性统计为我们的数据集提供了许多关键信息，例如:</p><ul class=""><li id="cae5" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">我们确定变量的分布，</li><li id="dd05" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">我们可以识别一些问题，比如数据中的<strong class="ih hj">缺失值</strong>、<strong class="ih hj">异常值</strong>——让我们以Customer_Since_Months变量为例，查看计数统计。当我们与他人比较时，计数会更少，这意味着数据中存在<strong class="ih hj"> NaNs </strong>，即缺失值。现在如果我们取Life_Style_Index变量，你会看到最小值远小于下限。<strong class="ih hj">下限为25%——(1.5 * IQR)</strong>。因此存在离群值。因此，我们必须解决数据集的这些问题，并对待它们。</li></ul><p id="1c43" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们已经对数据有了一些基本的概念，我们需要更深入地研究它，寻找数据中的异常，并做必要的处理！这里我们将只讨论两种类型的数据异常:</p><ul class=""><li id="d445" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">缺少值</li><li id="dd91" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">极端值</li></ul><p id="6c4d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> a)缺失值</strong></p><p id="9213" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要浏览数据集中缺失的值，我们可以执行以下操作，如下图所示:</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es ls"><img src="../Images/16a7d0b0bd736e2a46e0d78846f3e0ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*y8_L3zY6QBN715rikJXmXQ.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated"><strong class="bd kb">探索缺失值</strong></figcaption></figure><p id="6bbb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的图像序列中是我们导入数据的数据帧。<strong class="ih hj"> isna() </strong>是一个函数，用于检查数据集的列中是否存在<strong class="ih hj">nan</strong>。<strong class="ih hj">。sum() </strong>返回列中缺失值的总数。</p><p id="b2f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上图中，我们看到像<strong class="ih hj"> Type_of_Cab、Customer_Since_Months、Life_Style_Index、Confidence_Life_Style_Index、Var1 </strong>这样的变量缺少值。<strong class="ih hj"> Total_Perc </strong>列返回该列中缺失值的百分比。</p><p id="1ad1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们研究具有缺失值的列，以了解更多关于缺失值的本质。这将有助于您确定处理缺失值的合适方法。在删除丢失的值行或输入它们之间有一个权衡。<strong class="ih hj">* *注:我们通过平均值或中值估算连续变量的缺失值，通过模式估算分类变量的缺失值。</strong>让我们研究一下<strong class="ih hj"> Type_of_Cab </strong>变量，以了解缺失值的性质。请参考下面显示的图片，它将向您展示一些关键发现以及对驾驶室类型的探索。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es lt"><img src="../Images/bcf81db8cd6126e2729525437e823d64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*Y9onPwqT5IQznajErheAbw.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated"><strong class="bd kb">分组激增-定价-按出租车类型分类</strong></figcaption></figure><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es lu"><img src="../Images/e722d8782b9ccfaba26b079df5b01f1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*VTS-R_dS3eDA5MG1jWDueA.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">按所有连续变量的Cab类型分组</figcaption></figure><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es lv"><img src="../Images/0926bbacecccfdb6027a278aead4b772.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*osmo_wJ-V4ymEntnAb85Tw.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">主要发现</figcaption></figure><p id="a53e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我已经创建了一个函数来处理缺失值列，请参考下图:</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es lw"><img src="../Images/f204fd41a0daabd5528ade67c7dc1ea5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*UESW--j0axvjvCKRzr725w.png"/></div></figure><p id="6b59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，上面的函数有四个输入:列名、变量类型:连续或分类、数据帧名、值、最后一个参数，即值是可选的。如果你想用用户定义的值进行估算，你可以将值分配给<strong class="ih hj">值</strong>参数，否则如果你想让函数估算自身，你可以让<strong class="ih hj">值</strong>参数默认等于<strong class="ih hj">无</strong>。</p><p id="ab56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们来处理Type_of_Cab变量，在其中我们给它分配一个新的类‘F ’,因为丢失值的频率如此之大，以至于我们不能将它包括在现有的类中。如果我们看到类的计数是10K (10，000)的倍数，缺失值的计数也是10K的倍数，因此我认为有一个类缺失。因此，我们定义新的类'<strong class="ih hj"> F </strong>'。驾驶室类型有4个现有等级<strong class="ih hj"> A、B、C、D、e</strong></p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es lx"><img src="../Images/51f624af9b8a3ddf8bbaf37c6629a1db.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*H6W64fKOSiIPkPB1xJikYg.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">驾驶室类型柱的处理</figcaption></figure><p id="430e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们已经了解了如何处理缺失值，让我们了解如何处理异常值？</p><p id="1a31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> b)异常值</strong></p><p id="98a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">异常值是一个与其他观察结果明显不同的数据点。<strong class="ih hj">异常值</strong>可能是由于测量中的<strong class="ih hj">可变性造成的，或者它也可能表明<strong class="ih hj">实验误差</strong>。</strong></p><p id="746d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了检查异常值，我们绘制每个变量的箱线图，下须和上须之后的点是异常值。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es ly"><img src="../Images/270b153807a32713fe82d765266f29da.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*uf_Mf8Oat09qqxhMILXiQA.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">局外人</figcaption></figure><p id="b922" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在数学上，我们通过下式定义下限和上限:</p><ul class=""><li id="7e9e" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">下限:(25%——(1.5 * IQR))</li><li id="38b3" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">上限:(75% + (1.5*IQR))</li><li id="48c1" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">IQR : (75% — 25%)</li></ul><p id="c7fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">任何高于<strong class="ih hj">上限</strong>和低于<strong class="ih hj">下限</strong>的值都是异常值，必须进行修剪。下图中的函数用于处理异常值:</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es lz"><img src="../Images/095b6de7ccabf979f063a2702053c9a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*nKMwt6WRBCAIaDHPjjslhw.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">处理异常值</figcaption></figure><p id="ce58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们已经了解了异常处理，是时候了解我们的数据，探索数据并分析它了。这对于特征工程、重要特征选择和模型构建等后续过程至关重要。下面分享的图片只是一个例子，但是如果你想了解更多关于EDA的知识，你可以访问我的<a class="ae jd" href="https://github.com/startmljourney/Logistic-Regression/blob/master/Mobility%20Analytics/Logistic_Regression.ipynb" rel="noopener ugc nofollow" target="_blank"> github库</a></p><div class="la lb lc ld fd ab cb"><figure class="ma le mb mc md me mf paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><img src="../Images/d88828982209b1321b9c9cda2b507299.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*CBI5q2RX8eUeUSAzc35Nlg.png"/></div></figure><figure class="ma le mg mc md me mf paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><img src="../Images/494d008ef8f04ab7e1f88885ca451783.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*Ii9zAmDQBNo229QBTb-uuA.png"/></div></figure></div><div class="ab cb"><figure class="ma le mh mc md me mf paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><img src="../Images/f5577b5b2e6c4ac04876f4e2632a4463.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*cX99DbrGSHZYAXsPNNkQQw.png"/></div></figure><figure class="ma le mi mc md me mf paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><img src="../Images/2e6ea5cbdac571459ad8f0ad65120ac6.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*Hd4ag4XKPPRZw3uyViNRTA.png"/></div></figure></div><p id="b229" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请务必阅读下面的最后评论，它会告诉我们可能的重要特性。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es lu"><img src="../Images/1724893758b870ee1906b133143d64cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*AYZQyDM7_vQPfBFKoHycjA.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">最终意见</figcaption></figure><p id="5252" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然我们已经介绍了<strong class="ih hj">信息图、异常检测&amp;处理、EDA、</strong>，现在是时候谈谈开始建模前路线图的最后一步，即<strong class="ih hj">数据预处理。</strong></p><p id="7396" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要将分类变量从字符串数据类型转换为数字数据类型，以便算法能够理解它。我们可以把它编码成二进制或多进制编码，也就是0 &amp; 1。可以使用<strong class="ih hj">一次热编码</strong>或<strong class="ih hj">标签编码器</strong>来完成。我做了一个热编码。参考下图了解如何做到这一点。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es mj"><img src="../Images/904dc96458efb14627f25f1ae2671d3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*_i1EO_5_JTrebbxjXXGEgA.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated"><strong class="bd kb">一次热编码</strong></figcaption></figure><p id="2027" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">编码之后，我们需要把连续变量放在同样的尺度上，这样它们的大小是相同的，可以比较的。我们通过sklearn的normalizer()函数来规范化我们的连续变量。参考下图:</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es mk"><img src="../Images/7c7cdb5bffdfa0a6022628b074570b5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*4shuXow1K4iKI13jz05dAA.png"/></div></figure><p id="5f86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">建模前的最后一步是将数据分为训练和测试两部分。这里就不说了。我将在单独的文章中介绍它。</p><p id="9d55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在是进入模型开发阶段的时候了。</p></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><h2 id="bd56" class="jz ka hi bd kb kc kd ke kf kg kh ki kj iq kk kl km iu kn ko kp iy kq kr ks kt bi translated">逻辑回归-从零开始开发它！</h2><p id="6384" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">这里，在下图中显示的是我们模型的架构。</p><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es ml"><img src="../Images/b7f7577499ff49815841450d75698dfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R1cyQE5hPO19X2wILKvnqA.jpeg"/></div></div><figcaption class="ll lm et er es ln lo bd b be z dx translated"><strong class="bd kb">逻辑回归</strong></figcaption></figure><p id="a9f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为我在上一篇文章中已经分享了理论基础，所以在这里我将只讨论逻辑回归的实践方面！</p><p id="95a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在下图中，我们定义了sigmoid函数，它将线性函数转换为概率。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es mm"><img src="../Images/830eb39937abc6250177341cb45932a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*0DSsmFwBABCbIhkkyo96tw.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">乙状结肠的</figcaption></figure><p id="218d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们输入数据时，我们将它与权重相乘，以生成逻辑回归架构中所示的线性函数。为此，我们首先需要初始化权重。下图显示了初始化权重和偏差的函数。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es mn"><img src="../Images/ee451cdc06aef981ed1abeae63f96488.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*fKA5ReRNs_RgoNs-i7p_rA.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">初始化权重</figcaption></figure><p id="178e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们定义如何通过模型传播我们的输入来给出输出！当模型得到自变量的输入时，它取自变量和初始化权重的点积。然后，我们将其输入到sigmoid函数中，输出为<strong class="ih hj"> yhat </strong>，我们将其与<strong class="ih hj">实际y </strong>进行比较，并计算损失函数。最后我们计算权重的梯度&amp;偏差。</p><p id="6439" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设我们的独立特征集形状是(6583，29)，那么:</p><p id="3e50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">称重矩阵形状:(29，1)</p><p id="c422" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">z形:(1，6583)</p><p id="2e64" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">激活函数矩阵(A)形状:(1，6583)</p><p id="4901" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">dz形状:(1，6583)</p><p id="cc46" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">成本:它是一个标量值</p><p id="66de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">dw形状:(29，1)</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es mo"><img src="../Images/e20cd7205ba6215e9123082ad95ed0fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*-vKuycdJRpFzzbucM5k3Ng.png"/></div></figure><p id="7c46" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们需要优化我们的权重和偏差，使损失达到全局最小值，因此我们使用梯度下降算法。在这种情况下，我们获取由<strong class="ih hj"> Propogate() </strong>函数计算的权重和偏差的梯度，并更新模型权重和偏差，直到损失达到全局最小值。</p><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lw"><img src="../Images/f020f77c417bb47e3811854c6fce22b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*rBUKUR-DbIQnNN4Afxuz7Q.png"/></div></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">梯度下降</figcaption></figure><p id="ba84" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下图是<strong class="ih hj">预测()</strong>函数，用于将激活函数<strong class="ih hj"> sigmoid() </strong>计算的概率转换为0 &amp; 1。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es lu"><img src="../Images/2e635611184c9326da7c247bce3d4672.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*1EHHvGvh7eQzGyL5uqRnlA.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">预测功能</figcaption></figure><p id="e944" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用上面定义的所有函数，最终模型如下图所示:</p><p id="6616" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我们执行我们的模型，如下图所示:</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es mp"><img src="../Images/83ff1abe0d7a6e98fc619c737080ebbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*GtR--oL3OSiLeWuspSo0rQ.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">模型执行</figcaption></figure><p id="9cbe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里有一个<strong class="ih hj">学习率的概念，</strong>简而言之，它是一个超参数，决定了模型损失多快达到其全局最小值。我将在接下来的文章中讨论这个问题。</p><p id="8f3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在剩下的重要事情是评估指标，我将在下一篇文章中讨论。</p><p id="fb4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您有任何疑问，请随时发表评论，或者您可以通过startmljourney@gmail.com联系我</p><p id="7c22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">再见，朋友们！我希望这篇文章对你有所帮助，我们会很快见面的。</p></div></div>    
</body>
</html>