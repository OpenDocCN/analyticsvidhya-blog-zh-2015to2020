<html>
<head>
<title>Analyze NEWS updates as positive or negative using Azure Text Analytics Service</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Azure文本分析服务分析正面或负面的新闻更新</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/analyze-news-updates-as-positive-or-negative-using-azure-text-analytics-service-2c3abeaa1c61?source=collection_archive---------20-----------------------#2019-12-23">https://medium.com/analytics-vidhya/analyze-news-updates-as-positive-or-negative-using-azure-text-analytics-service-2c3abeaa1c61?source=collection_archive---------20-----------------------#2019-12-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7a82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你有一堆新闻更新或标题(可能是一年)，你想用Azure文本分析服务从列表中获得正面(好消息)和负面(坏消息)标题的数量。让我们开始吧。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="ddcf" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">先决条件</h1><ol class=""><li id="3306" class="ki kj hi ih b ii kk im kl iq km iu kn iy ko jc kp kq kr ks bi translated">Python3和Flask关于创建API的知识</li><li id="0e8f" class="ki kj hi ih b ii kt im ku iq kv iu kw iy kx jc kp kq kr ks bi translated">Azure订阅</li><li id="8ba8" class="ki kj hi ih b ii kt im ku iq kv iu kw iy kx jc kp kq kr ks bi translated">Ubuntu 16.04机器(你可以在任何操作系统上这样做，但我将使用给定的)</li></ol></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="7ebd" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">使用的技术</h1><ol class=""><li id="e231" class="ki kj hi ih b ii kk im kl iq km iu kn iy ko jc kp kq kr ks bi translated">Python3和Flask</li><li id="fe6c" class="ki kj hi ih b ii kt im ku iq kv iu kw iy kx jc kp kq kr ks bi translated">Azure认知服务— Azure文本分析</li><li id="0dcc" class="ki kj hi ih b ii kt im ku iq kv iu kw iy kx jc kp kq kr ks bi translated">面向Azure认知服务的Python SDK</li></ol></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="deec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">按照步骤开始-</p><ol class=""><li id="e05e" class="ki kj hi ih b ii ij im in iq ky iu kz iy la jc kp kq kr ks bi translated">登录您的Azure订阅并搜索Azure认知服务</li><li id="e1ac" class="ki kj hi ih b ii kt im ku iq kv iu kw iy kx jc kp kq kr ks bi translated">创建文本分析服务。见下图-</li></ol><div class="lb lc ld le fd ab cb"><figure class="lf lg lh li lj lk ll paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><img src="../Images/ab2e5ddaf408c367b85f97a661751028.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*ofVGz1_LWrNNYRQ8zp6SSQ.png"/></div></figure><figure class="lf lg ls li lj lk ll paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><img src="../Images/03afc92fff436bf69f3e8d7c353a53d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*JMFD3tJQMa_ra4f8PPu1Gg.png"/></div><figcaption class="lt lu et er es lv lw bd b be z dx lx di ly lz translated">创建Azure文本分析服务</figcaption></figure></div><p id="0450" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.创建后，获取您的订阅密钥和API端点</p><p id="b63b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.使用下面给出的代码为任何输入创建一个文本分析器服务—(确保您已经安装了所有必备的软件包)</p><pre class="lb lc ld le fd ma mb mc md aw me bi"><span id="6624" class="mf jl hi mb b fi mg mh l mi mj">import flask<br/>from flask import request, jsonify</span><span id="189e" class="mf jl hi mb b fi mk mh l mi mj"><a class="ae ml" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.route('/detect/sentiment', methods=['GET'])<br/>def detect_sentiment():<br/>    if 's' in request.args:<br/>        user_string = request.args['s']<br/>        documents = {'documents': [<br/>            {'id': '1', 'language': 'en', 'text': user_string}<br/>        ]}<br/>       <br/>        subscription_key = "your subscription key"<br/>        sentiment_api_url = "<a class="ae ml" href="https://westcentralus.api.cognitive.microsoft.com/text/analytics/v2.0/sentiment" rel="noopener ugc nofollow" target="_blank">https://westcentralus.api.cognitive.microsoft.com/text/analytics/v2.0/sentiment</a>"<br/>        </span><span id="6a4d" class="mf jl hi mb b fi mk mh l mi mj">        headers = {"Ocp-Apim-Subscription-Key": subscription_key}<br/>        response = requests.post(sentiment_api_url, headers=headers, json=documents)<br/>        sentiment = response.json()</span><span id="ed91" class="mf jl hi mb b fi mk mh l mi mj">        sentiment_dict = sentiment['documents'][0]</span><span id="3209" class="mf jl hi mb b fi mk mh l mi mj">        # Make the value in percent<br/>        sentiment_val = float(sentiment_dict['score']) * 100</span><span id="7a00" class="mf jl hi mb b fi mk mh l mi mj">        if sentiment_val &lt; 25:<br/>            sentiment_dict['priority'] = "Negative News"<br/>        elif sentiment_val &gt; 85:<br/>            sentiment_dict['priority'] = "Positive News"<br/>        else:<br/>            sentiment_dict['priority'] = "Failed "<br/>        <br/>        return jsonify(sentiment_dict)</span><span id="6312" class="mf jl hi mb b fi mk mh l mi mj">        else:<br/>             return jsonify({"error": "404"})</span><span id="02e9" class="mf jl hi mb b fi mk mh l mi mj"># Run the app on All IP and 8082 port<br/>app.run(host='0.0.0.0', port=8082)</span></pre><p id="6c47" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.使用以下命令执行上述服务-</p><pre class="lb lc ld le fd ma mb mc md aw me bi"><span id="90b1" class="mf jl hi mb b fi mg mh l mi mj"># python3 file-name.py</span></pre><p id="f36e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.服务必须在<a class="ae ml" href="http://localhost:8082" rel="noopener ugc nofollow" target="_blank"> http://localhost:8082 </a>上运行。如果您有本地环境设置或者如果您有公共IP或域名，它必须在<a class="ae ml" href="http://domain-or-ip:8082" rel="noopener ugc nofollow" target="_blank"> http://domain-or-ip:8082 </a>上可访问</p><p id="e0c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6.启动您最喜欢的浏览器，将url与您想要分析的消息粘贴在一起—</p><pre class="lb lc ld le fd ma mb mc md aw me bi"><span id="0020" class="mf jl hi mb b fi mg mh l mi mj">http://localhost:8082/detect/sentiment?s= The flood immediately killed over 100,000 people, and another 150,000 died of subsequent epidemic diseases and famine, bringing the total death toll to around 250,000 and making it the worst technical disaster ever</span></pre><p id="ee08" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">7.在上面的URL中我们正在分析下面给出的字符串是正面的还是负面的消息</p><pre class="lb lc ld le fd ma mb mc md aw me bi"><span id="ee03" class="mf jl hi mb b fi mg mh l mi mj">The flood immediately killed over 100,000 people, and another 150,000 died of subsequent epidemic diseases and famine, bringing the total death toll to around 250,000 and making it the worst technical disaster ever</span></pre><p id="7b53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">8.你会得到以下回应-</p><pre class="lb lc ld le fd ma mb mc md aw me bi"><span id="e296" class="mf jl hi mb b fi mg mh l mi mj">{<br/>  "id": "1", <br/>  "priority": "Negative News", <br/>  "score": 0.019632428884506226<br/>}</span></pre></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="79a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就是这样朋友们！我们已经完成了analyzer，它可以将标题作为输入，并自动通知我们这是一条正面消息还是负面消息。留给你的是一个前端，你可以开发和使用上述逻辑做更多的新闻分析。</p></div></div>    
</body>
</html>