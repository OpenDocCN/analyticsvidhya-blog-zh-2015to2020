<html>
<head>
<title>Face Recognition using Transfer learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于迁移学习的人脸识别</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/face-recoginition-using-transfer-learning-15c39b1d1618?source=collection_archive---------28-----------------------#2020-07-11">https://medium.com/analytics-vidhya/face-recoginition-using-transfer-learning-15c39b1d1618?source=collection_archive---------28-----------------------#2020-07-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="25b3" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">迁移学习</h1><p id="11ac" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><em class="kb">迁移学习</em>利用解决一个问题时获得的知识，并将其应用于另一个不同但相关的问题。我使用Inception模型，因为它能够从图像中提取有用的信息。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es kc"><img src="../Images/f009abfeb526777ffd6c4a3e8e82fe19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*mi24L7gwXxH8lf8PVndtPg.png"/></div><figcaption class="kk kl et er es km kn bd b be z dx translated">迁移学习</figcaption></figure><h1 id="aa83" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">为什么要转学？</h1><p id="d35b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">众所周知，卷积网络需要大量的数据和资源来训练。</p><p id="487d" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">使用迁移学习和微调(也就是说，将在以前的项目(如ImageNet)中训练的网络权重转移到新的任务中)已经成为研究人员和实践者的规范。</p><p id="2833" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">您可以采取两种方法。</p><ul class=""><li id="890a" class="kt ku hi jf b jg ko jk kp jo kv js kw jw kx ka ky kz la lb bi translated"><em class="kb">迁移学习</em>:你可以拿一个已经在ImageNet上预训练好的CNN，去掉最后一个全连接层，然后把CNN的剩余部分当做新数据集的特征提取器。一旦提取了所有图像的特征，就可以为新的数据集训练一个分类器。</li><li id="c7ba" class="kt ku hi jf b jg lc jk ld jo le js lf jw lg ka ky kz la lb bi translated"><em class="kb">微调</em>:你可以替换和重新训练CNN上的分类器，也可以通过反向传播微调预训练网络的权重。</li></ul><h1 id="5cc2" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">导入模块和冻结层</h1><p id="8b78" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">首先，我们导入所需的模块和库。Keras是用于机器学习的python库之一。所以这里我们必须导入我们程序中需要的不同的子模块和函数。因为我们使用VGG16架构，所以我们导入了VGG16函数。然后我们冻结这些层。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lh"><img src="../Images/f4c547963ac07fdac4eca6ecab5a60c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pwa6d2Baq2UKEGjCOqVl6Q.png"/></div></div></figure><p id="c148" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">现在，我们将创建一个名为new的函数，在该函数中，我们将定义要添加到现有模型中的新层。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lm"><img src="../Images/62e32ba34d6efb62f9cbc3e8a8d25c79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bCzl8W-LvBZNhLwabYN3tQ.png"/></div></div></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es ln"><img src="../Images/53f1a538ea76f798c8aedc502ddf42c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:76/0*V_tvwfqeBjBS-LNC"/></div></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lo"><img src="../Images/48611a88ce52522e08fad6659e688aa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4tdwz7XkalTdxwUltvdh1w.png"/></div></div></figure><p id="7bd5" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">现在，我们将定义培训和验证数据的呈现路径。</p><p id="d8ac" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">train_generator将从目录中获取输入，并根据VGG调整它们的大小。类似地，validation_generator也可以。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lp"><img src="../Images/bc666c378888dd74786c9ca2e140db8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2sloHPDdvULyafT3mkBjkA.png"/></div></div></figure><p id="282a" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">这里我们使用PMSprop作为优化器。</p><p id="f44c" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">我们将使用模型检查点来保存模型。根据价值损失，只选择最佳模型。</p><p id="8188" class="pw-post-body-paragraph jd je hi jf b jg ko ji jj jk kp jm jn jo kq jq jr js kr ju jv jw ks jy jz ka hb bi translated">然后我们编译并保存模型。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lq"><img src="../Images/8490a3b6649317449370aba2813bb26f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qwxrt466NXwF2lYlWcOhUQ.png"/></div></div></figure><h1 id="f88b" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">测试模型</h1><p id="f40b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">现在我们处于最后一步，即测试我们的模型。在这一步，我们向我们的模型提供那些既不在训练集中也不在测试集中提供的图像，以便我们可以检查我们的模型预测是对还是错。因此，首先，我们将导入所需的模块，然后，我们加载之前训练的模型。最后，我们使用predict()函数进行预测，并解码其输出。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lr"><img src="../Images/d049bbd9e32933410b3893535e367d96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9134QOGLrDsPxfXA2Z721g.png"/></div></div></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es ls"><img src="../Images/2d5ac4aa2a4b100a11c8865716506ef4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jvq_x1Jo2fnQEwkhGctGyA.png"/></div></div></figure></div></div>    
</body>
</html>