<html>
<head>
<title>Understanding reduce in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解Python中的reduce</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/understanding-reduce-in-python-7641af074211?source=collection_archive---------10-----------------------#2020-02-16">https://medium.com/analytics-vidhya/understanding-reduce-in-python-7641af074211?source=collection_archive---------10-----------------------#2020-02-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="9c0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我们试图通过收集一些很酷的用例来理解<code class="du jd je jf jg b">reduce</code>函数。</p><h1 id="3af0" class="jh ji hi bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke bi translated">介绍</h1><p id="d68d" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">Python已经成为数据科学和ML事实上的语言。人们蜂拥而至，通常来自不同的背景。</p><p id="bce7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">函数式编程是人们容易感到困惑的盲点之一。<code class="du jd je jf jg b">map</code>、<code class="du jd je jf jg b">apply</code>、<code class="du jd je jf jg b">reduce</code>、<code class="du jd je jf jg b">lambda</code>、<code class="du jd je jf jg b">filter</code> …🤯</p><p id="4266" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">事实上，在Python 2.x中，<code class="du jd je jf jg b">reduce</code>是内置函数之一。这在Python 3中有所改变，因为(<a class="ae kl" href="https://www.python.org/dev/peps/pep-3100/" rel="noopener ugc nofollow" target="_blank"> PEP 3100 </a>):</p><blockquote class="km kn ko"><p id="46d6" class="if ig kk ih b ii ij ik il im in io ip kp ir is it kq iv iw ix kr iz ja jb jc hb bi translated">reduce():放入functools，一个循环在大多数时候更具可读性</p></blockquote><p id="715d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这位作者不太同意这种观点，认为它太固执己见了。众所周知，Python的创始人Guido不喜欢函数式编程(例如这里的<a class="ae kl" href="https://news.ycombinator.com/item?id=1175531" rel="noopener ugc nofollow" target="_blank"/>)</p><p id="47c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用reducer函数通常比for循环更好的原因是for循环的本质:作为一个<strong class="ih hj">方法</strong> <em class="kk">，</em>阅读其他人的<strong class="ih hj"> <em class="kk"> </em> </strong>代码可能会令人沮丧和/或乏味。一个正确记录的reducer倾向于更短，更优雅地抽象核心功能——IMO。</p></div><div class="ab cl ks kt gp ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="hb hc hd he hf"><h1 id="b0db" class="jh ji hi bd jj jk kz jm jn jo la jq jr js lb ju jv jw lc jy jz ka ld kc kd ke bi translated">那么，<code class="du jd je jf jg b">reduce</code>到底是什么？</h1><p id="5374" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">想想加法运算符+。</p><p id="7423" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个二元运算符，接受两个int，然后产生第三个int，即另外两个的和<code class="du jd je jf jg b">s = x + y</code>。</p><p id="2781" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，假设我们有两个整数，而不是两个整数。我们可能仍然需要将它们加在一起。</p><p id="9919" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基本上有两种方法可以做到这一点:</p><figure class="le lf lg lh fd li"><div class="bz dy l di"><div class="lj lk l"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">这里的解决方案1是(<a class="ae kl" href="https://www.python.org/dev/peps/pep-3100/" rel="noopener ugc nofollow" target="_blank"> PEP 3100 </a>)建议我们在没有类似<code class="du jd je jf jg b">sum</code><em class="lp"/>的功能可用时使用<em class="lp">！</em></figcaption></figure><h2 id="3e71" class="lq ji hi bd jj lr ls lt jn lu lv lw jr iq lx ly jv iu lz ma jz iy mb mc kd md bi translated">那reduce在哪里？</h2><p id="a6f7" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">Reduce是<code class="du jd je jf jg b">sum</code>真正在做的事情:</p><blockquote class="me"><p id="988a" class="mf mg hi bd mh mi mj mk ml mm mn jc dx translated">将二元运算推广到任意数量的项。简而言之:从+到∑。</p></blockquote><figure class="mo mp mq mr ms li"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="f98c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一方面，<code class="du jd je jf jg b">sum</code>是内置函数，在c中进行了超优化。</p><p id="4678" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一方面，<code class="du jd je jf jg b"> my_sum</code>适用于所有支持二进制加法的类型，比如字符串或列表！</p></div><div class="ab cl ks kt gp ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="hb hc hd he hf"><h1 id="a26b" class="jh ji hi bd jj jk kz jm jn jo la jq jr js lb ju jv jw lc jy jz ka ld kc kd ke bi translated">为什么要“减少”？</h1><p id="22e3" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">在这一点上，你可能想知道为什么reduce被称为reduce。答案是我们有效地将整个集合缩减为一个元素。</p><p id="d0cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这也有点类似于字典的定义:</p><blockquote class="km kn ko"><p id="fadb" class="if ig kk ih b ii ij ik il im in io ip kp ir is it kq iv iw ix kr iz ja jb jc hb bi translated">减少| rəˈd(y)o͞os |动词<em class="hi">【带宾语】</em>使数量变小或变少</p></blockquote></div><div class="ab cl ks kt gp ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="hb hc hd he hf"><p id="c399" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有些二元运算符内置了它们的<strong class="ih hj">缩减器</strong>:</p><ul class=""><li id="616b" class="mt mu hi ih b ii ij im in iq mv iu mw iy mx jc my mz na nb bi translated">+有<code class="du jd je jf jg b">sum</code></li><li id="b764" class="mt mu hi ih b ii nc im nd iq ne iu nf iy ng jc my mz na nb bi translated"><code class="du jd je jf jg b">and</code>有<code class="du jd je jf jg b">all</code></li><li id="adfc" class="mt mu hi ih b ii nc im nd iq ne iu nf iy ng jc my mz na nb bi translated"><code class="du jd je jf jg b">or</code>有<code class="du jd je jf jg b">any</code></li><li id="7970" class="mt mu hi ih b ii nc im nd iq ne iu nf iy ng jc my mz na nb bi translated"><code class="du jd je jf jg b">min</code> / <code class="du jd je jf jg b">max</code>是内置函数，既充当+ <strong class="ih hj">又充当</strong>它们的减速器。也就是说，你可以将它们都用作<code class="du jd je jf jg b">min(x, y, z)</code>或<code class="du jd je jf jg b">min([x, y, z])</code></li></ul><p id="54c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">许多人不知道:</p><ul class=""><li id="f898" class="mt mu hi ih b ii ij im in iq mv iu mw iy mx jc my mz na nb bi translated">设置联合</li><li id="b879" class="mt mu hi ih b ii nc im nd iq ne iu nf iy ng jc my mz na nb bi translated">设置交叉点</li><li id="8452" class="mt mu hi ih b ii nc im nd iq ne iu nf iy ng jc my mz na nb bi translated">数字产品(𝚷我的列表)</li><li id="1ade" class="mt mu hi ih b ii nc im nd iq ne iu nf iy ng jc my mz na nb bi translated">功能组成</li></ul><p id="7d0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们把这些拼出来！</p><h2 id="a71b" class="lq ji hi bd jj lr ls lt jn lu lv lw jr iq lx ly jv iu lz ma jz iy mb mc kd md bi translated">设置并集和交集</h2><figure class="le lf lg lh fd li"><div class="bz dy l di"><div class="lj lk l"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">如何定义集合并运算符？对于交集运算符，只需用&amp;</figcaption></figure><h2 id="bee5" class="lq ji hi bd jj lr ls lt jn lu lv lw jr iq lx ly jv iu lz ma jz iy mb mc kd md bi translated">产品(𝚷)</h2><p id="66c9" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">对于产品来说，这是完全相同的想法。</p><figure class="le lf lg lh fd li"><div class="bz dy l di"><div class="lj lk l"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">副作用可能包括定义另一个(非常低效的)阶乘函数！</figcaption></figure><h2 id="8d9a" class="lq ji hi bd jj lr ls lt jn lu lv lw jr iq lx ly jv iu lz ma jz iy mb mc kd md bi translated">功能组成</h2><p id="f622" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">这个是最棘手的。我们定义了一些实值函数，并将它们组合在一起。在这个例子中，加1，乘以10，然后平方。</p><p id="19aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，将它们组合在一起会产生一个函数，我们可以将它用于我们自己的输入:</p><figure class="le lf lg lh fd li"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="26a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这与您可能在Scikit-Learn或PowerBI中找到的<strong class="ih hj">转换管道</strong>是同一类型的！</p></div><div class="ab cl ks kt gp ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="hb hc hd he hf"><h1 id="62c4" class="jh ji hi bd jj jk kz jm jn jo la jq jr js lb ju jv jw lc jy jz ka ld kc kd ke bi translated">引擎盖下到底发生了什么？</h1><p id="1427" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">让我们仔细看看产品示例:</p><figure class="le lf lg lh fd li"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="88c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们所看到的，在像<code class="du jd je jf jg b">product_operator</code>这样的缩减函数中，<code class="du jd je jf jg b">x</code>始终是缩减过程的当前状态，也就是累加器，而<code class="du jd je jf jg b">y</code>是要缩减的新值！</p></div><div class="ab cl ks kt gp ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="hb hc hd he hf"><h1 id="883c" class="jh ji hi bd jj jk kz jm jn jo la jq jr js lb ju jv jw lc jy jz ka ld kc kd ke bi translated">奖励——制作“蟒蛇艺术”</h1><p id="c2b2" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">我们可以很容易地用一个缩小器让一条蛇在一个正方形的画布上移动。</p><p id="16bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将利用可选的第三个参数<code class="du jd je jf jg b">reduce</code>，它使用了一个不属于我们正在减少的集合的开始元素。</p><p id="935b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这可用于将<code class="du jd je jf jg b">reduce</code>扩展到不同数据类型的二进制运算。在下面的例子中，左边的操作数是一个元组(canvas，cursor ),右边的操作符是一个在画布中移动光标的函数。</p><p id="5945" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">玩得开心！</p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es nh"><img src="../Images/7db71664a923a2a3fd174e3af578d1d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:462/format:webp/1*1f4dPPJNC_5gh4bvzGtiUg.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">上面脚本的输出！在我们的命令下，蛇在画布上移动！</figcaption></figure><figure class="le lf lg lh fd li"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="7ff6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们使用一条随机行走的蛇，用类似于<code class="du jd je jf jg b">random.choices(list("LRUD"), k=10000)</code>的东西替换上面的固定字符串，我们可能会得到:</p><figure class="le lf lg lh fd li er es paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="er es nk"><img src="../Images/36580fc57c37bbd2a4d016704ac7898a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4xZ5uUk_7kR5u-DAfNHTBQ.png"/></div></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">蛇还是烟？</figcaption></figure><figure class="le lf lg lh fd li"><div class="bz dy l di"><div class="lj lk l"/></div><figcaption class="ll lm et er es ln lo bd b be z dx translated">蛇或烟的代码？</figcaption></figure></div></div>    
</body>
</html>