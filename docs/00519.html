<html>
<head>
<title>Basic Scrapy: How to Scraping Animal Name</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基础刮痧:如何刮动物名</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/basic-scrapy-how-to-scraping-animal-name-e34c3c825492?source=collection_archive---------3-----------------------#2019-07-18">https://medium.com/analytics-vidhya/basic-scrapy-how-to-scraping-animal-name-e34c3c825492?source=collection_archive---------3-----------------------#2019-07-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e7d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嗨，今天我要告诉你关于scrapy的事情。Scrapy是一个用Python编写的免费开源网络爬行框架。它最初是为web抓取而设计的，也可以用于使用API提取数据或作为通用的web爬虫。它目前由一家网络抓取开发和服务公司Scrapinghub Ltd .维护。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/69c1b0f02fc8567498702074cadbbe4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*N8LJsZ83z-RZEbIrr1XLYw.png"/></div></figure><p id="bd5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">网页抓取功能从一个网站检索数据分区，例如从市场上获取价格数据进行比较，检索天气预报数据等等。这对一个公司的领导做决策是非常有用的。</p><p id="0bee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这一次，我想解释如何做简单的网页抓取。我们将检索<a class="ae jl" href="https://a-z-animals.com/animals/" rel="noopener ugc nofollow" target="_blank">https://a-z-animals.com/animals/</a>的机场名称数据</p><p id="e62c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先打开你的PyCharm，用这样的虚拟环境新建一个项目。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es jm"><img src="../Images/e140c025ad7ef2e8b3cef3d7f1c93322.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0-0-t5UK4g0Ov3XZt5eVhw.png"/></div></div></figure><p id="01da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在安装Scrapy之前，你必须先安装Twisted，你可以在https://www.lfd.uci.edu/~gohlke/pythonlibs/的<a class="ae jl" href="https://www.lfd.uci.edu/~gohlke/pythonlibs/" rel="noopener ugc nofollow" target="_blank">下载，根据你的python和你的windows版本搜索Twisted并下载。我的Python版本是3.6，我的windows版本是64位，所以我选择了</a><a class="ae jl" href="https://download.lfd.uci.edu/pythonlibs/t4jqbe6o/Twisted-19.2.1-cp36-cp36m-win_amd64.whl" rel="noopener ugc nofollow" target="_blank">https://download . lfd . UCI . edu/Python libs/t 4 jqbe 6 o/Twisted-19 . 2 . 1-cp36-cp36m-win _ amd64 . whl</a>。</p><p id="b3ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在windows资源管理器中打开文件，点击复制，打开你的Pycharm，右击scrapy _ for _初学者目录，点击粘贴。那就跑</p><pre class="je jf jg jh fd jr js jt ju aw jv bi"><span id="59c2" class="jw jx hi js b fi jy jz l ka kb"><strong class="js hj">pip install Twisted-19.2.1-cp36-cp36m-win_amd64.whl<br/>pip install scrap</strong></span></pre><p id="a1a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在可以开始抓取，首先我们必须命名这个抓取项目，在终端上运行它。</p><pre class="je jf jg jh fd jr js jt ju aw jv bi"><span id="2008" class="jw jx hi js b fi jy jz l ka kb"><strong class="js hj">scrapy startproject animal_names<br/>cd animal_names<br/>scrapy genspider animal www.a-z-animals.com</strong></span></pre><p id="c2c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">之后，它们将是一个名为animal.py的新python文件。接下来我们必须安装Pywin32，并将代码改为。json格式，在terminal.jelasin json上运行这个</p><pre class="je jf jg jh fd jr js jt ju aw jv bi"><span id="42d2" class="jw jx hi js b fi jy jz l ka kb"><strong class="js hj">pip install pywin32<br/>scrapy crawl animal -o codes.json</strong></span></pre><p id="0971" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一个类似的类型在animal.py上。</p><pre class="je jf jg jh fd jr js jt ju aw jv bi"><span id="c874" class="jw jx hi js b fi jy jz l ka kb">name = <strong class="js hj">'animal'<br/></strong>allowed_domains = [<strong class="js hj">'www.a-z-animals.com'</strong>]<br/>start_urls = [<strong class="js hj">'http://a-z-animals.com/animals'</strong>]<br/><br/><strong class="js hj">def </strong>parse(self, response):<br/>    data = []<br/>    table = response.css(<strong class="js hj">'.az-leftbox.az-animal-index'</strong>)<br/>    row_selector = <strong class="js hj">".//li[@class='az-phobia-link-990']|.//li[@class='az-phobia-link-322']|" </strong>\<br/>                   <strong class="js hj">".//li[@class='az-phobia-link-451']|.//li[@class='az-phobia-link-204']|" </strong>\<br/>                   <strong class="js hj">".//li[@class='az-phobia-link-225']"</strong></span></pre><p id="dc99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">允许的域是我们要检索数据的主url。Start_urls是我们想要检索数据的特定url，在本例中，我们想要依次检索第一个字母为A的5个动物名称。我从哪里获得代码的源代码？你可以打开https://a-z-animals.com/animals/的网址<a class="ae jl" href="https://a-z-animals.com/animals/" rel="noopener ugc nofollow" target="_blank">点击鼠标右键</a>并进行检查。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es jm"><img src="../Images/4b986508a4b32136955245a8ddc93d8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S9klMwaE7shqxaMUJ0-CQQ.png"/></div></div></figure><p id="8e55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我们想要检索数据的主类。写在上面</p><pre class="je jf jg jh fd jr js jt ju aw jv bi"><span id="3726" class="jw jx hi js b fi jy jz l ka kb">table = response.css(<strong class="js hj">'.az-leftbox.az-animal-index'</strong>)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es jm"><img src="../Images/9868dafe6e46434a32496dc4725a892b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GowwyNaPfudULQEq4TXoDA.png"/></div></div></figure><p id="97e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我们想要检索数据的子类，在本例中，我们想要检索第一个字母为A的5个动物名称，因此只需在animal.py上写入子类的前五个。</p><pre class="je jf jg jh fd jr js jt ju aw jv bi"><span id="08f9" class="jw jx hi js b fi jy jz l ka kb">row_selector = <strong class="js hj">".//li[@class='az-phobia-link-990']|.//li[@class='az-phobia-link-322']|" </strong>\<br/>                   <strong class="js hj">".//li[@class='az-phobia-link-451']|.//li[@class='az-phobia-link-204']|" </strong>\<br/>                   <strong class="js hj">".//li[@class='az-phobia-link-225']"</strong></span></pre><p id="c422" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，您必须选择行。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es jm"><img src="../Images/30e4c4e35dc8c6ed9bf267fa8f95db3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f-x5hLiYWBTSZHUSaFHloQ.png"/></div></div></figure><p id="4996" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们想要检索土豚，红阿比，阿德利企鹅，Affenpinscher，Afgan猎犬文本，它们在html中的位置在。/a/b，然后我们键入文本。/a/b/text()并将其放在我们的代码中，如下所示。</p><pre class="je jf jg jh fd jr js jt ju aw jv bi"><span id="718a" class="jw jx hi js b fi jy jz l ka kb"><strong class="js hj">for </strong>row <strong class="js hj">in </strong>table.xpath(row_selector):<br/>    name = row.xpath(<strong class="js hj">'./a/b/text()'</strong>).extract_first()<br/>    print(name)<br/><br/>    data.append({<br/>        <strong class="js hj">"name"</strong>: name<br/>    })</span></pre><p id="0a58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我还添加了名称文本，使结果更加整洁。如果要添加一些文本或函数，可以键入data.append，然后键入文本。这是最后的代码，你在animal.py中的整个代码应该是这样的。</p><pre class="je jf jg jh fd jr js jt ju aw jv bi"><span id="09dd" class="jw jx hi js b fi jy jz l ka kb"><strong class="js hj">import </strong>scrapy<br/><br/><br/><strong class="js hj">class </strong>AnimalSpider(scrapy.Spider):<br/>    name = <strong class="js hj">'animal'<br/>    </strong>allowed_domains = [<strong class="js hj">'https://www.a-z-animals.com'</strong>]<br/>    start_urls = [<strong class="js hj">'https://www.a-z-animals.com/animals'</strong>]<br/><br/>    <strong class="js hj">def </strong>parse(self, response):<br/>        data = []<br/>        table = response.css(<strong class="js hj">'.az-left-box.az-animals-index'</strong>)<br/>        row_selector = <strong class="js hj">".//li[@class='az-phobia-link-990']|.//li[@class='az-phobia-link-322']|" </strong>\<br/>                       <strong class="js hj">".//li[@class='az-phobia-link-451']|.//li[@class='az-phobia-link-204']|" </strong>\<br/>                       <strong class="js hj">".//li[@class='az-phobia-link-225']"<br/><br/>        for </strong>row <strong class="js hj">in </strong>table.xpath(row_selector):<br/>            name = row.xpath(<strong class="js hj">'./a/b/text()'</strong>).extract_first()<br/>            print(name)<br/><br/>            data.append({<br/>                <strong class="js hj">"name"</strong>: name<br/>            })<br/><br/>        <strong class="js hj">return </strong>data</span></pre><p id="212b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后去终端输入scrapy crawl animal -o codes.json，在package.json上查看一下就会得到这个。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es jm"><img src="../Images/b8fa37aa5435b673f4e6e2e43f3ad3fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rfaMhuXiNwvKOw786mwIkw.png"/></div></div></figure><p id="c685" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为我们在代码上键入print(name ),结果也会添加到终端中。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es kc"><img src="../Images/85abc4868521ce51bba14823ed49b3f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VNu6n-J7MWL_-dGuB8GM-Q.png"/></div></div></figure><p id="1ce4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是如何抓取一个网站的例子。在这个例子中，我们依次抓取了五个动物的名字，第一个字母是A。在下一篇文章中，我将再次分享更多关于Python、Javascript或HTML的内容。</p><p id="0c99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请继续关注我的下一篇文章！！</p></div></div>    
</body>
</html>