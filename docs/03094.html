<html>
<head>
<title>Handle Excel file using Python (Part 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python处理Excel文件(第2部分)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/handle-excel-file-using-python-part-2-bdda6c061f16?source=collection_archive---------20-----------------------#2020-01-15">https://medium.com/analytics-vidhya/handle-excel-file-using-python-part-2-bdda6c061f16?source=collection_archive---------20-----------------------#2020-01-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/92a74536a5c015b6aee2ab098bae4e89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YKY03tQFwrsnaddcntX0KA.png"/></div></div></figure><p id="316f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在之前的博客《<a class="ae jo" href="https://bqstack.com/b/detail/103/Handle-Excel-file-using-Python-%28Part-1%29" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">用Python处理Excel文件(第一部分)</strong> </a>中，我已经讲述了如何用Python创建Excel文件，添加工作表，添加数据，查看Excel工作表细节等。现在，我们将介绍如何使用Python查看Excel数据，以及如何在Excel表格单元格值上添加样式。所以让我们从上一篇博客离开的地方继续。</p><p id="1b9c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">从Excel表中读取:</strong> <br/>现在让我们从Excel表中读取数据，我们可以用与编写数据相同的方式读取数据:<br/> 1)通过使用单元格地址<br/> data1 = sheet['B2'] <br/> 2)通过提供行号和列号<br/> data2 = sheet.cell(row=1，column=2) <br/>现在让我们使用下面的代码片段从工作表中读取数据:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="b5e9" class="jy jz hi ju b fi ka kb l kc kd"># import openpyxl module as this is required to work with Excel<br/>import openpyxl as exl  <br/><br/># provide the Excel file name <br/>filename="testexcel.xlsx"<br/><br/># Loading the Excel workbook .xlsx file which we have created earlier<br/>workbook = exl.load_workbook(filename)<br/><br/># Take the reference of the active sheet<br/>sheet = workbook.active<br/><br/># Get the values<br/>data1 = sheet['A1'] <br/>data2 = sheet.cell(row=1, column=2)<br/><br/># print the Excel sheet values<br/>print("data 1 is {} and data 2 is {}".format(data1.value, data2.value))</span></pre><p id="c92e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">执行上述Python代码后，我们可以得到以下响应:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="2d68" class="jy jz hi ju b fi ka kb l kc kd">data 1 is id and data 2 is name</span></pre><p id="ac74" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这样我们就可以使用Python读取工作表数据。我们可以使用一个循环从Excel表中获取完整的表格，并使用Python打印出来。</p><p id="cc72" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">将一张表的数据复制到另一张表:</strong> <br/>我们可以将一张表的数据复制到新的复制表中。我们可以编写以下代码来生成任何工作表的副本:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="ccf6" class="jy jz hi ju b fi ka kb l kc kd"># import openpyxl module as this is required to work with Excel<br/>import openpyxl as exl  <br/><br/># provide the Excel file name <br/>filename="testexcel.xlsx"<br/><br/># Loading the Excel workbook .xlsx file which we have created earlier<br/>workbook = exl.load_workbook(filename)<br/><br/># get Sheet which you want to copy<br/>source=workbook['Anurag test sheet']<br/># create the copy sheet<br/>target=workbook.copy_worksheet(source)<br/><br/># save workbook<br/>workbook.save(filename)</span></pre><p id="2609" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用上面的代码，我们可以创建一个“Anurag测试表”表的副本。</p><p id="04fd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">从Excel文件中移除工作表:</strong> <br/>现在我们要从Excel文件中移除工作表，为此，我们需要通过传递工作表引用来调用Remove()方法，参见下面的代码片段:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="9f7d" class="jy jz hi ju b fi ka kb l kc kd"># import openpyxl module as this is required to work with Excel<br/>import openpyxl as exl  <br/><br/># provide the Excel file name <br/>filename="testexcel.xlsx"<br/><br/># Loading the Excel workbook .xlsx file which we have created earlier<br/>workbook = exl.load_workbook(filename)<br/><br/># remove a sheet from the Excel file.<br/>workbook.remove(workbook['Anurag test sheet Copy'])<br/><br/># save workbook<br/>workbook.save(filename)</span></pre><p id="e32b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用上面的代码，我们可以从Excel文件中删除“Anurag测试表副本”表。</p><p id="d2e7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">在Excel单元格数据中添加样式:</strong> <br/>我们可以改变字体，填充到单元格中。如果我们想为一个单元格配置字体，那么我们需要首先定义字体，然后将该字体分配给所需的单元格，请参考下面的代码片段:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="c21a" class="jy jz hi ju b fi ka kb l kc kd">font = Font(color = colors.GREEN, bold = True, italic = True)<br/>cell1.font = font</span></pre><p id="0d73" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用上面的代码，我们可以改变特定单元格值的格式。同样，我们也可以在需要设置填充变量的地方更改填充颜色，然后将其分配给任何单元格，请参考下面的代码片段:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="49f7" class="jy jz hi ju b fi ka kb l kc kd">fill = PatternFill(fill_type = 'lightUp', bgColor = 'D8F1D3')<br/>cell2.fill = fill</span></pre><p id="8211" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请参考下面的代码，我们在这里应用字体，并填写我们之前使用的相同的excel文件。</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="3b9a" class="jy jz hi ju b fi ka kb l kc kd"># importing openpyxl and its styles module as this is required to work with Excel<br/>import openpyxl as exl  <br/>from openpyxl.styles import *<br/><br/># providing the Excel file name <br/>filename="testexcel.xlsx"<br/><br/># Loading the Excel workbook .xlsx file which we have created earlier<br/>workbook = exl.load_workbook(filename)<br/><br/># Fetching the current sheet<br/>sheet = workbook['Anurag test sheet']<br/><br/># Fetching the cell values<br/>cell1 = sheet['B2']<br/>cell2 = sheet['C2']<br/><br/># Configuring the font for the first cell<br/>font = Font(color = colors.GREEN, bold = True, italic = True)<br/>cell1.font = font<br/><br/># Configuring the fill for the first cell<br/>fill = PatternFill(fill_type = 'lightUp', bgColor = 'D8F1D3')<br/>cell2.fill = fill<br/><br/># saving the workbook<br/>workbook.save(filename)</span></pre><p id="e4ca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">执行上述代码后，我们可以得到以下输出(参考截图)。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es ke"><img src="../Images/62521e8cf24e9772bb6ad3364a308f80.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*jtnAyNjqHWiAuDsxyA4F3A.png"/></div></figure><p id="13d5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">对Excel中的表格数据应用样式:</strong> <br/>在上一节中，我们对单个单元格进行了样式化，但是使用Table和TableStyleInfo模块，我们可以对给定范围的完整表格数据进行样式化。我们首先需要创建一个表格对象，如下面的代码片段所示:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="1359" class="jy jz hi ju b fi ka kb l kc kd">table = Table(displayName = "Table", ref = "A1:G11")</span></pre><p id="30a8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">之后，我们可以创建styel对象，如下面的代码片段所示:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="b80f" class="jy jz hi ju b fi ka kb l kc kd">style = TableStyleInfo(name = "TableStyleMedium9", showRowStripes = True, showColumnStripes = True)</span></pre><p id="f2c6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，我们可以将样式分配给表格:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="d20d" class="jy jz hi ju b fi ka kb l kc kd">table.tableStyleInfo = style</span></pre><p id="352f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，我们可以将表格添加到工作表中:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="96c9" class="jy jz hi ju b fi ka kb l kc kd">sheet.add_table(table)</span></pre><p id="62b3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请参考下面的代码片段，我们可以使用它来设置表格Excel数据的样式:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="a343" class="jy jz hi ju b fi ka kb l kc kd"># importing openpyxl and its styles module as this is required to work with Excel<br/>import openpyxl as exl  <br/>from openpyxl.styles import *<br/>from openpyxl.worksheet.table import Table, TableStyleInfo<br/><br/># providing the Excel file name <br/>filename="testexcel.xlsx"<br/><br/># Loading the Excel workbook .xlsx file which we have created earlier<br/>workbook = exl.load_workbook(filename)<br/><br/># Fetching the current sheet<br/>sheet = workbook['Anurag test sheet']<br/><br/>#Creating a table inside the sheet<br/>table = Table(displayName = "Table", ref = "A1:C3")<br/><br/>#Defining a style for the table (default style name, row/column stripes)<br/>#Choose your table style from the default styles of openpyxl<br/>#Just type in openpyxl.worksheet.table.TABLESTYLES in the Python interpreter<br/>style = TableStyleInfo(name = "TableStyleMedium9", showRowStripes = True, showColumnStripes = True)<br/><br/>#Applying the style to the table<br/>table.tableStyleInfo = style<br/><br/>#Adding the newly created table to the sheet<br/>sheet.add_table(table)<br/><br/># saving the workbook<br/>workbook.save(filename)</span></pre><p id="b017" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用上面的代码，我们可以格式化Excel文件中的表格数据。不可能在两篇博客中涵盖openpyxl模块的所有特性，但是我已经尝试涵盖了一些重要的特性，通过这些特性，任何人都可以使用Python处理Excel文件操作。如有任何疑问，请随时留下评论。</p></div><div class="ab cl kf kg gp kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hb hc hd he hf"><p id="2bab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="km">最初发表于</em><a class="ae jo" href="https://bqstack.com/b/detail/104" rel="noopener ugc nofollow" target="_blank"><em class="km">【https://bqstack.com】</em></a><em class="km">。</em></p></div></div>    
</body>
</html>