<html>
<head>
<title>A Week of Machine Learning: Day 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一周的机器学习:第二天</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-week-of-machine-learning-2nd-day-d14c4a9b08f?source=collection_archive---------3-----------------------#2019-07-06">https://medium.com/analytics-vidhya/a-week-of-machine-learning-2nd-day-d14c4a9b08f?source=collection_archive---------3-----------------------#2019-07-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/6f8b8792ed00720a14434c75fc99cce9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L7vIFepPY2nxjWFclPphnA.png"/></div></div></figure><p id="4407" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是为期7天的机器学习系列的第二天。</p><h1 id="4013" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">逻辑回归</strong></h1><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es km"><img src="../Images/ea915f79cbff7c227d6e23124de56750.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nPJ7L21RaC4Ti5_UwySPoQ.png"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">逻辑回归</figcaption></figure><p id="8b0d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是一种监督学习算法。我们有给定的目标值，我们必须预测看不见的数据。它用于分类问题。</p><p id="4599" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">其背后的直觉是，曲线是用误差最小的数据拟合的。在设定曲线之后，在层的上部下面的新的看不见的数据点属于一个类别(具有概率1)，而在层的下部的数据点属于另一个部分(具有概率0)。介于两者之间的数据点的概率为0.5。</p><p id="df65" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上图显示了一只老鼠是否肥胖的例子。曲线拟合得很好，体重轻意味着不肥胖，体重多意味着肥胖。</p><p id="08dc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们来玩代码吧。尽量不要复制这段代码，并尝试自己编写代码。你想看多少遍都可以。</p><h2 id="fb41" class="kv jp hi bd jq kw kx ky ju kz la lb jy jb lc ld kc jf le lf kg jj lg lh kk li bi translated"><strong class="ak">代号</strong></h2><figure class="kn ko kp kq fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="78b2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们一部分一部分地理解代码。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/bf24286377b5dd1696c84d7052fbc59a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ODArilBnoagKj-eUJHSg_g.png"/></div></div></figure><p id="b141" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本节中，我们将导入所需的库。这些在前一篇文章中都已经解释过了。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/8433e8293df4a80b759f1972569edd20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Os15hrhLDFzGMhU49rz3Zw.png"/></div></div></figure><p id="187a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们用熊猫的<strong class="is hj"> read_csv </strong>功能从网上读取了一个csv文件。我们可以在<strong class="is hj"> read_csv </strong>函数中传递CSV文件的路径或者指向它的链接。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/b4331fcfad89ef5a898bb6261a4cc127.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fN1k7q2LEOCcYoEz5laHiA.png"/></div></div></figure><p id="9dcc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你想离线工作，那么从<a class="ae lo" href="https://query.data.world/s/67p5gkjye5vocfiqm2cuxnrkx4ijim" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">这里</strong> </a>下载数据集。在<strong class="is hj"> read_csv </strong>函数中用正确的路径代替链接放入文件名。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/36c0297823860d4e3f8f06449559fe03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZItSKCju-aBwIm6KAAY0pA.png"/></div></div></figure><p id="cc18" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了检查数据的外观，我们使用<strong class="is hj"> head </strong>功能打印了前5行。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/9a36777ed24fcd6f282c9697141960b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fTHAkmVYTKT-7A7ehszWMg.png"/></div></div></figure><p id="0f42" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了检查数据类型，空值我们使用了<strong class="is hj"> info </strong>函数。它的输出:-</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/12ffb938f4e2f061b54274604c01013a.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*W93khG3ENb6GZZDRIYxhWw.png"/></div></figure><p id="2f95" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里我们可以看到“3P%”列有一些空值。所以我们现在用零填充这些空值。有不同的方法来处理空值，但现在，我们只是用简单的方法。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/ad6c86100895672009e0c9a79b431bfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NlCxVkCPqFkuNUnD8bPwRw.png"/></div></div></figure><p id="6ce1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> fillna </strong>函数的第一个参数是放在空值位置的值。“就地”意味着应该在数据帧中进行更改，并且不返回任何内容。否则，它将返回具有已更改值的数据帧。运行不带“inplace”的这行代码，您就会知道其中的区别。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/2a496435da077b54bde84c6e5253839a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UFNpcr6LMmsf9BbQ77bG7w.png"/></div></div></figure><p id="61ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这部分做一个简单的任务。将目标值和特征分配给不同的变量。<strong class="is hj"> drop </strong>函数删除指定的行或列。这里我们放“axis = 1”表示列。如果“轴= 0 ”,那么它意味着行。删除“TARGET _ 5Yrs”和“Name”列并返回其余数据，因为我们尚未设置“inplace = True”。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/92a3ef368d575b4df1f4494de2be71db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vuHhKoKqMNnUNRa1IRJ98g.png"/></div></div></figure><p id="ca88" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">把我们的数据分成两组。一个用于培训，另一个用于测试。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/91e370dea70e644e6f356cdfc51b5890.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xyTDbA9ax1nPfbmM5Xe-Vg.png"/></div></div></figure><p id="c393" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里，我们创建一个类LogisticRegression对象，并使用函数“fit”根据我们的训练数据训练我们的模型。拟合函数将特征和目标变量作为输入。然后我们使用得分函数来获得准确度。分数函数采用特征和实际目标。</p><h1 id="8857" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">支持向量机(SVM) </strong></h1><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/b417ea0e8a5250dfc4d15c002b43adf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pvd6CP2x1OIOOpyKh2RWdw.png"/></div></div></figure><p id="4f85" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该算法用于回归和分类问题。</p><p id="2e61" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该算法在两类超平面中寻找最佳超平面。具有最大余量的超平面被认为是最佳超平面。从上图可以很容易的得到直觉。数据点被称为支持向量，超平面和这些点之间的距离被称为余量。</p><h2 id="8dac" class="kv jp hi bd jq kw kx ky ju kz la lb jy jb lc ld kc jf le lf kg jj lg lh kk li bi translated"><strong class="ak"> SVC (SVM为分类)</strong></h2><figure class="kn ko kp kq fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="2214" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们把代码分成几部分。有些部分已经解释过了。</p><ol class=""><li id="2264" class="lv lw hi is b it iu ix iy jb lx jf ly jj lz jn ma mb mc md bi translated">导入所需的库:</li></ol><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/8358a9569d38b9a3be7e04d02e1b1a0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hcUr8pUwAwqWkJ43T-XwEA.png"/></div></div></figure><p id="423c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.从互联网上的CSV文件中读取数据到pandas dataframe。数据集与上面逻辑回归示例中使用的数据集相同:</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/1c23747a6d873970fb19e0567ff67c36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_zv_qQpLtODUG-udMrtIMA.png"/></div></div></figure><p id="8cab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.打印前五行数据:</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/5ed38f42ce3bb1a61c04f297b2d2c250.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HGQqaIz4PcBOxcCdBcYXAA.png"/></div></div></figure><p id="50fa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.打印数据的详细信息:</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/38a6973657431ade3a09eded03cf609a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l696pXVkwMtWdpNLGBZhzg.png"/></div></div></figure><p id="566a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.填充空值:</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/bb476867b81304083d77f0b1cc9a8e58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CgDDJLlZE9YOSDInTzbC1Q.png"/></div></div></figure><p id="144c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">6.获取我们的目标变量和不同变量的特征:</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/da7893b26c871c272cf79778ff33cb1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ng9x2HdrmGsLdmsBUwozHQ.png"/></div></div></figure><p id="8a6d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">7.将我们的数据分为训练集和测试集:</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/b97d139d96353c64373d29ec58c285fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*95X9JG8BYP924Nlg4wtSdg.png"/></div></div></figure><p id="b497" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">8.训练我们的分类器并检查准确性:</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/88ce94779720b5e66dd6caa24d04da9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v4JF8jPUzHxMpPKNuNUlDg.png"/></div></div></figure><h2 id="a606" class="kv jp hi bd jq kw kx ky ju kz la lb jy jb lc ld kc jf le lf kg jj lg lh kk li bi translated"><strong class="ak"> SVR (SVM回归)</strong></h2><figure class="kn ko kp kq fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="ae67" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们把代码分成几部分。</p><ol class=""><li id="a338" class="lv lw hi is b it iu ix iy jb lx jf ly jj lz jn ma mb mc md bi translated">导入所需的库。有些部分已经解释过了。因此，我们会很快扔了它们。</li></ol><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/4a34190c83f8ce8db2c0a10c3fb6bb8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nWf9qIvkQMaVfXDh_kPqag.png"/></div></div></figure><p id="604c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.加载波士顿房价预测数据集。你可以从<a class="ae lo" href="https://www.kaggle.com/fauzantaufik/boston-housepredict/downloads/boston-housepredict.zip/1#boston_train.csv" rel="noopener ugc nofollow" target="_blank">这里</a>下载</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/0c81c8786a969616075433ecbad77267.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NWW7Niw29DCP_N0-iCwWjg.png"/></div></div></figure><p id="0a1f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.打印前五行以查看我们的数据:</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/e4d93666ff05f95b17e22b0bf30410a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rJnion91iyeaPr5xHIujpA.png"/></div></div></figure><p id="1be2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.打印数据的详细信息</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/15e23cd55d3f56602f0b4ea244b40f14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qQ55jRWl7y08avnNKPo8mQ.png"/></div></div></figure><p id="0191" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.“medv”是我们必须预测的目标值。在y_train中获取，其他放在x_train中:</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/f410d3dea6511c021569370544dc4597.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0lS5tWvpA_hWS464AUEGaQ.png"/></div></div></figure><p id="321f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">6.将数据分为训练集和测试集:</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/6e48c2c89dabd4439afb9db66f7c0b28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ga3UVRucKCbVjtUHuTIeVw.png"/></div></div></figure><p id="3b26" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">7.训练回归器并检查误差。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/f19a9753ba184ad7e32c7ea97c841578.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LHYj1EeEY8Cg-Fb28hg_Ww.png"/></div></div></figure><p id="5f8e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">去玩数据吧。下载上面的数据集，自己进行逻辑回归和支持向量机。</p><h2 id="5dcb" class="kv jp hi bd jq kw kx ky ju kz la lb jy jb lc ld kc jf le lf kg jj lg lh kk li bi translated">感谢阅读。快乐学习！！</h2></div></div>    
</body>
</html>