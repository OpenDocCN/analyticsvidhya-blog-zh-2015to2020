<html>
<head>
<title>Time-Series Forecasting with Spark ML: Part — 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Spark ML 进行时间序列预测:第一部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/time-series-forecasting-with-spark-ml-part-1-4e888144ad27?source=collection_archive---------2-----------------------#2020-12-23">https://medium.com/analytics-vidhya/time-series-forecasting-with-spark-ml-part-1-4e888144ad27?source=collection_archive---------2-----------------------#2020-12-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="55ad" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这个由两部分组成的系列中，我们将探索如何使用 Apache Spark ML 库创建简单的时间序列预测模型。第一部分包括介绍、软件/工具描述和探索性数据分析。第二部分包括代码描述、结果和总结。</p><p id="d4e4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">目录</strong></p><ol class=""><li id="566b" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated">介绍</li><li id="02e4" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">软件/工具描述</li><li id="401a" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">数据描述和探索性数据分析</li><li id="4052" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">代码描述(自定义时序包)</li><li id="da38" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">结果</li><li id="ac91" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">摘要</li><li id="c44d" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">参考</li></ol></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><ol class=""><li id="d299" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated"><strong class="io hj">简介</strong></li></ol><p id="329d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">动量投资/交易策略是一种策略，投资者买入价格呈上升趋势的流动证券(如股票)，卖出价格呈下降趋势的证券。动量投资的主要目标之一是预测股票的价格趋势，以便制定及时进入和退出投资的策略。</p><p id="7cc8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这项工作中，我们寻求发展<em class="jy">短期</em>动量交易策略来投资股票。我们研究最受欢迎的蓝筹股称为方(脸书，苹果，和谷歌)的股票。目标是使用<em class="jy"> Apache Spark </em>机器学习库和从获得的 2008 年到 2018 年的历史日价格数据来预测方股票的<em class="jy">近期</em>价格(1 天、3 天、5 天和 7 天预测)。这些预测将被用来制定简单的<em class="jy">短期</em>交易策略</p><p id="9295" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">2.<strong class="io hj">软件/工具描述</strong></p><p id="5a68" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> Quandl 包</strong></p><p id="5c34" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们使用 Nasdaq.com 的数据。为此，我们使用一个名为<em class="jy">quandl</em>【1】的包。这个包裹已经被 Nasdaq.com 收购了。这是一个流行的金融时间序列数据数据库，提供 Python 和 R APIs 来下载数据和对数据执行简单的操作[2]。我们使用 Python-time-series API 来获取数据[3]。</p><p id="ac8b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">安装:</p><p id="4679" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以从 PyPI 或 github 库使用</p><p id="6c37" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="jy"> $pip 安装 quandl </em></p><p id="a751" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用软件包:</p><p id="8b81" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们只需在 Python 客户端程序中使用 import 命令导入 quandl 包。</p><p id="919a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="jy">进口 quandl </em></p><p id="88a5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">认证:</p><p id="daad" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了使用<em class="jy">quandl</em>API 访问数据，我们需要在<em class="jy"> quandl </em>网站[1]中创建一个帐户，并生成一个认证密钥。我们需要在 python 客户机程序中如下设置认证密钥，</p><p id="bb8b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="jy"> quandl。ApiConfig.api_key = "您的 API key" </em></p><p id="daf8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">查询数据:</p><p id="4346" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们使用 quandl python API 查询数据。查询的数据作为<em class="jy"> pandas </em> dataframe 获得。例如，我们可以获得苹果股票价格的时间序列数据如下:</p><p id="f228" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="jy"> apple_data = quandl.get("维基/AAPL") </em></p><p id="bf46" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="jy"> apple_data </em>是一个 pandas 数据帧，有“Date”列作为它的索引(datetime 数据类型)。如果我们需要在计算中使用“日期”列，我们需要重置索引(图 1a)。</p><figure class="ka kb kc kd fd ke er es paragraph-image"><div class="er es jz"><img src="../Images/4b2afa3aa43cdf9b863c668b4adc9256.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*AbcdATEP94KaVbpUejI9rA.png"/></div><figcaption class="kh ki et er es kj kk bd b be z dx translated"><strong class="bd kl">图 1a。</strong>使用<em class="km"> quandl </em>包从 Nasdaq.com 获取苹果股票价格数据</figcaption></figure><p id="5d19" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果我们需要从一个特定的时间范围内获得数据(图 1b)，我们可以进行过滤时间序列调用[3]，</p><p id="d245" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="jy">apple _ data _ time frame = quandl . get("维基/AAPL "，start _ date = ' 2014–09–01 '，end _ date = ' 2015–09–01 ')</em></p><figure class="ka kb kc kd fd ke er es paragraph-image"><div class="er es jz"><img src="../Images/51dd45c7a792baec99235ac4c6e20c1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*rX3DRuW49t1KbiyKe-SEAg.png"/></div><figcaption class="kh ki et er es kj kk bd b be z dx translated"><strong class="bd kl">图 1b。</strong>获取指定时间窗的时间序列数据，这里我们获取 2014 年 9 月 1 日到 2015 年 9 月 1 日之间的苹果股票价格。</figcaption></figure><p id="075f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">此外，如果我们需要在查询时对数据进行任何转换，我们可以在调用中添加转换类型[3]。例如，如果我们需要差异数据(即 yt — yt-1)，命令是(图 1c)，</p><p id="63d8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">apple_data_diff = quandl.get("维基/AAPL "，transformation = 'diff ')</p><figure class="ka kb kc kd fd ke er es paragraph-image"><div class="er es jz"><img src="../Images/6a28002d56132d4830468ed45fc89d3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*_bKzTJKiqj91yDhSOxACcw.png"/></div><figcaption class="kh ki et er es kj kk bd b be z dx translated"><strong class="bd kl">图 1c。</strong>获得数据经过小的操作，这里我们对苹果股票价格数据进行一阶差分(即当前值—先前时间步长值)</figcaption></figure><p id="5488" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">此外，我们可以更改时间序列数据的频率，但是要在 get 调用中附加 frequency 参数。例如，我们可以每天、每周、每月等频率获取数据。我们还可以使用 Excel 插件下载 CSV 格式的数据文件。因此，<em class="jy"> quandl </em>包提供了一组易于使用的 API，用于从 Nasdaq.com 获取金融时间序列数据。</p><p id="89b0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">除了 quandl 包，我们还在 Anaconda 中使用 py spark(Spyder 版本 3.3.2，Jupyter 版本 5.6.0 ),并在 CentOS 7.5 VM 中使用 VMWare Workstation</p><p id="b76e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">3.<strong class="io hj">数据描述和探索性数据分析</strong></p><p id="03a8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们观察了苹果、脸书、网飞和谷歌四只股票的股价，并进行了简短的探索性数据分析。我们执行简单的测试来确定时间序列的平稳性。我们将每个股票价格视为一个单变量时间序列。</p><p id="5710" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们首先检查数据集中的空值。我们首先研究脸书的股票价格数据。我们看到，我们有从 2012 年 5 月 18 日到 2018 年 3 月 27 日的每日收盘价数据，并且数据集中没有空值。</p><p id="e439" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">同样，我们检查了苹果、网飞和谷歌股票价格的数据集。</p><p id="ee1d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们有网飞股票从 2002 年 5 月 23 日到 2018 年 3 月 27 日的每日收盘价数据。网飞数据集中没有空值。对于苹果股票，我们有从 1980 年 12 月 12 日到 2018 年 3 月 27 日的每日收盘价数据，并且苹果数据集中没有空值。最后，对于谷歌股票，我们有从 2004 年 8 月 19 日到 2018 年 3 月 27 日的每日收盘价数据。Google 数据集中没有空值。</p><figure class="ka kb kc kd fd ke er es paragraph-image"><div class="er es jz"><img src="../Images/636735c44ef849f0380d8f6f79149175.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*M_7s6Ko0u7tTiUPHc2lhlA.png"/></div><figcaption class="kh ki et er es kj kk bd b be z dx translated"><strong class="bd kl">图 2a。</strong>检查脸书股票价格数据中的空值</figcaption></figure><figure class="ka kb kc kd fd ke er es paragraph-image"><div class="er es jz"><img src="../Images/7736f78918388d1ad141c403919ce96f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*Ez3OjhJ9Zbbjypn5rMu2Kg.png"/></div><figcaption class="kh ki et er es kj kk bd b be z dx translated"><strong class="bd kl">图 2b。</strong>检查网飞股票价格数据集中的空值。</figcaption></figure><figure class="ka kb kc kd fd ke er es paragraph-image"><div class="er es jz"><img src="../Images/79a68e34de5e326fd1e42196e2e771ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*dRodiZvWOZ6uuwMe6zIAgg.png"/></div><figcaption class="kh ki et er es kj kk bd b be z dx translated"><strong class="bd kl">图 2c。</strong>检查苹果股票价格数据集中的空值。</figcaption></figure><figure class="ka kb kc kd fd ke er es paragraph-image"><div class="er es jz"><img src="../Images/4cbddc8bad7fab0f5fa432a847276874.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*Bi-QXJQqa8k_7LqdLdjVIg.png"/></div><figcaption class="kh ki et er es kj kk bd b be z dx translated"><strong class="bd kl">图 2d。</strong>检查 Google 股票价格数据集中的空值</figcaption></figure><p id="0f56" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">检查时间序列的平稳性:</strong></p><p id="6910" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们执行扩展的 Dickey-Fuller 检验，以确定时间序列数据是否是平稳的。我们观察到这四个股票价格时间序列都是非平稳的。</p><figure class="ka kb kc kd fd ke er es paragraph-image"><div class="er es jz"><img src="../Images/332d13c37e818ced886a57b73a9b5bef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*VTwR_gFmIz1U_o7-o4-pqg.png"/></div><figcaption class="kh ki et er es kj kk bd b be z dx translated"><strong class="bd kl">图 2e。我们看到四个股票价格时间序列都是非平稳的</strong></figcaption></figure><p id="7785" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们接受零假设，即如果 p 值&gt; 0.05，时间序列数据是平稳的。以下是结果摘要:</p><figure class="ka kb kc kd fd ke er es paragraph-image"><div class="er es jz"><img src="../Images/9bfc8b5789bc12f5fe40b21814118857.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*qLt85IeflYO25mXf65YoGA.png"/></div><figcaption class="kh ki et er es kj kk bd b be z dx translated"><strong class="bd kl">图 2f。</strong>对所有股票价格进行的增强 Dickey-Fuller 检验汇总</figcaption></figure><p id="50d1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">尽管完整的时间序列数据是不稳定的，但也可能有部分数据是稳定的。</p><p id="d89a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们通过获得数据的一阶差分使时间序列数据近似平稳。第一个差异定义如下:</p><p id="937c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果 St 是时间步长 t 时的股价，那么一阶差分 Zt = St-St-1</p><p id="b8cd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这种使序列平稳的方法是一种近似的方法，只有当时间序列为<em class="jy">差分平稳</em>时才有效。然而，众所周知，股票价格数据是非平稳的。它们可以展示趋势、季节性等。我们在本书中不探讨这些方面。</p><p id="0333" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在对原始股票价格数据执行第一次差分之后，我们对差分数据采用机器学习算法。众所周知，这种方法可以产生稳定可靠的预测。为了检查差异数据是否是稳定的，我们再次对差异数据执行增强的 Dickey-Fuller 检验。我们看到差异数据是稳定的。所有 p 值均小于 0.05，ADF 统计值为高度负值，小于 1%临界值(见图 2h、2i)。这表明我们应该使用差分数据进行时间序列预测。</p><figure class="ka kb kc kd fd ke er es paragraph-image"><div class="er es jz"><img src="../Images/51a34a40933fc5ba93a10bad1cdf05a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*6hHrHZgc4NK_jm9w91GQBA.png"/></div><figcaption class="kh ki et er es kj kk bd b be z dx translated"><strong class="bd kl">图 2g。</strong>使用 quandl API 获取差异数据</figcaption></figure><figure class="ka kb kc kd fd ke er es paragraph-image"><div class="er es jz"><img src="../Images/9274803e468931737681f2f89e1a7fb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*b5hoxaj4eNxnxV2kYP7YRg.png"/></div><figcaption class="kh ki et er es kj kk bd b be z dx translated"><strong class="bd kl">图 2h。</strong>苹果和谷歌股价的差异数据是稳定的，表现为 p 值&lt; 0.05 和 ADF 统计数据高度负值且小于 1%临界值</figcaption></figure><figure class="ka kb kc kd fd ke er es paragraph-image"><div class="er es kn"><img src="../Images/290981e25dbdbf4f3eeb6885bf5f8108.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*y6KwvYAcvUBMPN1SPnEBBQ.png"/></div><figcaption class="kh ki et er es kj kk bd b be z dx translated"><strong class="bd kl">图 2i。</strong>网飞和脸书股票价格的差异数据是稳定的，由 p 值&lt; 0.05 和 ADF 统计高度负且小于 1%临界值表示</figcaption></figure><p id="045b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们比较了谷歌股票的原始价格数据和差异股价数据的滚动平均值。我们看到，在进行差异计算时，差异数据的 30 天滚动平均值在某种程度上是恒定的(这意味着差异数据是稳定的，我们已经对其进行了趋势分析)。</p><figure class="ka kb kc kd fd ke er es paragraph-image"><div class="er es ko"><img src="../Images/a2bf129f76d96195e14fa49785613356.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*zgiFTorf3Ci5H_SQDcZh_Q.png"/></div><figcaption class="kh ki et er es kj kk bd b be z dx translated"><strong class="bd kl">图 2j。</strong>谷歌股票原始价格数据(上图)和差异价格数据(下图)的 30 天滚动平均值比较；x 轴是时间窗的数量。</figcaption></figure><p id="67e1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">但是，标准差没有太大差别。</p><figure class="ka kb kc kd fd ke er es paragraph-image"><div class="er es kp"><img src="../Images/613bf34ff6eb2edebd5150fa04963c6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*KR3S1uQK-OoEkCoNVRsyTw.png"/></div><figcaption class="kh ki et er es kj kk bd b be z dx translated"><strong class="bd kl">图 2k。</strong>谷歌股票原始价格数据(上图)和差异价格数据(下图)的 30 天滚动标准差比较；x 轴是时间窗的数量</figcaption></figure><p id="9fb2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">类似地，对于苹果股票，我们看到，在对数据进行差分后，我们移除了股票价格的趋势，并使其保持平稳。我们看到，差异数据的 30 天滚动平均值大部分是恒定的(除了最后)。</p><figure class="ka kb kc kd fd ke er es paragraph-image"><div class="er es kq"><img src="../Images/8df909633be058c7d2c3ef131f22ced1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*pg2lves_28hKs_UEXq7EzQ.png"/></div><figcaption class="kh ki et er es kj kk bd b be z dx translated"><strong class="bd kl">图 2l。</strong>苹果股票原始价格数据(上图)和差异价格数据(下图)的 30 天滚动平均值比较；x 轴是大小为 30 天的时间窗的数量。</figcaption></figure><p id="7bec" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们看到苹果股价的方差在数据差异上没有太大变化(就像我们在谷歌股价之前看到的那样)。</p><figure class="ka kb kc kd fd ke er es paragraph-image"><div class="er es kr"><img src="../Images/7bf5802d67f9343a9d12e54ee29ee6b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*iwPWspxySvl1SVdl2vA1eA.png"/></div><figcaption class="kh ki et er es kj kk bd b be z dx translated"><strong class="bd kl">图 2m。</strong>苹果股票原始价格数据(上图)和差异价格数据(下图)的 30 天滚动标准差比较；x 轴是时间窗的数量。</figcaption></figure><figure class="ka kb kc kd fd ke er es paragraph-image"><div class="er es ks"><img src="../Images/4289da4e4a8d9213ba47fb3f4edb4722.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*EvtG2dRE9bfiex-dOzXsyw.png"/></div><figcaption class="kh ki et er es kj kk bd b be z dx translated"><strong class="bd kl">图 2n。</strong>网飞和脸书股票价格的原始数据和差异数据之间的 30 天滚动平均值比较。</figcaption></figure><p id="899a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">因此，我们得出结论，通过差分时间序列数据，我们可以使其平稳，从而避免虚假回归。在本系列的下一部分，我们将详细描述我们开发的使用 Spark MLlib 执行时间序列预测的类和实用函数。</p><p id="503e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">参考文献:</strong></p><p id="f138" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">[1]<a class="ae kt" href="http://www.quandl.com" rel="noopener ugc nofollow" target="_blank">www.quandl.com</a></p><p id="2693" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae kt" href="http://docs.quandl.com" rel="noopener ugc nofollow" target="_blank">http://docs.quandl.com</a></p><p id="ed48" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">[3]<a class="ae kt" href="https://docs.quandl.com/docs/python-time-series" rel="noopener ugc nofollow" target="_blank">https://docs.quandl.com/docs/python-time-series</a></p></div></div>    
</body>
</html>