<html>
<head>
<title>Supervised Learning with Scikit-learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Scikit-learn的监督学习</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/supervised-learning-with-scikit-learn-df617631216a?source=collection_archive---------12-----------------------#2020-12-05">https://medium.com/analytics-vidhya/supervised-learning-with-scikit-learn-df617631216a?source=collection_archive---------12-----------------------#2020-12-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="21ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从什么是监督学习开始，它与无监督学习有何不同，它的实际应用是什么，以及如何使用python的Scikit-learn库实现监督学习。</p><p id="16b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">监督学习是一种创建人工智能的方法，其中我们向监督学习模型提供输入和预期输出结果，并且模型具有检测潜在模式和关系的任务。这有助于模型在以前从未见过的数据上表现良好，并预测输出结果。监督学习的反面是无监督学习，在这种学习中，模型试图在没有任何指导方针和数据预期结果的情况下理解数据本身。无监督学习模型理解数据，尝试检测数据中的相似性和模式，并对其进行分类。</p><p id="cf69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">监督学习可以大致分为两个子类-</p><ol class=""><li id="aa2e" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated"><strong class="ih hj">回归</strong> -这是一种监督学习算法，其中算法从标记的数据集学习，并且能够为馈送到算法的新数据预测连续值输出。回归算法的示例有-预测房价、预测车价、预测犯罪率等。主要的回归算法有-线性回归和逻辑回归。</li><li id="aa55" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">分类</strong> -分类算法是一种学习算法，需要将新数据分类到不同的类别中。与回归不同，它没有连续值输出。它用于我们需要二进制输出的地方，例如-肿瘤是恶性的还是良性的，天气是否晴朗，邮件是否是垃圾邮件等。主要的分类器是决策树、朴素贝叶斯分类器和支持向量机(SVM)。</li></ol><p id="fa56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">监督学习在实际世界中被广泛使用。监督学习的主要实际应用如下-</p><ol class=""><li id="c771" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">垃圾邮件检测——这是由Gmail、rediffmail等使用的。它从邮件中识别单词，这使得它更有可能是垃圾邮件。因此，它通过识别邮件中的可疑单词来对邮件进行分类。它不断学习，并随着时间的推移而进步。</li><li id="f069" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">语音识别——这是一个我们在Alexa、Siri、Google Assistant、Cortana等网站上看到的应用程序。我们教算法关于我们的声音和如何解释它。每次我们使用它时，它都会不断学习，并变得更有效率。</li><li id="7a10" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">物体识别——这是一个我们在不同地方都能看到的应用。首先，我们在一大组数据上训练算法，然后算法识别不同的对象。它主要用于交通系统、安全系统等。</li><li id="256a" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">生物信息学——这是监督学习算法最广泛的应用之一，它被用于我们的智能手机中的面部识别、屏幕指纹等。它储存我们的生物信息，并利用它来识别我们，而且每次我们使用它时，它都会变得更好。</li><li id="27de" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">推荐系统——它被网飞、亚马逊Prime、Hotstar等热门网站使用。它根据我们的搜索和以前看过的电影为我们推荐新电影。</li></ol><p id="31e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们来看看scikit learn如何借助一个例题实现监督学习算法。示例问题是“使用Gapminder数据集预测预期寿命”。</p><p id="20c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是首先，让我们设置一些关于scikit-learn的见解。Scikit-learn是Python中最健壮、最有用的机器学习库。它为我们提供了各种高效的统计建模和机器学习工具。它主要是用python编写的，构建在其他python库之上，如NumPy、Matplotlib和SciPy。</p><p id="370e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们为我们的问题陈述编码，即“<strong class="ih hj">使用Gapminder数据集</strong>预测预期寿命”。它属于回归类别，让我们看看如何使用scikit-learn来实现监督学习模型</p><p id="dac2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以从这里得到关于Gapminder数据集的信息- <a class="ae jr" href="https://www.gapminder.org/data/" rel="noopener ugc nofollow" target="_blank"> Gapminder_Dataset </a>。</p><p id="4dc4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将尝试给出代码的一个概述，而不深入技术定义。以便有助于对Scikit-Learn和监督学习有一个整体的了解。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="6002" class="kb kc hi jx b fi kd ke l kf kg">import numpy as np</span><span id="7cc5" class="kb kc hi jx b fi kh ke l kf kg">import pandas as pd</span><span id="9173" class="kb kc hi jx b fi kh ke l kf kg"># Read the CSV file into a DataFrame 'df'</span><span id="6920" class="kb kc hi jx b fi kh ke l kf kg">df = pd.read_csv('gapminder.csv')</span><span id="c92e" class="kb kc hi jx b fi kh ke l kf kg">y = df['life'].values</span><span id="2813" class="kb kc hi jx b fi kh ke l kf kg">X = df['fertility'].values</span><span id="f5a3" class="kb kc hi jx b fi kh ke l kf kg">y = y.reshape(-1,1)</span><span id="ae65" class="kb kc hi jx b fi kh ke l kf kg">X = X.reshape(-1,1)</span></pre><p id="add2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个代码块中，我们导入了NumPy、pandas和gapminder数据集。之后，我们将数据集分割成目标变量“y”和特征“X”。然后，我们对它进行了改造，使其符合我们的需求。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="a24c" class="kb kc hi jx b fi kd ke l kf kg">from sklearn.linear_model import LinearRegression</span><span id="d65a" class="kb kc hi jx b fi kh ke l kf kg"># Create the regressor 'reg'</span><span id="f4e8" class="kb kc hi jx b fi kh ke l kf kg">reg = LinearRegression()</span></pre><p id="e4cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们从sklearn.linear_model模块导入了LinearRegression。我们已经创建了一个名为“reg”的实例。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="7c42" class="kb kc hi jx b fi kd ke l kf kg"># Create the prediction space<br/>Here we have preloaded the fertility column in X to numpy array X_fertiity.</span><span id="fc9e" class="kb kc hi jx b fi kh ke l kf kg">prediction_space = np.linspace(min(X_fertility), max(X_fertility)).reshape(-1,1)</span><span id="0e26" class="kb kc hi jx b fi kh ke l kf kg"># Fit the model to the data</span><span id="591a" class="kb kc hi jx b fi kh ke l kf kg">reg.fit(X_fertility,y)</span><span id="1abd" class="kb kc hi jx b fi kh ke l kf kg"># Calculating the prediction</span><span id="4806" class="kb kc hi jx b fi kh ke l kf kg">y_pred = reg.predict(prediction_space)</span><span id="d2ba" class="kb kc hi jx b fi kh ke l kf kg"># Print R^2 error</span><span id="2571" class="kb kc hi jx b fi kh ke l kf kg">print(reg.score(X_fertility,y))</span><span id="95c1" class="kb kc hi jx b fi kh ke l kf kg"># reg score is=0.6192442167740035</span><span id="7af3" class="kb kc hi jx b fi kh ke l kf kg"># Plotting  the regression line</span><span id="69c7" class="kb kc hi jx b fi kh ke l kf kg">plt.plot(prediction_space, y_pred, color='black', linewidth=3)</span><span id="b38d" class="kb kc hi jx b fi kh ke l kf kg">plt.show()</span></pre><p id="3943" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们通过使用生育力作为特征来训练和测试我们的回归变量“reg ”,计算精确度，并绘制我们拟合的线性回归线的分布。</p><figure class="js jt ju jv fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es ki"><img src="../Images/3dd790e4b141057379368a5763b7f043.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TUzp0k8VqW07A6z5e5MJtA.png"/></div></div></figure><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="f8bb" class="kb kc hi jx b fi kd ke l kf kg"># Import necessary modules from sklearn</span><span id="7fcf" class="kb kc hi jx b fi kh ke l kf kg">from sklearn.linear_model import LinearRegression</span><span id="21dd" class="kb kc hi jx b fi kh ke l kf kg">from sklearn.metrics import mean_squared_error</span><span id="14e0" class="kb kc hi jx b fi kh ke l kf kg">from sklearn.model_selection import train_test_split</span><span id="6e1b" class="kb kc hi jx b fi kh ke l kf kg"># Creating X_train, X_test, y_train, y_test</span><span id="77e4" class="kb kc hi jx b fi kh ke l kf kg">X_train, X_test, y_train, y_test = train_test_split(X,y, test_size = 0.3, random_state=42)</span><span id="ab2e" class="kb kc hi jx b fi kh ke l kf kg"># Create the regressor reg_a</span><span id="4a0a" class="kb kc hi jx b fi kh ke l kf kg">reg_a = LinearRegression()</span><span id="22ec" class="kb kc hi jx b fi kh ke l kf kg"># Fit the regressor to the training data</span><span id="0861" class="kb kc hi jx b fi kh ke l kf kg">reg_a.fit(X_train,y_train)</span><span id="e663" class="kb kc hi jx b fi kh ke l kf kg"># Predict on the test data  'y_pred'</span><span id="363e" class="kb kc hi jx b fi kh ke l kf kg">y_pred = reg_a.predict(X_test)</span><span id="06bd" class="kb kc hi jx b fi kh ke l kf kg"># Compute and print R^2 and RMSE</span><span id="b672" class="kb kc hi jx b fi kh ke l kf kg">print("R^2: {}".format(reg_a.score(X_test, y_test)))</span><span id="30f1" class="kb kc hi jx b fi kh ke l kf kg">#Prints , R^2: 0.838046873142936</span><span id="5cc2" class="kb kc hi jx b fi kh ke l kf kg"><br/>rmse = np.sqrt(mean_squared_error(y_test,y_pred))</span><span id="9b6e" class="kb kc hi jx b fi kh ke l kf kg"><br/>print("Root Mean Squared Error: {}".format(rmse))</span><span id="864a" class="kb kc hi jx b fi kh ke l kf kg"># Prints, Root Mean Squared Error: 3.2476010800377213</span></pre><p id="a972" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个代码块中，我们用整个X _train和y_train训练了我们的回归器reg_a，并在X_test和y_test上进行了测试。我们还打印了模型的R误差和准确度分数。我们使用了sklearn模块，并导入了LinearRegression、train_test_split和mean_squared_error模块来完成所有后端计算。所以这个模型可以根据新数据预测预期寿命，准确率接近84%。</p><p id="ec53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我们可以看到使用Scikit-Learn实现监督学习模型是多么容易。这就是Scikit-Learn的强大之处，它有助于轻松实现任何模型，而无需担心复杂的计算。</p></div></div>    
</body>
</html>