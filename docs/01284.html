<html>
<head>
<title>Diving into Baseball Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">钻研棒球数据</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/diving-into-baseball-data-day-2-visualizing-the-historical-performance-for-each-team-1e9636fc69ab?source=collection_archive---------11-----------------------#2019-10-12">https://medium.com/analytics-vidhya/diving-into-baseball-data-day-2-visualizing-the-historical-performance-for-each-team-1e9636fc69ab?source=collection_archive---------11-----------------------#2019-10-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="96ab" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">第2天:可视化每个团队的历史表现</h2></div><p id="e52f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们已经有了每个赛季的团队表现(检查<a class="ae jt" rel="noopener" href="/@jiashun.zheng/diving-into-baseball-data-day-1-55d34ae95ca3">第1天</a>)，我们可以在如下表格中显示单个团队的表现:</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="716f" class="kd ke hi jz b fi kf kg l kh ki"># check the last 10 year of SF Giants<br/>team_results1[team_results1['team']=='SFN'].tail(n=10)</span></pre><p id="7a47" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然而，如果我们可以一起展示所有团队，热图将是一个完美的工具。我们首先需要将数据框转换成另一种格式，列是不同的年份，行是相应年份每个团队的绩效(胜率)。我们将再次首先构建一个以团队名称为关键字的字典。所以最终的字典是这样的:</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="09dd" class="kd ke hi jz b fi kf kg l kh ki">{'SFN':{2010:92, 2011:86, ...},'LAN':{...}}</span></pre><figure class="ju jv jw jx fd kj"><div class="bz dy l di"><div class="kk kl l"/></div></figure><p id="6f3a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们检查一下刚刚制作的数据框:</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="deff" class="kd ke hi jz b fi kf kg l kh ki">team_percentage.shape() # (148, 151) 148 years, 151 teams</span></pre><p id="2e64" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">等等，得到的数据框有这么多的团队和这么多的零(意味着该团队在该年不存在)。作为一个拥有超过<a class="ae jt" href="https://en.wikipedia.org/wiki/Major_League_Baseball" rel="noopener ugc nofollow" target="_blank"> 116年历史的联盟</a>，球队来来去去或者从一个城市搬到另一个城市。但是，我们更熟悉现在的球队。让我们看看现代社会:</p><figure class="ju jv jw jx fd kj"><div class="bz dy l di"><div class="kk kl l"/></div></figure><p id="9c95" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，新的数据框架有33个团队，这与今天的团队数量非常接近。先把它画出来。我在用seaborn制作热图。</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="17e6" class="kd ke hi jz b fi kf kg l kh ki">import matplotlib as mpl<br/>import matplotlib.pyplot as plt</span><span id="13da" class="kd ke hi jz b fi km kg l kh ki">#so the font can be handle by illustrator<br/>mpl.rcParams['pdf.fonttype'] = 42<br/>plt.style.use('ggplot')</span><span id="ebcd" class="kd ke hi jz b fi km kg l kh ki">import seaborn as sns</span><span id="8009" class="kd ke hi jz b fi km kg l kh ki">values = team_percentage.values[team_percentage.values&gt;0]<br/>plt.figure(figsize=(12,8))<br/>sns.heatmap(team_percentage.transpose(), vmin=np.min(values))</span></pre><figure class="ju jv jw jx fd kj er es paragraph-image"><div class="er es kn"><img src="../Images/44869de48bdc2f4ac7f811278f1adfac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*5TXBrxJYxbwCCB9nb7qbPQ.png"/></div></figure><p id="f08c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用颜色很酷，但我们也可以添加百分比的注释。</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="999a" class="kd ke hi jz b fi kf kg l kh ki">values = team_percentage.values[team_percentage.values&gt;0]</span><span id="cdce" class="kd ke hi jz b fi km kg l kh ki">#make it bigger so we can fit the annotations<br/>plt.figure(figsize=(16,12))</span><span id="7d92" class="kd ke hi jz b fi km kg l kh ki">#add annotation, format the percentage to show 2 digits<br/>sns.heatmap(team_percentage.transpose(), vmin=np.min(values), \<br/>    annot=True, fmt=".2g")</span></pre><figure class="ju jv jw jx fd kj er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kq"><img src="../Images/447b6cea12f6559dae3556d279576110.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jE9Yy-rQBl7luqHfLzrO1w.png"/></div></div></figure><p id="bcb7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有些球队只是改变了他们的名字:例如，2005年MON改成了WAS，1997年CAL改成了ANA。我会把他们合并在一起，这样我们就有了所有的现代球队。</p><figure class="ju jv jw jx fd kj"><div class="bz dy l di"><div class="kk kl l"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">合并团队</figcaption></figure><p id="dcd1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此外，更容易显示完整的球队名称，如“旧金山巨人”，而不是缩写“SFN”。在这之后，我将根据历史成绩，按照相似性对队伍进行分组，并使用更好的配色方案。</p><figure class="ju jv jw jx fd kj"><div class="bz dy l di"><div class="kk kl l"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">将团队分组</figcaption></figure><figure class="ju jv jw jx fd kj er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kz"><img src="../Images/89cc944c59e5ee1ca4450d2f38ee565a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hTAbaLEHerBC2kz62N2f7g.png"/></div></div></figure><p id="2043" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">马上，你可能会注意到三个红色方框，只有扬基队、水手队和印第安人队的胜率都达到了69%以上。四支球队聚集在一起:勇士队、扬基队、红袜队、道奇队:这些球队多年来保持着50%以上的胜率。另一方面，皇家队、海盗队、金莺队和国民队在2000年代经历了低迷，在2010年代中期反弹。</p><p id="ea42" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">那么你能看到其他有趣的模式吗？谁和你最喜欢的球队在一起？请在回复中分享你的想法。</p></div></div>    
</body>
</html>