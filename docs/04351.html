<html>
<head>
<title>Computer Vision and some of its applications like object detection and tracking</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">计算机视觉及其一些应用，如物体检测和跟踪</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/basics-of-computer-vision-and-some-of-its-application-d84ee847d4c0?source=collection_archive---------18-----------------------#2020-03-15">https://medium.com/analytics-vidhya/basics-of-computer-vision-and-some-of-its-application-d84ee847d4c0?source=collection_archive---------18-----------------------#2020-03-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/aec5a73af509e4a82144dcf673b2b08b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XOmJtwaQpVHf5mfSDuZrrA.jpeg"/></div></div></figure><p id="5538" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">基本上是让计算机看到并理解图像和视频的内容。简单。</p><p id="54fa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">互联网上充斥着大量的图像和视频，如果我们要索引和搜索图像，计算机需要知道图像包含什么。</p><p id="033e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是计算机科学的一个领域，致力于使计算机能够像人类一样看到、识别和处理图像。这是人工智能的一个领域。</p><p id="5277" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可能想知道计算机视觉与图像处理有何不同？</p><p id="25b8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">嗯，图像处理是从现有图像创建新图像的过程，可能是通过以某种方式增强内容。它与理解图像的内容无关。</p><p id="7dcc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然而，计算机视觉背后的想法是理解图像的内容。可能需要对原始图像进行图像处理，例如裁剪、去除噪声、归一化、亮度等。</p><p id="b297" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一个物体可以从任何方向，任何光线条件下被看到。真正的计算机视觉应该能够看到任意数量的图像，并且仍然能够提取一些有意义的东西。这是计算机视觉的主要挑战。</p><p id="2f25" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当你在facebook上上传一张图片的时候，有一个叫做自动标记的功能。脸书会给你自动建议标记谁在图像中的人。这一切都归功于计算机视觉。这个想法是将人类视觉系统可以完成的任务自动化。</p><p id="14f6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">说到这里，我们先来了解一下计算机是如何读取一幅图像的。一个正常人可以很容易地分辨出下图中的汽车。但是计算机真的能看到这些吗？答案是否定的。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jo"><img src="../Images/9abea79a85f4dcdf76bde8e0b847be7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*CjG5LmZylfJP2P0I4rfpYQ.jpeg"/></div></figure><p id="4da1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">计算机将图像视为0到255之间的数字矩阵。对于彩色图像，将有三个通道:红色、绿色和蓝色，即RGB。并且将存在与每个通道相关联的矩阵。矩阵的每个元素将代表像素的亮度强度。所有这些通道相互叠加，形成3D矩阵。因此，计算机将图像解释为3D矩阵，如下图所示。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/95681e5e2ce60cc0692b2978f16262eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6_xCf_RqohDWPk1ahYG34g.png"/></div></div></figure><p id="b345" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">计算机视觉有三个主要的处理组件。</p><ol class=""><li id="6a83" class="ju jv hi is b it iu ix iy jb jw jf jx jj jy jn jz ka kb kc bi translated"><strong class="is hj">图像采集:</strong>可以使用网络摄像头、DSLR、手机摄像头</li><li id="f0c7" class="ju jv hi is b it kd ix ke jb kf jf kg jj kh jn jz ka kb kc bi translated"><strong class="is hj">图像处理:</strong>边缘检测、分割、分类等。</li><li id="e526" class="ju jv hi is b it kd ix ke jb kf jf kg jj kh jn jz ka kb kc bi translated"><strong class="is hj">图像分析:</strong>物体识别，物体跟踪等。</li></ol><p id="90dc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当我在海德拉巴的ISB学习商业分析的时候，我和我的三个朋友一起做了一个为期三个月的顶点项目，为视觉障碍者制作智能眼镜。这个项目给了我们很多机会来探索和获得计算机视觉和深度学习的经验。我将试着用简单的例子来分享一些经验。但在此之前，我想用著名的计算机视觉库OpenCV展示一些图像处理的基础知识。</p><p id="bfa7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> OpenCV: </strong>开源计算机视觉库。它支持深度学习框架pytorch、tensorflow和caffe。如果你想将面部识别应用于视频，做图像分类，物体检测等。你迟早需要学习openCV。让我们从一些非常基本的步骤开始:</p><p id="4cb1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">cv2.imread():用于读取图像。它需要两个参数:图像的路径和我们希望图像被阅读的方式。在下面的例子中,“1”意味着它将加载实际颜色的图像。你可能也注意到了为什么我在第4行把它转换成RGB。OpenCV使用BGR作为图像的默认颜色顺序，matplotlib使用RGB。当你在matplotlib中显示用OpenCV加载的图像时，通道将从后向前。解决这个问题最简单的方法是使用OpenCV将其显式转换回RGB。下面我也解释了为什么我使用matplotlib imshow()而不是opencv imshow()。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ki"><img src="../Images/d51571ce0bc0e375df629751055105d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WtxzOzMgaR8a-_NYNqi4OA.png"/></div></div></figure><p id="e0c4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">cv2。加载一幅彩色图像。主要用于没有alpha通道的8位图像。在上面的示例中，您可以将“1”作为参数传递。意思是一样的。</p><p id="727b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">cv2。im read _ gray:加载灰度图像。您可以在imread()参数中传递“0”，它的含义是相同的。</p><p id="d4ec" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">cv2。VideoCapture():用于读取视频文件。如果您指定路径，它将读取视频文件。如果指定为0，它会将网络摄像头作为输入视频。</p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="ac8a" class="ko kp hi kk b fi kq kr l ks kt">video = cv2.VideoCapture('Test.avi')</span></pre><p id="d144" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">cv2.imshow():查看图像/视频，如上例所示。请注意，cv2.imshow()在jupyter笔记本上不起作用。如果运行cv2.imshow()，笔记本将停止响应。所以，我用过matplotlib imshow()。</p><p id="30c3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">cv2.waitkey(0):它将一直等待，直到按下任何键</p><p id="690e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">cv2.windowsdestroyall():它将销毁所有临时打开的窗口</p><p id="400d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">诸如此类。继续探索功能，如调整大小，改变色彩空间，图像旋转，翻译，过滤等。如果你想知道细节。</p><p id="f671" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我将解释计算机视觉的一些应用。</p><p id="a9f5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">图像分类:</strong>给整张图像分配一个标签。它也被称为目标分类或图像识别。有大量的类别可以对图像进行分类。假设你想给所有有汽车的图片分配一个标签。哪辆车不重要。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ku"><img src="../Images/247df8bc12b5dce652ee6f1d1881c747.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o-BbfE9KzcLIXkPJtYGqfw.jpeg"/></div></div></figure><p id="be43" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">物体检测:</strong>通过包围盒定位图像中的物体，并且还识别图像中的每个物体。可用于面部检测、道路上的物体检测、车辆类型检测、任何事件中的行人计数等。在我们的项目中，我们使用对象检测算法来检测道路上的各种对象。有各种预训练模型，这些模型是在一些著名的公共图像数据集上训练的。预训练模型的问题是，它是在美国道路或任何发达国家的道路上训练的。如果我们在印度的道路上行驶，这不会给出很好的准确性，因为我们有人力车、汽车和各种其他类型的物体，它们不能被模型检测到。最好的方法是通过收集大量印度道路的视频/图像来训练模型，注释图像，然后训练模型。这是一个使用预训练的YOLOv3模型在印度道路上进行的对象检测的示例。不要担心写在边框上的数字。它用于跟踪视频中多个帧上的对象。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kv"><img src="../Images/25b20a917592c66d428dd9a0b3c047f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*keDsKKjlgnTpY1Q2NwOKDQ.jpeg"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">目标检测</figcaption></figure><p id="0136" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> Yolo </strong>(你只看一次)是最著名的物体检测算法。Yolov3是Yolo的最新版本，经过更新，该算法更加精确，尤其是在检测小物体时。为了检测图像中的所有物体，它只需要看图像一次。这就是Yolo非常快的原因。这是关于YOLO的一个非常基本的信息。如果你想深入了解物体检测算法，你可以在这方面做更多的探索。还有各种各样的其他模型。我的意图只是给你一个关于这些主题的开始，然后如果你想获得更深入的知识，你可以更进一步。</p><p id="1be1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">语义分割:</strong>基本上是给图像的每个像素分配一个标签或类别的任务。</p><p id="d3d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，你可能想知道它与图像分类有什么不同？</p><p id="a86f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">嗯，语义分割将图像的每个像素分类到一个类别或标签中。然而，图像分类将单个类别分配给整个图像。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es la"><img src="../Images/b110cd64897949c8a8d3ec10e76c80b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*RFQ6jpFDs_chtvu45IinYQ.jpeg"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">语义分割</figcaption></figure><p id="1298" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你注意到上面的例子，图像中的每个像素属于一个特定的类，即汽车，人，树，道路等。并且属于同一类的所有像素都被分配了相同的颜色。基本上，同一个类的不同实例被赋予相同的颜色，所以这里不能识别人物1和人物2。语义分割不预测对象周围的任何边界框。</p><p id="2b03" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当我们开始探索我们的项目时，我们开始了解语义分割。但是，由于我们的目的是跟踪道路上的每个物体，我们不能继续这样做，因为这种方法不能识别同一类的不同实例。因此，如果道路上有多辆汽车，那么它会将所有汽车视为一个类别。此外，它没有给出边界框和预测，这使得它与我们的用例更加不相关。然后我们想，如果我们有一些其他的方法，可以给出每个对象的掩码，也可以给出这些对象的编号。所以，我们以实例分割结束。</p><p id="5f32" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">语义分割的应用之一是自动驾驶汽车。它有助于提供道路上空闲空间的信息。也用于检测车道标志和交通信号。这是我在youtube上找到的一个关于语义分割的漂亮视频。</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="lb lc l"/></div></figure><p id="d984" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">实例分割:</strong></p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/dcaad41363285aa90d45f23d003a17b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KEw2Cqwt4NTCId9D40B78w.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">实例分割</figcaption></figure><p id="0a5b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你注意到上面的例子，同一个类的不同实例被单独分段。这可以用于对象跟踪。在我们的项目中，我们尝试了预训练的Mask -RCNN模型来跟踪道路上的物体。然而，性能并不像我们的实时视频用例那样令人印象深刻。</p><p id="465c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">目标跟踪:</strong>我们项目的主要目标之一是跟踪道路上的目标，并描述这样的场景:“道路上有3辆车，其中2辆在移动，1辆静止。”我们尝试了各种跟踪算法来跟踪物体的边界框。这里总结了我们尝试过的预训练模型和我们面临的问题。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es le"><img src="../Images/60eb79b30c308440f9dab8e4d0fe9508.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pCTikAgqFURDzXx75Vn1RQ.jpeg"/></div></div></figure><p id="bca9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您想了解更多细节，您可以在每种型号上探索更多信息，并在您的机器上试用。</p><p id="d3ba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">使用视差图计算距离:</strong>我们项目的另一个特点是将图像作为输入，计算各种物体与摄像机的距离。对于距离计算，我们需要图像及其相应的深度图。为了计算深度图，我们需要立体图像(从两个相机拍摄的同一场景的图像)。我们使用ZED相机捕捉所需的数据。我们去了德里的不同街道，从不同的角度捕捉图像，这样我们就有了各种各样的图像。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lf"><img src="../Images/071cf3b2f810b140624f587b386051ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RdePinxvRCjtBc0b7j5pCw.jpeg"/></div></div></figure><p id="7555" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我的下一篇博客中，我会尝试涵盖更多关于距离计算模型的细节。</p><p id="9e15" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我的意图是涵盖计算机视觉的基础知识，并强调它的能力。如果你真的想了解细节，我会鼓励你运行github上的一些应用程序代码，这样你就可以了解上下文了。</p><p id="3060" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你有任何问题，请随时联系我。</p></div></div>    
</body>
</html>