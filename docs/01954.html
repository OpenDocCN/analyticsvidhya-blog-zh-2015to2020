<html>
<head>
<title>Measuring entropy using AIF360 metrics on Watson machine learning model predictions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在沃森机器学习模型预测上使用AIF360度量来测量熵</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/measuring-entropy-using-aif360-metrics-on-a-watson-machine-learning-model-predictions-dddf9feefa5f?source=collection_archive---------13-----------------------#2019-11-23">https://medium.com/analytics-vidhya/measuring-entropy-using-aif360-metrics-on-a-watson-machine-learning-model-predictions-dddf9feefa5f?source=collection_archive---------13-----------------------#2019-11-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b5613152c339a6b327e22fba9f140dc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jcz7uV6GpbrJpF-7lfm29Q.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">无序或熵的增加是过去和未来的区别，给时间一个方向。斯蒂芬·霍金，《时间简史》</figcaption></figure><p id="4535" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">ML快速介绍</strong></p><p id="0d0d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">所以，让我们保持简单。</p><p id="71f9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们没有做出决定，而是建立了一个机器学习模型，并要求它代表我们做出决定。但是，我们能相信这个决定吗？为什么首先问这个问题？为什么？因为所谓的机器学习模型只不过是一段程序或代码，它是由我们(人类)通过教这个是这个，教那个是那个来训练的(给这群人贷款，不给这群人贷款，或者给这群学生发借书证，不给这群人发借书证，或者..嗯，你看，这样的例子比较多)。作为教导模型的一部分，我们(人类，犯错是人类)可能会有意或无意地犯错误，错误地教导模型，比如有偏见的教导或训练。因此，这个模型很有可能给出有偏见或错误的结果。</p><p id="6883" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在我们继续之前，通常构建机器学习模型包括以下步骤:</p><ul class=""><li id="112e" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">收集数据并建立训练数据以及地面实况手册标签</li><li id="296b" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">构建模型，包括</li><li id="db2c" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated"><em class="kg">确定用于模型的算法</em></li><li id="d2f1" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated"><em class="kg">找出模型的特征</em></li><li id="4456" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated"><em class="kg">训练模型</em></li><li id="075a" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">最后我们有训练好的分类器，不好意思是模型。</li><li id="4fc0" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">我们向这个模型发送一个有效载荷或记录来进行预测。</li></ul><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kh"><img src="../Images/3468c088fd05d18f7ae07fc4cf230403.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QSEIOIPxbvyLMStnvIw1Cg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">机器学习模型构建的生命周期</figcaption></figure><p id="6bd3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">熵是不确定性的量度</strong></p><p id="06a6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">回到做出错误预测的模型，有两个明显的问题——模型给出了“准确”的预测吗？与地面真实标签相比，预测中的“不确定性”是什么？。</p><p id="18a4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这里，为了设置这篇文章的正确的上下文，这篇文章并没有谈论太多关于模型的准确性度量，而是试图解释模型的不确定性方面的度量。</p><p id="784f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，让我们尝试在机器学习的背景下定义熵是什么。想象一下，政府为农民推出了一项新的福利计划，机器学习模型被用来将农民分类为谁将从这些计划中受益。偏差会导致一些符合条件的农民没有受益(假阳性)，或者一些不符合条件的农民受益(假阴性)。看，这就像是衡量模型的公平性。另一方面，这里的熵是对数据的无序或不确定性的度量——结果是否在所有农民中平均分配，如果不是，无序率是多少。一般熵的公式如下:</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es km"><img src="../Images/f52c822fdffe6904120fc1c6de8bb9f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*amL5YgFeUn3HAudEhGKa_Q.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">广义熵</figcaption></figure><p id="d1c3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为简单起见，让我们假设模型预测两个(N)标签类别——积极类别(将授予农民的政府福利计划)和消极类别(不给予)。因此，在上面的公式中,“I”可能是正(+)或负(-)。假设数据集中总共有100个数据点，其中30个数据点属于正类，70个数据点属于负类。这个模型根据它被训练的特征预测了30，70个结果，比如说，一个这样的特征是农民的种族。从人类直觉的角度来看，正面和负面类别之间的预测存在明显的混乱——30对70。我们想量化这个无序值。</p><p id="3104" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">因此，yi/ybar被定义为数据中“I”类的频繁出现概率。也就是说，y+应该是30/100，y-应该是70/100。并且α是调节给予分布的不同部分的值之间的距离的权重的参数。</p><p id="f412" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">所以GE(0)=-1/2 *(ln(0.7)+ln(0.3))=-0.5 *(0.36-1.2)= ~ 0.78</p><p id="ea3c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这里的熵大约是0.78。这被认为是一种高熵，一种高度无序。熵的度量值介于0和1之间。在一个理想的预测分布中，我们应该期望熵应该接近于0。</p><p id="f711" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">使用IBM AIF360测量熵</strong></p><p id="f5c7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果你注意到这里，我们用一个公式手动计算熵值。为了自动化这些计算，IBM提供了一个人工智能公平工具包(AIF 360—【https://aif360.mybluemix.net】T2)，使用它我们可以计算各种各样的公平度量。其中一个方法就是计算熵。使用AIF360还可以进行其他形式的熵计算。</p><p id="9f1d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们尝试使用AIF360 python实用程序来演示熵检测。继续以政府对农民的补助计划为例，将种族特征编码为0、1、2，人工标注数据和模型预测标注数据如下表所示。这里有利值是1，不利值是0。如果您注意到组{race:0}和{race:2}获得了所有有利的值，而组{race:1}获得了所有不利的值。因此，很明显，在各组之间的预测标签中有一个无序，这就是我们计划使用AIF360在各组[{race:0}、{race:1}、{race:2}]之间测量的。</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div class="er es ko"><img src="../Images/ce917040b84c8d947f68a746104dc643.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*mk5Uv584B190Bouuub2hCw.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">抽样资料</figcaption></figure><p id="236e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">遵循相关的代码。</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kp"><img src="../Images/608e9e1851f4c73f6fd9f83ceaaf186a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vrsW4s8FaXbSBkP0DRpsCA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">用AIF360计算广义熵</figcaption></figure><p id="cc91" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">该值几乎接近0.2，这表明组[{race:0}、{race:1}、{race:2}]之间的有利预测是无序的。</p><p id="96d5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这段代码记录在这个笔记本里:<a class="ae kn" href="https://github.com/ravichamarthy/AIF360Experiments/blob/master/Entropy%20Identifier.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/ravic amarthy/AIF 360 experiments/blob/master/Entropy % 20 identifier . ipynb</a></p></div><div class="ab cl kq kr gp ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="hb hc hd he hf"><p id="ba64" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">使用AIF360测量沃森机器学习中部署的德国信用风险模型的熵</strong></p><p id="aa97" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">kaggle的“德国信用风险”分类旨在预测客户的信用好坏。信用等级好的贷方向客户提供贷款没有风险，信用等级差的贷方向客户提供贷款有风险。</p><p id="0c61" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">训练数据集的模式如下，其中衡量公平性的属性为“性别”，标签属性为“风险”。</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div class="er es kx"><img src="../Images/e95d976c20fed57338d6543e66d919ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*k3c1zQ5y4-0pYvDHec8KIQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">德国信用风险-培训数据模式</figcaption></figure><p id="ff81" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">训练数据的数据分布如下:</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div class="er es ky"><img src="../Images/aeebb2d035590015c0448de1cf4dd933.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*BfHYcLXVy5fiFu81YONG6A.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">训练数据有利分布</figcaption></figure><p id="2dfb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">评分模型上的预测分布如下:</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div class="er es ky"><img src="../Images/27629016d75f27f9f23acb15c32c2925.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*ZW65R2Q5rV-2m6ka8SYNeQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">得分数据有利分布</figcaption></figure><p id="937d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">显然，该模型似乎在预测所有组之间的广义熵指数为0.001935845727733805的值方面做得很好。几乎接近于零。</p><p id="e78f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我使用AIF360中的以下代码片段计算组之间的熵值:</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kz"><img src="../Images/3df71fd4f21b36bb375479cda770a850.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z6sLhm391GwecFTvOH597A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">笔记本代码片段</figcaption></figure><p id="a447" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">此工作流程记录在笔记本中:<a class="ae kn" href="https://github.com/ravichamarthy/AIF360Experiments/blob/master/German%20Credit%20Risk%20AIF360.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/ravic amarthy/AIF 360 experiments/blob/master/German % 20 credit % 20 risk % 20 AIF 360 . ipynb</a></p><p id="f0d0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">结论</strong></p><p id="1e03" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">因为熵是无序或不确定性的度量，机器学习模型和数据科学家的目标通常是尽可能减少不确定性。</p><p id="8ea0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">参考文献</strong></p><p id="f17a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">熵标识符笔记本<a class="ae kn" href="https://github.com/ravichamarthy/AIF360Experiments/blob/master/Entropy%20Identifier.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/ravic amarthy/AIF 360 experiments/blob/master/Entropy % 20 Identifier . ipynb</a></p><p id="13c9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">部署WML模型和测量熵的笔记本<br/><a class="ae kn" href="https://github.com/ravichamarthy/AIF360Experiments/blob/master/German%20Credit%20Risk%20AIF360.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/ravic amarthy/AIF 360 experiments/blob/master/German % 20 credit % 20 risk % 20 AIF 360 . ipynb</a></p><p id="e407" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">IBM AIF 360<br/><a class="ae kn" href="https://aif360.mybluemix.net" rel="noopener ugc nofollow" target="_blank">https://aif360.mybluemix.net</a></p><p id="4843" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">IBM AIF 360 API<br/><a class="ae kn" href="https://aif360.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank">https://aif360.readthedocs.io/en/latest/index.html</a></p></div></div>    
</body>
</html>