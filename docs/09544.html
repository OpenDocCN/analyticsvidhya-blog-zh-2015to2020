<html>
<head>
<title>React: How to Use Context with Functional Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React:如何在功能组件中使用上下文</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/react-how-to-use-context-with-functional-components-240a8ec4126a?source=collection_archive---------0-----------------------#2020-09-10">https://medium.com/analytics-vidhya/react-how-to-use-context-with-functional-components-240a8ec4126a?source=collection_archive---------0-----------------------#2020-09-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/08a4438151516e7a31cd33547d243a6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7HEJEx_fAajNC9ua"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">乌戈·门德斯·多内利在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="01d7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当在所有需要状态的React组件之间共享状态变得太复杂时，上下文就来帮忙了。这里有一个简短的指南，介绍如何在React中将上下文与功能组件和钩子结合使用。</p><h1 id="034a" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">什么时候应该使用反应上下文</h1><p id="ea89" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">React的上下文是针对需要在多个组件之间共享状态的用例的解决方案。如果没有上下文，所有想要使用相同状态的组件都必须有一个公共的父组件，通过props传递状态。</p><p id="7dbb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果有几个组件需要使用同一个状态，并且它们都有一个可以存储它的公共父组件，这就很好了。但是一旦有太多的组件需要相同的状态和/或它们在React组件树中相距太远，通过props传递状态就变成了一场噩梦。写起来繁琐，理解起来复杂，维护起来困难。</p><p id="dd1d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您遇到这个问题，请考虑用React上下文替换您的状态。</p><p id="8a99" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦你掌握了它，建立一个上下文是非常简单的。然而，也很容易<em class="kw">忘记</em>如何做，因为你通常在你的React应用中需要很少(或者可能只有一个)上下文。我不得不重新学习如何去做，所以我想我可以通过写下这个过程来帮助自己和他人。</p><p id="17ea" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上下文以类似的方式对状态做出反应，但它不一定绑定到具体的组件。相反，所有需要访问存储在上下文中的信息的组件都可以简单地调用所需上下文的useContext钩子。</p><p id="a9f6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果上下文没有绑定到特定的组件，它通常存储在一个单独的模块(文件)中。为了便于导航，您可以将所有这样的React上下文实例分组到一个公共文件夹中，与React组件分开。</p><p id="10a6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我们将看一下如何定义上下文，然后我们将讨论在哪里放置它以及如何在组件中使用它。</p><h1 id="f0f1" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">定义上下文</h1><p id="d41f" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">与state类似，使用createContext函数创建上下文。该函数将上下文的初始值作为参数，并返回创建的上下文。</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="lb lc l"/></div></figure><p id="c50b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">注意，与state不同，context没有允许您更改上下文值的setContext函数。相反，每个上下文使用一个接收值的提供者组件。该值被设置为上下文的值，并且可以被所有子组件访问。</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="lb lc l"/></div></figure><p id="d2b6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，为了使您的组件能够使用上下文的内容，您还需要创建一个useContext挂钩。需要访问上下文值的组件可以使用这个钩子。</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="lb lc l"/></div></figure><p id="e042" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是一个简单的上下文示例，它提供了当前是否是白天的信息:</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="lb lc l"/></div></figure><p id="2b20" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上下文提供者可以有更复杂的方法来确定要传递给其子代的值。上下文提供者本身可以有一个状态，然后提供者的状态值可以通过上下文传递。</p><p id="f583" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">注意，您需要导出您创建的上下文提供者和useContext挂钩。下一节将介绍如何在React应用程序中使用它们。</p><h1 id="a9c7" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">使用上下文</h1><p id="761a" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">所有需要访问上下文的组件都应该作为上下文提供者的子组件来呈现。然后，提供者将提供其子代可以访问的值。</p><p id="7e5a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，您需要做的第一件事是识别包含所有需要使用上下文的组件的父组件，并在那里呈现提供者。</p><p id="73e2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因为上下文通常包含许多组件所需的信息，所以通常在顶级应用程序组件中呈现提供者。这里有一个例子:</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="lb lc l"/></div></figure><p id="6c2c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，可以通过useContext钩子访问上下文中的值。</p><figure class="kx ky kz la fd ij"><div class="bz dy l di"><div class="lb lc l"/></div></figure><p id="812c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">本例中的上下文只包含一个布尔值，但是上下文不限于简单的值，还可以包含复杂的对象，就像state一样。</p><p id="098a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是在React中启动和运行上下文所需的全部内容！你可以在<a class="ae iu" href="https://reactjs.org/docs/context.html" rel="noopener ugc nofollow" target="_blank">官方文档</a>中寻找关于这个主题的更多信息。</p><p id="cd18" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我希望这将帮助您开始使用React上下文。感谢您的阅读！</p><h1 id="72ce" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">小抄</h1><p id="b4a7" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">这里有一个关于如何获得有效的React上下文的简短总结。</p><p id="df56" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">设置您的上下文:</strong></p><ul class=""><li id="83d3" class="ld le hi ix b iy iz jc jd jg lf jk lg jo lh js li lj lk ll bi translated">使用React.createContext()创建上下文</li><li id="1e71" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">创建呈现上下文的上下文提供程序</li><li id="57ed" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">创建React.useContext挂钩</li></ul><p id="a307" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">用你的语境:</strong></p><ul class=""><li id="8e26" class="ld le hi ix b iy iz jc jd jg lf jk lg jo lh js li lj lk ll bi translated">在父组件(通常是顶级应用程序组件)中呈现上下文提供程序</li><li id="20ad" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">使用useContext挂钩从组件的上下文中获取值</li></ul></div></div>    
</body>
</html>