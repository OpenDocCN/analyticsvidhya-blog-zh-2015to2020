<html>
<head>
<title>Exploring Easy, Scalable, Fault-tolerant Stream Processing with Structured Streaming</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用结构化流探索简单、可扩展、容错的流处理</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/easy-scalable-fault-tolerant-stream-processing-with-structured-streaming-8f340be7ed29?source=collection_archive---------24-----------------------#2020-06-25">https://medium.com/analytics-vidhya/easy-scalable-fault-tolerant-stream-processing-with-structured-streaming-8f340be7ed29?source=collection_archive---------24-----------------------#2020-06-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/efb2faabd4c0410fd074794646e1686b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q-0ZmI_LyymdS_7v8CWhLA.png"/></div></div></figure><h2 id="5e84" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">流处理的复杂性:</h2><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jo"><img src="../Images/51453503f4ca9e1da2258726d05b52c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hPy0R69WM-L9TK175ihKjA.png"/></div></div></figure><h2 id="5fe0" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">什么是结构化流？</strong></h2><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/418fab1d63e961387b63f389504d0889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5UXF1SJeLhxPwFhtT4R7_w.png"/></div></div></figure><h2 id="8017" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">解剖流字数:</strong></h2><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ju"><img src="../Images/e6c340c1ee9c8bd45fc26875a04f1953.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H2mWo0eI_1XmSxXt3RlI3g.png"/></div></div></figure><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jv"><img src="../Images/2dd7650b814f18a2f9e16e7c24ad4552.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pjIFTLNr7PJC153ykKTiyA.png"/></div></div></figure><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jw"><img src="../Images/da8615132b7d8a2fb84d8a1865fce286.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jN4WDeHVn-uu3M1wulrQbg.png"/></div></div></figure><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jx"><img src="../Images/0c5b3990a76f01b13c76bf7935bbf5c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PkGu6W2GHaPu_f3q-rYLyg.png"/></div></div></figure><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jy"><img src="../Images/781bf3e0e40bc3cac1755cbec3352628.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yCqKSHLC_2GLtHw4FmP4kQ.png"/></div></div></figure><h2 id="327e" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">利用时间:</h2><p id="b701" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj jb kk kl km jf kn ko kp jj kq kr ks kt hb bi translated"><strong class="kb hj">活动时间- </strong></p><ul class=""><li id="a032" class="ku kv hi kb b kc kw kg kx jb ky jf kz jj la kt lb lc ld le bi translated">许多用例需要按事件时间汇总统计数据。</li></ul><p id="d4d5" class="pw-post-body-paragraph jz ka hi kb b kc kw ke kf kg kx ki kj jb lf kl km jf lg ko kp jj lh kr ks kt hb bi translated">例如，在1小时窗口内，每个系统中的错误数量是多少？</p><ul class=""><li id="4f36" class="ku kv hi kb b kc kw kg kx jb ky jf kz jj la kt lb lc ld le bi translated">从数据中提取事件时间，处理延迟的、无序的数据。</li><li id="a8a3" class="ku kv hi kb b kc li kg lj jb lk jf ll jj lm kt lb lc ld le bi translated">DStream APIs对于事件时的东西是不够的。</li></ul><p id="5dd0" class="pw-post-body-paragraph jz ka hi kb b kc kw ke kf kg kx ki kj jb lf kl km jf lg ko kp jj lh kr ks kt hb bi translated"><strong class="kb hj">事件时间聚合- </strong></p><ul class=""><li id="3732" class="ku kv hi kb b kc kw kg kx jb ky jf kz jj la kt lb lc ld le bi translated">窗口只是结构化流中另一种类型的分组。</li></ul><p id="3781" class="pw-post-body-paragraph jz ka hi kb b kc kw ke kf kg kx ki kj jb lf kl km jf lg ko kp jj lh kr ks kt hb bi translated">每小时记录数-<strong class="kb hj">parsed data . group by(window(" timestamp "，" 1小时"))。count() </strong></p><p id="ca20" class="pw-post-body-paragraph jz ka hi kb b kc kw ke kf kg kx ki kj jb lf kl km jf lg ko kp jj lh kr ks kt hb bi translated">每10分钟每个设备的平均信号强度-<strong class="kb hj">parsed data . group by(" device "，window("timestamp "，" 10 mins "))。avg("信号")</strong></p><ul class=""><li id="2f90" class="ku kv hi kb b kc kw kg kx jb ky jf kz jj la kt lb lc ld le bi translated">支持UDAFs！</li></ul><h2 id="60d9" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">聚合的有状态处理:</strong></h2><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/f1fb6b932314be3ac3ab173562fb47ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MOsSS_D98l2zx77RHMsRkQ.png"/></div></div></figure><h2 id="8de6" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">自动处理迟交数据:</strong></h2><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/c3f259c76c6f9c70d2abb394659d257a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hiF2eA5TpuKuHWClRuB-cQ.png"/></div></div></figure><h2 id="a374" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">水印:</h2><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/308f392b12d87def4be70b0d09e8de8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JixDiDkdIVwl0AsZa-Iz5A.png"/></div></div></figure><h2 id="b1cb" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">关注点的彻底分离:</h2><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/4eac67aa0ba5a9a5f08cfb2bd3db7831.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pRNlBAbb_u7YtSjgSlwywg.png"/></div></div></figure><h2 id="7695" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">其他有趣的操作:</h2><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/16b5ae3847644edf899bc65c35a32b91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O2sgWxQpws-hlk27cjTqwQ.png"/></div></div></figure><h2 id="8393" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">流式重复数据删除:</h2><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/f7ccf7d592f5f9008ceb7513cb5e3aa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B0u4rxH5az70p5PmVElAWg.png"/></div></div></figure><h2 id="9e1a" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">带水印的流式重复数据删除:</strong></h2><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/b7099ead2fe4862a7d08e6c4d074bc18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xZKrF_PtlqXkP3GUEk1Dyg.png"/></div></div></figure><h2 id="ba04" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">任意有状态操作:</strong></h2><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/fd0fd461a19ee2c8e5209b35945191dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kSKrltw020Jhef6d7EvFOA.png"/></div></div></figure><h2 id="d2eb" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak"> MapGroupsWithState:如何使用？</strong></h2><p id="e5b5" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj jb kk kl km jf kn ko kp jj kq kr ks kt hb bi translated">1.定义数据结构</p><p id="cb08" class="pw-post-body-paragraph jz ka hi kb b kc kw ke kf kg kx ki kj jb lf kl km jf lg ko kp jj lh kr ks kt hb bi translated">2.定义使用新数据更新每个分组键状态的函数</p><p id="7f92" class="pw-post-body-paragraph jz ka hi kb b kc kw ke kf kg kx ki kj jb lf kl km jf lg ko kp jj lh kr ks kt hb bi translated">3.对分组数据集使用用户定义的函数</p><p id="5ca4" class="pw-post-body-paragraph jz ka hi kb b kc kw ke kf kg kx ki kj jb lf kl km jf lg ko kp jj lh kr ks kt hb bi translated"><strong class="kb hj"><em class="lv">user actions . group by key(_。关键)。mapGroupsWithState(updateStateFunction)</em>T25】</strong></p><p id="1cbc" class="pw-post-body-paragraph jz ka hi kb b kc kw ke kf kg kx ki kj jb lf kl km jf lg ko kp jj lh kr ks kt hb bi translated"><strong class="kb hj">它适用于批处理和流式查询</strong></p><p id="e7b0" class="pw-post-body-paragraph jz ka hi kb b kc kw ke kf kg kx ki kj jb lf kl km jf lg ko kp jj lh kr ks kt hb bi translated"><em class="lv">批量查询时，每组只调用一次函数，没有先验状态</em></p><h2 id="85af" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">FlatMapGroupsWithState:</strong></h2><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/89bd7dab9afad3b7f87c7d0a7fedfbe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MLza7aGrDBfdHeWiQ2hYfg.png"/></div></div></figure><h2 id="2ffd" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">监控流查询:</strong></h2><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/0efe600266b7b7c3df2f7356fcac5644.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IIYe1e0CYXiRRskFaN7Xfg.png"/></div></div></figure><h2 id="9fff" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">故障恢复和存储系统要求:</strong></h2><p id="2e2a" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj jb kk kl km jf kn ko kp jj kq kr ks kt hb bi translated">即使机器出现故障，结构化流也能保持其结果有效。为此，它对输入源和输出接收器提出了两个要求:</p><p id="5eb8" class="pw-post-body-paragraph jz ka hi kb b kc kw ke kf kg kx ki kj jb lf kl km jf lg ko kp jj lh kr ks kt hb bi translated">输入源必须是<em class="lv">可重放的</em>，以便在作业崩溃时可以重新读取最近的数据。例如，像Amazon Kinesis和Apache Kafka这样的消息总线是可重放的，文件系统输入源也是如此。</p><p id="f0ec" class="pw-post-body-paragraph jz ka hi kb b kc kw ke kf kg kx ki kj jb lf kl km jf lg ko kp jj lh kr ks kt hb bi translated">输出接收器必须支持<em class="lv">事务更新</em>，这样系统才能让一组记录原子地出现。到目前为止，结构化流为文件接收器实现了这一点。</p><h2 id="fc4b" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">带检查点的容错:</strong></h2><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/75d9a02b8f1058d39ddb99c0ad9a2c0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0OyX_hQKSuAZfrENbgvf1A.png"/></div></div></figure><h2 id="2fcd" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">支持的源&amp;汇:</strong></h2><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/37aec5ebbd163f36ddc541a98eed8f17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PTRX2fUTVz-r5lgPhFZuJQ.png"/></div></div></figure><h2 id="6936" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">性能基准:</strong></h2><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/1084eb1fca5f8862a6ef571fdbf901f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5KW5U6NH3GTgLzDn6bO9pg.png"/></div></div></figure><h2 id="bd27" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">更多卡夫卡支持:</strong></h2><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/654db4a5ffde1bc56f117f2a7e41f960.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RT7mOJMe0x7wqSM7OSoEcQ.png"/></div></div></figure><h1 id="e10c" class="mc ir hi bd is md me mf iw mg mh mi ja mj mk ml je mm mn mo ji mp mq mr jm ms bi translated">感谢阅读💜</h1></div></div>    
</body>
</html>