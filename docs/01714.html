<html>
<head>
<title>BERT — Multi class Text Classification on your dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">BERT数据集上的多类文本分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/bert-multi-class-text-classification-e3822836ee0d?source=collection_archive---------15-----------------------#2019-11-10">https://medium.com/analytics-vidhya/bert-multi-class-text-classification-e3822836ee0d?source=collection_archive---------15-----------------------#2019-11-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ec6b902415b52ae9fbc9a8c46340d738.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ERci-1D3Q4XlJHW3OfGr8w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">印度比哈尔邦的古代那烂陀大学遗址</figcaption></figure><p id="df50" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我正在为我的一个客户进行多类文本分类，我想根据BERT序列分类来评估我当前的模型准确性。</p><p id="fbed" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这就是我的一切开始。鉴于BERT的受欢迎程度，我确信我会得到一些在线代码的帮助，以便将结果与我现有的分类模型进行比较。但是，令人惊讶的是，我找不到任何现成的东西来研究它。</p></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><p id="ebb6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">因此，我想为其他人节省时间，并决定为那些想使用BERT对数据集进行多类文本分类的人写这篇文章</p><p id="d30e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">多亏了《变形金刚》中的“拥抱脸”,现在pytorch上也有了。您可以从安装变压器pip开始。该模型将在第一次代码运行时安装。</p><p id="2373" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我已经使用了<strong class="iw hj"><em class="jz">Bert-base-uncased</em></strong>作为模型，所以在这篇文章中的进一步讨论将是关于这个预训练的模型。</p><p id="5799" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了使用预先训练的模型，你需要坚持指定的序列特征。按给定顺序阅读以下函数，以理解矢量化步骤。</p><figure class="ka kb kc kd fd ij"><div class="bz dy l di"><div class="ke kf l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">根据您的训练/有效/测试示例创建数据集</figcaption></figure><p id="aed9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在您实际进行训练练习之前，理解以下函数很重要，这是需要根据您计划使用的模型进行修改的函数。另外，使用特定的<em class="jz">记号赋予器</em>很重要，所以要小心。</p><p id="d24e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">下面的特征化代码是针对<strong class="iw hj"><em class="jz">Bert-base-un cased</em></strong>模型的。</p><figure class="ka kb kc kd fd ij"><div class="bz dy l di"><div class="ke kf l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">数据的矢量化</figcaption></figure><p id="d920" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">一旦我们有了矢量化的数据集，我们就可以进入训练步骤。所有其他步骤，如运行一段时间，保存模型以供评估，都保持不变。</p><p id="3c77" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">就我而言，我已经接受了大约10，000次训练和2，000个验证句子。我运行了10个时期来提高现有分类模型的准确性。</p><p id="6b22" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">运行自己的数据</strong></p><p id="14ec" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">通过按如下所述排列数据，您可以直接在自己的数据集上运行此代码或笔记本:</p><ul class=""><li id="3f47" class="kg kh hi iw b ix iy jb jc jf ki jj kj jn kk jr kl km kn ko bi translated">安装的附属设备，如变压器、手电筒等。(我在《回购》中已经提到了名单。)</li><li id="6f3e" class="kg kh hi iw b ix kp jb kq jf kr jj ks jn kt jr kl km kn ko bi translated">将您的数据分为三个通常的类别，“<em class="jz">训练、有效和测试</em>”，并存储为CSV文件。</li><li id="0c70" class="kg kh hi iw b ix kp jb kq jf kr jj ks jn kt jr kl km kn ko bi translated">CSV文件至少应该有两列，分别命名为“<strong class="iw hj">文本</strong>和“<strong class="iw hj">标签</strong></li><li id="266b" class="kg kh hi iw b ix kp jb kq jf kr jj ks jn kt jr kl km kn ko bi translated">你一定已经猜到“<strong class="iw hj">文本</strong>应该包含你的句子，而“<strong class="iw hj">标签</strong>应该包含它的类别/范畴</li></ul><p id="f159" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">以下是我关于BERT评估的超参数。一旦你能够使用默认值和评估运行，我建议你使用“per_gpu_train_batch_size”、“max_seq_length”和“learning_rate”来重新运行并评估结果。</p><figure class="ka kb kc kd fd ij"><div class="bz dy l di"><div class="ke kf l"/></div></figure><p id="78e8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我的作品在此提交<a class="ae ku" href="https://github.com/kumardeepak/bert-multi-class.git" rel="noopener ugc nofollow" target="_blank">，随意叉评。</a></p><p id="bd70" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">运行其他预训练模型</strong></p><p id="d520" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">你需要调整一下我的代码来运行其他可用的模型，如XLNet，GPT2或RoBERT等。如果你需要帮助，一定要联系我。然而，我敢肯定，你需要调整或固定到矢量化步骤，如上所述。</p><p id="7b27" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">请克隆<a class="ae ku" href="https://github.com/huggingface/transformers.git" rel="noopener ugc nofollow" target="_blank">变形金刚库</a>，具体为二分类还是多分类，查看“run_glue.py”代码。</p></div></div>    
</body>
</html>