<html>
<head>
<title>Simple Whatsapp Automation Using Python3 and Selenium</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python3和Selenium实现简单的Whatsapp自动化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/simple-whatsapp-automation-using-python3-and-selenium-77dad606284b?source=collection_archive---------0-----------------------#2019-04-11">https://medium.com/analytics-vidhya/simple-whatsapp-automation-using-python3-and-selenium-77dad606284b?source=collection_archive---------0-----------------------#2019-04-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5bcb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我之前的故事里(<a class="ae jd" rel="noopener" href="/@DeaVenditama/how-i-build-whatsapp-automation-tools-74f10c93e9b8">https://medium . com/@ DeaVenditama/how-I-build-whatsapp-automation-tools-74 f 10 c 93 e 9 b 8</a>)我告诉过你一般的步骤怎么做，现在我从技术上用代码解释一下怎么做。我在本教程中使用Python 3和Selenium，并且我假设读者了解Python的基础知识。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/ec2d2496f422c9348d38990e9de91151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tP3vBfFM2MGVneTd"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">照片由<a class="ae jd" href="https://unsplash.com/@drscythe?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">张秀坤镰刀</a>在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="955c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们必须安装Python 3；你可以从<a class="ae jd" href="https://www.python.org/" rel="noopener ugc nofollow" target="_blank">https://www.python.org/</a>下载并按照安装说明进行操作。安装Python3后，安装Selenium Automation Framework来自动化我们以后要做的所有事情。我推荐使用pip安装Selenium。</p><pre class="jf jg jh ji fd ju jv jw jx aw jy bi"><span id="0ae0" class="jz ka hi jv b fi kb kc l kd ke">python3 -m pip install Selenium</span></pre></div><div class="ab cl kf kg gp kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hb hc hd he hf"><h1 id="5b44" class="km ka hi bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">硒你好世界</h1><p id="6d89" class="pw-post-body-paragraph if ig hi ih b ii lj ik il im lk io ip iq ll is it iu lm iw ix iy ln ja jb jc hb bi translated">Selenium成功安装后，要测试它是否正确安装在您的机器上，运行这个Python代码并检查是否有任何错误消息。</p><pre class="jf jg jh ji fd ju jv jw jx aw jy bi"><span id="12c4" class="jz ka hi jv b fi kb kc l kd ke">from selenium import webdriver<br/>import time<br/>driver = webdriver.Chrome()<br/>driver.get("http://google.com")<br/>time.sleep(2)<br/>driver.quit()</span></pre><p id="11d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将此代码保存在一个名为automate.py或任何python文件名的文件中，然后运行它，它将显示谷歌浏览器窗口，并自动转到google.com。</p></div><div class="ab cl kf kg gp kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hb hc hd he hf"><h1 id="f07e" class="km ka hi bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">自动化Whatsapp</h1><pre class="jf jg jh ji fd ju jv jw jx aw jy bi"><span id="4889" class="jz ka hi jv b fi kb kc l kd ke">from selenium import webdriver<br/>from selenium.webdriver.support.ui import WebDriverWait<br/>from selenium.webdriver.support.ui import Select<br/>from selenium.webdriver.common.by import By<br/>from selenium.webdriver.common.keys import Keys<br/>from selenium.webdriver.chrome.options import Options<br/>import time</span><span id="167f" class="jz ka hi jv b fi lo kc l kd ke">contact = "John"<br/>text = "Hey, this message was sent using Selenium"</span><span id="40cf" class="jz ka hi jv b fi lo kc l kd ke">driver = webdriver.Chrome()<br/>driver.get("https://web.whatsapp.com")<br/>print("Scan QR Code, And then Enter")<br/>input()<br/>print("Logged In")</span><span id="38da" class="jz ka hi jv b fi lo kc l kd ke">inp_xpath_search = "//input[@title='Search or start new chat']"<br/>input_box_search = WebDriverWait(driver,50).until(lambda driver: driver.find_element_by_xpath(inp_xpath_search))<br/>input_box_search.click()<br/>time.sleep(2)<br/>input_box_search.send_keys(contact)<br/>time.sleep(2)</span><span id="b2d9" class="jz ka hi jv b fi lo kc l kd ke">selected_contact = driver.find_element_by_xpath("//span[@title='"+contact+"']")<br/>selected_contact.click()</span><span id="42b9" class="jz ka hi jv b fi lo kc l kd ke">inp_xpath = '//div[@class="_2S1VP copyable-text selectable-text"][@contenteditable="true"][@data-tab="1"]'<br/>input_box = driver.find_element_by_xpath(inp_xpath)<br/>time.sleep(2)<br/>input_box.send_keys(text + Keys.ENTER)<br/>time.sleep(2)</span><span id="bdb8" class="jz ka hi jv b fi lo kc l kd ke">driver.quit()</span></pre><p id="17aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将上面的代码复制粘贴到automation.py中，运行，就会显示一个Whatsapp的Web界面。扫描QR码，等待加载完成，然后在终端/命令提示符下按enter键继续发送消息。</p></div><div class="ab cl kf kg gp kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hb hc hd he hf"><p id="6890" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是上面对Python代码的解释，</p><pre class="jf jg jh ji fd ju jv jw jx aw jy bi"><span id="86ac" class="jz ka hi jv b fi kb kc l kd ke">contact = "John"<br/>text = "Hey, this message was sent using Selenium"</span></pre><p id="1ce8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这两行代码是存储联系人姓名和消息的Python变量。</p><pre class="jf jg jh ji fd ju jv jw jx aw jy bi"><span id="ee9b" class="jz ka hi jv b fi kb kc l kd ke">driver = webdriver.Chrome()<br/>driver.get("https://web.whatsapp.com")<br/>print("Scan QR Code, And then Enter")<br/>input()<br/>print("Logged In")</span></pre><p id="649c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它将打开一个Whatsapp Web界面，自动要求您扫描二维码，input()用于暂停该过程，直到您在终端中按下enter按钮。</p><pre class="jf jg jh ji fd ju jv jw jx aw jy bi"><span id="4d8d" class="jz ka hi jv b fi kb kc l kd ke">inp_xpath_search = "//input[@title='Search or start new chat']"<br/>input_box_search = WebDriverWait(driver,50).until(lambda driver: driver.find_element_by_xpath(inp_xpath_search))<br/>input_box_search.click()<br/>time.sleep(2)<br/>input_box_search.send_keys(contact)<br/>time.sleep(2)</span></pre><p id="7f94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">inp_xpath_search变量是一个xpath路径，用于查找搜索输入框。搜索框找到后，它会点击搜索框，输入联系人的姓名，然后自动输入。</p><pre class="jf jg jh ji fd ju jv jw jx aw jy bi"><span id="ec57" class="jz ka hi jv b fi kb kc l kd ke">selected_contact = driver.find_element_by_xpath("//span[@title='"+contact+"']")<br/>selected_contact.click()</span></pre><p id="24a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">单击在搜索结果中找到的联系人</p><pre class="jf jg jh ji fd ju jv jw jx aw jy bi"><span id="2a49" class="jz ka hi jv b fi kb kc l kd ke">inp_xpath = '//div[@class="_2S1VP copyable-text selectable-text"][@contenteditable="true"][@data-tab="1"]'<br/>input_box = driver.find_element_by_xpath(inp_xpath)<br/>time.sleep(2)<br/>input_box.send_keys(text + Keys.ENTER)<br/>time.sleep(2)</span></pre><p id="b831" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">找到消息文本框，输入消息，然后自动按enter键</p><pre class="jf jg jh ji fd ju jv jw jx aw jy bi"><span id="945c" class="jz ka hi jv b fi kb kc l kd ke">driver.quit()</span></pre><p id="434e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">driver.quit()用来杀死chromedriver的实例或者你使用的任何驱动程序，如果你不包含这行代码，这个进程将一直在你的电脑内存中运行。</p></div><div class="ab cl kf kg gp kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hb hc hd he hf"><p id="f5c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好了，本教程到此结束，在接下来的故事中，我将向你展示如何将代码包装在Python类中，这样你就可以更加动态和可重用地使用它。也许我会涵盖一些新的功能，如收集联系人或消息。谢谢你。</p></div></div>    
</body>
</html>