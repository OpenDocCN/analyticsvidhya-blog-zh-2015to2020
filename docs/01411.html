<html>
<head>
<title>Inserting Records Into a Database From Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从Python向数据库中插入记录</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/inserting-records-into-a-database-from-python-723ed7f0ae8?source=collection_archive---------9-----------------------#2019-10-20">https://medium.com/analytics-vidhya/inserting-records-into-a-database-from-python-723ed7f0ae8?source=collection_archive---------9-----------------------#2019-10-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ebd5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据分析师/科学家的基本角色之一是从原始数据中提取模式和见解。由于世界上许多政府和企业数据都是在关系数据库中组织的，因此数据分析师/科学家需要知道如何使用这些数据库结构是有意义的。除此之外，更有用的是在SQL环境中使用Pandas数据框架。</p><p id="bba0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大多数时候，数据分析师/科学家使用Python和R之类的语言，这些语言在统计分析、可视化和解释方面非常有用。因此，在本文中，我们将学习如何在SQL和Python(pandas)之间搭建桥梁。</p><p id="08dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如何在Python中建立数据库连接并将记录插入数据库</p><p id="bb21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以通过在Python和MySQL之间建立连接来向MySQL数据库发送和接收数据。这里，我们将使用pymysql进行数据库连接；尽管数据库连接还有其他方式。</p><p id="92bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是我们连接pymysql、插入数据、然后从mysql提取数据需要完成的主要步骤:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/654af27f0ba76e0d1b1db23ab1304174.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j6bmqxUUiKeQt21omKSG5w.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">数据库连接过程</figcaption></figure><p id="6fe7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">MySQL连接库:pymysql</p><p id="e292" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Oracle连接库:cx_Oracle</p><p id="2141" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样的，你也可以查查其他的数据库软件。</p><p id="0733" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果它不可用，您可以使用pip命令安装它，如下所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jt"><img src="../Images/882be025fc01f43d3e1acdcae8865e78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xEulABBvE0I4_32bK_NkDw.png"/></div></div></figure><p id="43c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤1:导入pymysql模块。</p><p id="2a1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤2:使用pymysql的connect()函数创建到MySQL数据库的连接，该函数带有参数host、user、database name和password。</p><p id="029a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤3:使用cursor()函数创建一个游标。这将允许我们在编写完SQL查询后执行它。</p><p id="28aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤4:执行所需的SQL查询，使用commit()函数提交更改，并检查插入的记录。请注意，我们可以创建一个名为sql的变量，将查询的语法赋给它，然后将sql和我们希望作为参数插入的特定数据传递给cursor.execute()。</p><p id="761e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我们将使用commit()提交这些更改。</p><p id="648e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤5:现在我们完成了，我们应该使用close()方法关闭数据库连接。</p><pre class="je jf jg jh fd ju jv jw jx aw jy bi"><span id="c68e" class="jz ka hi jv b fi kb kc l kd ke">##Step 1<br/>import pymysql<br/>## Step 2<br/>try:<br/>    # Connect to the database<br/>    connection = pymysql.connect(host='localhost',<br/>                             user='username',<br/>                             password='*****',<br/>                             db='employee')<br/>## Step3<br/>    cursor=connection.cursor()<br/>    # Create a new record<br/>    sql = "INSERT INTO `employee` (`EmployeeID`, `Ename`, `DeptID`, `Salary`, `Dname`, `Dlocation`) VALUES (%s, %s, %s, %s, %s, %s)"<br/>    cursor.execute(sql, (1009,'Morgan',1,4000,'HR','Mumbai'))<br/>    # connection is not autocommit by default. So we must commit to save our changes.<br/>    connection.commit()<br/>## Step 4<br/>    # Execute query<br/>    sql = "SELECT * FROM `employee`"<br/>    cursor.execute(sql)<br/>    # Fetch all the records<br/>    result = cursor.fetchall()<br/>    for i in result:<br/>        print(i)<br/>except Error as e:<br/>    print(e)<br/>## Step 5<br/>finally:<br/>    # close the database connection using close() method.</span><span id="4e5b" class="jz ka hi jv b fi kf kc l kd ke">connection.close()</span></pre></div></div>    
</body>
</html>