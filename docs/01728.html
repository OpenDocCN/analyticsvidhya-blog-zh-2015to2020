<html>
<head>
<title>K-Nearest Neighbors: All you need to know</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">k近邻:你需要知道的一切</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/k-nearest-neighbors-all-you-need-to-know-1333eb5f0ed0?source=collection_archive---------7-----------------------#2019-11-11">https://medium.com/analytics-vidhya/k-nearest-neighbors-all-you-need-to-know-1333eb5f0ed0?source=collection_archive---------7-----------------------#2019-11-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7455" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我从来不喜欢通过写博客而不是写论文甚至是一本书来炫耀我的知识，但今天早些时候向我的一位同事解释K-近邻(K-NN)时，我感到有些生疏。因此在这篇文章中，我将解释你需要知道的关于K-NN的一切。</p><blockquote class="jd"><p id="08eb" class="je jf hi bd jg jh ji jj jk jl jm jc dx translated">你是生活在你周围的五个人的平均值。</p></blockquote><p id="22d0" class="pw-post-body-paragraph if ig hi ih b ii jn ik il im jo io ip iq jp is it iu jq iw ix iy jr ja jb jc hb bi translated"><strong class="ih hj"> <em class="js">目录:</em> </strong></p><ol class=""><li id="eef5" class="jt ju hi ih b ii ij im in iq jv iu jw iy jx jc jy jz ka kb bi translated">介绍</li><li id="2bf9" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">它是如何工作的</li><li id="0585" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">K-NN中的这个<strong class="ih hj">‘K</strong>’是什么(在这种情况下也称为超参数调谐)</li><li id="269a" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">利用K-NN构建电影推荐系统</li><li id="7255" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">从这里去哪里</li></ol><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kh"><img src="../Images/d880d49739a5be92a67148c1ba2fd548.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HG85cPnoo214nIx2qIh_Eg.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">我的邻居做这件事，所以我也在做。</figcaption></figure><h1 id="5609" class="kx ky hi bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">{1}简介</h1><p id="fc2b" class="pw-post-body-paragraph if ig hi ih b ii lv ik il im lw io ip iq lx is it iu ly iw ix iy lz ja jb jc hb bi translated">尽管被认为是最简单的机器学习算法之一(可能是因为我们周围的例子很容易联系起来)，K-NN已经被证明在解决现实世界的问题时非常有用。</p><h2 id="eabb" class="ma ky hi bd kz mb mc md ld me mf mg lh iq mh mi ll iu mj mk lp iy ml mm lt mn bi translated">何时使用:</h2><p id="fc2c" class="pw-post-body-paragraph if ig hi ih b ii lv ik il im lw io ip iq lx is it iu ly iw ix iy lz ja jb jc hb bi translated">是一种有监督的机器学习算法(提供输出标签)<strong class="ih hj">既解决</strong> <a class="ae mo" href="https://www.cs.princeton.edu/~schapire/talks/picasso-minicourse.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">分类</strong> </a> <strong class="ih hj">又解决</strong> <a class="ae mo" href="https://www.kdnuggets.com/2017/02/regression-analysis-primer.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">回归</strong> </a> <strong class="ih hj">问题</strong>。虽然它被广泛用于分类问题，它在回归问题上也很有效，但是使用量很小。</p><h1 id="592c" class="kx ky hi bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">{2}它是如何工作的</h1><p id="4c71" class="pw-post-body-paragraph if ig hi ih b ii lv ik il im lw io ip iq lx is it iu ly iw ix iy lz ja jb jc hb bi translated">让我们通过一个简单的例子来理解K-NN，在这个例子中，我们必须根据到其最近邻居的距离来找到空圆的值(请注意，我在这里已经考虑了度为“2”的闵可夫斯基距离)。因为在红色边界中我们可以看到有一个负值最接近我们的空圆，所以我们将空圆的值指定为负值。很明显，对吧？？</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es mp"><img src="../Images/044271a2253589d4ed9a1a103ad7003f.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*nzzIRMVUkve2GAR2kBksnA.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">我最亲密的朋友</figcaption></figure><p id="abde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意:</strong> <em class="js">请注意，在执行K-NN时，您不应该考虑K的偶数值，因为以50-50分割来决定结果可能会产生歧义。</em></p><blockquote class="mq mr ms"><p id="06b4" class="if ig js ih b ii ij ik il im in io ip mt ir is it mu iv iw ix mv iz ja jb jc hb bi translated">计算距离的不同方法</p></blockquote><blockquote class="jd"><p id="8311" class="je jf hi bd jg jh mw mx my mz na jc dx translated"><a class="ae mo" href="https://en.wikipedia.org/wiki/Minkowski_distance" rel="noopener ugc nofollow" target="_blank">闵可夫斯基距离</a>(欧几里德、曼哈顿等)</p><p id="3a3c" class="je jf hi bd jg jh ji jj jk jl jm jc dx translated"><a class="ae mo" href="https://en.wikipedia.org/wiki/Chebyshev_distance" rel="noopener ugc nofollow" target="_blank">切比雪夫距离</a></p><p id="e803" class="je jf hi bd jg jh ji jj jk jl jm jc dx translated"><a class="ae mo" href="https://en.wikipedia.org/wiki/Cosine_similarity" rel="noopener ugc nofollow" target="_blank">余弦相似度</a></p><p id="5370" class="je jf hi bd jg jh ji jj jk jl jm jc dx translated"><a class="ae mo" href="https://en.wikipedia.org/wiki/Hamming_distance" rel="noopener ugc nofollow" target="_blank">海明距离</a></p></blockquote><p id="ad7c" class="pw-post-body-paragraph if ig hi ih b ii jn ik il im jo io ip iq jp is it iu jq iw ix iy jr ja jb jc hb bi translated">现在，让我们看看下面的图片，我们需要根据它的邻居找到空圆的值，但我们刚刚遇到了一个选择的困境。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es nb"><img src="../Images/5f83d589d44feb311c39a81a62af1851.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*gn48DrMdZLTulYSBAuxLCw.png"/></div></figure><blockquote class="mq mr ms"><p id="4de1" class="if ig js ih b ii ij ik il im in io ip mt ir is it mu iv iw ix mv iz ja jb jc hb bi translated">内部紫色边界表示数值为负，而外部黄色边界表示数值为正。这就是K-NN中<strong class="ih hj"> K </strong>概念的由来。</p></blockquote><h1 id="5d60" class="kx ky hi bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">{ 3 } K-NN中的这个<strong class="ak">K</strong>是什么</h1><p id="d8d1" class="pw-post-body-paragraph if ig hi ih b ii lv ik il im lw io ip iq lx is it iu ly iw ix iy lz ja jb jc hb bi translated">让我们考虑一个实时的例子，找出其中K的值。这就是我们的数据集的样子，我们要找到这个问题的K值。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es nc"><img src="../Images/8a0c3c1e752f828394c3f9122a1109e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*94LDm48zOSedDrV3L3Rffg.png"/></div></div></figure><p id="f3d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，有两种流行的方法来计算K-NN中K的值</p><blockquote class="mq mr ms"><p id="ca31" class="if ig js ih b ii ij ik il im in io ip mt ir is it mu iv iw ix mv iz ja jb jc hb bi translated">(a)肘部曲线</p><p id="de21" class="if ig js ih b ii ij ik il im in io ip mt ir is it mu iv iw ix mv iz ja jb jc hb bi translated">(b)网格搜索</p></blockquote><p id="9847" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看肘曲线，找出K的值</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es nd"><img src="../Images/69bcc4aa88562d53d2735fc2d11dd297.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*uOInJpQgxt6cnu8hjt-61w.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">肘形曲线</figcaption></figure><p id="b463" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，我们的肘曲线表示K = 8的值。</p><p id="acc5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，一旦我们知道了K的值，问题就解决了。现在，我们需要做的就是预测值，并寻找我们的精度措施。让我们来看看。(你可以在这里找到笔记本<a class="ae mo" href="https://jovian.ml/rustydigg918/24418db5df5e4224a17b7e1331d3703f" rel="noopener ugc nofollow" target="_blank"/>)</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es ne"><img src="../Images/4e5d6415c676c97309b6ff7d15911b3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*z0ksQFSsrDKyi9XsPnXfkg.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">准确度分数</figcaption></figure><h1 id="1113" class="kx ky hi bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">{4}基于K-NN的电影推荐系统</h1><p id="a9f7" class="pw-post-body-paragraph if ig hi ih b ii lv ik il im lw io ip iq lx is it iu ly iw ix iy lz ja jb jc hb bi translated">推荐系统可以大致分为三类:</p><blockquote class="jd"><p id="f408" class="je jf hi bd jg jh ji jj jk jl jm jc dx translated">&gt; &gt; &gt;<strong class="ak">基于内容的系统:</strong>它利用一个项目的一系列离散特征来推荐具有相似属性的附加项目。</p><p id="26ba" class="je jf hi bd jg jh ji jj jk jl jm jc dx translated">&gt; &gt; &gt;<strong class="ak">协同过滤系统:</strong>它根据用户过去的行为(之前购买或选择的项目和/或对这些项目给出的数字评级)以及其他用户做出的类似决定来建立模型。该模型然后被用于预测用户可能感兴趣的项目(或项目的评级)。)</p><p id="5c31" class="je jf hi bd jg jh ji jj jk jl jm jc dx translated">&gt; &gt; &gt;<strong class="ak">混合系统:</strong>它结合了前两种方法。大多数企业更喜欢在他们的产品推荐系统中使用混合方法。</p></blockquote><blockquote class="mq mr ms"><p id="6a10" class="if ig js ih b ii jn ik il im jo io ip mt jp is it mu jq iw ix mv jr ja jb jc hb bi translated">步骤1:导入必要的库</p></blockquote><blockquote class="jd"><p id="44fe" class="je jf hi bd jg jh mw mx my mz na jc dx translated"># Import必需的库<br/>Import matplotlib . py plot as PLT<br/>Import pandas as PD<br/>Import numpy as NP<br/>Import seaborn as SNS<br/>% matplotlib inline<br/>from ipython . display Import Image<br/># utils Import<br/>from fuzzywuzzy Import fuzz</p></blockquote><blockquote class="mq mr ms"><p id="ce70" class="if ig js ih b ii jn ik il im jo io ip mt jp is it mu jq iw ix mv jr ja jb jc hb bi translated">步骤2:读取数据集</p></blockquote><blockquote class="jd"><p id="0861" class="je jf hi bd jg jh mw mx my mz na jc dx translated"># read data<br/>df _ movies = PD . read _ CSV(<br/>'<a class="ae mo" href="http://khansingh.xyz/Datasets/movies.csv'" rel="noopener ugc nofollow" target="_blank">http://khansingh.xyz/Datasets/movies.csv'</a>，<br/> usecols=['movieId '，' title']，<br/> dtype={'movieId': 'int32 '，' title': 'str'})</p><p id="cce1" class="je jf hi bd jg jh ji jj jk jl jm jc dx translated">df _ ratings = PD . read _ CSV(<br/>'<a class="ae mo" href="http://khansingh.xyz/Datasets/ratings.csv'" rel="noopener ugc nofollow" target="_blank">http://khansingh.xyz/Datasets/ratings.csv'</a>，<br/> usecols=['userId '，' movieId '，' rating']，<br/> dtype={'userId': 'int32 '，' movieId': 'int32 '，' rating': 'float32'})</p></blockquote><p id="569f" class="pw-post-body-paragraph if ig hi ih b ii jn ik il im jo io ip iq jp is it iu jq iw ix iy jr ja jb jc hb bi translated">注:虽然KNN没有对基础数据分布做出任何假设，但它依赖于项目特征的相似性。当KNN对一部电影做出推断时，它会计算目标电影与其数据库中所有其他电影之间的“距离”，然后对其距离进行排序，并返回前K部最近邻电影作为最相似的电影推荐。</p><blockquote class="mq mr ms"><p id="0d4a" class="if ig js ih b ii ij ik il im in io ip mt ir is it mu iv iw ix mv iz ja jb jc hb bi translated">步骤3:数据操作</p></blockquote><blockquote class="jd"><p id="4ac4" class="je jf hi bd jg jh mw mx my mz na jc dx translated">从scipy.sparse导入csr_matrix <br/> # pivot评级到电影功能<br/>df _ movie _ features = df _ ratings . pivot(<br/>index = ' movie id '，<br/> columns='userId '，<br/> values='rating' <br/>)。菲尔纳(0)</p><p id="4d41" class="je jf hi bd jg jh ji jj jk jl jm jc dx translated">#创建从电影标题到索引的映射器<br/>movie _ to _ idx = {<br/>movie:I for I，movie in<br/>enumerate(list(df _ movies . set _ index(' movie id ')。loc[df_movie_features.index]。标题))<br/> }</p><p id="6dda" class="je jf hi bd jg jh ji jj jk jl jm jc dx translated">#将电影特征的数据帧转换为稀疏矩阵<br/>mat _ movie _ features = CSR _ matrix(df _ movie _ features . values)</p></blockquote><p id="b568" class="pw-post-body-paragraph if ig hi ih b ii jn ik il im jo io ip iq jp is it iu jq iw ix iy jr ja jb jc hb bi translated">现在，看看我们的派生数据集，由于显而易见的原因，它是稀疏的。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es nf"><img src="../Images/2f837e994d36cdfc7b73585b2604a7e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pDgoV8e-lTzaj1T4FoDpIA.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">稀疏表</figcaption></figure><p id="5228" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们增强表格的可视性</p><blockquote class="jd"><p id="362e" class="je jf hi bd jg jh ji jj jk jl jm jc dx translated">df _ movie _ features _ name = df _ complete . pivot _ table(<br/>index = ' userId '，<br/> columns='title '，<br/> values='rating' <br/>)。菲尔纳(0)</p></blockquote><blockquote class="mq mr ms"><p id="712e" class="if ig js ih b ii jn ik il im jo io ip mt jp is it mu jq iw ix mv jr ja jb jc hb bi translated">步骤4:数据可视化</p></blockquote><blockquote class="jd"><p id="c146" class="je jf hi bd jg jh mw mx my mz na jc dx translated">ax = df_movie_cnt \ <br/>。sort_values('movie_cnt '，ascending=False) \ <br/>。reset_index(drop=True) \ <br/>。plot( <br/> figsize=(12，8)，<br/> title= '所有电影的评分频率'，<br/>font size = 12<br/>)<br/>ax . set _ xlabel("电影Id") <br/> ax.set_ylabel("评分数")</p></blockquote><p id="9a2f" class="pw-post-body-paragraph if ig hi ih b ii jn ik il im jo io ip iq jp is it iu jq iw ix iy jr ja jb jc hb bi translated">现在，让我们看看这个图表</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ng"><img src="../Images/d82b10efe0a78e6b10064bbfa451cc2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*icF-9puKQHIWwI-wCz-GUg.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">了解我们的数据集</figcaption></figure><p id="ed00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们从数据中看到的，绝大多数人对评价电影不感兴趣，所以我们可以只考虑前40%的数据。</p><blockquote class="jd"><p id="4a5d" class="je jf hi bd jg jh ji jj jk jl jm jc dx translated">#过滤数据<br/>ratings _ thres = 50<br/>active _ users = list(set(df _ users _ CNT . query(' movie _ CNT&gt;=<a class="ae mo" href="http://twitter.com/ratings_thres" rel="noopener ugc nofollow" target="_blank">@ ratings _ thres</a>')。index))<br/>df _ ratings _ drop _ users = df _ ratings _ drop _ movies[df _ ratings _ drop _ movies . userid . isin(active _ users)]<br/>print('原始收视率数据形状: '，df_ratings.shape) <br/> print('去掉冷门电影和非活跃用户后的收视率数据形状: '，df_ratings_drop_users.shape)</p></blockquote><blockquote class="mq mr ms"><p id="87cc" class="if ig js ih b ii jn ik il im jo io ip mt jp is it mu jq iw ix mv jr ja jb jc hb bi translated">步骤5:现在，创建模型最关键的部分之一，选择合适的距离度量来计算K的值</p></blockquote><p id="63a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，我们需要处理一个非常高维的数据集，但高维对KNN来说并不好。<br/>此外，欧几里德距离在高维度中是无用的，因为所有向量与搜索查询向量(目标电影的特征)几乎等距。相反，我们将使用余弦相似度进行最近邻搜索。</p><p id="b1a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">余弦相似性是有利的，因为即使两个相似的向量或文档相距欧几里德距离很远(由于文档的大小)，它们仍有可能朝向更近。<br/>角度越小，余弦相似度越高。</p><p id="0419" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当绘制在多维空间上时，其中每个维度对应于特征向量中的一个特征，余弦相似性捕获特征的方向(角度)而不是幅度。如果你想知道大小，计算欧几里得距离。</p><p id="3903" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有另一种流行的方法来处理<br/>高维数据中的最近邻搜索，即位置敏感散列法。</p><blockquote class="jd"><p id="3b92" class="je jf hi bd jg jh ji jj jk jl jm jc dx translated">从sklearn.neighbors导入nearest neighbors<br/>model _ KNN = nearest neighbors(metric = ' cosine '，algorithm='brute '，n_neighbors=20，n_jobs=-1)</p></blockquote><p id="e4f6" class="pw-post-body-paragraph if ig hi ih b ii jn ik il im jo io ip iq jp is it iu jq iw ix iy jr ja jb jc hb bi translated">拟合模型:</p><blockquote class="jd"><p id="a4e3" class="je jf hi bd jg jh ji jj jk jl jm jc dx translated">模型_ KNN . fit(mat _电影_特征)</p></blockquote><p id="1e66" class="pw-post-body-paragraph if ig hi ih b ii jn ik il im jo io ip iq jp is it iu jq iw ix iy jr ja jb jc hb bi translated"><strong class="ih hj">让我们让预测变得可读</strong></p><pre class="ki kj kk kl fd nh ni nj nk aw nl bi"><span id="dcdf" class="ma ky hi ni b fi nm nn l no np">def fuzzy_matching(mapper, fav_movie, verbose=True):<br/> “””<br/> return the closest match via fuzzy ratio. If no match found, return None<br/> <br/> Parameters<br/> — — — — — <br/> mapper: dict, map movie title name to index of the movie in data</span><span id="74f1" class="ma ky hi ni b fi nq nn l no np">fav_movie: str, name of user input movie<br/> <br/> verbose: bool, print log if True</span><span id="a439" class="ma ky hi ni b fi nq nn l no np">Return<br/> — — — <br/> index of the closest match<br/> “””<br/> match_tuple = []<br/> # get match<br/> for title, idx in mapper.items():<br/> ratio = fuzz.ratio(title.lower(), fav_movie.lower())<br/> if ratio &gt;= 60:<br/> match_tuple.append((title, idx, ratio))<br/> # sort<br/> match_tuple = sorted(match_tuple, key=lambda x: x[2])[::-1]<br/> if not match_tuple:<br/> print(‘Oops! No match is found’)<br/> return<br/> if verbose:<br/> print(‘Found possible matches in our database: {0}\n’.format([x[0] for x in match_tuple]))<br/> return match_tuple[0][1]</span><span id="2685" class="ma ky hi ni b fi nq nn l no np">def make_recommendation(model_knn, data, mapper, fav_movie, n_recommendations):<br/> “””<br/> return top n similar movie recommendations based on user’s input movie</span><span id="a64e" class="ma ky hi ni b fi nq nn l no np">Parameters<br/> — — — — — <br/> model_knn: sklearn model, knn model</span><span id="4b69" class="ma ky hi ni b fi nq nn l no np">data: movie-user matrix</span><span id="cfbf" class="ma ky hi ni b fi nq nn l no np">mapper: dict, map movie title name to index of the movie in data</span><span id="0c1d" class="ma ky hi ni b fi nq nn l no np">fav_movie: str, name of user input movie</span><span id="528e" class="ma ky hi ni b fi nq nn l no np">n_recommendations: int, top n recommendations</span><span id="07bd" class="ma ky hi ni b fi nq nn l no np">Return<br/> — — — <br/> list of top n similar movie recommendations<br/> “””<br/> # fit<br/> model_knn.fit(data)<br/> # get input movie index<br/> print(‘You have input movie:’, fav_movie)<br/> idx = fuzzy_matching(mapper, fav_movie, verbose=True)<br/> # inference<br/> print(‘Recommendation system start to make inference’)<br/> print(‘……\n’)<br/> distances, indices = model_knn.kneighbors(data[idx], n_neighbors=n_recommendations+1)<br/> # get list of raw idx of recommendations<br/> raw_recommends = \<br/> sorted(list(zip(indices.squeeze().tolist(), distances.squeeze().tolist())), key=lambda x: x[1])[:0:-1]<br/> # get reverse mapper<br/> reverse_mapper = {v: k for k, v in mapper.items()}<br/> # print recommendations<br/> print(‘Recommendations for {}:’.format(fav_movie))<br/> for i, (idx, dist) in enumerate(raw_recommends):<br/> print(‘{0}: {1}, with distance of {2}’.format(i+1, reverse_mapper[idx], dist))</span></pre><blockquote class="mq mr ms"><p id="473d" class="if ig js ih b ii ij ik il im in io ip mt ir is it mu iv iw ix mv iz ja jb jc hb bi translated">第六步:我们来预测一下电影:</p></blockquote><blockquote class="jd"><p id="7be6" class="je jf hi bd jg jh mw mx my mz na jc dx translated">我最喜欢的=《低俗小说(1994)》</p><p id="952f" class="je jf hi bd jg jh ji jj jk jl jm jc dx translated">make _ recommendation(<br/>model _ KNN = model _ KNN，<br/> data=mat_movie_features，<br/> fav_movie=my_favorite，<br/> mapper=movie_to_idx，<br/> n_recommendations=10)</p></blockquote><figure class="ns nt nu nv nw km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es nr"><img src="../Images/30dcee7a42266705ad1174383134e228.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1kzZgNMJ9hsd-29bFjkrWg.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">该建议</figcaption></figure><p id="20c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然我们已经成功推荐了这部电影(此处的笔记本链接是<a class="ae mo" href="https://github.com/rustydigg918/movie_recommender/" rel="noopener ugc nofollow" target="_blank"/>，但同时我们也发现基于项目的协同过滤有两个缺点:</p><blockquote class="mq mr ms"><p id="e3c2" class="if ig js ih b ii ij ik il im in io ip mt ir is it mu iv iw ix mv iz ja jb jc hb bi translated">1.人气偏向:推荐者倾向于推荐人气商品</p><p id="2106" class="if ig js ih b ii ij ik il im in io ip mt ir is it mu iv iw ix mv iz ja jb jc hb bi translated">2.项目冷启动问题:推荐器无法推荐新的或不太知名的项目，因为项目要么没有交互，要么很少交互。想象一部没有评级或评级很低的新电影</p></blockquote><h1 id="efa2" class="kx ky hi bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">{5}下一步该怎么走</h1><p id="f632" class="pw-post-body-paragraph if ig hi ih b ii lv ik il im lw io ip iq lx is it iu ly iw ix iy lz ja jb jc hb bi translated">对现行制度的改进</p><p id="14e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个电影推荐器可以使用“矩阵分解”来进一步改进</p><p id="cae5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在现实世界中，绝大多数电影很少或者根本没有得到用户的评价。我们正在查看一个极其稀疏的矩阵<br/>，其中99%以上的条目都是缺失值。有了这样的稀疏矩阵，有哪些ML算法可以训练出来，可靠的做出推断？因此，必须解决数据稀缺问题，以建立更好的模型，矩阵分解是解决方案。</p><p id="dfc3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将在我的下一篇文章中讨论。</p><p id="2857" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参考资料:</p><blockquote class="mq mr ms"><p id="2f7d" class="if ig js ih b ii ij ik il im in io ip mt ir is it mu iv iw ix mv iz ja jb jc hb bi translated"><em class="hi">斯普林格的《统计学习导论》</em></p><p id="6a35" class="if ig js ih b ii ij ik il im in io ip mt ir is it mu iv iw ix mv iz ja jb jc hb bi translated">麻省理工学院机器学习开放课件</p><p id="fa6d" class="if ig js ih b ii ij ik il im in io ip mt ir is it mu iv iw ix mv iz ja jb jc hb bi translated">爱丁堡大学的入门应用<em class="hi">机器学习</em> (IAML)课程</p><p id="c415" class="if ig js ih b ii ij ik il im in io ip mt ir is it mu iv iw ix mv iz ja jb jc hb bi translated">分析Vidhya，Medium，KDnuggets</p></blockquote></div></div>    
</body>
</html>