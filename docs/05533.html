<html>
<head>
<title>Feedback Analysis in Python with Tweepy and TextBlob</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Tweepy和TextBlob在Python中进行反馈分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/feedback-analysis-in-python-with-tweepy-and-textblob-ff4d7f39ff99?source=collection_archive---------16-----------------------#2020-04-24">https://medium.com/analytics-vidhya/feedback-analysis-in-python-with-tweepy-and-textblob-ff4d7f39ff99?source=collection_archive---------16-----------------------#2020-04-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="3e32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">产品或服务的反馈对任何组织的发展都是至关重要的。最终用户对我们产品的评价让我们了解到在哪些地方和哪些方面需要改进。这有助于产品和服务的改进，而产品和服务是任何行业发展的支柱。</p><p id="8732" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">反馈分析是一个宽泛的术语——反馈分析采用了许多方法。一种这样的方法是情感分析。情感分析显示了一个特定的句子有什么情感。对于这种应用，它们被分为三个主要类别——阳性、阴性和中性。</p><h1 id="1ef1" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">履行</h1><p id="3ec1" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">这个项目分为4个部分——导入库，实例化一个类，最后执行分析。让我们详细探究每一部分。</p><h2 id="21e0" class="kg je hi bd jf kh ki kj jj kk kl km jn iq kn ko jr iu kp kq jv iy kr ks jz kt bi translated">第1部分—导入必要的库</h2><p id="8eb8" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">让我们开始实施我们的项目。这里的任务是从标签下的用户那里提取反馈，看看大多数用户对这个话题的看法——积极的、消极的或中立的。我们这里使用的数据库是Twitter数据库，我们使用Twitter API来访问它。</p><p id="8101" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从导入必要的库并理解每个库的作用开始。</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="dac9" class="kg je hi kz b fi ld le l lf lg">import re<br/>import tweepy<br/>from tweepy import OAuthHandler<br/>from textblob import TextBlob<br/>import datetime<br/>import matplotlib.pyplot as plt<br/>from decimal import *</span></pre><p id="f6a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">re是一个python库，用于处理正则表达式。我们在这里使用它通过删除不需要的符号来清理推文。</p><p id="ab41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> tweepy </strong>包含twitter API来验证您的twitter账户，并从特定的标签中获取推文。</p><p id="1d72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> texblob </strong>是一个自然语言处理库，它返回我们传递给它的语句的极性或情绪。</p><p id="31ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> matplotlib </strong>用于绘制和可视化最终结果。</p><p id="6c55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">十进制</strong>用于处理十进制数。在这里，它被用来设置每一类情感的百分比值的精度，使其更有意义。</p><h2 id="5dd6" class="kg je hi bd jf kh ki kj jj kk kl km jn iq kn ko jr iu kp kq jv iy kr ks jz kt bi translated">第2部分—实例化一个类</h2><p id="aba1" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">下一步是建立一个类，该类将验证twitter帐户，并提供获取、清理和分析数据的功能。</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="e0c0" class="kg je hi kz b fi ld le l lf lg">class SentimentAnalysis(object):</span><span id="9835" class="kg je hi kz b fi lh le l lf lg">p_tweets=0     #count of positive tweets<br/>  n_tweets=0     #count of negative tweets<br/>  neu_tweets=0   #count of neutral tweets<br/>  total_tweets=0 #count of total tweets</span><span id="9bb3" class="kg je hi kz b fi lh le l lf lg">#initialize the object with user credentials</span><span id="89e9" class="kg je hi kz b fi lh le l lf lg">def __init__(self):</span><span id="3541" class="kg je hi kz b fi lh le l lf lg">consumer_key = ‘your_consumer_key’<br/>    consumer_secret = ‘your_consumer_secret’<br/>    access_key = ‘your_access_key’<br/>    access_secret = ‘your_access_secret’</span><span id="835b" class="kg je hi kz b fi lh le l lf lg">try :</span><span id="aa75" class="kg je hi kz b fi lh le l lf lg">self.auth = OAuthHandler(consumer_key,consumer_secret)<br/>       self.auth.set_access_token(access_key,access_secret)<br/>       self.api = tweepy.API(self.auth)</span><span id="6e14" class="kg je hi kz b fi lh le l lf lg">except : <br/>       print(“Authentication failed\n”)</span><span id="5a4a" class="kg je hi kz b fi lh le l lf lg">#clean the tweet by removing unwanted symbols<br/>  def clean_tweet(self, tweet):<br/>    return ‘ ‘.join(re.sub(“(@[A-Za-z0–9]+)|([0-9A-Za-z \t]) |(\w+:\/\/\S+)”, “ “, tweet).split())</span><span id="8531" class="kg je hi kz b fi lh le l lf lg">#fetch the tweets and store them<br/>  def fetch_tweets(self,query):</span><span id="215a" class="kg je hi kz b fi lh le l lf lg">startdate = datetime.date(2020,3,24)<br/>    enddate = datetime.date(2020,4,24)</span><span id="22b9" class="kg je hi kz b fi lh le l lf lg">try:</span><span id="856a" class="kg je hi kz b fi lh le l lf lg">fetched_tweets = tweepy.Cursor(<br/>      self.api.search,q=query + “ -filter:retweets”,<br/>      lang=”en”,<br/>      since=startdate,<br/>      tweet_mode=’extended’,<br/>      until=enddate).items()<br/>      <br/>      for tweet in fetched_tweets :<br/>          self.total_tweets = self.total_tweets + 1<br/>          self.AnalyseTweet(tweet.full_text)</span><span id="5f87" class="kg je hi kz b fi lh le l lf lg">except tweepy.TweepError as e:<br/>       print(str(e))</span><span id="300d" class="kg je hi kz b fi lh le l lf lg">def AnalyseTweet(self,tweet):<br/>      res = TextBlob(self.clean_tweet(tweet))</span><span id="6076" class="kg je hi kz b fi lh le l lf lg">if res.sentiment.polarity &gt; 0:<br/>         self.p_tweets = self.p_tweets + 1</span><span id="ca97" class="kg je hi kz b fi lh le l lf lg">if res.sentiment.polarity == 0:<br/>         self.neu_tweets = self.neu_tweets + 1</span><span id="101d" class="kg je hi kz b fi lh le l lf lg">if res.sentiment.polarity &lt; 0:<br/>         self.n_tweets = self.n_tweets + 1</span></pre><p id="5745" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类的构造函数(__init__())执行授权过程。要成功授权一个账户，需要有4个与你的Twitter账户相匹配的凭证。这些可以通过登录你在developer.twitter.com<a class="ae li" href="http://developer.twitter.com" rel="noopener ugc nofollow" target="_blank">的账户并创建一个应用程序来获得。创建应用程序后，将向您显示凭据。回到程序，如果授权成功，您可以继续从数据库获取tweets。</a></p><p id="d623" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">fetch_tweets()方法获取用户作为参数传递的hashtag下的tweets。推文可以根据日期和数量进行过滤。</p><p id="3f61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">开始和结束日期可以在函数调用中提供，它返回该日期范围内的所有tweets。为了限制收集的tweet的数量，方法items()接受一个数值作为参数，该参数将只获取指定数量的tweet。该函数在JSON对象中返回结果。</p><p id="0074" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">遍历每个JSON对象，增加tweet的总数，并发送每条tweet以分析其情绪。full_text属性将包含获取的完整tweet，其他属性包含关于获取的tweet的元数据。</p><p id="5b27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就把我们带到了AnalyzeTweet(tweet)方法。每个tweet都作为该方法的一个参数被接收，并被发送到TextBlob以对其极性进行分类。极性是表述观点的专业术语。</p><p id="b943" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在它被发送到TextBlob API之前，使用正则表达式进行一个小的清理，以删除tweet中使用的不需要的符号。推文的文本部分最为重要。</p><p id="fa91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">极性&gt; 0表示陈述有积极的情绪</p><p id="33b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">极性&lt; 0 implies statement has a negative sentiment</p><p id="19b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Polarity == 0 implies the statement has neutral sentiment</p><p id="2fe0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">For the occurrence of each case, respective variables for positive, negative, or neutral are updated to keep track of the count of each case. These are later used in measuring the distribution of each among the results.</p><h2 id="c72b" class="kg je hi bd jf kh ki kj jj kk kl km jn iq kn ko jr iu kp kq jv iy kr ks jz kt bi translated">Part 3 — Generating results and Visualisation</h2><p id="fd66" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">Now we have the functionality required for generating results, let us make an instance of the SentimentAnalysis class and invoke each method to generate the result.</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="bed9" class="kg je hi kz b fi ld le l lf lg">getcontext().prec=3</span><span id="e64e" class="kg je hi kz b fi lh le l lf lg">sa = SentimentAnalysis()</span><span id="c9dd" class="kg je hi kz b fi lh le l lf lg">sa.fetch_tweets(“#Google”)</span><span id="f3d8" class="kg je hi kz b fi lh le l lf lg">tweets_count = [ sa.p_tweets,<br/>                 sa.n_tweets,<br/>                 sa.neu_tweets ]</span><span id="9035" class="kg je hi kz b fi lh le l lf lg">labels = [ “Positive “ + str(Decimal((sa.p_tweets /sa.total_tweets)) * 100) + “ %”,<br/>“Negative “ + str(Decimal((sa.n_tweets / sa.total_tweets)) * 100) + “ %” ,<br/>“Neutral “ + str(Decimal((sa.neu_tweets / sa.total_tweets)) * 100) + “ %” ]</span><span id="9bd4" class="kg je hi kz b fi lh le l lf lg">plt.pie( tweets_count,<br/>labels=labels,<br/>colors=[‘g’,’r’,’y’]<br/>)</span><span id="d2a0" class="kg je hi kz b fi lh le l lf lg">plt.show()</span></pre><p id="b827" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">The getcontext().prec = 3 sets the precision of percentage values of the sentiment distribution to 3 to make it look more meaningful. For a large number of fetched tweets, the percentage presence of each sentiment can be shown as a high precision floating point number ( Eg: 45.349832938 %). Reducing this to 3 digits will make it was 45.3 %.</p><p id="a575" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Rest steps involve making an instance of the SentimentAnalysis class and invoking the fetch_tweets() method by passing the required hashtag as the parameter. The distribution of each sentiment will be stored in the data members <strong class="ih hj"> <em class="lj"> p_tweets </em> </strong>(正极)<strong class="ih hj"> <em class="lj"> n_tweets </em> </strong>(负极)<strong class="ih hj"> <em class="lj"> neu_tweets </em> </strong>(中性)。</p><p id="0664" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lj"> total_tweets </em> </strong>数据成员存储获取的tweets总数。</p><p id="e4c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lj">标签</em> </strong>是一个列表，以<strong class="ih hj"> <em class="lj">情感&lt;空间&gt;百分比_分布</em> </strong>的格式存储饼状图中要显示的文本</p><p id="3a65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，绘制饼图来可视化分布并得出结论。下面是一个生成可视化的例子。</p><figure class="ku kv kw kx fd ll er es paragraph-image"><div class="er es lk"><img src="../Images/8431951629af8eafbeed5b19b5557317.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*FM3el8eNppLaKphUtr5Mmg.png"/></div><figcaption class="lo lp et er es lq lr bd b be z dx translated">生成的可视化</figcaption></figure><p id="c6a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">绿色对应积极的推文，红色对应消极的推文，黄色对应中性的推文。</p><p id="b3c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于上述情况，积极和中立似乎就在附近，需要改进产品/服务，由于负面推文数量较少，一旦主要问题得到解决，就可以对其进行调查。</p><h1 id="4738" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">缺点</h1><p id="1384" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">我们制作的系统非常简单，而且关于最终用户的反馈信息非常丰富。这个系统的后备是它没有定义问题是什么——它只描述了用户如何看待产品/服务。这仅提供了对产品/服务“状态”的基本了解。因此，系统本身并不能保证完整的分析报告。</p><p id="81cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类似地，当有大量推文时，仔细检查每个用户的反馈并确定需要改进的地方变得不切实际。这种情况需要使用语言模型来检测与特定产品/服务相关的改进领域。因此，这两个系统结合起来可以给出完整的分析报告。</p><p id="b581" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读！</p></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><p id="e49e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在GitHub上找到这个项目:<a class="ae li" href="https://github.com/vishnu-u/Feedback-Analysis-in-Python-with-Tweepy-and-TextBlob" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/Vishnu-u/Feedback-Analysis-in-Python-with-Tweepy-and-text blob</a></p><p id="e302" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在LinkedIn上找我:【https://www.linkedin.com/in/vishnuu0399/ T2】</p><p id="8139" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更多地了解我:https://bit.ly/vishnu-u</p></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><h1 id="b6be" class="jd je hi bd jf jg lz ji jj jk ma jm jn jo mb jq jr js mc ju jv jw md jy jz ka bi translated">参考</h1><p id="8943" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">【www.geeksforgeeks.com T4】</p><p id="07a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae li" href="http://www.developer.twitter.com" rel="noopener ugc nofollow" target="_blank">www.developer.twitter.com</a></p><p id="ac4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae li" href="http://www.stackoverflow.com" rel="noopener ugc nofollow" target="_blank">www.stackoverflow.com</a></p><p id="11b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae li" href="http://www.pypi.org" rel="noopener ugc nofollow" target="_blank">www.pypi.org</a></p></div></div>    
</body>
</html>