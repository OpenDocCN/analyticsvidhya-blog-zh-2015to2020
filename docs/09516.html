<html>
<head>
<title>ARIMA-GARCH forecasting with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Python 实现 ARIMA-GARCH 预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/arima-garch-forecasting-with-python-7a3f797de3ff?source=collection_archive---------2-----------------------#2020-09-09">https://medium.com/analytics-vidhya/arima-garch-forecasting-with-python-7a3f797de3ff?source=collection_archive---------2-----------------------#2020-09-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/bdd05733d2e4f4aab31dad016f779f3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GEc19phPRK6euP9NDPjDEg.jpeg"/></div></div></figure><p id="07a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ARIMA 模型是一种流行的预测方法，在金融领域有着广泛的应用。例如，使用过去回报和残差的线性组合，可以尝试预测未来的回报。可悲的是，当回报率的方差随着时间的推移而变化时，这一系列模型就遇到了问题。这种现象经常出现，也称为条件方差，或<a class="ae jo" href="https://en.wikipedia.org/wiki/Volatility_clustering" rel="noopener ugc nofollow" target="_blank">波动率聚类</a>。幸运的是，还有另一类模型能够模拟这种不规则性:(G)ARCH 模型。因此，这两种类型的模型在实践中结合起来，以优化预测性能。</p><p id="0f26" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Python 有很好的分别训练 ARIMA 和 GARCH 模型的包，但没有一个真正将两者结合起来(像 R 的漂亮包<a class="ae jo" href="https://cran.r-project.org/web/packages/rugarch/rugarch.pdf" rel="noopener ugc nofollow" target="_blank">rugarch</a>——<em class="jp">该死的 R 用户</em>)。让我们看看如何在 Python 中结合这些模型，同时避免过多的理论。有大量的其他教程来扩展我们在这篇文章中所涉及的内容，必要时我会方便地为您提供链接。我们来深究一下吧！</p><h2 id="1ae5" class="jq jr hi bd js jt ju jv jw jx jy jz ka jb kb kc kd jf ke kf kg jj kh ki kj kk bi translated">Python 中的 ARIMA 建模</h2><p id="7955" class="pw-post-body-paragraph iq ir hi is b it kl iv iw ix km iz ja jb kn jd je jf ko jh ji jj kp jl jm jn hb bi translated">Python 有两个用于建模 ARIMA 流程的流行包:<a class="ae jo" href="https://www.alkaline-ml.com/pmdarima/" rel="noopener ugc nofollow" target="_blank"> <em class="jp"> pmdarima </em> </a>和<a class="ae jo" href="https://www.statsmodels.org/stable/generated/statsmodels.tsa.arima_model.ARIMA.html" rel="noopener ugc nofollow" target="_blank"> <em class="jp"> statsmodels </em> </a>包。关于<em class="jp"> pmdarima </em>的伟大之处在于，它会为您找到最佳的 ARIMA(p，d，q)参数，而<em class="jp"> statsmodels </em>包会强制您手动找到最佳参数。这两个包都提供了大量可以修改的变量，所以它们的文档绝对值得一看。此外，有两个很棒的教程更深入地介绍了 Python 中的 ARIMA:一个<a class="ae jo" href="https://machinelearningmastery.com/arima-for-time-series-forecasting-with-python/" rel="noopener ugc nofollow" target="_blank"> statsmodels 版本</a>和一个<a class="ae jo" rel="noopener" href="/@josemarcialportilla/using-python-and-auto-arima-to-forecast-seasonal-time-series-90877adff03c"> pmdarima 版本</a>。</p><figure class="kq kr ks kt fd ij"><div class="bz dy l di"><div class="ku kv l"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">pmdarima 与 stats 模型</figcaption></figure><h2 id="c125" class="jq jr hi bd js jt ju jv jw jx jy jz ka jb kb kc kd jf ke kf kg jj kh ki kj kk bi translated">Python 中的 GARCH 建模</h2><p id="6871" class="pw-post-body-paragraph iq ir hi is b it kl iv iw ix km iz ja jb kn jd je jf ko jh ji jj kp jl jm jn hb bi translated">当谈到建模条件方差时，<a class="ae jo" href="https://arch.readthedocs.io/en/latest/univariate/introduction.html" rel="noopener ugc nofollow" target="_blank"> arch </a>是突出的 Python 包。更深入的教程可以在<a class="ae jo" href="https://machinelearningmastery.com/develop-arch-and-garch-models-for-time-series-forecasting-in-python/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。请注意，没有像 pmdarima 这样的软件包可以根据给定的标准自动找到最佳参数 p 和 q。</p><figure class="kq kr ks kt fd ij"><div class="bz dy l di"><div class="ku kv l"/></div></figure><p id="8519" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">GARCH 模型可以单独用来预测收益吗？是和不是。上面代码片段中的模型假设返回具有恒定的平均值。然而，在现实生活中，这不会完全捕捉偏度和尖峰值。这就是为什么 ARIMA 和 GARCH 模型经常被结合在一起。ARIMA 模型估计条件均值，随后 GARCH 模型估计 ARIMA 估计的残差中存在的条件方差。</p><h2 id="3080" class="jq jr hi bd js jt ju jv jw jx jy jz ka jb kb kc kd jf ke kf kg jj kh ki kj kk bi translated">结合 ARIMA 和 GARCH</h2><p id="b65c" class="pw-post-body-paragraph iq ir hi is b it kl iv iw ix km iz ja jb kn jd je jf ko jh ji jj kp jl jm jn hb bi translated">那么我们如何结合 ARIMA 和 GARCH 模型呢？让我们简单看看 ARMA-GARCH 模型背后的数学原理:</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es la"><img src="../Images/2b4726c8a83b373e0208d96f57d943ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*azEK9WckHXBx73L8bTPu6Q.png"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">ARMA-GARCH 模型</figcaption></figure><p id="4956" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个公式非常简单。通过组合 ARIMA 模型(红色)和 GARCH 模型(绿色)的输出给出最终预测。</p><p id="e3ea" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们看看这在 Python 中是如何工作的！请注意，这次我们将 GARCH 模型拟合在 ARIMA 模型的残差上，而不是收益率上。</p><figure class="kq kr ks kt fd ij"><div class="bz dy l di"><div class="ku kv l"/></div></figure><p id="c325" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就是全部了！然而，我们在这里的工作方式有一个警告(摘自<a class="ae jo" href="https://stats.stackexchange.com/questions/77925/procedure-for-fitting-an-arma-garch-model" rel="noopener ugc nofollow" target="_blank"> stackoverflow 帖子</a>):</p><blockquote class="lb lc ld"><p id="993e" class="iq ir jp is b it iu iv iw ix iy iz ja le jc jd je lf jg jh ji lg jk jl jm jn hb bi translated">您可以选择先拟合 ARMA 模型，然后在 ARMA 残差上拟合 GARCH 模型，但这不是首选方法。你的 ARMA 估计通常是不一致的。(在只有 AR 项而没有 MA 项的特殊情况下，估计将是一致的，但效率低。)这也会污染 GARCH 估计。因此，最好的方法是同时估计 ARMA 和 GARCH 模型。统计软件能够做到这一点(例如参见 R 的 rugarch 软件包)。</p></blockquote><p id="44bc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">克服这个问题的一个方法是训练许多不同的 ARIMA(p1，d，q1)-GARCH(p2，q2)模型，并基于诸如<a class="ae jo" href="https://en.wikipedia.org/wiki/Akaike_information_criterion" rel="noopener ugc nofollow" target="_blank"> <em class="jp"> aic </em> </a>或<a class="ae jo" href="https://en.wikipedia.org/wiki/Bayesian_information_criterion" rel="noopener ugc nofollow" target="_blank"> <em class="jp"> bic </em> </a>的标准选择最佳工作的模型。</p><h1 id="ff45" class="lh jr hi bd js li lj lk jw ll lm ln ka lo lp lq kd lr ls lt kg lu lv lw kj lx bi translated">后续步骤</h1><p id="45ba" class="pw-post-body-paragraph iq ir hi is b it kl iv iw ix km iz ja jb kn jd je jf ko jh ji jj kp jl jm jn hb bi translated">有大量潜在的下一步要探索。例如，我们使用 ARIMA 来模拟收益序列的均值。但是<a class="ae jo" href="https://arch.readthedocs.io/en/latest/univariate/mean.html" rel="noopener ugc nofollow" target="_blank">其他均值模型</a>存在。这同样适用于方差建模，因为有大量的其他方差模型可供选择！最后，我们在这篇文章中只考虑了单变量的情况。这里有一篇<a class="ae jo" href="https://freakonometrics.hypotheses.org/tag/arma-garch" rel="noopener ugc nofollow" target="_blank">的精彩帖子</a>如何将 ARIMA-GARCH 应用于一个多元案例(R)。</p></div></div>    
</body>
</html>