<html>
<head>
<title>User Retention in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的用户保持</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/user-retention-in-python-8c33fa5766b6?source=collection_archive---------2-----------------------#2019-11-06">https://medium.com/analytics-vidhya/user-retention-in-python-8c33fa5766b6?source=collection_archive---------2-----------------------#2019-11-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7fc0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我将向您展示如何通过导入一个非常小的易于运行的保留模块来对您的数据集运行用户保留分析。这篇文章是为那些希望以最少的努力快速进行保留分析的分析师(和学生一样)准备的——这样可以让你花更多的时间分析，花更少的时间编码。</p><p id="fcb1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">那么什么是用户留存？</strong></p><p id="2d77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从本质上来说，用户留存允许你进行群组分析(这只是意味着在某个时间段内对用户进行分组)，并查看有多少用户在加入后参与了某项活动。</p><p id="693f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">也许上面的解释让你感到困惑，但是不用担心，这个概念很容易理解。假设您从如下所示的数据集开始:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/9a239c02a3b6d97fe4f0554e2435bf62.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*d8nZGPGQ5XXYnfP5iil3tg.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">数据应该采用的格式示例</figcaption></figure><p id="8874" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上图是您理想使用的原始数据格式，其中:</p><ul class=""><li id="aa70" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated"><strong class="ih hj"> user_id </strong>:您希望将其包含在保留计算中的每个用户的唯一标识符。</li><li id="c41d" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj"> created_at </strong>:用户的注册日期。你如何考虑什么是“注册”完全取决于你的具体用例。但一个简单的例子可以有一个网站，用户必须创建一个帐户(因此注册)</li><li id="c05f" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><strong class="ih hj"> end_time </strong>:用户执行动作的最后日期。示例:用户上次登录您的服务的时间。同样，这个指标完全取决于您的用例。</li></ul><p id="2954" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注:</strong>给定用户的<em class="kd"> end_time </em>必须始终大于或等于<em class="kd"> created_at </em>值。当你思考这个问题时，直觉上这是有道理的。例如:在用户注册并被引入您的环境之前，无法跟踪任何用户活动。</p><p id="f6ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们使用CalculateRetention包来执行此分析:</p><p id="8d8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第一步:安装软件包</strong></p><pre class="je jf jg jh fd ke kf kg kh aw ki bi"><span id="1f8e" class="kj kk hi kf b fi kl km l kn ko">pip install calculate-retention</span></pre><p id="8981" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第二步:导入需要的包</strong></p><pre class="je jf jg jh fd ke kf kg kh aw ki bi"><span id="4082" class="kj kk hi kf b fi kl km l kn ko">from calculate_retention import CalculateRetention</span></pre><p id="42c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">和其他包裹一起</p><pre class="je jf jg jh fd ke kf kg kh aw ki bi"><span id="178e" class="kj kk hi kf b fi kl km l kn ko">import pandas as pd<br/>import numpy as np<br/>import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>from datetime import date, timedelta<br/>import datetime as dt<br/>import warnings</span></pre><p id="8d7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第三步:导入你的文件作为熊猫数据框架</strong></p><p id="87bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的关键点是，你只需要输入一个熊猫数据框。因此，您可以在任何Python工作流中实现这种保留分析。</p><p id="a049" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我只需将一个CSV文件读入一个熊猫数据帧，该数据帧包含上图所示的数据(为了完整起见，我将在这里再次展示)</p><pre class="je jf jg jh fd ke kf kg kh aw ki bi"><span id="12fa" class="kj kk hi kf b fi kl km l kn ko"># Reading in the file <br/>my_file = pd.read_csv('retention_test.csv')<br/>my_file.head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kp"><img src="../Images/8f5dc88637206cd8bb8c1a4b433cc707.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*LqilnYAVlb98d1dqOlGRMA.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">我的文件的前5行</figcaption></figure><p id="dc2c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第四步:创建留存分析对象</strong></p><pre class="je jf jg jh fd ke kf kg kh aw ki bi"><span id="3643" class="kj kk hi kf b fi kl km l kn ko"># Use 'weekly' for weekly retention and 'monthly' for monthly retention<br/>retention_data = CalculateRetention(my_file, 'monthly')</span></pre><p id="4214" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤7:地块保持</strong></p><p id="de47" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kd">绘图原始数据:</em></p><pre class="je jf jg jh fd ke kf kg kh aw ki bi"><span id="e70f" class="kj kk hi kf b fi kl km l kn ko">retention_data.plot_retention('raw')</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kq"><img src="../Images/c4ca1cc0ed59b09ad7b16faafa9227e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PjN9si0XwVVfm79_gggM1A.png"/></div></div></figure><p id="c9cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如何阅读:很简单，这张图显示了0月实际注册的用户数量，以及这些用户中有多少人在接下来的几周内进行了某项活动(如登录、做某事等)</p><p id="3ffd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，让我们看看五月。本质上，我们说5个用户在5月注册(或进入你的系统)，所有5个用户在6月都进行了一些活动。然而，我们在6月失去了2个用户，因此在7月、8月、9月、10月只剩下3个用户登录或执行一些活动。在10月，所有3个用户都是最后一次登录，因此剩下的几个月是空白的。</p><p id="57af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kd">剧情百分比:</em></p><pre class="je jf jg jh fd ke kf kg kh aw ki bi"><span id="b6a6" class="kj kk hi kf b fi kl km l kn ko">retention_data.plot_retention('percentage')</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kq"><img src="../Images/955d4f4fd8e8ba1bbea69d94ae0cbf3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CpB58NSrZYX9z0s3rhrLkQ.png"/></div></div></figure><p id="a9e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如何阅读:例如，让我们看看五月。本质上，我们说100%的用户在5月注册(或进入你的系统)，100%的用户在6月进行了一些活动。然而，只有0.66%的用户在7月、8月、9月、10月进行一些活动，100%的用户中有66%在10月最后一次登录(或进行一些活动)，因此剩下的月份为空白。</p><p id="6180" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第五步&amp;第六步呢？</strong></p><p id="44cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在你可能已经注意到我错过了第5步和第6步。这是因为不需要它们来执行如上所述的快速保留分析。</p><p id="dfd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第五步:获取底层数据</strong></p><p id="c8fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的目标是让你，分析师，轻松地将这些结果纳入你的分析</p><p id="aa00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kd">原始数据</em></p><pre class="je jf jg jh fd ke kf kg kh aw ki bi"><span id="d1c6" class="kj kk hi kf b fi kl km l kn ko">z = retention_data.get_raw_retention()<br/>z.fillna('')  # Just to make it look neater</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kv"><img src="../Images/6b5c203739513a0a67d01e5dd993825d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P_PRu3kfTtY0AyHiN7_Iig.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">一个熊猫的数据框架，上面也画了同样的数据</figcaption></figure><p id="e879" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kd">百分比</em></p><pre class="je jf jg jh fd ke kf kg kh aw ki bi"><span id="1897" class="kj kk hi kf b fi kl km l kn ko">p = retention_data.compile_percentages()<br/>p.fillna('')  # Just to make it look neater</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kw"><img src="../Images/8c5681b99a3add42189a936553b740cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VDFkVQQZ3Bk0Lps1rsmaow.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">一个熊猫的数据框架，上面也画了同样的数据</figcaption></figure><p id="b3ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一般说明:该分析基于模拟数据。当使用生产级别的数据时，您的结果将更有意义。我使用了一个小的数据集，以避免让任何人感到困惑，尤其是那些刚刚开始编程和分析之旅的人。</p><p id="e7e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">祝你好运，我希望这有所帮助。如果有东西坏了，请在评论中告诉我，我会在几个小时内帮你修好:)</p></div></div>    
</body>
</html>