<html>
<head>
<title>Using Pytorch and Cuda for Large Computation in Google Colabs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Pytorch和Cuda在Google Colabs中进行大规模计算</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/using-pytorch-and-cuda-for-large-computation-in-google-colabs-f1c026c17673?source=collection_archive---------8-----------------------#2020-02-24">https://medium.com/analytics-vidhya/using-pytorch-and-cuda-for-large-computation-in-google-colabs-f1c026c17673?source=collection_archive---------8-----------------------#2020-02-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/5716014e3cb7d3d4ec87f1a903249baa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zFqJ86kmrnbexp5u"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">马库斯·斯皮斯克在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="216a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">大多数数据科学家/人工智能爱好者都知道Pytorch是一个深度学习框架，用于建立、训练和推理深度神经网络，但很少有人利用Pytorch来加快计算速度。</p><p id="feaf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">在这篇文章中，我想比较一下CPU上的NumPy、torch和GPU上的torch的速度。</strong></p><p id="2e1a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我会参考这篇<a class="ae iu" rel="noopener" href="/deep-learning-turkey/google-colab-free-gpu-tutorial-e113627b9f5d">文章</a>来了解如何在Google Colab中设置GPU</p><p id="5d80" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最简单和最常见的方法是模拟矩阵乘法。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="54b2" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">矩阵乘法</h1><p id="4d55" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">让我们重温一下矩阵乘法</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/fc40ff299653a1cf47fb40011bbd04bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*HCKLKLOm5clIeG-d0cRLhA.gif"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:<a class="ae iu" href="https://mscroggs.co.uk/blog/73" rel="noopener ugc nofollow" target="_blank">https://mscroggs.co.uk/blog/73</a></figcaption></figure><p id="eda3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它由乘法和加法组成，这种“幼稚”的方式具有三次方的复杂性。例如，4×4矩阵乘法的复杂度是O(4)，而10×10矩阵乘法的复杂度是O(10)。</p><p id="90dc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">随着时间的推移，这种计算的效率越来越高。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es li"><img src="../Images/7680c79e15bc71fa0cb2fceb6d2af18c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sBw34u18ITIC5Aqv95IokA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:<a class="ae iu" href="https://en.wikipedia.org/wiki/Matrix_multiplication_algorithm#Sub-cubic_algorithms" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/Matrix _乘法_算法#次立方_算法</a></figcaption></figure></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="a1d8" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">结果在谷歌Colab</h1><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lj"><img src="../Images/8e858fd1ff8a3b3de7bc03bd8e3b518f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jl1ERxTOX29DKy9PJPsLCQ.png"/></div></div></figure><p id="4794" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">试试你自己的谷歌实验室<a class="ae iu" href="https://colab.research.google.com/drive/1nw34aks9SdMwHXl9Gf5T9GPxRB9BIIyr" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="d0b8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们比较大小为10，000×10，000的矩阵乘法。</p><p id="9b30" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用NumPy (CPU)和torch (CPU)进行速度对比，torch的表现比NumPy好两倍多(<strong class="ix hj"> 26.5s vs 57.2s </strong>)。</p><p id="664e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当我们将矩阵放入GPU时，计算速度变为10.6s。</p><p id="7350" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">但是有一点要注意，GPU需要预热。</strong></p><p id="bbc8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后重新运行计算，我们会在1s内得到结果！！！</p><blockquote class="lk"><p id="3568" class="ll lm hi bd ln lo lp lq lr ls lt js dx translated">在这个小例子中，我们使用torch GPU使<strong class="ak">比</strong>快60倍。</p></blockquote><p id="7501" class="pw-post-body-paragraph iv iw hi ix b iy lu ja jb jc lv je jf jg lw ji jj jk lx jm jn jo ly jq jr js hb bi translated">在这个google colab文件<a class="ae iu" href="https://colab.research.google.com/drive/1nw34aks9SdMwHXl9Gf5T9GPxRB9BIIyr" rel="noopener ugc nofollow" target="_blank">这里</a>中，我们实验乘法到40，000x40，000只需要15.9秒，但是当我们尝试50，000x50，000乘法时，它会因为内存不足而出错。</p><p id="d5e3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">希望这篇文章能有所帮助。</p><h1 id="ad24" class="ka kb hi bd kc kd lz kf kg kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx bi translated">干杯！！！</h1></div></div>    
</body>
</html>