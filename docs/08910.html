<html>
<head>
<title>Blazeface: Face detection on mobile GPU</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Blazeface:移动GPU上的人脸检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/blazeface-face-detection-dd1783e2f2d8?source=collection_archive---------9-----------------------#2020-08-18">https://medium.com/analytics-vidhya/blazeface-face-detection-dd1783e2f2d8?source=collection_archive---------9-----------------------#2020-08-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0497" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在计算机视觉中，人脸检测是许多应用中的第一步。有许多技术可用于面部检测，这里有一个不错的<a class="ae jd" href="https://towardsdatascience.com/face-detection-for-beginners-e58e8f21aad9" rel="noopener" target="_blank">博客</a>供更多阅读。</p><p id="0ab3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用面部检测作为构建模块的一些实际应用如下</p><ul class=""><li id="1060" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">手机中的面部锁定</li><li id="3d17" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">识别社交媒体上的人</li><li id="69ae" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">唇读</li><li id="a442" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">情感检测</li><li id="84ab" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">人脸识别</li><li id="3966" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">面部增大</li></ul><p id="90c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">存在一些面部检测技术。根据你的需求选择合适的，看看这个<a class="ae jd" rel="noopener" href="/@Intellica.AI/a-guide-for-building-your-own-face-detection-recognition-system-910560fe3eb7">博客</a>了解更多信息。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es js"><img src="../Images/b57c8e2bddea2c0231f94b6034e9e0e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZLYUrNgoPyvhU1aORGPxzg.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">人脸检测技术</figcaption></figure><p id="ba96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为人脸检测广泛用于移动电话应用中。那么，哪一个是适合移动设备的正确选择呢？谷歌最近的一篇研究论文介绍了一种重量轻、性能好的人脸检测器，它可以与移动GPU很好地配合，提供实时性能。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es ki"><img src="../Images/0e8ccc077b24665ea8bed1b49040164d.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*PaM_aVmzVNB_IVfcKsqVmg.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">火焰脸</figcaption></figure><p id="fb6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该文件详细介绍了该模型的主要组成部分。我们可以使用文中提供的体系结构重新创建模型。在论文中描述了两种主要的结构单元，称为单结构单元和双结构单元。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kj"><img src="../Images/f7e30107949f883c706d120b911021af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*SNhogwDamDUEXqXV0I1G-g.png"/></div></figure><p id="106e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这些块中，使用了深度方向的卷积层，这提高了模型的速度。5x5内核用于DW conv，1x1内核用于conv图层。该模型使用5个单火焰块和6个双火焰块。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kk"><img src="../Images/6f15bc88fc37426ca1dc5f96c9f2fca3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*Y3iOn1CZtn1KU4almFcwOA.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">模型架构</figcaption></figure><p id="fe06" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于锚计算，具有16×16内核大小和8×8内核大小的两个Conv层分别与2个和8个滤波器一起使用。模型的输出需要后处理，因为重叠的锚的数量随着对象的大小而显著增加。该预测首先被裁剪以适合图像尺寸的边界，然后应用NMS得到最终的盒子。当输入图像被调整到128x128时，这些框可以被调整到图像的原始大小。最终的边界框可以使用cv2.rectangle在图像上随机生成。</p><p id="838a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最终检测到的人脸可以进一步用作特定任务的另一个模型的输入。</p><p id="8124" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">blazeface的tflite模型可以在<a class="ae jd" href="https://github.com/google/mediapipe/blob/master/mediapipe/models/face_detection_front.tflite" rel="noopener ugc nofollow" target="_blank">这里</a>找到。我们可以提取层细节和模型架构如下。</p><pre class="jt ju jv jw fd kl km kn ko aw kp bi"><span id="5c05" class="kq kr hi km b fi ks kt l ku kv">tflite_path = 'face_detection_front.tflite'<br/>interpreter = tf.lite.Interpreter(model_path=tflite_path)</span><span id="34f9" class="kq kr hi km b fi kw kt l ku kv">interpreter.allocate_tensors()</span><span id="c050" class="kq kr hi km b fi kw kt l ku kv">for i in interpreter.get_tensor_details():<br/>    print("name|shape ",i["name"],"|",i["shape"])</span></pre><p id="a6c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们需要内核的权重和偏差。我们可以通过将权重分配给模型的层来恢复模型的权重。</p><pre class="jt ju jv jw fd kl km kn ko aw kp bi"><span id="f94d" class="kq kr hi km b fi ks kt l ku kv">for var in model.variables:<br/>    weight = tflite_map[var.name]<br/>    var.assign(weight)</span></pre><p id="337f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">预测人脸包围盒，并使用cv2渲染。</p><pre class="jt ju jv jw fd kl km kn ko aw kp bi"><span id="f89d" class="kq kr hi km b fi ks kt l ku kv">for bx in final_boxes:<br/>    cv2.rectangle(orig_image, (bx[0], bx[1]), (bx[2], bx[3]), (0, 255, 0), 10)</span><span id="4d84" class="kq kr hi km b fi kw kt l ku kv">plt.figure(figsize=(15,15))<br/>plt.imshow(orig_frame)<br/>plt.show()</span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kx"><img src="../Images/8d3d47b550f575474591eb727900cea8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*1rJYvPgApZ_8rcaVmUdg7w.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">编辑表情图像</figcaption></figure><p id="4ecc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">保存模型，以便它可以用于进一步的任务，如面部识别，面部增强等。《BlazeFace:移动GPU上的亚毫秒级神经人脸检测》一文<a class="ae jd" href="https://arxiv.org/pdf/1907.05047.pdf" rel="noopener ugc nofollow" target="_blank">此处</a>可用。</p></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><p id="1e10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读…..</p></div></div>    
</body>
</html>