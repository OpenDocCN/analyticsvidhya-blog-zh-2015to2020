<html>
<head>
<title>All you need to know about Apache Kudu</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于阿帕奇·库杜你需要知道的</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/all-you-need-to-know-about-apache-kudu-c27ec2acbf09?source=collection_archive---------10-----------------------#2020-03-02">https://medium.com/analytics-vidhya/all-you-need-to-know-about-apache-kudu-c27ec2acbf09?source=collection_archive---------10-----------------------#2020-03-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="bc89" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">在本文中，我将描述和简化您应该知道的关于Apache Kudu的一切，因为您已经知道了基本的术语，并且您已经使用过分布式系统。通过这种方式，我将简化我从与kudu一起工作、阅读和研究不同来源的经验中学到的东西。</p></blockquote><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es jh"><img src="../Images/87b724c8b0c3e8cafff53e5281d53c18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*idOr0GiV9kmnHapdmoTbDQ.jpeg"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">标志；徽标</figcaption></figure><h1 id="15cc" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">cloud era为什么要打造阿帕奇Kudu？</strong></h1><p id="196b" class="pw-post-body-paragraph ii ij hi il b im kv io ip iq kw is it kx ky iw ix kz la ja jb lb lc je jf jg hb bi translated">Kudu集群存储的表看起来就像您习惯使用的关系数据库(SQL)中的表。</p><h1 id="865b" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">我认为库都被创造出来的原因:</strong></h1><p id="7751" class="pw-post-body-paragraph ii ij hi il b im kv io ip iq kw is it kx ky iw ix kz la ja jb lb lc je jf jg hb bi translated">1.为了填补HDFS和HBASE在流处理方面的空白，越来越多的公司需要控制流处理(我认为批处理已经过时)。与HBASE不同，Kudu可以更高效地实时扫描大量数据</p><p id="90cf" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kx iv iw ix kz iz ja jb lb jd je jf jg hb bi translated">2.与HBASE相比，Kudu允许对特定记录进行操作，并且扫描功能更快</p><p id="1479" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kx iv iw ix kz iz ja jb lb jd je jf jg hb bi translated">3.大量数据仍然难以控制，并且容量继续增长。对于某些设备来说，Hadoop和其他平台可能很复杂。</p><p id="c5a5" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kx iv iw ix kz iz ja jb lb jd je jf jg hb bi translated">4.开发团队在不断变化，许多用例需要关注实时生成的数据，以便进行实时分析。</p><h1 id="f539" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">库都建筑精要</strong></h1><ul class=""><li id="e246" class="ld le hi il b im kv iq kw kx lf kz lg lb lh jg li lj lk ll bi translated">阿帕奇库杜正在成长，我认为它还没有达到一个成熟的阶段来开发它所拥有的潜力</li><li id="20ec" class="ld le hi il b im lm iq ln kx lo kz lp lb lq jg li lj lk ll bi translated">Kudu与Impala和Spark融为一体，非常棒。</li><li id="ab5d" class="ld le hi il b im lm iq ln kx lo kz lp lb lq jg li lj lk ll bi translated">在Kudu中创建表与我们在关系数据库中创建的表非常相似，也就是说，您必须在表中定义一个或多个主键(PK ),并且主键一旦创建就不能更改。</li><li id="6ef5" class="ld le hi il b im lm iq ln kx lo kz lp lb lq jg li lj lk ll bi translated">与其他数据库不同，Apache Kudu有自己的文件系统来存储数据。也就是说，由于Kudu将其存储在自己的文件系统中，因此在HDFS将无法查询该表的信息。这些信息只能通过SQL查询来访问。另一方面，如果表结构存储在HDFS路径中，这主要发生在我们创建外部表时，在完全删除表的情况下，我们可以转到“创建表”中定义的HDFS路径并检索创建结构</li></ul><h1 id="e018" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">分区</strong></h1><p id="a6da" class="pw-post-body-paragraph ii ij hi il b im kv io ip iq kw is it kx ky iw ix kz la ja jb lb lc je jf jg hb bi translated">至于分区，Kudu在这一点上有点复杂，可能会成为一个真正令人头痛的问题。选择分区类型总是取决于我们的主板的开发需求。定义正确的分区将在未来为我们解决许多问题，主要是当数据量增长和读写查询的延迟受到影响时。</p><h1 id="dadb" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">那么我该如何选择分区呢？</strong></h1><p id="eeca" class="pw-post-body-paragraph ii ij hi il b im kv io ip iq kw is it kx ky iw ix kz la ja jb lb lc je jf jg hb bi translated">Kudu有两种分区类型；这些分区是范围分区和散列分区。</p><p id="0e8a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kx iv iw ix kz iz ja jb lb jd je jf jg hb bi translated"><strong class="il hj">按范围分区:</strong></p><p id="893f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kx iv iw ix kz iz ja jb lb jd je jf jg hb bi translated">它将允许很好地访问您在表的范围内指定的基于时间的查询。要按范围进行分区，我们必须在表中定义范围内包含的时间段或间隔。如果我们在表中不存在的区域中插入记录，会发生什么情况？这些记录将不会被插入。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es lr"><img src="../Images/2561648e3bc6caf80c86c7c5931eff71.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*NEvnzDMSEiyVSD4q86nxHw.png"/></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">按范围划分。来源:https://kudu.apache.org/docs/kudu_impala_integration.html</figcaption></figure><p id="03df" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kx iv iw ix kz iz ja jb lb jd je jf jg hb bi translated">值得注意的是，按范围划分提供了脚本的良好分布。对于给定的范围，所有插入的数据将到达所有服务器，每个服务器包含返回相同数量指标的传感器子集。如果一个范围内的传感器比另一个范围内的多，这将导致分区不平衡并影响性能。在散列分区的情况下，这个问题不会发生</p><p id="1ed6" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kx iv iw ix kz iz ja jb lb jd je jf jg hb bi translated"><strong class="il hj">哈希分区:</strong></p><p id="2584" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kx iv iw ix kz iz ja jb lb jd je jf jg hb bi translated">散列分区是在表中定义的PK类型字段上完成的。Kudu通过对指定列的值应用散列函数，将每个记录分成固定数量的容器，因此分区中不会出现不平衡。</p><p id="22f9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kx iv iw ix kz iz ja jb lb jd je jf jg hb bi translated">对于需要维护两种分区类型(散列和范围)的表，我推荐这种做法。这两者的结合允许良好的写入解释(因为哈希脚本扩展到多个</p><p id="90dc" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kx iv iw ix kz iz ja jb lb jd je jf jg hb bi translated">分区)和良好的读取解释(大型扫描可以跨多个服务器并行执行)</p><p id="0fa1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kx iv iw ix kz iz ja jb lb jd je jf jg hb bi translated">当分区级别为8个容器时，表的性能可能会很好，但是当分区级别为15个容器时，同一个表的性能可能会更差，而当分区级别为24个时，同一个表的读写时间可能会更短。执行分区调优是令人困惑的，正如我之前所说的，它总是取决于每种情况。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es lt"><img src="../Images/74b95d51bb84017f4a22a4fefec03684.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*kTqmpWsTtVoSY5hvRv4TGg.png"/></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">哈希分区。来源:https://kudu.apache.org/docs/kudu_impala_integration.html<a class="ae ls" href="https://kudu.apache.org/docs/kudu_impala_integration.html" rel="noopener ugc nofollow" target="_blank"/></figcaption></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es lu"><img src="../Images/1b9fa4212fdbd53d58eb0d243b39cd2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*jHxu-lQu76VvFftr9d0S7w.png"/></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">通过范围和散列进行分区。来源:<a class="ae ls" href="https://kudu.apache.org/docs/kudu_impala_integration.html" rel="noopener ugc nofollow" target="_blank">https://kudu.apache.org/docs/kudu_impala_integration.html</a></figcaption></figure><h1 id="28cb" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">可以动态分区吗？</strong></h1><p id="6b30" class="pw-post-body-paragraph ii ij hi il b im kv io ip iq kw is it kx ky iw ix kz la ja jb lb lc je jf jg hb bi translated">Kudu中不存在动态分区，在我看来这是一个主要的限制，因为在生产环境中，容量总是会增加，表的数据存储被限制在10GB。因此，在数据增长的情况下，需要迁移这些表中的数据，这可能需要时间(有不同的迁移备选方案)。</p></div><div class="ab cl lv lw gp lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="hb hc hd he hf"><h1 id="c2f6" class="jx jy hi bd jz ka mc kc kd ke md kg kh ki me kk kl km mf ko kp kq mg ks kt ku bi translated"><strong class="ak">最后，我留给大家一系列与Kudu合作时必须考虑的事项:</strong></h1><ul class=""><li id="3cfe" class="ld le hi il b im kv iq kw kx lf kz lg lb lh jg li lj lk ll bi translated">Kudu中不允许使用Char、Varchar、Date和Array类型。</li><li id="6f90" class="ld le hi il b im lm iq ln kx lo kz lp lb lq jg li lj lk ll bi translated">Kudu表不能超过300列。</li><li id="1bc7" class="ld le hi il b im lm iq ln kx lo kz lp lb lq jg li lj lk ll bi translated">列名不得超过256个字符，并且必须是有效的UTF-8字符串。</li><li id="bbe4" class="ld le hi il b im lm iq ln kx lo kz lp lb lq jg li lj lk ll bi translated">一列最多只能存储54Kb</li><li id="8866" class="ld le hi il b im lm iq ln kx lo kz lp lb lq jg li lj lk ll bi translated">在向集群添加新节点的情况下，Kudu不会重新分配平板服务器以确保平衡，在这种情况下，您必须手动移动已经创建的平板服务器，或者您必须删除并重新创建表</li><li id="ba16" class="ld le hi il b im lm iq ln kx lo kz lp lb lq jg li lj lk ll bi translated">不支持Sqoop</li><li id="da3c" class="ld le hi il b im lm iq ln kx lo kz lp lb lq jg li lj lk ll bi translated">Kudu管理员可以为数据迁移启用配置单元支持</li><li id="aeb6" class="ld le hi il b im lm iq ln kx lo kz lp lb lq jg li lj lk ll bi translated">查询必须通过Impala引擎进行，因此，有绝对的依赖性</li></ul></div><div class="ab cl lv lw gp lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="hb hc hd he hf"><p id="68c7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kx iv iw ix kz iz ja jb lb jd je jf jg hb bi translated">我希望你喜欢这篇文章，并且它是有帮助的。</p><p id="c982" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it kx iv iw ix kz iz ja jb lb jd je jf jg hb bi translated"><em class="ik">请留下你的意见</em></p></div></div>    
</body>
</html>