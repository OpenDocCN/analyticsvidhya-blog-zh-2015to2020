<html>
<head>
<title>Google CoLab Tutorial — How to setup a Pytorch Environment on CoLab</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Google CoLab教程——如何在CoLab上设置Pytorch环境</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/google-colab-tutorial-how-to-setup-a-deep-learning-environment-on-colab-bc5ab7569f02?source=collection_archive---------4-----------------------#2020-06-24">https://medium.com/analytics-vidhya/google-colab-tutorial-how-to-setup-a-deep-learning-environment-on-colab-bc5ab7569f02?source=collection_archive---------4-----------------------#2020-06-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/31b24a9ac05e1f5080aad2c409e92a55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*N0Hg0Ziglu5Bd2aUd7xE5g.jpeg"/></div></figure><p id="f6c9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果你是Python用户，你一定很熟悉Jupyter Notebook。好消息是谷歌有一个名为CoLab的云服务。这就像在Google Drive上运行Jupyter笔记本一样。无需申请额外账户，也无需申请服务。你所需要的只是一个Google Drive账户，仅此而已。简单易行！最好的事情是，它给用户免费TPU访问运行你的任务！因此，如果您的本地机器没有足够的GPU能力，例如，我的T470P笔记本电脑只有2G VRAM(显卡内存)，无法运行需要大约4G内存的培训任务，那么Google CoLab可以是一个解决方案。</p><p id="529f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这篇博客中，我将介绍:</p><ul class=""><li id="df97" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated">如何在Google Drive中创建CoLab</li><li id="a36c" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">如何在CoLab中安装库</li><li id="9504" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">如何在CoLab中导入模块</li></ul></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><h1 id="d007" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated"><strong class="ak"> 1。创建一个Colab文档</strong></h1><p id="27a3" class="pw-post-body-paragraph im in hi io b ip ld ir is it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj hb bi translated">如下图所示，使用创建Google doc的正常方式添加一个<strong class="io hj"> coLab </strong>文档。如果你是第一次使用它，你必须在<code class="du li lj lk ll b">Connect more apps</code>部分添加服务，并在弹出的应用搜索框中搜索<code class="du li lj lk ll b">Colaboratory</code>。</p><figure class="ln lo lp lq fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/c14e65f914da286531db2d42e6c1e366.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZC_Zpy0oT4LFSQYvrAZAhg.png"/></div></figure></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><h1 id="b1b7" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">2.编辑和运行Colab文档</h1><figure class="ln lo lp lq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es lr"><img src="../Images/850c546e66fde880a61b3e921bcb9b36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LxKczmluAvfy6P5Phm5liw.png"/></div></div></figure><p id="a1bf" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这是它在Colab文档中的样子。它与JupyterNoteBook几乎相同。它有<code class="du li lj lk ll b">CODE</code>和<code class="du li lj lk ll b">TEXT</code>来允许你添加一个新的单元格来写你的代码或文本，当你点击<code class="du li lj lk ll b">SHIFT+ENTER</code>时，它会执行这个单元格。<code class="du li lj lk ll b">TEXT</code>单元格也支持Markdown语法。</p></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><h1 id="47b0" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated"><strong class="ak"> 3。如何在Colab中安装Python库</strong></h1><p id="3e04" class="pw-post-body-paragraph im in hi io b ip ld ir is it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj hb bi translated">Colab有命令行支持，所以只需在单元格中添加<code class="du li lj lk ll b">!</code>感叹号即可运行Linux命令。您可以简单地运行<code class="du li lj lk ll b">!pip install &lt;package-name&gt;</code>来执行pip安装。所以当你去<a class="ae lw" href="https://pytorch.org/?utm_source=Google&amp;utm_medium=PaidSearch&amp;utm_campaign=%2A%2ALP+-+TM+-+General+-+HV+-+CAN&amp;utm_adgroup=Install+PyTorch+Using+Pip&amp;utm_keyword=install%20pytorch%20using%20pip&amp;utm_offering=AI&amp;utm_Product=PyTorch&amp;gclid=CjwKCAjw88v3BRBFEiwApwLevbJQfq_-AGl1f6xEoO0Z4N31uLJSV69Zocsi41E2tEVu4o-lty5xJxoCDGMQAvD_BwE" rel="noopener ugc nofollow" target="_blank"> Pytorch官方安装网站</a>，选择你想要下载的Pytorch版本的规格，确保你选择了Linux，pip，Python，然后是你想要安装的CUDA版本，你会看到一个Pip命令行显示在底部:</p><figure class="ln lo lp lq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es lx"><img src="../Images/dabc6973df9822b7755482b041367d1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J2O64HW20pw7yNr3hHL00Q.jpeg"/></div></div></figure><p id="c5b6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后将该命令复制粘贴到带有前缀<code class="du li lj lk ll b">!<br/></code>CoLab单元格中。因此，只需在CoLab单元格中运行<code class="du li lj lk ll b">!pip install torch trochvision</code>:</p><figure class="ln lo lp lq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es ly"><img src="../Images/a0c87fb9e5dcd39076aab4938fdcd152.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CzPMR_6Oeg9B-OMRF9uqIA.png"/></div></div></figure><p id="27c5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后在它运行之后，这个包就成功安装了。</p><figure class="ln lo lp lq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es lz"><img src="../Images/3ba6d8b197ef0250ed09be403fffe8f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CxOFZ-5d2irOE9M5BiPBxA.png"/></div></div></figure><p id="c9c5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">注意:</strong>CoLab似乎已经为您预装了Pytorch，所以如果您运行这个命令，它会告诉您“需求已经满足”。但是，您可以使用相同的方法通过pip install安装任何其他python包。</p></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><h1 id="b6a7" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated"><strong class="ak"> 4。在Colab中导入Python模块</strong></h1><p id="2450" class="pw-post-body-paragraph im in hi io b ip ld ir is it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj hb bi translated"><strong class="io hj">安装Google Drive </strong></p><p id="2f5c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了让CoLab识别您的Google drive主目录，第一步是通过运行以下命令将您的Google Drive挂载到Colab:</p><pre class="ln lo lp lq fd ma ll mb mc aw md bi"><span id="5768" class="me kg hi ll b fi mf mg l mh mi">from google.colab import drive<br/>drive.mount('/content/drive/')<!-- --> </span></pre><p id="b73c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在您执行上述代码后，它将显示一个URL链接，其中包含授权代码，供您授予许可。点击网址，将验证码复制粘贴到这里的输入框。</p><figure class="ln lo lp lq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mj"><img src="../Images/9c3e84b013df05ea74035d799a919b93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*43UQlZYe_Yf3t9Y50LleWg.png"/></div></div></figure><figure class="ln lo lp lq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es lz"><img src="../Images/3ba6d8b197ef0250ed09be403fffe8f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CxOFZ-5d2irOE9M5BiPBxA.png"/></div></div></figure><p id="1057" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在完成了！您的Google Drive安装在此路径<code class="du li lj lk ll b">/content/drive/My Drive/</code>。尝试列出目录下的所有文件。</p><pre class="ln lo lp lq fd ma ll mb mc aw md bi"><span id="824e" class="me kg hi ll b fi mf mg l mh mi">!ls "/content/drive/My Drive/"</span></pre></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><h1 id="b9a7" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated"><strong class="ak"> 5。从我的驱动器导入模块</strong></h1><p id="41b4" class="pw-post-body-paragraph im in hi io b ip ld ir is it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj hb bi translated">现在平台可以将<code class="du li lj lk ll b">"/content/drive/My Drive/"</code>识别为根路径。可以看到并导入这个主目录下的任何Python模块。例如，如果我的Google Drive目录下有一个Python文件<code class="du li lj lk ll b">model.py</code>，那么我可以简单地在我的Colab中执行<code class="du li lj lk ll b">import model</code>。</p><figure class="ln lo lp lq fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/16e46e7142b6d7b196e6e624e8cbcf77.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*JvnhutPm6GVH_O15LZbBFA.png"/></div></figure></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><h1 id="7440" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated"><strong class="ak"> 6。将Google Drive中的子文件夹添加到系统路径</strong></h1><p id="75bf" class="pw-post-body-paragraph im in hi io b ip ld ir is it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj hb bi translated">然而，有时我们想要分离我们的项目，并为不同的项目使用不同的dir。然后我们可以将我们的项目目录添加到<code class="du li lj lk ll b">sys.path</code>中，这使得Python可以看到项目目录下的所有内容。例如，如果我的项目文件夹在<code class="du li lj lk ll b">code</code>文件夹下，然后在<code class="du li lj lk ll b">image-segmentation-keras</code>文件夹下。绝对路径是<code class="du li lj lk ll b">/content/drive/My Drive/code/image-segmentation-keras</code>。</p><p id="fc3f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后，我们可以简单地将“code”文件夹路径添加到系统路径中:</p><pre class="ln lo lp lq fd ma ll mb mc aw md bi"><span id="cb62" class="me kg hi ll b fi mf mg l mh mi">import sys<br/><br/># Add your absolute path of your project folder to system path.<br/>sys.path.append("/content/drive/My Drive/code/image-segmentation-keras")<br/><br/># See the full list of paths in sys.path<br/>print(sys.path)</span></pre><p id="82cc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">将项目文件夹添加到sys.path后，现在我可以导入该文件夹中的任何Python模块。例如，我可以在我的Colab中导入“keras_segmentation”模块:</p><figure class="ln lo lp lq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es ml"><img src="../Images/eee8c6661baa4bd6b215b6ef1384a1e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ladZa2LwGYUYGaPDJD0lCQ.png"/></div></div></figure><pre class="ln lo lp lq fd ma ll mb mc aw md bi"><span id="702c" class="me kg hi ll b fi mf mg l mh mi">import keras_segmentation</span></pre></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><h1 id="8b79" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">7。在Colab中设置TPU/GPU访问</h1><p id="082e" class="pw-post-body-paragraph im in hi io b ip ld ir is it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj hb bi translated">最后一件事是<code class="du li lj lk ll b">Don't forget to setup free TPU</code>对于你的CoLab页面，如果你要用它来运行一个GPU强化训练任务，比如深度学习任务。您可以在<code class="du li lj lk ll b">Edit &gt; Notebook settings</code>中设置TPU。从下拉菜单<code class="du li lj lk ll b">Hardware accelerator</code>中选择<code class="du li lj lk ll b">GPU</code>或<code class="du li lj lk ll b">TPU</code>即可！</p><figure class="ln lo lp lq fd ij er es paragraph-image"><div class="er es mm"><img src="../Images/a783ec2e858d1ee101ec09b4c1ae7f4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*VFiUyMfJvAvFGgV3_jsdMA.png"/></div></figure><figure class="ln lo lp lq fd ij er es paragraph-image"><div class="er es mn"><img src="../Images/a75bd53da211957e07965c00876aebac.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*igTB22Aq--Hm_GLuebLjUg.png"/></div></figure></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><p id="60dd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">最后，</strong>虽然上述步骤是你在Google Colab中开始使用Pytorch所需要的全部，但是如果你碰巧是VSCode用户，并且想通过VSCode接口访问Google Colab，那么我发现这篇<a class="ae lw" href="https://towardsdatascience.com/colab-free-gpu-ssh-visual-studio-code-server-36fe1d3c5243" rel="noopener" target="_blank">文章</a>非常有趣，可以看看。</p></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><p id="f90d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">就是这样！希望你喜欢这篇关于如何在CoLab上建立深度学习环境的教程！如果你觉得这个帖子有用，请给这个帖子留个“拍手”吧！也欢迎你留下你的想法、评论或反馈！感谢您的阅读！</p></div></div>    
</body>
</html>