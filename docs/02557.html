<html>
<head>
<title>Build Raspberry Pi Hadoop/Spark Cluster from scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从头开始构建Raspberry Pi Hadoop/Spark集群</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/build-raspberry-pi-hadoop-spark-cluster-from-scratch-c2fa056138e0?source=collection_archive---------1-----------------------#2019-12-23">https://medium.com/analytics-vidhya/build-raspberry-pi-hadoop-spark-cluster-from-scratch-c2fa056138e0?source=collection_archive---------1-----------------------#2019-12-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="297c" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">介绍</h1><p id="2358" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">为了更好地理解云计算是如何工作的，我和我的同学林振决定深入挖掘数据工程师的世界。我们的目标是从头开始构建Spark Hadoop Raspberry Pi Hadoop集群。我们将向您介绍我们采取的步骤，并解决您在整个过程中可能遇到的错误。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kc"><img src="../Images/ee20992deb8215db6954ed3a4a715e66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ygZ_MENoXmY0MDNwrbKyOg.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated"><em class="ks">上图是我们购买的部件:树莓派4 *3，SD卡*3，网线*3，Charing线*3，Switch *1 </em></figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kt"><img src="../Images/08205cedac9ef9ab0b688239caf29cf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MMpyU8-SSypDmEV0PiQ3hA.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated"><em class="ks">上图显示了组装好的树莓果串的外观。</em></figcaption></figure><h1 id="8457" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak"> <em class="ks">第一阶段:树莓Pi设置</em> </strong></h1><p id="2e70" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj"> <em class="ku">在树莓Pi上安装操作系统</em> </strong></p><p id="974e" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">我们选择使用基于Debian的操作系统Raspbian。Raspbian NOOB是我们发现的让操作系统在Raspberry Pi上完美运行的最简单的方法。我们将microSD卡格式化为FAT，并提取NOOBS*。zip存档。然后，我们把文件复制到我们的microSD卡上。最后，我们将microSD卡插入Pi，成功地安装了操作系统。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es la"><img src="../Images/8fcf8bbc08f4e313e2e762f98a880cbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1CtKwz8sMU2SC6xcaaFung.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">上图显示Raspbian操作系统正在运行。</figcaption></figure><p id="9f11" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated"><strong class="jf hj"> <em class="ku">配置静态IP地址</em> </strong></p><p id="69e0" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">我们为网络交换机上的每个Pi设置静态IP地址，以便于Pi的简单联网。我们将它们分别命名为raspberrypi1、raspberrypi2、raspberrypi3。然后，我们编辑每个Pi上的文件<code class="du lb lc ld le b"><strong class="jf hj"><em class="ku">/etc/dhcpcd.conf</em> </strong></code>并取消注释。编辑此行:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/1289b1633fa177901318bcd3a028238c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*63wrMPJDth_YYGQzC6EAdg.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated"><em class="ks">其中X应替换为1代表Pi1，2代表Pi2，依此类推。</em></figcaption></figure><p id="4130" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">注意，您为Pis设置的静态ip地址应该与您路由器的ip地址一致。例如，我们路由器的ip地址从192.168.1.10X/24开始，因此我们为每个Pi分配如下所示的ip地址。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/ebfadbfaea0450ec04051a3b863a8a0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cDdWnMn82K8bEZga0GVeXA.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated"><em class="ks">上图显示了我们为raspberry pi1设置的ip地址。(相应地，我们对pi 2使用192.168.1.102/24，对pi 3使用192 . 168 . 1 . 103/24)</em></figcaption></figure><p id="fa72" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated"><strong class="jf hj"> <em class="ku">启用SSH </em> </strong></p><p id="de37" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">然后，我们按照这个<a class="ae kb" href="https://www.raspberrypi.org/documentation/remote-access/ssh/" rel="noopener ugc nofollow" target="_blank"> <em class="ku">链接</em> </a>的指示启用SSH。</p><p id="5da0" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated"><strong class="jf hj"> <em class="ku">设置主机名</em> </strong></p><p id="5271" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">首先，所有的pi都被称为raspberrypi，并且只有一个用户。如果我们经常在网络上不同的pi之间来回移动，这可能会变得非常混乱。为了解决这个问题，我们将根据每个Pi在机箱/网络交换机中的位置为其分配一个主机名。Pi #1将被称为raspberrypi1，Pi #2将被称为raspberrypi2，依此类推。</p><p id="fd9d" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">必须编辑两个文件，包括<strong class="jf hj"> <em class="ku"> /etc/hosts </em> </strong>和<strong class="jf hj"> <em class="ku"> /etc/hostname </em> </strong>。在这些文件中，raspberry pi应该只出现一次，这是默认的主机名。我们将其中的每一个都改为<strong class="jf hj"> <em class="ku"> raspberrypiX </em> </strong>，其中<strong class="jf hj"> <em class="ku"> X </em> </strong>是适当的数字1–3。最后，仅在<strong class="jf hj"> <em class="ku"> /etc/hosts </em> </strong>中，我们还在文件末尾添加了所有其他pi的IP，如下图所示。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/6149309cb84e5760f7d965d0279c78e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b0AH_-4SCxYFU41tR0e4ZA.png"/></div></div></figure><p id="b330" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">从现在开始，我们看到的终端看起来像下图所示:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/39a7412d514270678deacc11250c3a6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PsWDDSEbUWp1aU0bUv2ueA.png"/></div></div></figure><p id="651b" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated"><strong class="jf hj"> <em class="ku">简化宋承宪</em> </strong></p><p id="f862" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">要从一个pi连接到另一个pi，键入如下图所示的一系列命令可能会非常麻烦。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/7668db36e311f29915e475d1b9650d68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TTwmJYoyrTFFCwUGr5QZGA.png"/></div></div></figure><p id="d42a" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">我们可以通过设置带有公钥/私钥对的<strong class="jf hj"> <em class="ku"> ssh别名</em> </strong>和<strong class="jf hj"> <em class="ku">无密码ssh </em> </strong>连接来简化这个过程。</p><p id="d318" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated"><strong class="jf hj"> <em class="ku">宋承宪别名</em> </strong></p><p id="1fab" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">编辑<strong class="jf hj">~/<em class="ku">。ssh/config </em> </strong>文件并添加以下几行:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/854c10912330d0ae9c5c68508d092f13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EarloMSfwRUYkw2OdIMPEA.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">将X替换为每个Pis的编号。这是在单个Pi上完成的，因此一个Pi应该包含<strong class="bd ih"> <em class="ks"> ~/中的所有代码块。ssh/config </em></strong></figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/72c649c94b37b4a34ee5814c7f1d41c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NVwyqHIVr2G8iF5GJvhd7Q.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">(在我们的例子中，因为我们选择的主机名和我们构建的集群有三个raspberrypi，所以看起来像上面这样)</figcaption></figure><p id="01f0" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">在这之后，我们的ssh命令序列变成如上图所示:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/4912ad5b3985d1c8e031d58fba1777a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*omKLo9x6edTMtCAc0GD9Ow.png"/></div></div></figure><p id="f171" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">但是此时我们仍然需要输入密码。我们可以通过建立公钥/私钥对来进一步简化这一点。</p><p id="f47d" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated"><strong class="jf hj"> <em class="ku">公钥/私钥对</em> </strong></p><p id="f933" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">首先，在每个Pi上，运行以下命令:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/5e5c9473c59783fe0c08dce62277b9dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XoWT2waRg-5M5giBlbRVcw.png"/></div></div></figure><p id="426f" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">这将在目录<strong class="jf hj"> <em class="ku"> ~/中生成一个公钥/私钥对。ssh/ </em> </strong>，可以用来安全ssh，不需要输入密码。其中一个文件将被称为<strong class="jf hj"> <em class="ku"> id_ed25519 </em> </strong>，这就是私钥。另外，<strong class="jf hj"><em class="ku">id _ ed 25519 . pub</em></strong>是公钥。不需要密码来保护对密钥对的访问。公钥用于与其他pi通信，私钥永远不会离开其主机，也永远不会被移动或复制到任何其他设备。</p><p id="bfc0" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">那么每个公钥都需要连接到<strong class="jf hj"> <em class="ku"> ~/。每隔一个Pi上的ssh/authorized_keys文件</em> </strong>。让我们假设Pi #1将包含“主”记录，然后将它复制到另一个Pi。</p><p id="7af9" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">首先，在Pi #2(和#3，等等。)，运行上面显示的以下命令:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/5a2d967a9f1e88c2bd46fa6a8701efda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sDBjiOYdMi2TUEbv0jvK7g.png"/></div></div></figure><p id="c8d4" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">这将Pi #2的公钥文件与Pi #1的授权密钥列表连接起来，给予Pi #2在没有密码的情况下ssh到Pi #1的权限(公钥和私钥用于验证连接)。我们需要对每台机器都这样做，将每个公钥文件连接到Pi #1的授权密钥列表。</p><p id="5d4b" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">我们也应该为Pi #1这样做，这样当我们将完成的<strong class="jf hj"> <em class="ku"> authorized_keys文件</em> </strong>复制到其他Pi时，它们都有ssh到Pi #1的权限。在Pi #1上运行以下命令:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/193263d535e62d4fb441780ec7f59d32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FY7GwON74VPH9hyCJWnLPg.png"/></div></div></figure><p id="1099" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">一旦完成了这一步，以及前面的部分，ssh-ing就变得简单了:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/4912ad5b3985d1c8e031d58fba1777a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*omKLo9x6edTMtCAc0GD9Ow.png"/></div></div></figure><p id="563c" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated"><strong class="jf hj"> <em class="ku">复制配置</em> </strong></p><p id="1e58" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">最后，要在所有Pi之间复制无密码ssh，只需使用scp将上面提到的两个文件从Pi #1复制到另一个Pi:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/bfb81eae6887cddef310403dd791cd9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kh4Nk_GGXc846sisLNLZLQ.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">其中<strong class="bd ih"> <em class="ks"> piX </em> </strong>应该是你选择的主机名。(在我们的例子中，它是raspberrypi1、raspberrypi2、raspberrypi3)您现在应该能够从任何其他pi通过ssh访问集群上的任何pi，只需使用<strong class="bd ih"> <em class="ks"> ssh piX </em> </strong>。</figcaption></figure><p id="51cf" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated"><strong class="jf hj"> <em class="ku">为了使用方便</em> </strong></p><p id="cb63" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">编辑<strong class="jf hj"> <em class="ku"> ~/。bashrc </em>文件下面的</strong>和<strong class="jf hj"> </strong>添加几行(注意，每当你编辑<strong class="jf hj"> <em class="ku"> ~/。bashrc </em> </strong>，要使这些更改生效，您必须<strong class="jf hj"> <em class="ku">源</em> </strong>文件或注销并重新登录。)然后，就可以调用新的函数了。下面是我们强烈推荐使用的功能。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/20c7def28b4db6b70ed7f372e99625ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*guvg7NHBPf4KKkFabceFaw.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated"><strong class="bd ih"> <em class="ks"> 1。</em> <em class="ks">获取除此之外的每个Pi的主机名</em> </strong></figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/267a8f316b575e214644c72fb6ce8bb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z3PxfG6u4wMLmu_3ZIQ85g.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated"><strong class="bd ih">2<em class="ks">。</em> <em class="ks">向所有pi发送相同的命令</em> </strong></figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/d5d494cfaab6fdc29a48d41f04d351b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LAiLzRUSE8OVrM_NZ9JMkQ.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated"><strong class="bd ih"> 3。<em class="ks">重启集群</em> </strong></figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/94d49603945ef196a876bedd1a2e7d15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bkEv8PSAXAvIh6qUHGlMTg.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated"><strong class="bd ih"> <em class="ks"> 4。关闭集群</em> </strong></figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/3f82d639a4c93840c2e60a039b34016e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U3T8sGKDjjIu2EUMFqriew.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated"><strong class="bd ih"> 5。<em class="ks">向所有pi发送相同的文件</em> </strong></figcaption></figure><p id="86bf" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">然后我们可以复制我们在~/中定义的所有易用的函数。使用下面显示的命令将bashrc连接到集群上的所有其他Pi:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/34bc7d75414774c7ab04f21d312e2ec8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MgXzLNkvcYN7Lvg6aZU3Nw.png"/></div></div></figure><h1 id="87ba" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak"> <em class="ks">第二期:Hadoop &amp; Spark </em> </strong></h1><p id="4709" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj"> <em class="ku">单节点设置</em> </strong></p><p id="282f" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated"><strong class="jf hj"> <em class="ku"> Hadoop安装</em> </strong></p><p id="3aa4" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">在安装Hadoop之前，我们确保我们的pi拥有可接受的Java版本。我们首先在我们选择的主节点上构建一个单节点设置。在pi#1上，用这个命令获取Hadoop(这是获取hadoop-3.2.0.tar.gz的一个简短链接):</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/53f4627da25787fe6408acf7a47dacf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FGWFZXbqahFw7lt2rSwIdA.png"/></div></div></figure><p id="0be6" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">接下来，使用下面显示的命令:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/bf908c4bc82b60ba53bb515e3041fcb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kp_4X8j7Y8lYuiav_pj6Xw.png"/></div></div></figure><p id="82ef" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">然后，确保更改该目录的权限:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/d739b1dfab8a6cdcd120aab808909eed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WhHpKTTNFDjsn8sMakXWMw.png"/></div></div></figure><p id="0129" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">最后，通过编辑<strong class="jf hj"> <em class="ku"> ~/，将这个目录添加到$PATH中。bashrc </em> </strong> <strong class="jf hj">文件</strong>并在文件末尾加上以下几行:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/5a5e1a4876937266c11710bfb3d85209.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xOe6OOg0fyaFs3VXrjXq3w.png"/></div></div></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/139db9ecb9219df764b5ef646e919b77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n-_SeKhtkFQs665BJF1HFw.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">上图显示了我们用来编辑<strong class="bd ih"> <em class="ks"> ~/的线条。bashrc </em> </strong> <strong class="bd ih">文件</strong></figcaption></figure><p id="cf31" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">然后编辑<strong class="jf hj"><em class="ku">/opt/Hadoop/etc/Hadoop/Hadoop-env . sh</em></strong><strong class="jf hj">文件</strong>添加下面一行:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/08ecedd744a3b7b784dd3eeea55d533a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wzn6w0sImirm_IK1Ll9ZMw.png"/></div></div></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/38268c7e400c543cd62bd8cf02ac6c21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l1X4OD_eewZksrPN-7KLuQ.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">上图显示了我们用来编辑<strong class="bd ih"><em class="ks">/opt/Hadoop/etc/Hadoop/Hadoop-env . sh</em></strong><strong class="bd ih">文件</strong>的代码行</figcaption></figure><p id="9c02" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">通过检查版本来验证Hadoop是否已正确安装:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/85cbfa3cd60adce85abad3e0f054300f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Je3jylh_UPa_ZIDxfT5NlA.png"/></div></div></figure><p id="f885" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated"><strong class="jf hj"> <em class="ku">火花安装</em> </strong></p><p id="65f8" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">我们将以与下载Hadoop类似的方式下载Spark，运行以下命令(这是spark-2.4.3-bin-hadoop2.7.tgz的简短链接):</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/72cfbdae894ba37a1290de65a00c3efa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5wqsh2nZr1adeqNxZlfWqw.png"/></div></div></figure><p id="1fa5" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">然后使用下面显示的命令:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/2a515694afaeb5553d8636d350768df6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HR_77u4YtjHML4CW9G3XzA.png"/></div></div></figure><p id="5a95" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">然后，确保更改该目录的权限:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/4224c1a92997e39d47767ee9f64f1dc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*izxQDmcwXEJs2M19MF0iCg.png"/></div></div></figure><p id="0b67" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">最后，通过编辑<strong class="jf hj"> <em class="ku"> ~/，将这个目录添加到您的$PATH中。bashrc </em> </strong>并在文件末尾添加以下行:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/5ba3316fc2561f303aef0e2a47b5b55e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LX6qF2XEYyrwfbs1pPVXNQ.png"/></div></div></figure><p id="56bd" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">您可以通过检查版本来验证Spark是否已正确安装:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/e5f6d56076126ab35c92f8fac692b3a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a02mi5gvXLSDj-0S32R1eA.png"/></div></div></figure><p id="3706" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated"><strong class="jf hj"><em class="ku">【HDFS(Hadoop分布式文件系统)</em> </strong></p><p id="61e2" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">为了启动并运行Hadoop分布式文件系统(HDFS ),我们需要修改一些配置文件。</p><ul class=""><li id="1d75" class="lg lh hi jf b jg kv jk kw jo li js lj jw lk ka ll lm ln lo bi translated">所有这些文件都在<strong class="jf hj"><em class="ku">/opt/Hadoop/etc/Hadoop</em></strong>内</li><li id="4c1c" class="lg lh hi jf b jg lp jk lq jo lr js ls jw lt ka ll lm ln lo bi translated">包括<strong class="jf hj"> core-site.xml，hdfs-site.xml，mapred-site.xml，yarn-site.xml </strong></li></ul><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/a13f3a3ee223cb72c6fe6709f7852f43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pWzmk1gBMTs_w_WcjH9JJQ.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">编辑<strong class="bd ih"><em class="ks">core-site . XML</em></strong>所以看起来是这样的。</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/33e77973ad20518dd37a955e655082b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eh2vw89bS4QWWNJ0Rn7Q-w.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">编辑<strong class="bd ih"><em class="ks">HDFS-site . XML</em></strong>所以看起来是这样的。</figcaption></figure><p id="a26e" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">上面显示的行配置了DataNode和NameNode信息的存储位置，还将replication(跨集群复制块的次数)设置为1(我们可以在以后根据您构建的DataNode的数量来更改)。</p><p id="0660" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">使用下面显示的命令创建这些目录:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/b8d9f36e84f678a361e40801724d3dbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e5jazxI5btGDQvwuaco5qw.png"/></div></div></figure><p id="76fe" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">然后调整这些目录的所有者:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/2da9892124b0ce89a0bba4df58241630.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*puR3o8sqKN5MkgqOcxJRdw.png"/></div></div></figure><p id="2168" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">将下面几行添加到<strong class="jf hj"><em class="ku">mapred-site . XML</em></strong>中，使其看起来如下所示:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/1c6ac4370d19ad8ba4e55e0999daabb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FPJgv5s-Oznlg2Es_k7j1g.png"/></div></div></figure><p id="ffc4" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">最后，将下面的行添加到<strong class="jf hj"><em class="ku">yarn-site . XML</em></strong>中，如下所示:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/4f064b3b4d2806592f3cc0bbf03f4ff2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0eMOZZuNKjk-noBGdR_-rw.png"/></div></div></figure><p id="e153" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">编辑完这四个文件后，我们可以使用下面的命令格式化HDFS。(警告:如果您在HDFS已经有数据，请不要这样做！它将会丢失！):</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/ed50e86d623053faee6fd50920638fef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6F931bMEygJyCDHPNw4YiQ.png"/></div></div></figure><p id="2459" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">然后，我们用下面显示的两个命令启动HDFS:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/bccb259d3b34297dafe26f2fc8a26bc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hsiLVrO7xi9UXhOw1wv0mw.png"/></div></div></figure><p id="7b93" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">并通过创建一个临时目录来测试它是否工作:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/6ee904a0d66182810538a2f70af92cae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K90wGHiTD-MwLFi2z8Qimg.png"/></div></div></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lu"><img src="../Images/eb3477446ef733824fc24b104b6f2ba6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zhYhLNCOSYr48DqvyjVYmQ.png"/></div></div></figure><p id="03e9" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">或者通过运行命令jps:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/034045c08218a4a2b31880013f1a6010.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jY8cymozN9EqZqYGsSso7g.png"/></div></div></figure><p id="95c3" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">上图显示HDFS已经启动并运行，至少在1号码头是这样。要检查Spark和Hadoop是否协同工作，我们可以使用下面的命令行:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/0291a2182d745000ef00c464850e47f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mWMtClqIdElUbmoKuNkEzg.png"/></div></div></figure><p id="b55e" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">然后它会打开Spark shell，并提示Scala &gt;:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/dc7d7e7d73bd1a7f99f2ff742a64e5dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U_lKOezVQnYefs5Jgh8rUw.png"/></div></div></figure><p id="4ff3" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated"><strong class="jf hj"> <em class="ku">集群设置</em> </strong></p><p id="025f" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">此时，我们有了一个单节点集群，该单节点同时充当主节点和工作节点。为了设置工作节点(并将计算分布到整个集群)，我们采取以下步骤。</p><p id="1bf2" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated"><strong class="jf hj"> <em class="ku">创建目录</em> </strong></p><p id="5fa2" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">使用下面显示的命令行在所有其他pi上创建所需的目录:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/2103b329609b3ba5ef1cb4c61f62230e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3vYT5qMXSIiUi8ofnP99HQ.png"/></div></div></figure><p id="df3b" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated"><strong class="jf hj"> <em class="ku">复制配置</em> </strong></p><p id="151c" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">将<strong class="jf hj"> <em class="ku"> /opt/hadoop </em> </strong>中的文件复制到对方Pi中使用:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/e5be5b0067d64a16fea5b2de954e7c25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QTSCtDMIMA8Rc2uMWkLYYQ.png"/></div></div></figure><p id="b563" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">过一会儿，您可以通过使用以下命令查询每个节点上的Hadoop版本来验证文件复制是否正确:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/ab8c8dfd35138fbdc407ecb457b519d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hnDzEF68n8I6uQ-MqhgkZw.png"/></div></div></figure><p id="3b35" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated"><strong class="jf hj"> <em class="ku">在集群上配置Hadoop</em></strong></p><p id="63fb" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">为了让HDFS在集群中运行，我们需要修改之前编辑的配置文件。所有这些文件都在<strong class="jf hj"><em class="ku">/opt/Hadoop/etc/Hadoop</em></strong>内</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/594b9d7d98828e1d1bbf72b953cd5906.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GJrKP3yod9kQ6rYLbaB_lQ.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">首先，编辑<strong class="bd ih"><em class="ks">core-site . XML</em></strong>使其看起来如上图。</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/4a9e3417d4608c431db86a64cb1dbd85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LeTnZmPOuWDb1kdsqMYQCQ.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">编辑<strong class="bd ih"><em class="ks">HDFS-site . XML</em></strong>这样看起来就像上面的。(我们没有改变复制号，像以前一样使用1，因为我们决定只有两个DataNode。)</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/c98dfb28bf4c2348523884dac36e4ffa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mlrG-X0v1mDqWD42Z9MSUA.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">编辑<strong class="bd ih"><em class="ks">mapred-site . XML</em></strong>使其看起来如上图。</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/a68b53c62dd26a47f455930c08341d8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HTPF1PZNNYTJCoGoIkxZXw.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">最后，编辑<strong class="bd ih"><em class="ks">yarn-site . XML</em></strong>使其看起来如上图。</figcaption></figure><p id="bbfd" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">对这些文件进行这些更改，然后从所有pi中删除所有旧文件。您可以通过以下方式清理所有Pis:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/5fb4cd31f2542ef945b2824080afac26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZAhOEgLPh2K58ovF8ww5xg.png"/></div></div></figure><p id="8ad1" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">接下来，我们需要在<strong class="jf hj"><em class="ku">$ HADOOP _ HOME/etc/HADOOP/</em></strong>中创建两个文件，这两个文件告诉HADOOP将哪个Pi用作工作节点，哪个Pi应该是主(NameNode)节点。</p><p id="9c54" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">首先，我们在前面提到的目录中创建一个名为master的文件，并只添加一行Pi(<strong class="jf hj"><em class="ku">raspberrypi)</em></strong>)。其次，我们在同一目录下创建一个名为的文件，并添加所有其他pi(<strong class="jf hj"><em class="ku">【raspberrypi 2…)</em></strong>，如下图所示:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/21fc5bd055dbe749dc4dfaee77ff66ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LSQif-Opid0wVNuY-Cf0EQ.png"/></div></div></figure><p id="b8c5" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">然后，你需要再次编辑<strong class="jf hj"> <em class="ku"> /etc/hosts </em> </strong>。在任何Pi上，删除如下所示的线:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/9a01780ffc7507d2a0eceb79a6516ea7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ooga_IwCFqzTGAkr46K90A.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">其中X是特定圆周率的指数。</figcaption></figure><p id="bef6" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">然后，使用以下命令将该文件复制到所有其他pi:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/0b34b2e7b1655f47a102bc248a874b33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y-GhYJkr3isuIA4zTpS7WQ.png"/></div></div></figure><p id="3829" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">我们现在可以这样做，因为这个文件不再是特定于Pi的。最后，重新启动集群以使这些更改生效。当所有Pi都重新启动后，在Pi #1上运行命令:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/dcf36124117752096dc7ed16e15d2fd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BRbCnfVwfCxxSVbDAm5V7Q.png"/></div></div></figure><p id="e1a4" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">然后，我们使用以下两个命令启动HDFS:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/c57c4668e5de170978851be37b581841.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-z6T1cjrqjzb6pPoHeU4xw.png"/></div></div></figure><p id="e1e1" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">我们可以通过从任何Pi(使用hadoop fs -put)将文件放入HDFS来测试集群，并确保它们显示在其他Pi上(使用hadoop fs -ls)。您还可以通过打开web浏览器并导航到<a class="ae kb" href="http://192.168.1.101:9870/" rel="noopener ugc nofollow" target="_blank"><strong class="jf hj"><em class="ku">http://192 . 168 . 1 . 101:9870/</em></strong></a><strong class="jf hj"><em class="ku">(在我们的示例中)</em> </strong>来检查群集是否已启动并正在运行。该web界面为您提供了一个文件浏览器以及有关群集运行状况的信息。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/774a796e5dd7df3e7258f22cabb6fcad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WppP-qffTLxbwFeOs2NfLA.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated"><em class="ks">运行在端口9000上的Hadoop web UI。</em></figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/4e384ba92ee230a293de5c1ff77d415f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7SOzPEhw-bGneodDcT89cw.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated"><em class="ks">显示DataNode统计数据的Hadoop web UI。</em></figcaption></figure><p id="75df" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated"><strong class="jf hj"> <em class="ku">在集群上配置火花</em> </strong></p><p id="39fb" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">为了让Spark能够与YARN通信，我们需要在Pi #1的<strong class="jf hj"> <em class="ku"> ~/中再配置两个环境变量。巴沙尔</em> </strong>。之前，我们定义了:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/384360a39e5f5c5e9c6c9b396b3f95f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W7b0vvwJXyzeRZ85p11eDA.png"/></div></div></figure><p id="9e1c" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated"><strong class="jf hj">中的<em class="ku"> ~/。巴沙尔</em> </strong>。在此之下，我们现在将添加两个环境变量:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/9e9133e88a6700a931be87d6918bbc96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8r5C7Lo4AjV8tICOcOHmLA.png"/></div></div></figure><p id="38c3" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated"><strong class="jf hj"><em class="ku">$ HADOOP _ CONF _目录</em> </strong>是包含我们上面编辑的所有<strong class="jf hj"> <em class="ku"> *-site.xml </em> </strong>配置文件的目录。接下来，我们使用下面显示的命令行创建Spark配置文件:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/ed2e9c6e6eae7bfb5e7c7f9bac483d64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ytHG0L2ikykUr-Ag6HVuxw.png"/></div></div></figure><p id="630c" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">然后，我们将以下几行添加到该文件的末尾:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/ba43b8d7556d97555a26a98b87c2ab4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p9-cIbwQl6ydz3pr76nFKQ.png"/></div></div></figure><p id="36b5" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">此链接解释了这些值的含义。但是请注意，以上是非常特定于机器的。完成所有这些配置后，重新启动集群。请注意，当您重新启动时，您不应该再次格式化HDFS命名节点。相反，只需使用以下命令停止并重新启动HDFS服务:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/903b4e5cb5edbdc7e87b13045cd7a4df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XkDzd2iFxXiRer5aN6LDtA.png"/></div></div></figure><p id="49b3" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">现在，您可以在命令行上向Spark提交作业！我们使用下面显示的命令行从文本文件创建简单的RDD。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/acc9eb1bc739db27c30dcf14f9c69f32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*igaJsPUs0_YcbyCACuuNCQ.png"/></div></div></figure><p id="be24" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">输出应该如下图所示。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lf"><img src="../Images/f66bd82fadb71bac657755df7977d7d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_b51jkneWYGfnHi93nxURA.png"/></div></div></figure><h1 id="9492" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak"> <em class="ks">结论</em> </strong></h1><p id="1ef5" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">最终，我们成功完成了这个从零开始构建树莓pi hadoop/spark集群的项目。这是一个漫长的配置和探索过程。然而，我们确实乐在其中。这是我们职业生涯中的第一个数据工程师兼职项目，我们期待着更多地了解大数据分析领域。</p></div><div class="ab cl lv lw gp lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="hb hc hd he hf"><p id="8fe8" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated"><strong class="jf hj">参考</strong></p><p id="2770" class="pw-post-body-paragraph jd je hi jf b jg kv ji jj jk kw jm jn jo kx jq jr js ky ju jv jw kz jy jz ka hb bi translated">[1]:安德鲁。(2019年7月22日)。<a class="ae kb" href="https://dev.to/awwsmm/building-a-raspberry-pi-hadoop-spark-cluster-8b2?fbclid=IwAR1jloBA6-6U3LhcxhkLT0Kq2Nx90YZjnCCIfT01SQSRs3mHHB87kt4AK4w" rel="noopener ugc nofollow" target="_blank">构建Raspberry Pi Hadoop / Spark集群</a></p></div></div>    
</body>
</html>