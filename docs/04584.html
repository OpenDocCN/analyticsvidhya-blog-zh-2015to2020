<html>
<head>
<title>Lungs Disease prediction using Medical Imaging with Implementation of VGG, Resnet and Convolutional Neural Network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用医学成像预测肺部疾病，实现VGG、雷斯网和卷积神经网络</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/lungs-disease-prediction-using-medical-imaging-with-implementation-of-vgg-resnet-and-183e73b85df9?source=collection_archive---------10-----------------------#2020-03-25">https://medium.com/analytics-vidhya/lungs-disease-prediction-using-medical-imaging-with-implementation-of-vgg-resnet-and-183e73b85df9?source=collection_archive---------10-----------------------#2020-03-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="204d" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">关于</strong></h1><h2 id="aedc" class="jd ig hi bd ih je jf jg il jh ji jj ip jk jl jm it jn jo jp ix jq jr js jb jt bi translated"><strong class="ak">卷积神经网络</strong></h2><p id="f438" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke jk kf kg kh jn ki kj kk jq kl km kn ko hb bi translated">CNN是通常用于图像和音频识别和分类的神经网络。它是人脑的复制品，包含多列神经元。与其他神经网络不同，CNN拥有可调权重和偏差的神经元。卷积图层有助于从输入数据中查找和提取要素。卷积层使用过滤器，也称为内核，用于这一特征提取过程。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es kp"><img src="../Images/413c3b35e7c639e31c79092ed967e9c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KugmCBDMimkwFWrqvBszEA.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated"><strong class="bd ih">卷积神经网络的架构。</strong></figcaption></figure><h2 id="4695" class="jd ig hi bd ih je jf jg il jh ji jj ip jk jl jm it jn jo jp ix jq jr js jb jt bi translated"><strong class="ak"> VGG-16 </strong></h2><p id="1918" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke jk kf kg kh jn ki kj kk jq kl km kn ko hb bi translated">VGG-16神经网络是由牛津大学视觉几何组(VGG)开发和训练的卷积神经网络。它被提交到2014年大规模视觉识别挑战赛(ILSVRC2014)，该模型在2014年的Imagenet挑战赛中取得了92.7%的前5名测试准确率，此后它一直在各种框架中可用。数字是体系结构包含的层数。它有1400万张手工标注的图片。</p><h2 id="731f" class="jd ig hi bd ih je jf jg il jh ji jj ip jk jl jm it jn jo jp ix jq jr js jb jt bi translated"><strong class="ak"> ResNet50 </strong></h2><p id="c132" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke jk kf kg kh jn ki kj kk jq kl km kn ko hb bi translated">Resnet代表残余网络。resnet的基本概念是剩余学习。在残差学习中，我们不是试图学习一些特征，而是试图学习一些残差。残差是从该层输入中学习到的特征的减法。ResNet50是一个50层的剩余网络。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lf"><img src="../Images/0b0da9a0bcd16c662d6f179d0ffdfaa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LHjPgojb9DBsuR9_pHmaig.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated"><strong class="bd ih">VGG层和ResNet层(Vgg19和ResNet152) </strong></figcaption></figure><h2 id="2ac5" class="jd ig hi bd ih je jf jg il jh ji jj ip jk jl jm it jn jo jp ix jq jr js jb jt bi translated"><strong class="ak">医学影像</strong></h2><p id="6625" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke jk kf kg kh jn ki kj kk jq kl km kn ko hb bi translated">医学成像是指为了诊断、医疗条件或监测某一部位而观察人体的各种技术。不同类型的医学成像有CT扫描、X射线、MRI等</p><h2 id="9b53" class="jd ig hi bd ih je jf jg il jh ji jj ip jk jl jm it jn jo jp ix jq jr js jb jt bi translated"><strong class="ak"> ImageNet </strong></h2><p id="7080" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke jk kf kg kh jn ki kj kk jq kl km kn ko hb bi translated">ImageNet是一个图像数据库或数据集，由超过1400万张图像组成，用于计算机视觉研究(视觉对象识别)。它包含20，000个类别，如“气球”、“草莓”等。自2010年以来，ImageNet项目举办了一年一度的软件竞赛ImageNet大规模视觉识别挑战赛(<a class="ae lg" href="https://en.wikipedia.org/wiki/ImageNet#ImageNet_Challenge" rel="noopener ugc nofollow" target="_blank"> ILSVRC </a>)。VGG和雷斯内特在这次挑战赛中获奖，这使得他们大受欢迎。</p><h2 id="86a1" class="jd ig hi bd ih je jf jg il jh ji jj ip jk jl jm it jn jo jp ix jq jr js jb jt bi translated"><strong class="ak">肺部疾病预测</strong></h2><p id="1e0c" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke jk kf kg kh jn ki kj kk jq kl km kn ko hb bi translated">我们将使用位于三个文件夹train、test和Val中的5856幅图像来预测给定的患者x光片是否患有肺炎。肺炎是一种影响肺部的传染性炎症疾病，通常由病毒或细菌感染引起。肺炎可以通过胸部x光检查来诊断。我们收集了正常和肺炎诊断的x光片。这些图像的输入形状为64x64x3: 64宽，64高，有3个颜色通道。我们将使用三种不同类型的层对图像进行分类:VGG-16、ResNet50和卷积神经网络层。</p><h2 id="35f8" class="jd ig hi bd ih je jf jg il jh ji jj ip jk jl jm it jn jo jp ix jq jr js jb jt bi translated"><strong class="ak">让代码</strong></h2><p id="a051" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke jk kf kg kh jn ki kj kk jq kl km kn ko hb bi translated"><strong class="jw hj">导入库</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lh"><img src="../Images/2983b7fd5ff2b153e0979044d1178f10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jwIRvdnxAxWRaLj8hrszog.png"/></div></div></figure><p id="79a3" class="pw-post-body-paragraph ju jv hi jw b jx li jz ka kb lj kd ke jk lk kg kh jn ll kj kk jq lm km kn ko hb bi translated"><strong class="jw hj">建立培训和测试文件夹</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es ln"><img src="../Images/1e1605ae03ac6e0acfffef52dfb67a47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*3ZLAeyNaSsjRIGQ75NMHJA.png"/></div></figure><h2 id="24df" class="jd ig hi bd ih je jf jg il jh ji jj ip jk jl jm it jn jo jp ix jq jr js jb jt bi translated"><strong class="ak">让我们来看看其中的一些图片</strong></h2><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lo"><img src="../Images/9466a55cac9f8b780315b20c7daf283a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WWye08R-hUb9I2ippsJU9g.png"/></div></div></figure><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lp"><img src="../Images/d9a8e38e2101449bda0a56e6be09aee0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*73Wh4icldouPTiqangSS5g.png"/></div></div></figure><p id="be71" class="pw-post-body-paragraph ju jv hi jw b jx li jz ka kb lj kd ke jk lk kg kh jn ll kj kk jq lm km kn ko hb bi translated"><strong class="jw hj">使用图像数据生成器从数据集导入图像。</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lq"><img src="../Images/41c271dfee2cb1d150e49f7ea3e49c85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pRDMi6exZQiRYBaGY5-TJg.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated"><strong class="bd ih"> ImageDataGenerator有助于图像增强。IMAGE_SIZE将在VGG、ResNet实现中使用，以调整图像的大小</strong></figcaption></figure><h1 id="bfbf" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">使用CNN模型</strong></h1><h2 id="602b" class="jd ig hi bd ih je jf jg il jh ji jj ip jk jl jm it jn jo jp ix jq jr js jb jt bi translated"><strong class="ak">让我们建立CNN模型</strong></h2><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lr"><img src="../Images/29e1fe2f0a34490fc485351c17cde04a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z8ny7Dv1wcxszCVV7-Y8HA.png"/></div></div></figure><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es ls"><img src="../Images/895ab92884fb3a6b47fde7f0ca3c082a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cZp4aWGb0k2jnr15AvGLmA.png"/></div></div></figure><p id="ce6b" class="pw-post-body-paragraph ju jv hi jw b jx li jz ka kb lj kd ke jk lk kg kh jn ll kj kk jq lm km kn ko hb bi translated"><strong class="jw hj">让我们告诉模型使用什么成本和优化方法，并使模型适合我们的训练数据集</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lt"><img src="../Images/b335261e355e829fc3f5039689687a0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QqbFy-4C7HksFxgQ2wCN3g.png"/></div></div></figure><h1 id="1cec" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">使用VGG</h1><p id="28d1" class="pw-post-body-paragraph ju jv hi jw b jx jy jz ka kb kc kd ke jk kf kg kh jn ki kj kk jq kl km kn ko hb bi translated"><strong class="jw hj">导入Vgg16库后，在Vgg前添加预处理层</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lu"><img src="../Images/ded8d7814a8426b420e6c9055e3ffe74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k9XrWhpYlEFCvWxwdlQmVA.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">我们使用imagenet的权重</figcaption></figure><p id="e3c6" class="pw-post-body-paragraph ju jv hi jw b jx li jz ka kb lj kd ke jk lk kg kh jn ll kj kk jq lm km kn ko hb bi translated"><strong class="jw hj">确保现有的VGG层没有被训练并且权重没有被改变。</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lv"><img src="../Images/1b627e018dc9e925a6a9ad2b9e457657.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u5vkyxcccX_i7pBDX2h3Fw.png"/></div></div></figure><p id="dc9b" class="pw-post-body-paragraph ju jv hi jw b jx li jz ka kb lj kd ke jk lk kg kh jn ll kj kk jq lm km kn ko hb bi translated"><strong class="jw hj">获取输出类的数量</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lw"><img src="../Images/023e8224f176168414052683c4f32702.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*Avgp_mKeb4ewuGfSoKZAgw.png"/></div></div></figure><p id="eec2" class="pw-post-body-paragraph ju jv hi jw b jx li jz ka kb lj kd ke jk lk kg kh jn ll kj kk jq lm km kn ko hb bi translated"><strong class="jw hj">制作一个压平图层，添加最后一个图层</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lx"><img src="../Images/2f3d919a71e2a1621c0924eba24086a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hNlqxEjvt5wMqqAFgwC4iQ.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">len(folder)表示我的输出层中有多少类别</figcaption></figure><p id="151e" class="pw-post-body-paragraph ju jv hi jw b jx li jz ka kb lj kd ke jk lk kg kh jn ll kj kk jq lm km kn ko hb bi translated"><strong class="jw hj">创建模型并观察模型</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es ly"><img src="../Images/ed357767a463134dc47f5b2428c5e445.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EQVlem9EhDDiZ7_Mc1SUgg.png"/></div></div></figure><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es lz"><img src="../Images/f2d303ab59386faa93a4d01f6ebb0901.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*fjP0Ww6wjkCDEIyFjKifOQ.png"/></div></figure><p id="1caf" class="pw-post-body-paragraph ju jv hi jw b jx li jz ka kb lj kd ke jk lk kg kh jn ll kj kk jq lm km kn ko hb bi translated"><strong class="jw hj">告诉模型使用什么成本和优化方法</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es ma"><img src="../Images/269552070503567961060920989b8b59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2NkMnVtMaT9Gh50j49Vdng.png"/></div></div></figure><p id="a217" class="pw-post-body-paragraph ju jv hi jw b jx li jz ka kb lj kd ke jk lk kg kh jn ll kj kk jq lm km kn ko hb bi translated"><strong class="jw hj">拟合模型</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es mb"><img src="../Images/1f78f84226ebfa4cba87888d9ea196b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RhGt3kjpQhsx9_627fmm0Q.png"/></div></div></figure><h1 id="4ee3" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">使用ResNet50</h1><h2 id="c832" class="jd ig hi bd ih je jf jg il jh ji jj ip jk jl jm it jn jo jp ix jq jr js jb jt bi translated">Resnet50实现的代码与VGG-16的代码完全相同。您必须做的唯一更改是用ResNet50替换vgg16</h2><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es mc"><img src="../Images/f96a6bec461e73e4d295440ef728e446.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kh7Pw6t2lKQC46Sj1l7zTA.png"/></div></div></figure><h2 id="5143" class="jd ig hi bd ih je jf jg il jh ji jj ip jk jl jm it jn jo jp ix jq jr js jb jt bi translated">符合模型</h2><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es md"><img src="../Images/36fc8498373e3c22108f70268dc9e658.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QzNrxW7XPCsdq2CtnCPRGw.png"/></div></div></figure><h2 id="21ab" class="jd ig hi bd ih je jf jg il jh ji jj ip jk jl jm it jn jo jp ix jq jr js jb jt bi translated">链接到Github并完成代码:</h2><h2 id="8354" class="jd ig hi bd ih je jf jg il jh ji jj ip jk jl jm it jn jo jp ix jq jr js jb jt bi translated"><a class="ae lg" href="https://github.com/beingnitisho7/LungsDiseasePredictionCNN_VGG_ResNet" rel="noopener ugc nofollow" target="_blank">https://github . com/beingnitisho 7/lungsdiaeprediction CNN _ VGG _ ResNet</a></h2></div></div>    
</body>
</html>