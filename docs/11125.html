<html>
<head>
<title>How to Convert Tensorflow Object Detection CSV data to CoCo Json Format</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将 Tensorflow 对象检测 CSV 数据转换为 CoCo Json 格式</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-convert-tensorflow-object-detection-csv-data-to-coco-json-format-d0693d5b2f75?source=collection_archive---------7-----------------------#2020-11-19">https://medium.com/analytics-vidhya/how-to-convert-tensorflow-object-detection-csv-data-to-coco-json-format-d0693d5b2f75?source=collection_archive---------7-----------------------#2020-11-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ee1c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">CSV 格式的 Tensorflow 对象检测数据包含每个实例的一行。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/8ef251a79b9138a302b1e6ae3993d30a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*njEiuY26EdTm7fnOC6aUvg.png"/></div></div></figure><p id="7843" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它包含每个图像的每个标签的边界框位置和类别标签。</p><p id="b6fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它用于训练 tensorflow 对象检测模型和各种其他模型。</p><p id="8bbb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">CoCo Json 格式最初是由 CoCo 对象检测竞赛规定的。它以 json 格式存储对象检测数据。json 包含以下四个字段</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="0a2c" class="ju jv hi jq b fi jw jx l jy jz">{</span><span id="b151" class="ju jv hi jq b fi ka jx l jy jz">"info": info,</span><span id="524d" class="ju jv hi jq b fi ka jx l jy jz">"images": [image],</span><span id="bce4" class="ju jv hi jq b fi ka jx l jy jz">"annotations": [annotation],</span><span id="3834" class="ju jv hi jq b fi ka jx l jy jz">"licenses": [license],</span><span id="4643" class="ju jv hi jq b fi ka jx l jy jz">"categories": [category]</span><span id="ebe0" class="ju jv hi jq b fi ka jx l jy jz">}</span></pre><p id="f645" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于检测器 2 下的训练对象检测模型，只有图像、类别和注释字段是必需的，信息和许可证字段可以忽略。</p><p id="7e88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">图像字段包含字典列表，每个图像一个字典。它将图像 id 分配给注释字段中使用的图像名称。对于一个单独的图像，其结构如下:</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="9210" class="ju jv hi jq b fi jw jx l jy jz">{</span><span id="652c" class="ju jv hi jq b fi ka jx l jy jz">"id": int,</span><span id="72db" class="ju jv hi jq b fi ka jx l jy jz">"width": int,</span><span id="a2e6" class="ju jv hi jq b fi ka jx l jy jz">"height": int,</span><span id="013b" class="ju jv hi jq b fi ka jx l jy jz">"file_name": str,</span><span id="2220" class="ju jv hi jq b fi ka jx l jy jz">"license": int,</span><span id="35a2" class="ju jv hi jq b fi ka jx l jy jz">"flickr_url": str,</span><span id="d3c5" class="ju jv hi jq b fi ka jx l jy jz">"coco_url": str,</span><span id="5c89" class="ju jv hi jq b fi ka jx l jy jz">"date_captured": datetime,</span><span id="7714" class="ju jv hi jq b fi ka jx l jy jz">}</span></pre><p id="7a71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于 detectron2 的培训，只有 id、宽度、高度和文件名字段是必填的。</p><p id="fdf2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类别字段包含字典列表，每个类别一个字典。它将类别 id 分配给在注释字段中使用的类别名称。其单一类别的结构如下:</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="92c4" class="ju jv hi jq b fi jw jx l jy jz">{</span><span id="d6e3" class="ju jv hi jq b fi ka jx l jy jz">"id": int,</span><span id="1109" class="ju jv hi jq b fi ka jx l jy jz">"name": str,</span><span id="96e5" class="ju jv hi jq b fi ka jx l jy jz">"supercategory": str,</span><span id="3d77" class="ju jv hi jq b fi ka jx l jy jz">}</span></pre><p id="9abb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注释字段包含字典列表，每个标签一个字典。我们必须为每个注释提供唯一的注释 id。我们必须提供相关的图像 id 和类别 id。对于检测任务，我们必须提供包围盒坐标及其面积。如果是训练例如分割，那么我们也必须在分割字段中提供用于遮罩的多边形，在对象检测任务的情况下，分割字段可以留空</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="ee7d" class="ju jv hi jq b fi jw jx l jy jz">annotation{</span><span id="dce6" class="ju jv hi jq b fi ka jx l jy jz">"id": int,</span><span id="b722" class="ju jv hi jq b fi ka jx l jy jz">"image_id": int,</span><span id="1c59" class="ju jv hi jq b fi ka jx l jy jz">"category_id": int,</span><span id="6605" class="ju jv hi jq b fi ka jx l jy jz">"segmentation": [], </span><span id="d366" class="ju jv hi jq b fi ka jx l jy jz">"area": float,</span><span id="5c03" class="ju jv hi jq b fi ka jx l jy jz">"bbox": [x,y,width,height],</span><span id="8e65" class="ju jv hi jq b fi ka jx l jy jz">"iscrowd": 0,</span><span id="7a6f" class="ju jv hi jq b fi ka jx l jy jz">}</span></pre><p id="b098" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我使用以下代码将 tensorflow 对象检测 csv 数据转换为 Coco Json 格式</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kb kc l"/></div></figure><p id="54d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在第 9 行，我们读取了 csv 文件。需要为虚拟超级类别分配 id 0。我们使用虚拟类别作为其余类别超级类别。</p><p id="443d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我们遍历每一行，并填充图像、类别和注释字段。</p><p id="ee91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我已经用上面代码生成的 cocojson 数据训练了 detectron2 对象检测模型。</p></div></div>    
</body>
</html>