<html>
<head>
<title>Natural Selection and AutoML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自然选择和自动化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/natural-selection-and-automl-f9cb00d6a878?source=collection_archive---------37-----------------------#2020-05-02">https://medium.com/analytics-vidhya/natural-selection-and-automl-f9cb00d6a878?source=collection_archive---------37-----------------------#2020-05-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f2ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在处理任何数据科学问题(无论是回归问题还是分类问题)时，我们经常会在最终确定模型时遇到问题，例如这是否是最好的算法，参数是否得到了完美的调整，或者我是否可以在特征工程中更具创造性。坦率地说，改变管道的任何一个方面，都可能对找到最佳解决方案造成巨大的破坏。因此，如果你有足够的时间进行培训，我想把你的注意带到python中的TPOT库。这是一个个人的python数据科学助手，使用遗传算法处理上述令人头痛的问题。我们将首先了解什么是真正的遗传算法，然后我们将扩展我们对TPOT图书馆和一些常见的超参数的理解。</p><h1 id="cdfa" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">遗传算法</h1><p id="3696" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">遗传算法(GAs)是一种元启发式算法，它捕捉了自然选择的过程，以找到优化问题的解决方案。该算法基于查尔斯·达尔文的适者生存理论，即物种如何在后代中创造后代。最健康的那部分人口最有可能在下一代生育后代。这种类比可用于在有约束和无约束的优化问题中获得最优解，其中手动寻找解可能具有挑战性。</p><h1 id="e5bf" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">算法简介</h1><p id="1d54" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">该算法可以用下面的方式来理解。我们首先初始化一个随机生成的候选人群体和一个适应度函数，该函数定量地确定一个候选人如何优于另一个候选人，并且所有的适应度被收集到一个池中。现在，从这个池中选择个体来创建新的候选人(新一代)，并且再次测试这些个体以确定最合适的候选人。这个过程被迭代地应用，直到已经经过了最大数量的代，或者达到了令人满意的群体适应度水平，或者创建的新一代是前几代的精确副本。在这里，我们必须注意到，收敛到全局极值是没有保证的。</p><h1 id="3b24" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">主要特点:</h1><ol class=""><li id="ee18" class="kg kh hi ih b ii kb im kc iq ki iu kj iy kk jc kl km kn ko bi translated"><strong class="ih hj">代表群体(基因组和染色体):</strong>经典机器学习设置中的数据集中的每一行或者每一条流水线(在TPOT库使用的情况下，后面会详细解释)都可以理解为群体中的个体。行中的每个特征可以理解为类似于基因，整行可以理解为染色体。最常见和首选的表示是特征值对的二进制表示。</li></ol><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es kp"><img src="../Images/189ef68fc5774ba322a604d34899782d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MBY9VYb0lR6FrDTf1C9XrQ.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">代表一行数据</figcaption></figure><p id="e058" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。</strong> <strong class="ih hj">定义适应度函数:</strong>适应度函数工作的唯一要求是能够计算并定量区分好的和坏的候选人。它可以取决于问题陈述，并且可以是准确度、F1分数(在分类问题的情况下)或RMSE(在回归问题的情况下)。</p><p id="f909" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3。</strong> <strong class="ih hj">选择最佳候选人的方法:</strong>选择候选人放入池中以创建下一代群体的一些最常见的方法是——轮盘赌选择(基于更高的适应度分数分配更高的概率)、精英选择(仅选择最适合的成员)或截断选择(适应度分数大于特定值的成员)。</p><p id="9148" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 4。</strong> <strong class="ih hj">繁殖方法:</strong>在为下一代繁殖成员时使用两种主要方法——a)交叉——父母的染色体在不同的点上随机重组以产生后代；b)突变——父母染色体或产生的后代中的一些基因被翻转以适应数据中的噪声。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es lf"><img src="../Images/a82ef3c8584854cf7c9fbb2e49588c64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*zLDxUsMOnX8be_Ub64C30A.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">解释繁殖过程。</figcaption></figure><h1 id="5274" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">使用TPOT获取最佳算法和最佳参数</h1><h1 id="58e3" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">那么，TPOT是什么？</h1><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es lg"><img src="../Images/24f76eb9e85727003d3ad45d4b272eff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*XF3akvvCtNu3u2745BPBLQ.jpeg"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">冲泡最好的茶</figcaption></figure><p id="c0c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">TPOT是一个使用遗传算法优化机器学习管道的Python AutoML工具。它是在python中的scikit-learn库的基础上构建的，如果您已经熟悉它，它会非常直观。想象一下(从它的标志中进行类比),它就像一个茶壶，冲泡所有的管道、参数和功能，在让它冲泡几分钟(可能是几分钟、几小时甚至几天)后，给你你所希望的最好的管道。</p><h1 id="18b4" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">它是做什么的？</h1><p id="3838" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">它会制作原始数据集的多个副本，创建不同的要素集(多项式要素、PCA等等)，反复移除无关紧要的要素，然后选择最佳的分类/回归算法，最后调整其参数以获得最佳参数。在处理任何经典的ML问题时，它是自动化最乏味的部分。</p><h1 id="2968" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">它做得怎么样？</h1><p id="8c0f" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">要了解它如何优化整个设置，您必须将每个管道视为群体中的一员。现在，每个成员都将接受体能评估(根据你的体能得分)。然后对合适的候选人进行一点调整(如前所述的交叉和变异)，然后再次评估他们的适应性，直到你的耐心耗尽或者TPOT不能进一步提高适应性分数。</p><p id="0898" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">TPOT让您控制选择<strong class="ih hj">种群</strong>大小、<strong class="ih hj">代</strong>数量(类似于迭代次数)、选择您自己的适应度<strong class="ih hj">评分</strong>函数(提供最常用的分数，如‘准确性’、‘f1’、‘负_对数_损失’、‘roc _ AUC’)以及从大量其他超参数中调整的数量(<strong class="ih hj"><em class="lh"/></strong><em class="lh">、</em> <strong class="ih hj"> <em class="lh">交叉率</em> </strong>)</p><p id="e205" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以参考以下链接来更好地了解如何使用该库:</p><ol class=""><li id="ed76" class="kg kh hi ih b ii ij im in iq li iu lj iy lk jc kl km kn ko bi translated"><a class="ae ll" href="http://epistasislab.github.io/tpot/" rel="noopener ugc nofollow" target="_blank">http://epistasislab.github.io/tpot/</a></li><li id="8408" class="kg kh hi ih b ii lm im ln iq lo iu lp iy lq jc kl km kn ko bi translated"><a class="ae ll" href="https://towardsdatascience.com/tpot-automated-machine-learning-in-python-4c063b3e5de9" rel="noopener" target="_blank">https://towards data science . com/tpot-automated-machine-learning-in-python-4c 063 B3 e 5 de 9</a></li></ol><p id="9c32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你想了解更多关于气体的知识，你可以看看这些笔记。</p></div></div>    
</body>
</html>