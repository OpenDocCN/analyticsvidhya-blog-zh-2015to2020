<html>
<head>
<title>Exploratory Data Analysis of Google Fit data with Pandas and Seaborn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索性数据分析Google Fit数据与熊猫和海牛</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/exploratory-data-analysis-of-google-fit-data-with-pandas-and-seaborn-a4369366c543?source=collection_archive---------10-----------------------#2020-06-25">https://medium.com/analytics-vidhya/exploratory-data-analysis-of-google-fit-data-with-pandas-and-seaborn-a4369366c543?source=collection_archive---------10-----------------------#2020-06-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9a387b5a929e87faa7f007abd0ac1fd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oD_bYLm6zxe_TqcDgjiOsA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">安迪·比厄斯在<a class="ae iu" rel="noopener ugc nofollow" target="_blank" href="/s/photos/running-technology?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"> Unsplash </a>上的照片</figcaption></figure><p id="b2c1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇文章中，我想用熊猫来说明谷歌健身数据的探索性数据分析，通过对个人健身活动进行一些可视化来进行一些观察。</p><h2 id="0d02" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">动机</h2><p id="c5df" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">大多数个人健身跟踪设备都有一个应用程序支持，显示一系列分析，让用户有动力实现他们的健身目标。如果你对这种分析的兴趣与应用程序自带的不同，那该怎么办？如果你手里有数据，你更喜欢自己的定制洞察怎么办？</p><p id="53f5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我有这个设备<a class="ae iu" href="https://www.tomsguide.com/us/fossil-q-marshal-smartwatch,review-4417.html" rel="noopener ugc nofollow" target="_blank"> Fossil Q Marshal </a>，运行Google Wear操作系统，并将我的活动数据同步到Google Fit。尽管该手表提供了良好的健身体验，但提供的健身见解却相当枯燥。我的数据分析师思路带我走了不同的路，想知道如何更好地了解我的日常活动。然后我偶然发现了Goolge外卖。</p><h2 id="9cbc" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">谷歌外卖——适合</h2><p id="0982" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">通过<a class="ae iu" href="https://takeout.google.com" rel="noopener ugc nofollow" target="_blank">外卖</a>，谷歌提供了一个导出我们通过不同应用程序获取的个人数据的工具。Google Fit就是其中之一，它提供了一种探索我们所有活动数据历史的方法。拿到这些数据增加了我分析自己一年来活动模式的好奇心。<em class="kt">这种方法不仅限于Google Fit，如果你有不同设备或应用程序的数据，只需稍加调整就可以扩展。</em></p><h2 id="9bbb" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">数据提取和设置</h2><ol class=""><li id="6250" class="ku kv hi ix b iy ko jc kp jg kw jk kx jo ky js kz la lb lc bi translated">前往takeout.google.com</li><li id="b61f" class="ku kv hi ix b iy ld jc le jg lf jk lg jo lh js kz la lb lc bi translated">选择Google Fit并创建导出</li><li id="223a" class="ku kv hi ix b iy ld jc le jg lf jk lg jo lh js kz la lb lc bi translated">收到数据存档可用的通知后，下载并解压缩存档</li></ol><h2 id="7d5e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">档案里有什么？</h2><p id="1fc1" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">该档案由两个文件夹组成，其中包含不同格式的数据。活动文件夹包含TCX(培训中心XML)格式的数据，这是一种封装了活动、时间和地理坐标的数据交换格式。另一个文件夹“每日聚合”包含一组csv文件，模式为yyyy-mm-dd.csv，每天一个文件。每个文件都记录了卡路里、距离、纬度和经度、行走持续时间以及15分钟间隔内的步数。</p><p id="2e9b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">作为第一步，我们需要解析这些csv文件，加载到pandas数据框架中，并执行一些分析，以获得一些我们渴望知道的见解。</p><figure class="li lj lk ll fd ij"><div class="bz dy l di"><div class="lm ln l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">解析2019年的每日聚合</figcaption></figure><p id="8d2f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上面的代码片段</p><ol class=""><li id="eb7d" class="ku kv hi ix b iy iz jc jd jg lo jk lp jo lq js kz la lb lc bi translated">使用pdf.read_csv将每个每日聚合文件(自2019年)解析为数据帧</li><li id="525b" class="ku kv hi ix b iy ld jc le jg lf jk lg jo lh js kz la lb lc bi translated">通过在文件名中添加日期前缀，将时间字段转换为日期时间字段</li><li id="fb83" class="ku kv hi ix b iy ld jc le jg lf jk lg jo lh js kz la lb lc bi translated">将所有数据帧连接成一个带有所需列子集的数据帧</li><li id="6ec3" class="ku kv hi ix b iy ld jc le jg lf jk lg jo lh js kz la lb lc bi translated">应用索引</li></ol><p id="466e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">结果看起来像这样</p><figure class="li lj lk ll fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/3d47c29b38839d3f697690e32a10a74c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*VB443Gg2cuIcmkPGvn7STg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">activity_dttm(活动时间)、消耗的卡路里、移动的距离、步数和时间</figcaption></figure><p id="5df8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这种间隔为15分钟的原始数据需要汇总并汇总到每日。</p><figure class="li lj lk ll fd ij"><div class="bz dy l di"><div class="lm ln l"/></div></figure><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/3167c9d00134b2b789492003f3139980.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EqFrc2NRjCixAKehrCwzRg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">每天的聚合活动数据</figcaption></figure><p id="86d5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这给出了日常活动的图像，适合于进一步的分析。</p><h2 id="bff1" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">问:2019年我最活跃的5天是哪几天？</h2><p id="8b72" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">对step_count应用熊猫nlargest</p><pre class="li lj lk ll fd lt lu lv lw aw lx bi"><span id="8bb3" class="jt ju hi lu b fi ly lz l ma mb">df_daily_group.nlargest(5,"step_count")[["distance_m","step_count","activity_day"]]</span></pre><figure class="li lj lk ll fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/cd869de93adb74c9616060fd33ec0a3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*hIHRPcbb28dUwlaLpTNvTA.png"/></div></figure><p id="1491" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">等等！，一天47公里！！！。我没在手表上做手脚。4月19日至20日和10月5日至6日，我参加了为期两天的徒步活动，全程65公里。</p><h2 id="33f5" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">问:我通常一周走多远？</h2><figure class="li lj lk ll fd ij"><div class="bz dy l di"><div class="lm ln l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">按周分组，并将米转换为公里</figcaption></figure><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/57d4d2abadc4c6fdabe08536c834a406.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uji4Tzfu1FSc1-CkpKfIzQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">2019年的每一周都有公里行走</figcaption></figure><p id="8fd1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我平均一周走25-35公里。在悉尼一年中较温暖的时候(第0-20周和第40-52周)，平均温度更高，约为35度。在一年中较冷的时候，我有点懒，只有35公里，在25-30公里之间波动。</p><p id="9c99" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于我的65公里行走中的两个异常值，所有的星期在图表中都显得矮小了。让我们尝试使用箱线图来分析一个月内的步数分布，箱线图提供了一个更好的视图，显示了度量值如何分布在中位数周围。</p><p id="7225" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了实现这一点和更多的图形，让我们添加更多的列，并以千片为单位归一化步进数，并将它们限制在2K到15K的范围内。</p><figure class="li lj lk ll fd ij"><div class="bz dy l di"><div class="lm ln l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">按月和日分组，标准化步骤并为工作日设置标志</figcaption></figure><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/bd8ac6416cf10e9f877fdff27296b21f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z_un7RMwdPRF1Doa40S2LA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">导出月份、工作日/周末，并将步长归一化为2k到15k之间的千位步长</figcaption></figure><h2 id="eec1" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">问:我的步行距离逐月分布如何？</h2><p id="80ed" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">让我们使用seaborn为每个月的每日步数绘制一个方框图。</p><pre class="li lj lk ll fd lt lu lv lw aw lx bi"><span id="7ee1" class="jt ju hi lu b fi ly lz l ma mb">sns.boxplot(x=df_monthly_group_2019["month"],y=df_monthly_group_2019["step_count_k"])</span></pre><p id="2406" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">方框代表中间50%的测量值除以粗线代表的中值。其余线条描绘了较低的25%和较高的25%分布。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/aa1afb6245158fce56ba46244ec756f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x7wsgM2bsfA8YeEZQGRwPw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">步骤的方框图</figcaption></figure><p id="736a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">解读剧情，</p><ul class=""><li id="a6fc" class="ku kv hi ix b iy iz jc jd jg lo jk lp jo lq js mg la lb lc bi translated">1月和7月我走过了相似的距离，6-12K，中间值为9K</li><li id="c220" class="ku kv hi ix b iy ld jc le jg lf jk lg jo lh js mg la lb lc bi translated">在二月和三月，我增加了8-9K和7-8K步的频率，然后减少了9-13K和8-12K步的频率</li><li id="e049" class="ku kv hi ix b iy ld jc le jg lf jk lg jo lh js mg la lb lc bi translated">在4月和5月，这一趋势发生了逆转。我跑8-10公里的频率减少了，走11-13公里的频率增加了。我在四月和五月一直比前两个月更活跃</li></ul><p id="269a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这种解读不是很直观。尽管箱线图显示了测量值的分布，但它并没有描绘出测量值在四分位数中的频率。</p><p id="9200" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">小提琴情节填补了这一空白。Violin plot通过显示测量值被观察到的频率来说明频率分布，同时在中间嵌入一个方框图，用一个点来表示中值。</p><p id="7cb6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要绘制小提琴图，只需用violin plot替换boxplot。</p><pre class="li lj lk ll fd lt lu lv lw aw lx bi"><span id="8ba6" class="jt ju hi lu b fi ly lz l ma mb">sns.violinplot(x=df_monthly_group_2019["month"],y=df_monthly_group_2019["step_count_k"])</span></pre><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/9ca84af9e19d585b137f95cce9abd872.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*woXoLBdfHV4SfQs1_Jl23w.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">小提琴情节</figcaption></figure><p id="ecf0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">解读剧情，</p><ul class=""><li id="888f" class="ku kv hi ix b iy iz jc jd jg lo jk lp jo lq js mg la lb lc bi translated">一月和七月看起来不再和盒子图中的一样。在一月份，我跑了6K多的天数，在七月份，我跑了11K多。这在一月和六月完全相同的箱形图中并不明显。总的来说，我在七月比一月更活跃。</li><li id="53fe" class="ku kv hi ix b iy ld jc le jg lf jk lg jo lh js mg la lb lc bi translated">二月和三月的较低回合表明我走8-9K和7-8K更频繁</li><li id="ccab" class="ku kv hi ix b iy ld jc le jg lf jk lg jo lh js mg la lb lc bi translated">4月和5月的上一回合表明我走了11-13K更频繁</li></ul><p id="a97d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这种解读比箱线图更直观。</p><p id="50e8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">小提琴情节伴随着许多华而不实的东西。其中之一是在同一个图中用相同的度量表示两个类别。</p><p id="c537" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们来看看我在工作日和周末的步行情况。色调参数可以达到这个目的。提供工作日标志作为色调。</p><pre class="li lj lk ll fd lt lu lv lw aw lx bi"><span id="a786" class="jt ju hi lu b fi ly lz l ma mb">sns.violinplot(x=df_monthly_group_2019["month"],y=df_monthly_group_2019["step_count_k"],hue=df_monthly_group["weekday"],split=True)</span></pre><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/777f15cadf24b43fe0f6b544f1a33303.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qvoecE_BA1-CQB9JLfAjUw.png"/></div></div></figure><p id="53c5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">解读分裂的小提琴曲，</p><ul class=""><li id="3b94" class="ku kv hi ix b iy iz jc jd jg lo jk lp jo lq js mg la lb lc bi translated">在一月，我在工作日和周末的活动几乎是一样的。但在7月，我在周末并不活跃。在4K附近，工作日的交易高于中位数，周末的交易远低于中位数</li><li id="18f6" class="ku kv hi ix b iy ld jc le jg lf jk lg jo lh js mg la lb lc bi translated">在二月和三月，周末和周末的活动几乎相同。在五月，我在周末比平日更活跃</li><li id="4966" class="ku kv hi ix b iy ld jc le jg lf jk lg jo lh js mg la lb lc bi translated">总的来说，我的周末没有工作日活跃</li></ul><h2 id="8f54" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">问:我一周内有多活跃，一天中的哪些时段是活跃的？</h2><p id="50c3" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">为了表现这一点，我需要用一个热图来讲述这个涉及168个小时的故事，以时间轮的形式。</p><p id="b26e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面的代码片段为每小时创建了一个每周活动的枢纽。</p><figure class="li lj lk ll fd ij"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="faef" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">结果呢</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/468d9967ccff8115b804f683c6232bab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uZb-xbrfXAS_QL3Av_RLOA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">每小时走的步数</figcaption></figure><p id="0f52" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是我在<a class="ae iu" href="https://stackoverflow.com/questions/40352607/time-wheel-in-python3-pandas" rel="noopener ugc nofollow" target="_blank"> stackoverflow </a>上找到的一段代码，用来绘制时间轮。这个代码片段将这个数据帧转换成一个圆形热图，每个小时一个圆圈，每天一个圆圈。</p><figure class="li lj lk ll fd ij"><div class="bz dy l di"><div class="lm ln l"/></div></figure><figure class="li lj lk ll fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/5e634cebad53a1745640b2fe18357b2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*kxJD-eq3viiCCTaRVRkRxA.png"/></div></figure><p id="06ad" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从剧情解读，</p><ul class=""><li id="b1d0" class="ku kv hi ix b iy iz jc jd jg lo jk lp jo lq js mg la lb lc bi translated">我一天中最活跃的时间是早上8点到晚上7点</li><li id="35bf" class="ku kv hi ix b iy ld jc le jg lf jk lg jo lh js mg la lb lc bi translated">我的大部分活动都集中在这一周的8，9，16，17小时之间，通常是我的通勤时间</li><li id="7038" class="ku kv hi ix b iy ld jc le jg lf jk lg jo lh js mg la lb lc bi translated">在13-14小时之间活动频繁，这包括我午餐后的散步</li><li id="e602" class="ku kv hi ix b iy ld jc le jg lf jk lg jo lh js mg la lb lc bi translated">我周日的活动量很低</li></ul><p id="288a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">来自这一分析的所有代码都可以在<a class="ae iu" href="https://github.com/vmnamburu/pyfit/blob/master/PyFit_with_Pandas_and_Seaborn.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>作为python笔记本获得。这种分析可以通过关联我所在郊区的天气数据来进一步扩展，并分析模式如何随天气条件而变化。</p></div></div>    
</body>
</html>