<html>
<head>
<title>Predicting Customer Churn in Telecom Industry</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">电信行业客户流失预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predicting-customer-churn-in-telecom-industry-fc7a5a32d358?source=collection_archive---------17-----------------------#2020-03-30">https://medium.com/analytics-vidhya/predicting-customer-churn-in-telecom-industry-fc7a5a32d358?source=collection_archive---------17-----------------------#2020-03-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6105" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我用R或Python解决数据分析/数据科学问题的小实验系列的一部分。这些实验可能是多余的，可能已经被不同的人写在博客上了，但这更多的是个人日记和我个人的学习过程。我希望我能够吸引和激励任何和我经历相似过程的人。如果一个更有见识的人偶然发现了这个博客，并认为有一个更好的方法来做事情，或者我在某些地方出错了，请随时分享反馈，不仅帮助我，而且帮助所有人，作为一个社区一起成长。</p><p id="cc99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">客户流失在任何行业都是一个大问题。毫不奇怪，数据科学家的主要关注点之一是减少客户流失和增加客户保留率。在存在按月计费服务的行业，例如电信、互联网、流媒体服务等，预测和检测相对容易。从组织的角度来看，留住现有客户总是比花钱获得新客户更便宜。</p><p id="397b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我的重点是尝试建立一个简单的模型来预测客户是否会流失。</p><p id="a322" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在这里找到我使用过的<a class="ae je" href="https://www.kaggle.com/gaurangswarge/practice-dataset-predict-customer-churn-telecom" rel="noopener ugc nofollow" target="_blank">的数据集，你可以在这里</a>找到我的<a class="ae je" href="https://github.com/rckclimber/predict_customer_churn" rel="noopener ugc nofollow" target="_blank"> GitHub Repo中的代码。</a></p><p id="f40d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据集</strong></p><p id="5208" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个数据集总共有11列，包括一个称为churn的列，它是我们的因变量，还有10列是我们的预测变量。</p><p id="8b8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将尝试并确定在预测客户流失方面具有重要意义的变量，并尝试建立一个逻辑回归模型来准确预测客户流失。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/bdd2ef1e0df7174813db53be0eafe471.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KJE6kIpnGSmB2IeomWOT0A.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">数据集示例</figcaption></figure><p id="8906" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第一步:导入数据集</strong></p><p id="a586" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，让我们导入R中的数据集，检查变量，并检查数据集中是否有空值或缺失值。同时，我们还应该检查数据集的五点摘要。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es jv"><img src="../Images/631b876d29cd3c982aab218c2addf467.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*SdP-xnrCsEKfhswycCLYXQ.png"/></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jw"><img src="../Images/5d9c044417b756d8f0005e5617e1a52c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DM3JL9wYygqVWJNAI1t1qw.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">没有缺失值</figcaption></figure><p id="eaa5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第二步:转换为因子变量并进行异常值处理</strong></p><p id="05d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如您所见，变量<em class="jd">‘客户流失’，‘合同续签’，‘数据计划’</em>实际上都是因子变量，所以让我们将它们转换成因子。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es jx"><img src="../Images/dd8203e018a1c28c910ccc21a2bb3fea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*yXzG3NqjrVl_DmZK6RHmQw.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">转换为因子变量</figcaption></figure><p id="ede3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一步是处理异常值，因为异常值可能会影响我们的模型性能。在我们上面的五点总结中，我注意到对于变量<em class="jd"> AccountWeeks </em>、<em class="jd"> DataUsage、CustServCalls </em>，第三象限值和最大值之间存在巨大差异，这表明这些变量可能存在异常值，让我们相应地检查并处理它们。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jy"><img src="../Images/3c3cdc8271948faf97bbc0addd033ae8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xdpYx4sDINrjVCE4kt9uCQ.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">异常值处理</figcaption></figure><p id="5fcf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，由于怀疑这些变量中存在很少的异常值，我将变量限制在第99个百分位数，以获得数据的均匀分布。</p><p id="17cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">变量<em class="jd"> DayMins、DayCalls、MonthlyCharge、RoamMins、OverageFee、</em>的重置似乎在可接受的范围内，没有任何异常值，所以我认为我们不需要限制其中任何一个。</p><h2 id="32af" class="jz ka hi bd kb kc kd ke kf kg kh ki kj iq kk kl km iu kn ko kp iy kq kr ks kt bi translated">步骤3:创建虚拟变量</h2><p id="4704" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">下一步是为我们所有的分类变量创建虚拟变量，如果你不知道虚拟变量是什么，那么这里是来自<a class="ae je" href="https://socialresearchmethods.net/kb/dummyvar.php" rel="noopener ugc nofollow" target="_blank">socialresearchmethods.net</a>的解释</p><blockquote class="kz la lb"><p id="fddf" class="if ig jd ih b ii ij ik il im in io ip lc ir is it ld iv iw ix le iz ja jb jc hb bi translated">虚拟变量是回归分析中使用的数值变量，用于表示研究中样本的子组。在研究设计中，虚拟变量通常用于区分不同的治疗组。在最简单的情况下，我们将使用一个0，1虚拟变量，其中如果一个人在对照组中，则给该人一个0值，如果在治疗组中，则给该人一个1值。虚拟变量是有用的，因为它们使我们能够用一个回归方程来代表多个群体。这意味着我们不需要为每个子群写出单独的方程模型。虚拟变量就像<strong class="ih hj">“开关”</strong>一样，在一个方程中打开和关闭各种参数。0，1虚拟编码变量的另一个优点是，即使它是一个名义水平变量，你也可以在统计上把它当作一个区间水平变量</p></blockquote><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lf"><img src="../Images/db10b09058fbf0f9762b71d5ad623c20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qbjo9xfR7BreUEUTtcMHXw.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">创建虚拟变量</figcaption></figure><p id="685d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一步是从每个分类变量中移除一个虚拟变量，这样我们总共有(n-1)个虚拟变量。</p><p id="637d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第四步:划分数据</strong></p><p id="7708" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们将数据集拆分为训练数据集和测试数据集，按照惯例，我们将进行70:30的拆分。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lg"><img src="../Images/0770e94bcf7c4a1a49cb6cdf36e1b8b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*4xysPfXPNxXEBnN9p913fg.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">划分数据集</figcaption></figure><p id="6d59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤5:第一个模型的时间</strong></p><p id="f63b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好的，让我们建立第一个包含所有变量的逻辑回归模型。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lh"><img src="../Images/19eea446e27e47ae4e5a8af3d167b13d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*4QeQs_OlyalLzG1ODEKC7w.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">第一个模型</figcaption></figure><p id="c76d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，该模型显示有3个变量对预测流失有重要意义，<em class="jd">contract renewal _ Not _ Renewed</em>(负面影响)<em class="jd">、CustServCalls</em>&amp;<em class="jd">roam mins</em></p><p id="ac75" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另外，请注意AIC得分为1383.2。具有最小AIC分数的模型将是最优选和优化的模型。</p><blockquote class="kz la lb"><p id="3a56" class="if ig jd ih b ii ij ik il im in io ip lc ir is it ld iv iw ix le iz ja jb jc hb bi translated">AIC:赤池信息标准(AIC)是对一组给定数据的统计模型的相对质量的衡量。给定数据的模型集合，AIC估计每个模型相对于其他每个模型的质量。</p></blockquote><p id="0b45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，既然我们已经建立了考虑所有预测因素的初始回归模型，让我们检查它的显著性</p><p id="14ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤6:检查模型显著性和稳健性</strong></p><p id="9bfc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们使用对数似然比检查模型的显著性</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es li"><img src="../Images/6bd122db25982c8230aaa1848c406ae8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*TcHWd5hU_hs3jC9Y46kJYg.png"/></div></figure><p id="5781" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">对数似然比检验的解释:</strong> <br/> H0:所有beta为零<br/> H1:至少有1个beta非零<br/>从对数似然中我们可以看出，截距只有model -859.04方差是我们未知的。<br/>当我们采用完整模型时，我们不知道-680.61方差。<br/>所以我们可以说，1 -(-680.61 /- 859.04)= 20.77%的仅截距模型固有的不确定性是由全模型校准的。Chisq似然比显著。p值也表明我们可以接受另一个假设，即至少有一个β不为零。所以模型很重要。</p><p id="2aeb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">模型稳健性:</strong>接下来我们检查我们的模型是否稳健？<strong class="ih hj"> </strong>利用麦克法登的伪R平方检验</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lj"><img src="../Images/6862c02a62912fa8ecb75ca6b21efe16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*brMvnikDlLy3MJQs8K4leg.png"/></div></figure><p id="3496" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">麦克法登的伪R平方检验表明，我们的模型捕获了至少20.77%的数据方差，这表明它是一个稳健的模型。</p><p id="48d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">回到我们第一个模型的输出，我们注意到3个变量在预测客户流失方面很重要，</p><p id="0aa5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">contract renewal _ Not _ Renewed，CustServCalls &amp; RoamMins </em></p><p id="450b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，合同续签这一分类变量对客户流失有负面影响。</p><p id="389a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，我们需要找出是否有更重要的变量，我们需要考虑？</p><p id="b019" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们找出影响客户流失的变量的赔率和概率的力量。</p><p id="9b6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第七步:赔率解释力</strong></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lk"><img src="../Images/8d23726766e6b4f55e6ee6a9d2e3e5d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*rfXQ3-Fr2hE-upvdPTi7pA.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">让步比</figcaption></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es ll"><img src="../Images/221a288905a6e2e9f28101af722a7f5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*TUMCrpdg5ls9IqiYbVndzg.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">赔率概率</figcaption></figure><p id="d757" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解释:</strong>如果下表所示的特定变量增加“一个单位”，客户流失(与未流失相比)的几率和客户流失的概率如下表所示。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es lm"><img src="../Images/33c5680fe133335f79e5c8215d46ed11.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*mvd8N00zJgP23axsGbt9BQ.png"/></div></figure><p id="23d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于分类变量，例如，当客户续约时，与客户续约时相比，客户流失的几率为0.12。同样，当客户选择数据计划时，客户流失的几率是不选择数据计划时的0.32。这告诉我们，在我们的模型中，还应该考虑其他重要的变量。</p><p id="551e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第8步:模型准确性:混淆矩阵<br/> </strong>既然我们已经确认了存在额外的重要变量，让我们使用分类表/混淆矩阵来检查我们模型的性能。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ln"><img src="../Images/572cbf0728e76eeb26421fecfcc4a3f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*D9ihKJ-FifBTc-ddQRVOTA.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">混淆矩阵</figcaption></figure><p id="fb05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">释义:</strong><br/>(287+1821)个客户中有1821个被正确识别并被转出。这相当于86.3%的阳性预测值。<br/>(10+13)个客户中有10个被正确识别，且未被大量生产。这相当于76.9%的阴性预测值。<br/>在86.3 %，该模型提供了良好的准确性措施。<br/>敏感性为0.99，特异性为0.033</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lo"><img src="../Images/19c2ac339a00d0d9f6cdebdd55fd45b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*oPdZSKPmjnhpXs9kqglwzQ.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">混淆矩阵测验</figcaption></figure><p id="c563" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解释:</strong><br/>(181+1024)个客户中有1024个被正确识别并被转出。这相当于84.9%的阳性预测值。<br/>(5+2)个客户中有5个被正确识别，且未被大量生产。这相当于71.4%的阴性预测值。<br/>在84.9 %时，该模型提供了良好的准确性度量。<br/>敏感性为0.998，特异性为0.026</p><p id="5e0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，该模型在训练和测试数据集上表现出非常相似的性能。</p><p id="89bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">进一步的步骤:模型提炼</strong></p><p id="0388" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">到目前为止，我们检查了模型的显著性，稳健性，准确性，我们对目前的情况相当满意。我们可以在这里结束我们的模型并继续前进，但我们不应该这样做。我们可以进一步改进我们的模型，以提高模型的准确性。之前，当我们检查优势比时，我们发现了一些变量，这些变量对于预测客户是否会流失非常重要。我们的下一步应该是:</p><ol class=""><li id="ba3d" class="lp lq hi ih b ii ij im in iq lr iu ls iy lt jc lu lv lw lx bi translated">变量选择(我们可以使用step()函数)</li><li id="958f" class="lp lq hi ih b ii ly im lz iq ma iu mb iy mc jc lu lv lw lx bi translated">检查模型的显著性、稳健性和准确性</li><li id="50bf" class="lp lq hi ih b ii ly im lz iq ma iu mb iy mc jc lu lv lw lx bi translated">最终解释结果</li></ol><p id="accf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">高级主题包括，理解变量的相互作用和进一步完善模型。</p><p id="3779" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望这对阅读的人有所帮助:)。如果您有任何疑问或需要澄清，请告诉我。</p></div></div>    
</body>
</html>