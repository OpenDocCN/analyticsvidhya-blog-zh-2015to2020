<html>
<head>
<title>How to make GUI in python for data analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用python制作用于数据分析的GUI</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-make-gui-in-python-for-data-analysis-f5cee63f4ff8?source=collection_archive---------2-----------------------#2020-01-24">https://medium.com/analytics-vidhya/how-to-make-gui-in-python-for-data-analysis-f5cee63f4ff8?source=collection_archive---------2-----------------------#2020-01-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/60320e5888176bf68c20903261118a44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*G6MRrosE6RI5XDh2LMgdvg.png"/></div></figure><p id="7f33" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我写了一篇关于如何使用Excel VBA制作数据分析管道的中型文章。它很好地满足了我的大部分需求。但是Excel并不是处理大数据的好工具。我们需要处理的数据不断增加。</p><p id="4ee0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以我写了一个python程序来处理我的数据分析工作。在本文中，我将概述我为数据分析任务创建python程序所采取的步骤。</p><p id="3127" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们在excel数据表中有以下数据。</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div class="er es jl"><img src="../Images/e62e8534581ab44bc97b4af9dc33619e.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*_KrqFrerI2JZap-KMYec8g.png"/></div></figure><p id="3178" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们有一个跨不同群体和地点的用户列表。收入和费用列包含每个用户给公司带来的收入和费用。</p><p id="2d97" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们希望创建以下报告</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div class="er es jq"><img src="../Images/cc065d20bd5942f89728464a0bf0c36a.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*4EENAH7HJEw_KH1GFsH7zA.png"/></div></figure><p id="7885" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">对于每个组，我们希望合并收入和用户数量。在上一篇文章中，我使用excel创建了这个表。现在我将展示如何用Python创建这个表。</p><p id="5349" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我正在使用Python 3.6.9和Pandas 0.22进行数据分析。你可以按照这个<a class="ae jk" href="https://www.liquidweb.com/kb/install-pip-windows/" rel="noopener ugc nofollow" target="_blank">网站</a>上的说明安装python和pip。之后，您可以使用pip安装任何python库。只需在cmd上运行以下命令。</p><pre class="jm jn jo jp fd jr js jt ju aw jv bi"><span id="c8d9" class="jw jx hi js b fi jy jz l ka kb">pip install library_name</span></pre><p id="fb75" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后我们首先导入熊猫图书馆</p><pre class="jm jn jo jp fd jr js jt ju aw jv bi"><span id="69ee" class="jw jx hi js b fi jy jz l ka kb">import pandas</span></pre><p id="63dc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在接下来的几个步骤中，我将展示制作GUI的代码。</p><p id="b21f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 1。读取文件</strong></p><p id="da5b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以使用下面的代码读取数据文件</p><pre class="jm jn jo jp fd jr js jt ju aw jv bi"><span id="fdb3" class="jw jx hi js b fi jy jz l ka kb">data = pandas.read_excel(‘data.xls’)</span></pre><p id="f435" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这将加载pandas的Dataframe对象中的数据。你可以在这里阅读更多关于熊猫<a class="ae jk" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html" rel="noopener ugc nofollow" target="_blank">的Dataframe API。Dataframe在结构上类似于Excel表格。数据以类似于Excel的行列结构存储在Dataframe对象中。您可以像Excel一样通过引用行号和列号来访问Dataframe中的特定数据。此外，您可以通过引用数据的行名和列名来访问数据。</a></p><p id="10e9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 2。创建表格</strong></p><p id="55e8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以通过下面的代码创建所需的表</p><pre class="jm jn jo jp fd jr js jt ju aw jv bi"><span id="371c" class="jw jx hi js b fi jy jz l ka kb">groups = data.groupby('Group')<br/>table = groups.agg({'Revenue':sum, 'Group': len})</span></pre><p id="7e62" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">pandas的Groupby功能根据指定列中的数据将数据分成不同的组。你可以在这里阅读更多关于Groupby API <a class="ae jk" href="https://pandas.pydata.org/pandas-docs/stable/reference/groupby.html" rel="noopener ugc nofollow" target="_blank">的内容。</a></p><p id="5599" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们将agg函数应用于Groupby创建的组。我们为数据中“收入”列的聚合指定了sum函数，为“组”列的聚合指定了len函数。最终结果是包含每个组的总收入和用户数量的表格。</p><p id="72e3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 3。保存表格</strong></p><p id="e184" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，我们可以使用以下代码保存输出表</p><pre class="jm jn jo jp fd jr js jt ju aw jv bi"><span id="f50d" class="jw jx hi js b fi jy jz l ka kb">table.to_csv('table.csv')</span></pre><p id="b245" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这将把输出表保存为代码工作目录中的“table.csv”文件。</p><p id="0582" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 4。Jupyter笔记本</strong></p><p id="991a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">以上所有代码我们都可以在Jupyter notebook中执行。这是我执行数据分析任务的常用工具。您可以在jupyter notebook中交互式地执行您的代码。您不仅可以处理数据，还可以在笔记本中查看和绘制数据。</p><p id="7aa4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果你想与之共享代码的人也是程序员，那么你可以和他们共享你的代码。</p><p id="0e3b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 5 Tkinter GUI </strong></p><p id="afff" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">否则，您希望为非程序员提供GUI来与您的代码进行交互。对于用python创建GUI，Tkinter库是最好的库之一。</p><p id="325d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以我用Tkinter为上面的代码做了一个图形用户界面，如下所示。</p><figure class="jm jn jo jp fd ij"><div class="bz dy l di"><div class="kc kd l"/></div></figure><p id="c3da" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当您运行上面的代码时，会弹出如下所示的GUI</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div class="er es ke"><img src="../Images/28858a855b94a2d1153a1c21fa140cef.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*2VprXQbHu3ZxJ6btb5FSiw.png"/></div></figure><p id="a111" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">GUI就像在无限循环中运行的代码。在上面的代码中，第18行和第25行之间的代码运行了一次。然后python程序等待诸如点击按钮、菜单、鼠标悬停等事件。在我们的代码中，名为“生成表格”的按钮链接到分析函数。当用户点击“生成表格”按钮时，分析功能被调用。</p><p id="2295" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">分析功能通过窗口提示要求数据文件。选择文件后，数据将被处理。该函数要求保存名称，并用指定的名称保存文件。</p><p id="3826" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 6。用pyinstaller编译</strong></p><p id="4b9c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后，要分发程序，您需要使用pyinstaller库创建一个可执行文件。首先，您必须安装pyinstaller库。然后，您需要将步骤5中的代码保存为“filename.pyw”。请注意。pyw扩展。如果您在python代码中使用tkinter，那么您需要保存它。pyw扩展，然后通过pyinstaller运行它。</p><p id="eeaf" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后打开命令提示符，进入代码所在的目录，在cmd中运行以下命令</p><pre class="jm jn jo jp fd jr js jt ju aw jv bi"><span id="66be" class="jw jx hi js b fi jy jz l ka kb">pyinstaller --noconsole --onefile filename.pyw</span></pre><p id="c961" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这将在当前目录的“dist”子文件夹中保存“filename.exe”。您可以分发该可执行文件供组织中的其他人使用。</p><p id="2928" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">总结</strong></p><p id="72f9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">从Excel跳到python语言是令人畏惧的。你不仅要学习python编程语言，还要学习很多库，比如pandas和numpy。</p><p id="7db3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然而一旦你掌握了库和语言。Python为数据分析提供了更强大的功能。</p><p id="3438" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在本文中，我只想对制作数据分析GUI所需的每个库进行基本介绍。在接下来的几篇文章中，我将详细介绍它们。</p><p id="06b1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">接下来，我将写如何使用熊猫图书馆做常见的excel任务。</p></div></div>    
</body>
</html>