<html>
<head>
<title>Building iOS Chatbot with Dialogflow ES and CX</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Dialogflow ES和CX构建iOS聊天机器人</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/building-ios-chatbot-with-dialogflow-es-and-cx-51c4e99f9270?source=collection_archive---------1-----------------------#2018-12-20">https://medium.com/analytics-vidhya/building-ios-chatbot-with-dialogflow-es-and-cx-51c4e99f9270?source=collection_archive---------1-----------------------#2018-12-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b8c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将分享使用Dialogflow构建iOS聊天机器人的步骤。你需要为一个iOS应用程序使用<a class="ae jd" href="https://dialogflow.com/" rel="noopener ugc nofollow" target="_blank"> Dialogflow </a>和<a class="ae jd" href="https://www.kommunicate.io/" rel="noopener ugc nofollow" target="_blank">komunicate</a>来构建一个示例聊天机器人。</p><p id="7834" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是一个在iOS中使用Dialogflow和komunicate开发的komunicate支持Bot的例子。我们实际上在我们的网站上使用这个机器人。如果你想看机器人的实际操作，<a class="ae jd" href="https://www.kommunicate.io/blog/building-ios-chatbot-with-dialogflow-api-ai/" rel="noopener ugc nofollow" target="_blank">点击这里</a>。</p><p id="cc98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们在iOS SDK 中支持Swift和Objective C两种语言，并且我们已经使用CocoaPod使添加变得非常容易。可操作的富消息驱动的机器人可以根据用户是否在聊天中进行一般查询、技术查询、只是结帐或安排演示来回复。</p><p id="e1ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://dashboard.kommunicate.io/signup" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">创建免费聊天机器人</strong> </a></p><p id="73cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以使用现有的Dialogflow bot或checkout <a class="ae jd" href="https://docs.kommunicate.io/docs/bot-samples" rel="noopener ugc nofollow" target="_blank"> bot samples </a>来构建自己的合格bot。从下载Kommunicate支持机器人，并将其导入您的Dialogflow帐户。</p><p id="b0e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们知道跳转到这个职位的关键。</p><h1 id="d291" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">使用Dialogflow构建iOS聊天机器人的分步指南</h1><h1 id="72d3" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">步骤1:在Kommunicate中设置一个帐户</h1><p id="7b56" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">这相当简单。你可以在Kommunicate获得一个免费账户。<a class="ae jd" href="https://dashboard.kommunicate.io/signup" rel="noopener ugc nofollow" target="_blank">注册</a>并导航到<a class="ae jd" href="https://dashboard.kommunicate.io/bots/bot-integrations" rel="noopener ugc nofollow" target="_blank">机器人集成部分</a>。点击Dialogflow ES或CX集成。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kh"><img src="../Images/1d683ea163d0b3abb20d7be5f6fcf85d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zYhNSJrUAo_RKbPLF3ztng.png"/></div></div></figure><p id="5359" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，导航到您的Google cloud控制台，下载服务帐户密钥文件。以下是查找文件的步骤:</p><ol class=""><li id="ece2" class="kt ku hi ih b ii ij im in iq kv iu kw iy kx jc ky kz la lb bi translated">登录<a class="ae jd" href="https://dialogflow.cloud.google.com/#/login" rel="noopener ugc nofollow" target="_blank">对话流ES控制台</a></li><li id="3390" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">前往谷歌云控制台中的<a class="ae jd" href="https://console.cloud.google.com/apis/credentials/serviceaccountkey" rel="noopener ugc nofollow" target="_blank">创建服务账户密钥</a>。确保您选择了正确的项目，并从<strong class="ih hj">服务账户列表</strong>中选择<strong class="ih hj">新服务账户</strong></li><li id="9aa4" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">在“服务帐户名称”字段中，输入名称</li><li id="bc6b" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">从<strong class="ih hj">角色</strong>列表中，选择<strong class="ih hj">项目&gt;所有者</strong></li><li id="2f38" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">单击创建。一个JSON文件，包含下载到您计算机的密钥</li><li id="0d8c" class="kt ku hi ih b ii lc im ld iq le iu lf iy lg jc ky kz la lb bi translated">上传<strong class="ih hj">服务账户私钥(JSON) </strong></li></ol><p id="21d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你也可以参考这个<a class="ae jd" href="https://docs.kommunicate.io/docs/bot-dialogflow-integration#integration-using-dialogflow-es" rel="noopener ugc nofollow" target="_blank">文档</a>来了解与Kommunicate的Dialogflow集成。</p><p id="e42e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要将<strong class="ih hj"> Dialogflow CX </strong>集成到komunicate中，请遵循相同的说明下载JSON密钥，并在komunicate仪表板中提及<strong class="ih hj">代理Id </strong></p><p id="5a9e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">获取代理Id </strong>:转到<strong class="ih hj">对话流CX控制台</strong> &gt; &gt; <strong class="ih hj">在您创建的代理中选择项目</strong> &gt; &gt;将代理名称复制到剪贴板将采用下面提到的格式，其中代理Id为<code class="du lh li lj lk b">54b0c663-2c01-4a09-a482-277ff39c0b05</code></p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ll"><img src="../Images/a98b4a6900e88fecf8ebbb2a5fa75893.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LkwvnEicbZqnBX6MHkJG3w.png"/></div></div></figure><p id="b19c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">设置您的机器人的名称和个人资料图片，并选择是否允许<a class="ae jd" href="https://www.kommunicate.io/blog/chatbot-human-handoff/" rel="noopener ugc nofollow" target="_blank">机器人向人类移交</a>您新创建的机器人。点击<strong class="ih hj">完成机器人集成设置</strong>，瞧，你的机器人现在集成了。</p><p id="42dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以在两个地方检查新创建的bot:</p><p id="7026" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">仪表盘→机器人集成→管理机器人</strong>:你可以在这里查看你所有集成的机器人。</p><p id="6653" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">仪表盘→机器人集成</strong>:你的Dialogflow图标应该是绿色的，显示你已经成功集成的机器人数量。</p><p id="6f65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦你创建了一个机器人，你就可以在点击<a class="ae jd" href="https://dashboard.kommunicate.io/settings/conversation-rules" rel="noopener ugc nofollow" target="_blank">对话路由部分</a>中将其设置为默认机器人，如下所示。<strong class="ih hj">设置</strong>-&gt;-<strong class="ih hj">对话规则-&gt;-</strong>然后点击下方的bot like，选择你的bot</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lm"><img src="../Images/b3a9e25239dfac181a4e3783f2ced9c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6akvoSZ18X9yVPbXE7iOTw.png"/></div></div></figure><p id="7950" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，这个机器人会在所有对话中回复。</p><h1 id="1c5f" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">第二步:安装和设置Dialogflow集成iOS聊天机器人SDK到您的应用程序中</h1><p id="bc58" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">在这一步中，您需要将Kommunicate iOS SDK添加到您的应用中。安装Kommunicate SDK它带有预配置的Dialogflow集成。按照以下说明将iOS SDK添加到您的应用中:</p><p id="8ca0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://dashboard.kommunicate.io/signup" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">免费试用30天</strong> </a></p><p id="546a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">初始化CocoaPods: </strong></p><p id="eb49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可通过椰子传播。要安装它，只需将下面一行添加到您的Podfile中:</p><pre class="ki kj kk kl fd ln lk lo lp aw lq bi"><span id="10ef" class="lr jf hi lk b fi ls lt l lu lv">pod 'Kommunicate'</span></pre><p id="d4e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是pod文件最终的样子</p><pre class="ki kj kk kl fd ln lk lo lp aw lq bi"><span id="f755" class="lr jf hi lk b fi ls lt l lu lv">target 'MyTargetName' do use_frameworks! pod 'Kommunicate' End</span></pre><p id="cc8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在项目终端文件夹中运行pod install</p><pre class="ki kj kk kl fd ln lk lo lp aw lq bi"><span id="c36f" class="lr jf hi lk b fi ls lt l lu lv">pod install</span></pre><p id="f92f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">安装完成后，您可以通过调用以下方法来初始化SDK:</p><p id="fdbb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">设置应用id: </strong></p><pre class="ki kj kk kl fd ln lk lo lp aw lq bi"><span id="2464" class="lr jf hi lk b fi ls lt l lu lv">Kommunicate.setup(applicationId:&lt;Your App ID&gt;)</span></pre><p id="fd71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以在您需要使用下面的<a class="ae jd" href="https://dashboard.kommunicate.io/settings/install" rel="noopener ugc nofollow" target="_blank">安装部分</a>注册用户中获得您唯一的应用程序ID。如果在任何文件中，你想使用komunicate，不要忘记用<strong class="ih hj">导入komunicate来导入框架。</strong><strong class="ih hj">komunicate . register在开始聊天前使用</strong> r方法，传递用户的userId和email。<strong class="ih hj">登录用户通信:</strong></p><pre class="ki kj kk kl fd ln lk lo lp aw lq bi"><span id="4604" class="lr jf hi lk b fi ls lt l lu lv">let kmUser = KMUser()<br/>kmUser.userId = userId <br/>// Pass userId here NOTE : +,*,? are not allowed chars in userId.<br/>kmUser.email = emailId // Optional<br/><br/>// Use this same API for login<br/>Kommunicate.registerUser(kmUser, completion: {<br/>    response, error in<br/>    guard error == nil else {return}<br/>    print(" login Success ") <br/>    // You can launch the chat screen on success of login<br/>})</span></pre><p id="9bcc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意:</strong>在用户登录Kommunicate之前，您需要使用<strong class="ih hj">komunicate . setup(</strong>application Id<strong class="ih hj">:&lt;您的应用ID &gt; ) </strong>，以便在启动阶段设置应用ID</p><h1 id="8150" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">第三步:发送和接收信息</h1><p id="2d32" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">现在，您可以通过聊天屏幕将有效负载数据发送到Dialogflow，并从Dialogflow代理获得文本响应。Kommunicate提供了一个现成的聊天UI，因此在这一步中只需要启动聊天屏幕。</p><pre class="ki kj kk kl fd ln lk lo lp aw lq bi"><span id="0451" class="lr jf hi lk b fi ls lt l lu lv">let kmConversation =<br/>    KMConversationBuilder()<br/>        .useLastConversation(true)<br/>        .build()<br/>Kommunicate.createConversation(conversation: kmConversation) { result in<br/>    switch result {<br/>    case .success(let conversationId):<br/>        print("Conversation id: ",conversationId)<br/>        DispatchQueue.main.async {<br/>            Kommunicate.showConversationWith(<br/>                groupId: conversationId,<br/>                from: self,<br/>                completionHandler: { success in<br/>                    print("conversation was shown")<br/>            })<br/>        }<br/>    case .failure(let kmConversationError):<br/>        print("Failed to create a conversation: ", kmConversationError)<br/>    }<br/>}</span></pre><p id="f197" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以在此处参考对话部分<a class="ae jd" href="https://docs.kommunicate.io/docs/ios-conversation#new-conversation" rel="noopener ugc nofollow" target="_blank">的更多文档。</a>运行iOS项目，用Dialogflow bot聊天。只需几个简单的步骤，您就可以轻松地将Dialogflow集成到iOS应用中。如果您需要更多信息，请查阅<a class="ae jd" href="https://docs.kommunicate.io/docs/ios-installation" rel="noopener ugc nofollow" target="_blank">komunicate iOS文档。</a>这里有一些iOS应用程序的示例聊天屏幕，带有Dialogflow和Kommunicate。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es lw"><img src="../Images/c771b5ee87861dcdbe22db15e45eb1a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/1*qYxON_WtzL4Q763TUYfCVA.gif"/></div></figure><p id="2388" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">komunicate示例应用:</strong>点击 从<a class="ae jd" href="https://github.com/Kommunicate-io/Kommunicate-iOS-SDK" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">下载示例应用，其中包括可以使用的Kommunicate iOS SDK</strong></a></p><p id="441b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Dialogflow iOS SDK客户端:</strong></p><p id="c29c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Dialogflow提供了iOS客户端SDK，可以轻松地在苹果设备上集成语音识别和API.ai自然语言处理API。</p><p id="7fc4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您希望开发自己的聊天实现，并且可以直接将Dialogflow集成到您的iOS应用程序中，而无需Kommunicate SDK，那么可以集成Github的以下SDK—<a class="ae jd" href="https://github.com/dialogflow/dialogflow-apple-client" rel="noopener ugc nofollow" target="_blank">dialog flow iOS客户端SDK </a>。</p><p id="4eda" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">相关岗位:<br/> 1。<a class="ae jd" href="https://www.kommunicate.io/blog/build-chatbot-with-dialogflow-android-sdk/" rel="noopener ugc nofollow" target="_blank">用Dialogflow (API.ai) </a> <br/> 2构建安卓聊天机器人。<a class="ae jd" href="https://www.kommunicate.io/blog/how-to-integrate-bot-using-dialogflow-in-kommunicate-1ac32911a7d0/" rel="noopener ugc nofollow" target="_blank">将Dialogflow (Api.ai) Bot集成到网站中</a></p><p id="87f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://dashboard.kommunicate.io/signup" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">免费试用</strong> </a></p></div><div class="ab cl lx ly gp lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="hb hc hd he hf"><p id="2a31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="me">原载于</em><a class="ae jd" href="https://www.kommunicate.io/blog/building-ios-chatbot-with-dialogflow-api-ai/" rel="noopener ugc nofollow" target="_blank"><em class="me">https://www . komunicate . io</em></a></p></div></div>    
</body>
</html>