<html>
<head>
<title>Deploying Nextcloud and MySQL On Elastic Kubernetes Service &amp; Efs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在弹性Kubernetes服务和Efs上部署Nextcloud和MySQL</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/deploying-nextcloud-and-mysql-on-elastic-kubernetes-service-efs-ae3d23e8c2ff?source=collection_archive---------21-----------------------#2020-07-15">https://medium.com/analytics-vidhya/deploying-nextcloud-and-mysql-on-elastic-kubernetes-service-efs-ae3d23e8c2ff?source=collection_archive---------21-----------------------#2020-07-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/dcc58a1b37341f09fbe6728081e80c8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hNxvyyuebBcXR4L34uBcjA.jpeg"/></div></figure><h1 id="29d6" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated"><strong class="ak">亚马逊EKS </strong></h1><p id="cce6" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">亚马逊弹性Kubernetes服务(亚马逊EKS)是一项托管服务，使您可以轻松地在AWS上运行Kubernetes，而无需建立或维护自己的Kubernetes控制面板。Kubernetes是一个开源系统，用于自动化容器化应用程序的部署、扩展和管理。由于其安全性、可靠性和可扩展性，英特尔、Snap、Intuit、GoDaddy和Autodesk等客户信任EKS来运行他们最敏感和最关键的应用程序。为了更多的理解</p><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es ki"><img src="../Images/b873249c221f233d72f3cf7e1f420aa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*zBfBvQv3sJtqkX6H7p7s9w.jpeg"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">亚马逊EKS</figcaption></figure><h1 id="7d63" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated"><strong class="ak">EKS的好处</strong></h1><p id="0a71" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">AWS平台的规模、可靠性和可用性，以及与AWS网络和安全服务的集成，例如用于负载分配的应用负载平衡器、用于基于角色的访问控制的身份访问管理器(IAM)</p><p id="2919" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">在EKS的顶部，我们已经开发了NextCloud并使用MySql作为数据库<strong class="jm hj">，那么什么是Next Cloud </strong>？</p><h1 id="7e88" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated"><strong class="ak"> NextCloud </strong></h1><p id="bf01" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">Nextcloud是一套用于创建和使用文件托管服务的客户端-服务器软件。Nextcloud是免费和开源的，这意味着任何人都可以在自己的私人服务器设备上安装和操作它。Nextcloud应用程序在功能上类似于Dropbox、Office 365或Google Drive，但可以用于家庭本地计算机或异地文件存储托管。</p><h1 id="1404" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated"><strong class="ak"> MYSQL </strong></h1><p id="5fde" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">MySQL 是一个关系数据库，通常用于存储与PHP协同工作的网站的数据。关系意味着数据库的不同表可以相互交叉引用。SQL代表“结构化查询语言”，它是用于与数据库交互的标准语言</p><h1 id="76d9" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated"><strong class="ak">我们在这里咕……</strong></h1><p id="2a98" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated"><strong class="jm hj">本次部署的前提条件</strong></p><p id="c309" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated"><strong class="jm hj"> 1-aws cli </strong></p><p id="94e1" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated"><strong class="jm hj">2-库贝克特尔</strong></p><p id="26fe" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">3-eksctl </p><p id="b51c" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">首先，我们将<strong class="jm hj">创建一个IAM用户</strong>来通过命令行访问AWS EKS</p><blockquote class="kw kx ky"><p id="d2e3" class="jk jl kz jm b jn kr jp jq jr ks jt ju la kt jx jy lb ku kb kc lc kv kf kg kh hb bi translated">点击添加用户</p></blockquote><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es ld"><img src="../Images/bb35fe4896ee6f0aae7fb3e66568ffe5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lgze0zoWZnMt_04ODLOELg.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated"><a class="ae li" href="https://console.aws.amazon.com/iam" rel="noopener ugc nofollow" target="_blank">https://console.aws.amazon.com/iam</a></figcaption></figure><blockquote class="kw kx ky"><p id="c040" class="jk jl kz jm b jn kr jp jq jr ks jt ju la kt jx jy lb ku kb kc lc kv kf kg kh hb bi translated">给<strong class="jm hj">用户名</strong>、<strong class="jm hj">编程访问</strong>，这样用户将获得<strong class="jm hj">访问密钥和密钥</strong></p></blockquote><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es lj"><img src="../Images/a55dfc71cf595b5bcad4165bfc6611c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ApbPaCcM48dTABcMRAhszA.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated"><a class="ae li" href="https://console.aws.amazon.com/iam" rel="noopener ugc nofollow" target="_blank">https://console.aws.amazon.com/iam</a></figcaption></figure><blockquote class="kw kx ky"><p id="1051" class="jk jl kz jm b jn kr jp jq jr ks jt ju la kt jx jy lb ku kb kc lc kv kf kg kh hb bi translated">点击<strong class="jm hj">附加现有策略</strong>并选择<strong class="jm hj">管理员访问</strong>，然后选择<strong class="jm hj">下一个标签</strong></p></blockquote><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es lk"><img src="../Images/5f1cc01ec12621f6b89945c4c45f0f67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5kB3AsHtkh2d62ViybUjlQ.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated"><a class="ae li" href="https://console.aws.amazon.com/iam" rel="noopener ugc nofollow" target="_blank">https://console.aws.amazon.com/iam</a></figcaption></figure><blockquote class="kw kx ky"><p id="c4b6" class="jk jl kz jm b jn kr jp jq jr ks jt ju la kt jx jy lb ku kb kc lc kv kf kg kh hb bi translated">添加标签，如果你想继续，然后<strong class="jm hj">下一步</strong>和<strong class="jm hj">创建用户</strong></p><p id="d621" class="jk jl kz jm b jn kr jp jq jr ks jt ju la kt jx jy lb ku kb kc lc kv kf kg kh hb bi translated">点击<strong class="jm hj">创建用户后，下载密钥</strong></p></blockquote><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es ll"><img src="../Images/ab4ace12babffd7447e9f740f9e6dacc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A6nJghWthwZXr70AsoaVeA.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated"><a class="ae li" href="https://console.aws.amazon.com/iam" rel="noopener ugc nofollow" target="_blank">https://console.aws.amazon.com/iam</a></figcaption></figure><blockquote class="kw kx ky"><p id="e589" class="jk jl kz jm b jn kr jp jq jr ks jt ju la kt jx jy lb ku kb kc lc kv kf kg kh hb bi translated">配置<strong class="jm hj">访问密钥&amp;秘密密钥</strong></p></blockquote><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/b0308aa306bfc7cafc33d1b6ea330543.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*It8LU_qj_vEf5G4TXIXfBg.jpeg"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">Windows CMD</figcaption></figure><p id="79bf" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">现在<strong class="jm hj"> EKS的角色进场了</strong></p><blockquote class="kw kx ky"><p id="b819" class="jk jl kz jm b jn kr jp jq jr ks jt ju la kt jx jy lb ku kb kc lc kv kf kg kh hb bi translated"><strong class="jm hj">在此之前创建SSH公钥</strong></p></blockquote><p id="f5d7" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">首先，我们将创建YAML格式的集群配置文件</p><p id="f89f" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">在这个文件中，我们必须选择我们需要哪种类型的实例和其他东西</p><p id="7d24" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated"><strong class="jm hj">我建议最后运行所有文件</strong></p><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es ln"><img src="../Images/8c2a3d7a3a48c23c6d8e8ac399a78e63.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*L3yfew3LJX_QuYM6SmLAmQ.jpeg"/></div></figure><blockquote class="kw kx ky"><p id="461e" class="jk jl kz jm b jn kr jp jq jr ks jt ju la kt jx jy lb ku kb kc lc kv kf kg kh hb bi translated"><strong class="jm hj"> <em class="hi"> eksctl创建集群-f cluster config . yml</em></strong><em class="hi">#运行此命令创建集群</em></p></blockquote><p id="3ef8" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">一旦运行这个命令，您将看到类似这样的输出。然后<strong class="jm hj">等待最小值。20分钟后</strong>集群将自动创建</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es lo"><img src="../Images/c527c20d5e691f8092a01babfb4116fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0GsBC7EZm_lGhi1CmKa1Pg.jpeg"/></div></div></figure><p id="8e11" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">创建后，您可以在AWS EKS中看到集群</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es lp"><img src="../Images/5a90603871187188284d7c7b997fc414.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dof7DAIaIS2Fcpgnjp0XsA.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">console.aws.amazon.com</figcaption></figure><p id="6939" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">使用EC2作为主节点和从节点的幕后AWS EKS集群</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es lq"><img src="../Images/26d47da1cb871d65d2af1764bf8b012b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-jeUtQ_ndFlwB2zT9Hxggg.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">console.aws.amazon.com</figcaption></figure><p id="4ad9" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">EKSCTL在后台向Cloudformation发送请求，因此它也创建Cloudformation堆栈</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es lr"><img src="../Images/e5e8f3b0d47e3e51f37036e84e7dfab9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VGzpb8KcvTGJemWbuh588Q.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">console.aws.amazon.com/cloudformation</figcaption></figure></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><h1 id="969c" class="im in hi bd io ip lz ir is it ma iv iw ix mb iz ja jb mc jd je jf md jh ji jj bi translated">从您当地的管理Kubernetes</h1><p id="600e" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">我们的Kubernetes集群运行在云上，因此我们可以从世界上的任何地方发送命令，为此我们只需要Kubernetes配置文件来管理它</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es me"><img src="../Images/cc54d29700cab73e5dfa5473c4f85105.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hOUl6vLwKLJK3lWKLV6gWQ.jpeg"/></div></div></figure><blockquote class="kw kx ky"><p id="5d02" class="jk jl kz jm b jn kr jp jq jr ks jt ju la kt jx jy lb ku kb kc lc kv kf kg kh hb bi translated"><strong class="jm hj">AWS eks update-kube config—name production env</strong>#运行此命令在您的pc中设置Kubernetes配置，并且不要忘记给出您的集群名称</p></blockquote><p id="f17c" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">所以现在我们的Kubernetes正在全力工作。我们可以用<strong class="jm hj"> Kubectl get pods </strong>命令检查</p></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><p id="5949" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated"><strong class="jm hj"> EFS弹性文件系统</strong></p><p id="aa60" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated"><strong class="jm hj">什么是EFS </strong></p><p id="3788" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">亚马逊弹性文件系统(亚马逊<strong class="jm hj"> EFS </strong>)提供了一个简单、可伸缩、完全托管的弹性NFS文件系统，用于<strong class="jm hj"> AWS </strong>云服务和内部资源</p><p id="f8f2" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">我们必须创建一个集中式存储，这样我们的所有节点都可以在那里装载数据</p><p id="6628" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">进入EFS然后点击<strong class="jm hj">创建文件系统</strong></p><p id="2e55" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">选择您的<strong class="jm hj"> VPC，</strong>在创建集群时，它还会创建自己的虚拟专用网络，因此我们必须<strong class="jm hj">选择那个</strong>，一旦我们选择它，就会自动选择所有与VPC连接的节点</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es mf"><img src="../Images/8b8fb92ba725ada1aa42a923136e9868.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e1LiKx2UAWnFac9ST8hVVA.jpeg"/></div></div></figure><p id="d37d" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">然后，我们必须选择相同的安全组。所以它们是可以互相连接的</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es mg"><img src="../Images/07f892214d1eddd21ad2c956ca46878e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eSUklChPdklidMXjKJ9t9A.jpeg"/></div></div></figure><p id="eb37" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">然后下一步，下一步，下一步，创建文件系统</p><p id="43d1" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">在这之后，我们必须在所有的<strong class="jm hj">三个实例</strong>中安装<strong class="jm hj"> amazon-efs-utils </strong>。使用ssh，所以这里我们必须使用在配置集群时输入的SSH密钥</p><blockquote class="kw kx ky"><p id="d4be" class="jk jl kz jm b jn kr jp jq jr ks jt ju la kt jx jy lb ku kb kc lc kv kf kg kh hb bi translated"><strong class="jm hj"> <em class="hi"> sudo yum安装Amazon-EFS-utils-y</em></strong><em class="hi">#运行并在所有节点安装这个</em></p></blockquote></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><h1 id="4384" class="im in hi bd io ip lz ir is it ma iv iw ix mb iz ja jb mc jd je jf md jh ji jj bi translated">现在开始我们今天的主要部署NextCloud和MySql</h1><p id="25b7" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">首先，我们必须创建EFS置备程序</p><div class="kj kk kl km fd ab cb"><figure class="mh ij mi mj mk ml mm paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><img src="../Images/e90320b7cddf6870b70126e5899ba0d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*TLHu4kZ6z4RxvbYXr60LRA.jpeg"/></div></figure><figure class="mh ij mn mj mk ml mm paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><img src="../Images/752f3003f9ce83ce3e3a7b88cbb5a573.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*Up29dBmAw1K3VbbD2lDllA.jpeg"/></div></figure></div><p id="ceb8" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">在这个yml文件中，我们只给出了值为的<strong class="jm hj"> efs id和efs </strong>的<strong class="jm hj">服务器名称</strong></p><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es mo"><img src="../Images/c64ecaac9cb4b76cc7899e10f7707bfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*PQaRqDLn756FwXJT7C6CXQ.jpeg"/></div></figure><p id="cdec" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">它在内部创建了一个efs部署，要使用efs存储，我们需要设置EFS资源调配器</p><p id="95c9" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">现在我们创建<strong class="jm hj">集群角色绑定</strong></p><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/f5e6a5f37792b6377247ac8c91bc62b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*iugr0FmnD0P0mDo1fuK7vA.jpeg"/></div></figure><p id="cb29" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">为了跨整个集群授予权限，我们可以使用一个<strong class="jm hj"> ClusterRoleBinding </strong>。下面的<strong class="jm hj"> ClusterRoleBinding </strong>允许组“manager”中的任何用户读取任何名称空间中的机密</p><p id="4ec5" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">现在我们创建<strong class="jm hj">存储类</strong></p><div class="kj kk kl km fd ab cb"><figure class="mh ij mq mj mk ml mm paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><img src="../Images/1d40e8bf9acebe4cea6ead7a795de701.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/1*DtHZ15UlTczCZd3__4G-Xg.jpeg"/></div></figure><figure class="mh ij mr mj mk ml mm paragraph-image"><img src="../Images/aa9df0d285fccefef8df79adae396ae9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*O3mVfETi7oQ28wapNMajOA.jpeg"/></figure></div><p id="a688" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">这将向EFS发送Pvc请求，并从那里获取存储，然后为其创建PVC。现在，我们的PVC已创建，并与一个集中式存储相连，因此，现在我们可以在一个集中式位置将pods数据装载到其中</p><p id="1979" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">现在我们创建<strong class="jm hj"> deploy-mysql.yml </strong></p><div class="kj kk kl km fd ab cb"><figure class="mh ij ms mj mk ml mm paragraph-image"><img src="../Images/ab2d6425bb7181b35033fe7882afed27.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*tAPd3xuehzqyFQNp-91BPw.jpeg"/></figure><figure class="mh ij mt mj mk ml mm paragraph-image"><img src="../Images/8454e66681d96f6cfabae3eb6ce84e85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*mXe66xP5bVn68c5MOVPneQ.jpeg"/></figure></div><p id="3533" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">MySql存储我们的数据，这些数据是由NextCloud生成的，在这里，我们使用一个秘密来隐藏数据，不让其他团队成员看到。这不是用来保护数据的，只是为了隐藏数据，不让人们看到，所以我们秘密地以BASE64编码存储数据</p><p id="5a2e" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">现在我们创建<strong class="jm hj"> deploy-nextcloud.yml </strong></p><div class="kj kk kl km fd ab cb"><figure class="mh ij mu mj mk ml mm paragraph-image"><img src="../Images/f4c3bb9b6a532c9ae78ce55be8cfec10.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*aJjvX7jOvCwAqJNsTM15_w.jpeg"/></figure><figure class="mh ij mv mj mk ml mm paragraph-image"><img src="../Images/136f6b62766abf58d310a52a79d8e131.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*LHhIEI3WQfH1sLeRTwA-Xw.jpeg"/></figure></div><p id="028b" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">在NextCloud中，它只是为了保护我们私人世界中的数据，所以没有人可以通过互联网访问它，所以我们可以通过nextcloud实现它</p><p id="30fd" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">之后，按顺序运行以下所有命令</p><p id="39e5" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated"><strong class="jm hj">1-ku bectl apply-f create-EFS-provisioner . YAML</strong></p><p id="5e18" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated"><strong class="jm hj">2-ku bectl apply-f create-RBAC . YAML</strong></p><p id="abf6" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated"><strong class="jm hj">3-ku bectl apply-f create-storage . YAML</strong></p><p id="5457" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated"><strong class="jm hj">4-ku bectl apply-f secret . yml</strong></p><p id="9316" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated"><strong class="jm hj">5-kubectl apply-f deploy-MySQL . YAML</strong></p><p id="fdc2" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated"><strong class="jm hj">6-ku bectl apply-f deploy-next cloud . YAML</strong></p><p id="58c3" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">运行所有这些之后，负载平衡器将自动在AWS中启动，并提供公共DNS来访问网站</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es mw"><img src="../Images/be8bb9fab6369a9793181bb1ca74dc38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6lLsfWWNvVpgKd7xtT6VBQ.jpeg"/></div></div></figure><p id="953d" class="pw-post-body-paragraph jk jl hi jm b jn kr jp jq jr ks jt ju jv kt jx jy jz ku kb kc kd kv kf kg kh hb bi translated">NextCloud在EKS成功部署</p><div class="kj kk kl km fd ab cb"><figure class="mh ij mx mj mk ml mm paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><img src="../Images/1d507ba2534802acefb5c74e4c17f388.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*6GId8-7gzT4jbnoFleKGXw.jpeg"/></div></figure><figure class="mh ij my mj mk ml mm paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><img src="../Images/553a3d89aa62acab2bd02156467ea234.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*A7lhdgwCBE3JL-ZFJEyTYg.jpeg"/></div></figure></div><h1 id="3329" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">现在，我们可以删除集群了</h1><blockquote class="kw kx ky"><p id="88cd" class="jk jl kz jm b jn kr jp jq jr ks jt ju la kt jx jy lb ku kb kc lc kv kf kg kh hb bi translated"><strong class="jm hj"> <em class="hi"> eksctl删除cluster-f cluster config . yml</em></strong></p></blockquote><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es mz"><img src="../Images/a593b41d9301d950031befb6096e547e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mF7xelGvZyXCr-a02VSaJQ.jpeg"/></div></div></figure><div class="na nb ez fb nc nd"><a href="https://github.com/mjmanas0699/EKS-NEXTCLOUD-MYSQL" rel="noopener  ugc nofollow" target="_blank"><div class="ne ab dw"><div class="nf ab ng cl cj nh"><h2 class="bd hj fi z dy ni ea eb nj ed ef hh bi translated">mj Manas 0699/EKS-next cloud-MYSQL</h2><div class="nk l"><h3 class="bd b fi z dy ni ea eb nj ed ef dx translated">在GitHub上创建一个帐户，为mjmanas 0699/EKS-next cloud-MYSQL开发做出贡献。</h3></div><div class="nl l"><p class="bd b fp z dy ni ea eb nj ed ef dx translated">github.com</p></div></div><div class="nm l"><div class="nn l no np nq nm nr ik nd"/></div></div></a></div></div></div>    
</body>
</html>