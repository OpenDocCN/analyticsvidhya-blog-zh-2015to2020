<html>
<head>
<title>How to create a Django Sitemap</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建Django网站地图</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/django-sitemap-8f4ca0538fa?source=collection_archive---------0-----------------------#2019-03-18">https://medium.com/analytics-vidhya/django-sitemap-8f4ca0538fa?source=collection_archive---------0-----------------------#2019-03-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/633e7b80f35c75ec664246c5a348bc1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0lOwTzxyKFRoUXYHsAgg7w.jpeg"/></div></div></figure><p id="3d30" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Sitemap是一个带有xml扩展名的文件，包含我们在网站上发布的内容页面。今天，站点地图已经成为每个站点最重要的SEO标准之一。</p><p id="2423" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们想从创建一个新项目开始。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="0dc8" class="jx jy hi jt b fi jz ka l kb kc">$ django-admin startproject django_sitemap<br/>$ cd django_sitemap/</span></pre><p id="9fc4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们现在想要创建一个新的应用程序，我将把它称为我的应用程序。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="b2f2" class="jx jy hi jt b fi jz ka l kb kc">$ ./manage.py startapp myapp</span></pre><p id="7c0e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以将<code class="du kd ke kf jt b">myapp</code>添加到我们的安装应用中。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="cbac" class="jx jy hi jt b fi jz ka l kb kc">INSTALLED_APPS = [<br/>    'django.contrib.admin',<br/>    'django.contrib.auth',<br/>    'django.contrib.contenttypes',<br/>    'django.contrib.sessions',<br/>    'django.contrib.messages',<br/>    'django.contrib.staticfiles',<br/>    'myapp',<br/>]</span></pre><p id="0966" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kd ke kf jt b">django_sitemap/urls.py:</code></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="77f3" class="jx jy hi jt b fi jz ka l kb kc">from django.contrib import admin<br/>from django.urls import path, include<br/>urlpatterns = [<br/>    path('', include('myapp.urls')),<br/>    path('admin/', admin.site.urls),<br/>]</span></pre><p id="945c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kd ke kf jt b">myapp/urls.py:</code></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="cb8b" class="jx jy hi jt b fi jz ka l kb kc">from django.urls import path<br/>from myapp.views import about<br/>urlpatterns = [<br/>    path('about/', about, name='about')<br/>]</span></pre><p id="fccf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kd ke kf jt b">myapp/views.py:</code></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="536b" class="jx jy hi jt b fi jz ka l kb kc">from django.http import HttpResponse<br/>def about(request):<br/>    return HttpResponse('about page')</span></pre><p id="be36" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有一个叫做<code class="du kd ke kf jt b">Django contrib sitemaps</code>的包，开始创建我们的网站地图。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="93bc" class="jx jy hi jt b fi jz ka l kb kc">INSTALLED_APPS = [<br/>    'django.contrib.admin',<br/>    'django.contrib.auth',<br/>    'django.contrib.contenttypes',<br/>    'django.contrib.sessions',<br/>    'django.contrib.messages',<br/>    'django.contrib.staticfiles',<br/>    'myapp',<br/>    'django.contrib.sitemaps',<br/>]</span></pre><p id="2373" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kd ke kf jt b">StaticViewSitemap()</code>将是我们所有静态视图的站点地图。每个单独的站点地图都必须有一个名为item的函数，并且<code class="du kd ke kf jt b">location()</code>应该为每个单独的项目返回一个路径。</p><p id="8ddf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kd ke kf jt b">myapp/sitemaps.py:</code></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="b7e9" class="jx jy hi jt b fi jz ka l kb kc">from django.contrib.sitemaps import Sitemap<br/>from django.shortcuts import reverse<br/>class StaticViewSitemap(Sitemap):<br/>    def items(self):<br/>        return ['about']<br/>    def location(self, item):<br/>        return reverse(item)</span></pre><p id="2c89" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们想要导入<code class="du kd ke kf jt b">static view the site map</code>，然后我们可以创建一个名为<code class="du kd ke kf jt b">site maps</code>的新字典，我们想要给它<code class="du kd ke kf jt b">static</code>的键和<code class="du kd ke kf jt b">static view side map</code>的值，因为我们需要马上传递这个字典。</p><p id="bb7c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kd ke kf jt b">django_sitemap/urls.py:</code></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="b523" class="jx jy hi jt b fi jz ka l kb kc">from django.contrib import admin<br/>from django.contrib.sitemaps.views import sitemap<br/>from django.urls import include, path<br/>from myapp.sitemaps import StaticViewSitemap<br/>sitemaps = {<br/>    'static': StaticViewSitemap<br/>}<br/>urlpatterns = [<br/>    path('', include('myapp.urls')),<br/>    path('sitemap.xml', sitemap, {'sitemaps': sitemaps}),<br/>    path('admin/', admin.site.urls),<br/>]</span></pre><h2 id="4e3c" class="jx jy hi bd kg kh ki kj kk kl km kn ko jb kp kq kr jf ks kt ku jj kv kw kx ky bi translated">运行应用程序</h2><ul class=""><li id="10be" class="kz la hi is b it lb ix lc jb ld jf le jj lf jn lg lh li lj bi translated"><code class="du kd ke kf jt b">http://127.0.0.1:8000/sitemap.xml</code>，我们得到一个包含位置的XML文件。</li></ul><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="9305" class="jx jy hi jt b fi jz ka l kb kc">&lt;urlset ae lk" href="http://www.sitemaps.org/schemas/sitemap/0.9" rel="noopener ugc nofollow" target="_blank"&gt;http://www.sitemaps.org/schemas/sitemap/0.9"&gt;<br/>    &lt;url&gt;<br/>        &lt;loc&gt;<a class="ae lk" href="http://127.0.0.1:8000/about/" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000/about/</a>&lt;/loc&gt;<br/>    &lt;/url&gt;<br/>&lt;/urlset&gt;</span></pre><h1 id="51e8" class="ll jy hi bd kg lm ln lo kk lp lq lr ko ls lt lu kr lv lw lx ku ly lz ma kx mb bi translated">模型</h1><p id="b255" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb mc jd je jf md jh ji jj me jl jm jn hb bi translated">我们创建一个片段模型。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="fcc6" class="jx jy hi jt b fi jz ka l kb kc">from django.db import models<br/>from django.utils.text import slugify<br/>class Snippet(models.Model):<br/>    title = models.CharField(max_length=80)<br/>    slug = models.SlugField(blank=True, null=True)<br/>    body = models.TextField()</span><span id="8e0a" class="jx jy hi jt b fi mf ka l kb kc">def save(self, *args, **kwargs):<br/>        self.slug = slugify(self.title)<br/>        super().save(*args, **kwargs)</span><span id="716a" class="jx jy hi jt b fi mf ka l kb kc">def get_absolute_url(self):<br/>        return f'/{self.slug}'</span></pre><p id="7e47" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用<code class="du kd ke kf jt b">save()</code>方法。因为，我们想从标题中生成slug。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="bd99" class="jx jy hi jt b fi jz ka l kb kc">$ ./manage.py makemigrations<br/>$ ./manage.py migrate<br/>$ ./manage.py shell<br/>In [1]: from myapp.models import Snippet<br/>In [2]: Snippet.objects.create(title='t1', body='&lt;h1&gt;&lt;/h1').save()<br/>In [3]: Snippet.objects.create(title='t2', body='&lt;h2&gt;&lt;/h2').save()</span></pre><p id="abbf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们想创建一个真实的路径和我们的详细视图，这一个将采取一个鼻涕虫。</p><p id="2c6a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kd ke kf jt b">myapp/urls.py:</code></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="b8d4" class="jx jy hi jt b fi jz ka l kb kc">from django.urls import path<br/>from myapp.views import about, snippet_detail<br/>urlpatterns = [<br/>    path('&lt;slug:slug&gt;/', snippet_detail),<br/>    path('about/', about, name='about'),<br/>]</span></pre><p id="df55" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kd ke kf jt b">myapp/views.py:</code></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="40e5" class="jx jy hi jt b fi jz ka l kb kc">from django.http import HttpResponse<br/>from django.shortcuts import get_object_or_404<br/>from .models import Snippet</span><span id="bedc" class="jx jy hi jt b fi mf ka l kb kc">def about(request):<br/>    return HttpResponse('about page')</span><span id="e5c6" class="jx jy hi jt b fi mf ka l kb kc">def snippet_detail(request, slug):<br/>    snippet = get_object_or_404(Snippet, slug=slug)<br/>    return HttpResponse(f'the detailview for slug of {slug}')</span></pre><h2 id="90ad" class="jx jy hi bd kg kh ki kj kk kl km kn ko jb kp kq kr jf ks kt ku jj kv kw kx ky bi translated">运行应用程序</h2><ul class=""><li id="d2e9" class="kz la hi is b it lb ix lc jb ld jf le jj lf jn lg lh li lj bi translated"><code class="du kd ke kf jt b">http://127.0.0.1:8000/h2/</code>，h2段塞流的详细视图。</li></ul><p id="00c8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kd ke kf jt b">django_sitemap/urls.py:</code></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="0059" class="jx jy hi jt b fi jz ka l kb kc">from django.contrib import admin<br/>from django.contrib.sitemaps.views import sitemap<br/>from django.urls import include, path<br/>from myapp.sitemaps import SnippetSitemap, StaticViewSitemap</span><span id="ad67" class="jx jy hi jt b fi mf ka l kb kc">sitemaps = {'static': StaticViewSitemap, 'snippet': SnippetSitemap}</span><span id="85a5" class="jx jy hi jt b fi mf ka l kb kc">urlpatterns = [<br/>    path('', include('myapp.urls')),<br/>    path('sitemap.xml', sitemap, {'sitemaps': sitemaps}),<br/>    path('admin/', admin.site.urls),<br/>]</span></pre><p id="4170" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du kd ke kf jt b">myapp/sitemaps.py:</code></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="1be6" class="jx jy hi jt b fi jz ka l kb kc">from django.contrib.sitemaps import Sitemap<br/>from django.shortcuts import reverse<br/>from .models import Snippet</span><span id="938c" class="jx jy hi jt b fi mf ka l kb kc">class StaticViewSitemap(Sitemap):<br/>    def items(self):<br/>        return ['about']</span><span id="0012" class="jx jy hi jt b fi mf ka l kb kc">def location(self, item):<br/>        return reverse(item)</span><span id="ef4d" class="jx jy hi jt b fi mf ka l kb kc">class SnippetSitemap(Sitemap):<br/>    def items(self):<br/>        return Snippet.objects.all()</span></pre><h2 id="2c3c" class="jx jy hi bd kg kh ki kj kk kl km kn ko jb kp kq kr jf ks kt ku jj kv kw kx ky bi translated">运行应用程序</h2><ul class=""><li id="3604" class="kz la hi is b it lb ix lc jb ld jf le jj lf jn lg lh li lj bi translated">我们得到一个包含位置的XML文件。</li></ul><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="861a" class="jx jy hi jt b fi jz ka l kb kc">&lt;urlset ae lk" href="http://www.sitemaps.org/schemas/sitemap/0.9" rel="noopener ugc nofollow" target="_blank"&gt;http://www.sitemaps.org/schemas/sitemap/0.9"&gt;<br/>    &lt;url&gt;<br/>        &lt;loc&gt;<a class="ae lk" href="http://127.0.0.1:8000/about/" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000/about/</a>&lt;/loc&gt;<br/>    &lt;/url&gt;<br/>    &lt;url&gt;<br/>        &lt;loc&gt;<a class="ae lk" href="http://127.0.0.1:8000/h1" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000/h1</a>&lt;/loc&gt;<br/>    &lt;/url&gt;<br/>    &lt;url&gt;<br/>        &lt;loc&gt;<a class="ae lk" href="http://127.0.0.1:8000/h2" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000/h2</a>&lt;/loc&gt;<br/>    &lt;/url&gt;<br/>    &lt;url&gt;<br/>        &lt;loc&gt;<a class="ae lk" href="http://127.0.0.1:8000/h3" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000/h3</a>&lt;/loc&gt;<br/>    &lt;/url&gt;<br/>&lt;/urlset&gt;</span></pre><h1 id="c034" class="ll jy hi bd kg lm ln lo kk lp lq lr ko ls lt lu kr lv lw lx ku ly lz ma kx mb bi translated">结论</h1><p id="6377" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb mc jd je jf md jh ji jj me jl jm jn hb bi translated">如果你在<a class="ae lk" href="https://docs.djangoproject.com/en/2.1/ref/contrib/sitemaps/" rel="noopener ugc nofollow" target="_blank"> django网站地图文档</a>中查找。你可以在网站地图上找到其他属性来告诉搜索引擎更多关于它的信息。在本文中，您已经学习了如何创建站点地图。该应用的源代码可在<a class="ae lk" href="https://github.com/erdimollahuseyin/django-site-map" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上获得。</p></div></div>    
</body>
</html>