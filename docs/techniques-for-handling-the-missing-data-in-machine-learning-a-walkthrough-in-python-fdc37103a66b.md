# 机器学习中缺失数据的处理方法

> 原文：<https://medium.com/analytics-vidhya/techniques-for-handling-the-missing-data-in-machine-learning-a-walkthrough-in-python-fdc37103a66b?source=collection_archive---------6----------------------->

## 机器学习中缺失数据的处理技术:Python 中的演练

![](img/4d0533d2a99cd7060f8f95164a3ec0a2.png)

弗兰基·查马基在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

# 为什么处理缺失数据很重要？

缺失数据问题在大多数研究领域都很普遍。丢失数据会产生各种问题。

*   首先，数据的缺失降低了统计方法的效力。
*   其次，缺失的数据会导致模型出现偏差。
*   第三，python 中很多机器学习包不接受缺失数据。它需要先处理缺失的数据。

这些问题中的每一个都可能导致虚假的结论，降低模型的可靠性。

# 缺失数据机制

*   **完全随机缺失(MCAR):** 如果缺失数据与观察到的和缺失的实例都完全不相关，则值完全随机缺失(MCAR)。
*   **随机缺失(MAR):** 随机缺失(MAR)是指缺失数据与观测数据有关，但与缺失数据无关。
*   **非随机缺失(MNAR):** 非随机缺失(MNAR)是既不是 MAR 也不是 MCAR 的数据。这意味着丢失的数据与观察到的和丢失的实例都有关。

# 处理缺失数据

1.  删除变量
2.  部分删除
3.  数据插补

# 1.删除变量

如果该列包含超过 **70%的缺失值**，则删除该列；否则，数据插补是比删除该列更可取的方法。模型的信息量越大，模型结果的可靠性就越高。

# 2.部分删除

# 2.1 列表式删除

**列表删除**是一种删除包含缺失值的行的技术。

**缺点:**列表式删除降低了所进行的统计检验的强度。更多的数据样本是分析的关键因素。因为列表式删除会删除缺少值的数据，所以它会减小数据的大小。列表式删除可能会导致数据偏差。

# 3.数据插补

# 3.1 单一插补

单一插补试图用单一值对缺失数据进行插补，而多重插补则用多个值替代缺失数据。

> ***3.1.1 数字列的单一插补***

3.1.1.1 平均插补

3.1.1.2 回归插补

> ***3.1.2 分类列的单一插补***

3.1.2.1 模式插补

## 3.1.1 数字列的单一插补

**3.1.1.1 均值插补**

*   平均值插补是用变量的平均值来插补缺失数据的过程，只能对数字列进行插补。

**缺点:**均值插补更容易在模型中引入偏倚。

【3.1.1.2 回归插补

*   拟合回归模型，其中预测值是没有缺失值的要素，目标值是有缺失值的要素。
*   然后用预测值替换缺失值。回归插补不太可能在模型中引入偏差。

## 3.1.2 分类栏的单一插补

【3.1.2.1 模式插补】T4

*   模式插补是通过变量的模式对缺失数据进行插补的过程，只能对分类列进行插补。

**缺点:**更容易在模型中引入偏差。

# 3.2 多重插补

*   在多重插补中，缺失数据被多次用多个值进行插补，最终形成大量插补数据集。

## 3.2.1 小鼠(通过链式方程进行多重插补)

## 鼠标算法:

*   **第一步:**最初，数据集使用平均值进行估算，平均值充当“占位符”。
*   **第二步:**随机选择一个缺失变量，命名为目标，除此之外的其他特征将作为特征。根据这些特征和目标训练回归模型。
*   **第 3 步:**目标的缺失值随后被回归模型的预测值(插补值)替代。
*   **步骤 4:** 然后对每个有未观察数据的特征重复步骤 2-3。在单个周期结束时，所有缺失值都将通过预测进行估算。
*   **步骤 5:** 重复步骤 2-4，重复指定的循环次数。

## 分类数据的 MICE 算法:

在执行 MICE 算法中的步骤 1 到 6 之前，必须完成以下步骤以估算分类数据。

*   **第一步:**对非空值进行顺序编码
*   **步骤 2:** 使用带有梯度增强分类器的 MICE 插补来插补有序编码的数据
*   **第三步:**从序数值转换回分类值。
*   **步骤 4:** 按照 MICE 算法中的步骤 1 至 5。使用**模式插补**代替初始策略的均值插补。

***在我的 Kaggle 笔记本里找到这个帖子:***[*https://www . ka ggle . com/srivignesh/techniques-for-handling-the-missing-data*](https://www.kaggle.com/srivignesh/techniques-for-handling-the-missing-data)

**参考文献:**

[1]玄康**，**，[数据缺失的预防与处理](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3668100/) (2013)，国家生物技术信息中心。

[2] 梅丽莎·j·阿祖尔，伊丽莎白·a·斯图亚特，康斯坦丁·弗兰基斯，菲利普·j·利夫，[链式方程多重插补:什么是多重插补，如何工作？](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3074241/) (2011)，国家生物技术信息中心。

*在*[*LinkedIn*](https://www.linkedin.com/in/srivignesh-rajan-123569151/)*，*[*Twitter*](https://twitter.com/RajanSrivignesh)*上联系我！*

**快乐的机器学习！**

## 谢谢你！