<html>
<head>
<title>IEEE Fraud Detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">IEEE欺诈检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/ieee-fraud-detection-f69586177604?source=collection_archive---------9-----------------------#2019-11-15">https://medium.com/analytics-vidhya/ieee-fraud-detection-f69586177604?source=collection_archive---------9-----------------------#2019-11-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4604" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我知道你可能是生活中一些诈骗的受害者，从学校恶作剧到一些真正的金钱损失。我们不能控制人们，也不能否认轻松赚钱的想法，所以人们倾向于偷别人的东西。我们不能总是阻止人们这样做，但我们绝对可以采取一些预防措施，以避免未来的损失。</p><p id="68b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将讨论一个检测在线欺诈交易的案例研究。本次比赛由<a class="ae jd" href="https://www.kaggle.com/c/ieee-fraud-detection" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>主持。所以让我们深入研究一下。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/23b838682399134f4f771aa978b863e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VC9bUJJVnh4uRlUG9RqdWQ.jpeg"/></div></div></figure><h1 id="3532" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">内容:-</h1><blockquote class="kv kw kx"><p id="721e" class="if ig ky ih b ii ij ik il im in io ip kz ir is it la iv iw ix lb iz ja jb jc hb bi translated">(1)-加载数据<br/> (2)-探索数据<br/> (3)-特征工程<br/> (4)-高级特征工程<br/> (5)-最后一步处理数据<br/> (6)-建模<br/> (7)-结论</p></blockquote></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h1 id="1abc" class="jx jy hi bd jz ka lc kc kd ke ld kg kh ki le kk kl km lf ko kp kq lg ks kt ku bi translated">[1]加载数据</h1><p id="934f" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">我们将首先加载提供给我们的数据。有两个表，一个在train_identity.csv，另一个在train_transaction.csv。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lm"><img src="../Images/1ea3dbcfff5248ad35a50a08dfaa5cd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OEGAa-IGo-I36qiUu5fYeA.jpeg"/></div></div></figure><p id="0217" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">加载两个表后，我们将合并它们。详情请参阅笔记本。</p><h1 id="89d5" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">[2]探索数据</h1><p id="9321" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">这个数据集有很多特性，很难逐一检查。已经为我们提供了一些高级功能，这些功能对于分类非常重要。我们必须预测给定的交易是否是欺诈性的，所以是的，这是一个二元分类任务。</p><p id="1bfd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> (1)数据的类型有哪些？</strong></p><ul class=""><li id="d035" class="ln lo hi ih b ii ij im in iq lp iu lq iy lr jc ls lt lu lv bi translated"><strong class="ih hj"> TransactionDT: </strong>给定参考日期时间的时间增量(不是实际时间戳)</li><li id="62ce" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated"><strong class="ih hj">交易金额:</strong>交易支付金额<br/>美元<strong class="ih hj">产品代码:</strong>产品代码，每笔交易的产品</li><li id="3917" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated"><strong class="ih hj"> card1 — card6: </strong>支付卡信息，如卡种、卡类、发卡行、国家等。</li><li id="10b4" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated"><strong class="ih hj">地址:</strong>地址</li><li id="82df" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated"><strong class="ih hj">距离:</strong>距离</li><li id="cade" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated"><strong class="ih hj"> P_ and (R__) emaildomain: </strong>购买者和接收者电子邮件域</li><li id="2dcc" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated"><strong class="ih hj"> C1-C14: </strong>计数，比如找到多少个地址与支付卡关联等。实际意义被掩盖了。</li><li id="dee8" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated"><strong class="ih hj"> D1-D15: </strong>时间增量，如前一次交易之间的天数等。</li><li id="68fe" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated"><strong class="ih hj"> M1-M9: </strong>匹配，比如名片上的名字和地址等。</li><li id="cb57" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated"><strong class="ih hj">vxxxx:</strong>Vesta设计了丰富的功能，包括排名、计数和其他实体关系。</li><li id="c705" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated"><strong class="ih hj">分类特征:</strong><br/>product CD<br/>card 1—card 6<br/>addr 1，addr 2<br/>P<em class="ky">email domain R</em>email domain<br/>M1—M9</li></ul><p id="ab41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">(2)——数据是平衡的还是不平衡的？</strong></p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es mb"><img src="../Images/26d79313e14ca1e6c94105f2c436b099.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*-Leexcq4-OPQbZAjfWbyuA.jpeg"/></div></div></figure><p id="d04e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到这是一个非常不平衡的数据集。所以我们不能用准确性作为衡量标准。我们必须使用一些其他指标，如F1得分、auc。在这种情况下，我们使用AUC-ROC评分。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="2e05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> (3)缺列有多少？</strong></p><div class="jm jn jo jp fd ab cb"><figure class="mc jq md me mf mg mh paragraph-image"><img src="../Images/e2c99807f2560220ece8a081ce097c46.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*MId97nJUDQuomGkvDdgUAA.jpeg"/></figure><figure class="mc jq mi me mf mg mh paragraph-image"><img src="../Images/573c17fc9f280166ee4dd12e08a95e16.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*LRonzLh4bdm2OG8DWFt4YA.jpeg"/></figure></div><p id="6afe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的数据包含大型nan列。这些列可能会影响我们的模型性能。因此，我们将删除缺失值超过90%的功能。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es mj"><img src="../Images/5085d72589497a0757538aef08e69139.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ppUyb7RopKX8r-8jAM3z-A.jpeg"/></div></div><figcaption class="mk ml et er es mm mn bd b be z dx translated">缺失值超过90%的特征。</figcaption></figure></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="69f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> (4)欺诈交易和非欺诈交易的交易值分布是怎样的？</strong></p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es mo"><img src="../Images/47ceb1d9806e59c44810734141944f19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6oQlU7copXHAMYfHcKsGqA.jpeg"/></div></div></figure><p id="7728" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从这个分布图中，我们可以观察到一些现象，例如欺诈性交易很高，而非欺诈性交易在本质上有点一致。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="019c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> (5)探索范畴特征</strong></p><div class="jm jn jo jp fd ab cb"><figure class="mc jq mp me mf mg mh paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/bd0ee30968fa50373266e07eedf1d4c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*_4M2jyvTawRKDBt3EfT6HQ.jpeg"/></div></figure><figure class="mc jq mq me mf mg mh paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/0f4dfe4a85c6787bdc95b8ad28238ee2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*eOJPqziqBAuSLRALYJXGmQ.jpeg"/></div></figure></div><p id="f53f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上面的条形图中，我们可以观察到一些卡特征，如卡4与万事达卡和维萨卡的欺诈性交易较高，卡6与信用卡和借记卡的欺诈性交易较高。</p><ul class=""><li id="fead" class="ln lo hi ih b ii ij im in iq lp iu lq iy lr jc ls lt lu lv bi translated">一些特征具有许多需要最小化的分类特征。例如，设备信息功能包含各种设备的名称。因此，Redmi Note 4和Redmi Note 5等两款设备将被视为两个不同的类别，以避免我们将它们作为一个类别在“Redmi”下使用。</li><li id="29e1" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">其中一个特性包含不同的操作系统版本，因此它们被转换成基本系统如windows、linux、mac等。</li><li id="3ae1" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">缺失的功能被转换为“缺失”值。</li><li id="5319" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">NaNs和inf值由特定特征的平均值代替。</li><li id="c441" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">通过多次迭代，我发现获取整个数据集不会产生好的结果。所以我进行了降采样，只使用了30 %的非欺诈数据。</li></ul><h1 id="064a" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">[3]特征工程</h1><p id="0d49" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">在进行一些特征工程之前，进行了一些预处理步骤，例如移除NaN和无穷大值，并且在某些情况下用平均值替换它们。</p><p id="d2ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">进行了以下特征工程:</p><pre class="jm jn jo jp fd mr ms mt mu aw mv bi"><span id="9425" class="mw jy hi ms b fi mx my l mz na">raw_train_data['id_30'].loc[raw_train_data['id_30'].str.contains('Mac')]='mac'<br/>raw_train_data['id_30'].loc[raw_train_data['id_30'].str.contains('iOS')]='ios'<br/>raw_train_data['id_30'].loc[raw_train_data['id_30'].str.contains('And')]='android'<br/>raw_train_data['id_30'].loc[raw_train_data['id_30'].str.contains('Lin')]='linux'<br/>raw_train_data['id_30'].loc[raw_train_data['id_30'].str.contains('Win')]='windows'<br/>np.unique(raw_train_data['id_30'])</span><span id="56ff" class="mw jy hi ms b fi nb my l mz na">raw_train_data['device_name'] = raw_train_data['DeviceInfo'].str.split('/', expand=True)[0]</span><span id="85ca" class="mw jy hi ms b fi nb my l mz na">raw_train_data.loc[raw_train_data['device_name'].str.contains('SM', na=False), 'device_name'] = 'Samsung'<br/>raw_train_data.loc[raw_train_data['device_name'].str.contains('SAMSUNG', na=False), 'device_name'] = 'Samsung'<br/>raw_train_data.loc[raw_train_data['device_name'].str.contains('GT-', na=False), 'device_name'] = 'Samsung'<br/>raw_train_data.loc[raw_train_data['device_name'].str.contains('Moto G', na=False), 'device_name'] = 'Motorola'<br/>raw_train_data.loc[raw_train_data['device_name'].str.contains('Moto', na=False), 'device_name'] = 'Motorola'<br/>raw_train_data.loc[raw_train_data['device_name'].str.contains('moto', na=False), 'device_name'] = 'Motorola'<br/>raw_train_data.loc[raw_train_data['device_name'].str.contains('LG-', na=False), 'device_name'] = 'LG'<br/>raw_train_data.loc[raw_train_data['device_name'].str.contains('rv:', na=False), 'device_name'] = 'RV'<br/>raw_train_data.loc[raw_train_data['device_name'].str.contains('HUAWEI', na=False), 'device_name'] = 'Huawei'<br/>raw_train_data.loc[raw_train_data['device_name'].str.contains('ALE-', na=False), 'device_name'] = 'Huawei'<br/>raw_train_data.loc[raw_train_data['device_name'].str.contains('-L', na=False), 'device_name'] = 'Huawei'<br/>raw_train_data.loc[raw_train_data['device_name'].str.contains('Blade', na=False), 'device_name'] = 'ZTE'<br/>raw_train_data.loc[raw_train_data['device_name'].str.contains('BLADE', na=False), 'device_name'] = 'ZTE'<br/>raw_train_data.loc[raw_train_data['device_name'].str.contains('Linux', na=False), 'device_name'] = 'Linux'<br/>raw_train_data.loc[raw_train_data['device_name'].str.contains('XT', na=False), 'device_name'] = 'Sony'<br/>raw_train_data.loc[raw_train_data['device_name'].str.contains('HTC', na=False), 'device_name'] = 'HTC'<br/>raw_train_data.loc[raw_train_data['device_name'].str.contains('ASUS', na=False), 'device_name'] = 'Asus'</span></pre><p id="bee0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一些大字符串被它们的短形式所取代。</p><p id="b71d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">进行上述将设备名称缩短为其基本名称的步骤的目的是最小化分类特征的总数。</p><h1 id="0bb4" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">[4]高级特征工程</h1><p id="1866" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">让我们做一些高级的特征工程。部分代码摘自本次竞赛中发布的顶级内核。</p><pre class="jm jn jo jp fd mr ms mt mu aw mv bi"><span id="6d9d" class="mw jy hi ms b fi mx my l mz na">raw_train_data['TransactionAmt_to_mean_C1'] = raw_train_data['TransactionAmt'] / raw_train_data.groupby(['C1'])['TransactionAmt'].transform('mean')<br/>raw_train_data['TransactionAmt_to_mean_C3'] = raw_train_data['TransactionAmt'] / raw_train_data.groupby(['C3'])['TransactionAmt'].transform('mean')<br/>raw_train_data['TransactionAmt_to_mean_C5'] = raw_train_data['TransactionAmt'] / raw_train_data.groupby(['C5'])['TransactionAmt'].transform('mean')<br/>raw_train_data['TransactionAmt_to_mean_C13'] = raw_train_data['TransactionAmt'] / raw_train_data.groupby(['C13'])['TransactionAmt'].transform('mean')<br/>raw_train_data['TransactionAmt_to_mean_D15'] = raw_train_data['TransactionAmt'] / raw_train_data.groupby(['D15'])['TransactionAmt'].transform('mean')<br/>raw_train_data['TransactionAmt_to_std_C1'] = raw_train_data['TransactionAmt'] / raw_train_data.groupby(['C1'])['TransactionAmt'].transform('std')<br/>raw_train_data['TransactionAmt_to_std_C3'] = raw_train_data['TransactionAmt'] / raw_train_data.groupby(['C3'])['TransactionAmt'].transform('std')<br/>raw_train_data['TransactionAmt_to_std_C5'] = raw_train_data['TransactionAmt'] / raw_train_data.groupby(['C5'])['TransactionAmt'].transform('std')<br/>raw_train_data['TransactionAmt_to_std_D15'] = raw_train_data['TransactionAmt'] / raw_train_data.groupby(['D15'])['TransactionAmt'].transform('std')</span></pre><p id="2794" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有一些更多的功能工程完成，请检查笔记本文件，以获得更多的细节。让我先解释一下我们做了什么样的特征工程</p><p id="3f63" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(1)- <strong class="ih hj">设备信息:- </strong>设备名称被缩短为其品牌名称，只是为了作为分类变量。</p><p id="1ca1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(2)- <strong class="ih hj"> Id_XX:- </strong>它们中的一些包含操作系统的名称和其他参数，这些参数被清理和缩短以作为分类变量。</p><p id="d3f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(3)- <strong class="ih hj">日期和时间:- </strong>交易日期、时间、小时从给定的时间戳中分离出来，这被认为是一个好的特征。</p><p id="f7ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(4)- <strong class="ih hj">交易金额:- </strong>计算欺诈性和非欺诈性交易的平均值、标准偏差。</p><p id="9691" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(5)- <strong class="ih hj"> Card-X:- </strong>所有卡的详细信息被组合在一起，以给出一个可以识别单个用户交易的id</p><p id="d183" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">更新:- </strong></p><p id="a35c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了更进一步的工程设计，我们做了以下改动:- <br/> (a)-从论坛上，我发现日期并不是一个重要的因素，它只与用户id有关。<br/> (b)-所以直接使用userid给了我们一个非常糟糕的结果，可能是因为新用户在测试集中，而不是在训练集中。</p><h1 id="ecb7" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">[5]为最终步骤处理数据</h1><p id="3f45" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">现在让我们将分类值转换为序数值。下面的代码做到了这一点。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es nc"><img src="../Images/1b85eb4923ca8fc40d684faa21261a1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mzs2PeQWrFXvIhXgWEkGkQ.jpeg"/></div></div></figure><p id="12ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们删除目标列，并将其存储在不同的变量中。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es nd"><img src="../Images/2f92f3c5576ccbc4e216264002f0d4b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c0xLXcyUVWs0zgt0ddNsIg.jpeg"/></div></div></figure><p id="6382" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们将数据分为训练集和测试集。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es ne"><img src="../Images/7448e9bdccca761fbe9dd7a1995d987a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*M9WIK8tNdJeJidrYiUt5sA.jpeg"/></div></figure><p id="2a07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们的数据终于可以施展魔法了。</p><h1 id="7dff" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">[6]建模</h1><p id="44b7" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">因为这是一场激烈的竞争，所以使用简单的基线模型没有帮助。</p><p id="c652" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但还是让我们使用随机森林分类器来检查它是如何工作的。</p><div class="jm jn jo jp fd ab cb"><figure class="mc jq nf me mf mg mh paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/8cf76dfa9e49ddbd31366703018df919.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*PCx-QOL2TheqO85fyumH-A.jpeg"/></div></figure><figure class="mc jq ng me mf mg mh paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/f5a80c8434a80aed50b9c567695df123.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*FBrL8fzsCJZPSckq_iVDZg.jpeg"/></div><figcaption class="mk ml et er es mm mn bd b be z dx nh di ni nj translated">随机森林分类器</figcaption></figure></div><p id="d351" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我们得到的auc-roc值是0.9441。但是请记住，这仍然是在训练集上的结果，我们还必须在最终的测试集上进行尝试。</p><p id="097a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们试试Light GBM，它是一种高级模型，主要用于这种比赛。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es nk"><img src="../Images/2a664600d46258b5326f7d3819c29e35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*tf99PtYeL8mCto8IVVhC-Q.jpeg"/></div><figcaption class="mk ml et er es mm mn bd b be z dx translated">轻型GBM</figcaption></figure><p id="dcb5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我们取得了比上次更好的成绩。让我们最终向kaggle提交我们的测试数据预测。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es nl"><img src="../Images/8dd0713761d6c06a9fb6dc2f50881618.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*rzag4Y5iCYNCxd3Bf57Q9w.jpeg"/></div></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es nm"><img src="../Images/5a15619677509dbaf836cdca8223cfee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QRUaOiE1x74imnIjVPYqLw.jpeg"/></div></div></figure><h1 id="9ef8" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">【7】结论</strong></h1><p id="00a3" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">因此，我们的模型工作得非常好，我们可以使用更高级的特征工程和一些集合模型来进一步改进它。</p><blockquote class="kv kw kx"><p id="602c" class="if ig ky ih b ii ij ik il im in io ip kz ir is it la iv iw ix lb iz ja jb jc hb bi translated"><strong class="ih hj">预防胜于治疗</strong></p></blockquote><p id="6148" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这样，我们可以很容易地确定金钱的损失，并在某种程度上，我们可以提高人们的财务稳定性。</p></div></div>    
</body>
</html>