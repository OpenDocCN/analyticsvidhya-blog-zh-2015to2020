<html>
<head>
<title>PoKi Poems Text Generation — A Comparison of LSTMs, GPT2 and OpenAI GPT3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PoKi Poems文本生成LSTMs、GPT2和OpenAI GPT3的比较</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/poki-poems-text-generation-a-comparison-of-lstms-gpt2-and-openai-gpt3-70c5b6c812b9?source=collection_archive---------12-----------------------#2020-11-18">https://medium.com/analytics-vidhya/poki-poems-text-generation-a-comparison-of-lstms-gpt2-and-openai-gpt3-70c5b6c812b9?source=collection_archive---------12-----------------------#2020-11-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="558c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">PoKi是一个由1到12年级的孩子写的61，330首诗的文集。PoKi在研究儿童语言时特别有用，因为它带有儿童作者的年龄信息(他们的年级)。<a class="ae jd" href="https://github.com/whipson/PoKi-Poems-by-Kids" rel="noopener ugc nofollow" target="_blank"> Github链接</a></p><p id="588d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一首诗的样本:</p><blockquote class="je jf jg"><p id="0f00" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated">一个下雪天:一个下雪天，孩子们出去玩雪。他们扔雪球，滑雪橇，堆雪人。之后，他们进去喝热巧克力。这是一个有趣的下雪天</p></blockquote><p id="9d2d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用PoKi语料库比较文本生成方法。我们尝试了一些传统的模型方法，比如LSTMs，然后是更新更先进的OpenAI模型。对于我们的用例，我们没有按照年龄来区分诗歌，但是这可以进一步研究。</p><p id="8582" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.让我们从经典的安德烈·卡帕西的角色RNNs开始。我们根据字符对文本进行标记并编码。共有129个独特的角色。我们通过连接所有标题和诗歌文本来处理文本，并将每个样本的序列长度保持为100。该模型是具有字符嵌入层和密集输出的简单LSTM模型。</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="90af" class="ju jv hi jq b fi jw jx l jy jz">BATCH_SIZE = 64<br/>vocab_size = len(vocab)<br/>embedding_dim = 256<br/>rnn_units = 1024</span><span id="61de" class="ju jv hi jq b fi ka jx l jy jz">def build_model(vocab_size, embedding_dim, rnn_units, batch_size):<br/> model = tf.keras.Sequential([<br/> tf.keras.layers.Embedding(vocab_size, embedding_dim,<br/> batch_input_shape=[batch_size, None]),<br/> tf.keras.layers.LSTM(rnn_units,<br/> return_sequences=True,<br/> stateful=True,<br/> recurrent_initializer=’glorot_uniform’),<br/> tf.keras.layers.Dense(vocab_size)<br/> ])<br/> return model</span><span id="3da6" class="ju jv hi jq b fi ka jx l jy jz">model = build_model(<br/> vocab_size=len(vocab),<br/> embedding_dim=embedding_dim,<br/> rnn_units=rnn_units,<br/> batch_size=BATCH_SIZE)</span><span id="6975" class="ju jv hi jq b fi ka jx l jy jz">def loss(labels, logits):<br/> return tf.keras.losses.sparse_categorical_crossentropy(labels, logits, from_logits=True)</span></pre><p id="d68e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们对模型进行20个时期的训练，并得到这样一个提示的输出<br/>“我爱动物园:玫瑰是红色的”</p><p id="f3f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">输出</strong>:</p><blockquote class="je jf jg"><p id="33da" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated">我爱动物园:玫瑰是红色的，紫罗兰是蓝色的，不代表生命！亲爱的再见:樱桃在低语，你的双脚也许冰冷却找不到。制造幻觉感受坏的温和的特色空气，它稳定地像一个挤奶工，我能通过事物辨别方向。我的黎明在漂移，闪光的人的罢工不知道为什么？孩子们真正想要的是什么？我应该通过吗？我的眼泪落下，静如冰湖。</p></blockquote><p id="bf98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嗯，是的，有一些单词，但考虑到它只有字符结构信息，还是很不错的。</p><p id="c0d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.让我们看看基于单词的LSTMs。我们保持上面的模型结构不变，只是用单词词汇大小60726替换了vocab大小。由于更大的词汇量，模型训练需要更长的时间。</p><p id="2d1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于相同的提示，下面是输出:</p><blockquote class="je jf jg"><p id="db36" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated">我爱动物园:玫瑰是红色的，写火车脚趾和腿溺水，因为我想到一个simlie我觉得平静像一个弹弓手或自由像狼谁看到了它一夜，但唯一的事情是我有机会去海滩，甚至我的老鼻子我想知道我是不是我的脸感觉很好，为我的意识深度一天晚上我走在这里，看到在她的怀里，我知道她错了，当她喜欢</p></blockquote><p id="476e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">头脑麻木呵呵？:)</p><p id="4988" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.具有快速文本嵌入的LSTMs</p><p id="0374" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在将尝试快速文本嵌入。我们在语料库上训练快速文本，然后将其用作LSTM模型中的嵌入矩阵。我们训练它20个纪元。对于与上面相同的提示，我们再次生成输出。</p><p id="d727" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">输出:</strong></p><blockquote class="je jf jg"><p id="ba8b" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated">我喜欢动物园:玫瑰是红色的，再来一点想象一下，当我九岁的时候，我不得不在干草上留级，在外面喝酒，我看见了蜜蜂我今天怎么能上来，但是昨天我会你会有很多作业，所以事情要快交朋友有时事情可以当一个朋友可以是一群母亲的管弦乐队，你应该吗 同意诗中的说法，所以小男孩不能离开学校，但男孩的心每个人的时间我在做梦</p></blockquote><p id="1359" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.OpenAI GPT2</p><p id="35d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在转到GPT3之前，让我们先试试GPT2。GPT2 large有7.74亿个参数，大小几乎是3GB。由于机器的限制，我们将只使用仅包含1.24亿个参数的小版本</p><p id="d3b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用HuggingFace，我们可以非常容易地导入标记器和模型，并使用它进行预测。</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="cd4d" class="ju jv hi jq b fi jw jx l jy jz">tokenizer = GPT2Tokenizer.from_pretrained("gpt2")<br/>GPT2 = TFGPT2LMHeadModel.from_pretrained("gpt2", pad_token_id=tokenizer.eos_token_id)</span></pre><p id="3078" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">贪婪搜索在每个时间步选择概率最高的单词。不过，这个模型开始不断重复。</p><p id="6114" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">贪婪搜索的输出:</strong></p><blockquote class="je jf jg"><p id="e293" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated">我喜欢动物园:玫瑰是红色的，紫罗兰是蓝色的。我喜欢动物园。你知道吗？恐怖森林。:森林真的闹鬼。我相信是这样的。但是之后我们要去露营。学校远足:学校真的很吓人。我相信是这样的。但是之后我们要去露营。学校远足:学校真的很吓人。我相信是这样的。但是之后我们要去露营。</p></blockquote><p id="4acd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">波束搜索在每个时间步找到最可能的单词数，并继续沿该路径扩展。它最终选择概率最高的假设。波束搜索也可以输出重复，我们使用no_repeat_ngram_size = 2来去除混淆。</p><p id="c8a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">光束搜索输出:</strong></p><blockquote class="je jf jg"><p id="2db0" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated">我喜欢动物园:玫瑰是红色的，紫罗兰是蓝色的。我喜欢动物园。你知道吗？恐怖森林。:森林真的闹鬼。我相信是这样的。但是之后我们要去露营。学校远足:我要去上学。我将和我的朋友们在树林中。我们会玩得很开心的。</p></blockquote><p id="d6a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以使用抽样在我们生成的文本中引入一些随机性。我们设置do_sample = True。在Top-K采样中，K个最可能的下一个单词被过滤，并且概率质量仅在这K个下一个单词中重新分配。这降低了产生不连贯单词的可能性。</p><p id="7c70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">前K个采样的输出:</strong></p><blockquote class="je jf jg"><p id="9c07" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated">我喜欢动物园:玫瑰是红色的，紫罗兰是蓝色的。我喜欢动物园。你知道吗？恐怖森林。:森林真的闹鬼。我相信是这样的。但是之后我们要去露营。学校远足:学校远足。远足就是远足。我不确定这是远足还是远足。但我认为这是一次远足。</p></blockquote><p id="e935" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">哼。好吧。</p><p id="a8d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.open ai GPT3——王者终于到来:)我们可以使用OpenAI API访问GPT 3。让我们看看GPT3生成了什么。</p><p id="e1cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们给GPT3两个标题和诗歌文本来理解我们想要的。</p><p id="bcb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">提示:</strong></p><blockquote class="je jf jg"><p id="1c42" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated">“我喜欢动物园:玫瑰是红色的，紫罗兰是蓝色的。我喜欢动物园。你知道吗？恐怖森林。:森林真的闹鬼。我相信是这样的。但是之后我们要去露营。在学校远足:我今天在学校远足，这是我看到的弹跳球女孩们靠着墙聊天孩子们爬上单杠我甚至看到一些老师的汽车风吹着我的头发在我脸上我看到一个泥坑，但只是一个痕迹所有这些事情我刚才在我的小远足中注意到的。电脑:"</p></blockquote><p id="5c41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">文本补全输出:</strong></p><blockquote class="je jf jg"><p id="6745" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated">“1 2 3代码-点击4回车-回车5 ok-睡眠键盘:在键盘上，我喜欢我的小写字母在左上角，大写字母在右边，数字在它们之间，我不喜欢把键放在一起，这使我打错了我的文本，我喜欢中间有一个空格。双胞胎:很多事情都是成对出现的，他们有第二只眼睛来看，你知道事情看起来会更好</p></blockquote><p id="1f28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">令人惊讶的是，只看几行和一个模式，GPT3就能够理解这是一个标题，后面是诗歌文本，并且能够用非常像人类的句子来模仿它。</p><p id="b082" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">让我们试试GPT3的其他用例。</strong></p><p id="7fe5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">英语到法语翻译:</strong></p><blockquote class="je jf jg"><p id="c6e5" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated"><strong class="ih hj">提示:</strong></p><p id="dd61" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated">“L1:你好吗？法语:这是什么名字？L1:你叫什么名字？法语:你的名字是什么？L1:你是哪里人？法语:“</p><p id="2ee3" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated"><strong class="ih hj">输出:</strong><br/>“D ' oùvenez-vous？L1:你多大了？法语:你好吗？L1:你的地址是哪里？法语:o habitez-vous？L1:你的电子邮件地址是什么？法语:这是一封电子邮件吗？L1:你的电话号码是多少？法语:电话号码是多少？英语:你会说英语吗？”</p></blockquote><p id="4751" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它似乎很好地抓住了总的模式！</p><p id="892b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">总结:</strong></p><blockquote class="je jf jg"><p id="9804" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated"><strong class="ih hj">提示:</strong> <br/>“根据设计，区块链可以抵抗对其数据的修改。这是因为一旦记录，任何给定块中的数据都不能在不改变所有后续块的情况下被追溯性地改变。为了用作分布式分类帐，区块链通常由对等网络管理，该对等网络共同遵守用于节点间通信和验证新块的协议。尽管区块链记录不是不可更改的，但区块链在设计上可以被认为是安全的，并且是具有高度拜占庭容错的分布式计算系统的一个范例。区块链被描述为一个开放的、分布式的分类账，它可以有效地、可验证地、永久地记录双方之间的交易。<strong class="ih hj">总结一下，我们可以说</strong></p><p id="6bb3" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated"><strong class="ih hj">输出:</strong> <br/>“作为分布式分类账，区块链降低了交易验证的成本，提高了多方交易的效率。为了用作分布式分类帐，区块链通常由对等网络管理，该对等网络共同遵守用于节点间通信和验证新块的协议</p></blockquote><p id="b403" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那看起来相当惊人。</p><p id="5c20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">自由形式写作:</strong></p><blockquote class="je jf jg"><p id="b04a" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated">她穿着柔软的白色毛衣<br/>告诉上帝，他说:“孩子们，我们把你们丢下了吗？我们允许吗？”她感受到了天堂的温暖，叹了一口气说:“再见。”她向下看，说她注定要站在天堂之门下；他打开门，说:“你不会死的；<br/>有一天明星，你”</p><p id="be0d" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated"><strong class="ih hj">提示:</strong></p><p id="4e79" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated">“从前有一只猴子和一只鸭子，他们很乖”</p><p id="ba48" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated"><strong class="ih hj">输出:</strong></p><p id="2c01" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated">“朋友。一天，他们决定去探险。一天深夜，当他们走在路上时，他们来到了一个岔路口。”我们走哪条路？”鸭子问。猴子说:“当你可以掷硬币的时候，为什么要决定呢？”于是猴子把一枚硬币抛向空中。他们走在硬币落地的路上，所以他们没有决定！”</p></blockquote><p id="63dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">哇！</p><p id="413f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">问答:</strong></p><blockquote class="je jf jg"><p id="532f" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated"><strong class="ih hj">提示:</strong></p><p id="2b9e" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated">“我:嗨！你能帮我介绍一些好的餐馆吗？艾:当然，你想吃什么菜？我:我更喜欢大陆AI:“</p><p id="43a8" class="if ig jh ih b ii ij ik il im in io ip ji ir is it jj iv iw ix jk iz ja jb jc hb bi translated"><strong class="ih hj">输出:</strong> <br/>“让我们看看，美丽的海景就是那家鱼馆我:太棒了！请预订明晚的，我们将有4个人艾:是安吉拉和罗德里戈吗？我:对！我们就去那里！”</p></blockquote><p id="57b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">太可怕了，不是吗？通过展示一个例子并让GPT3推断出合适的完成方式，使用GPT3可以做很多事情。</p><p id="f889" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有代码都可以在<a class="ae jd" href="https://github.com/ashavish/poki-text-generation" rel="noopener ugc nofollow" target="_blank"> github repo </a>上获得。</p><p id="c08f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望你喜欢这篇文章！一定要让我知道你的意见。</p></div></div>    
</body>
</html>