<html>
<head>
<title>Practical approach of State-of-the-Art Flair in Named Entity Recognition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">命名实体识别中的实用方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/practical-approach-of-state-of-the-art-flair-in-named-entity-recognition-46a837e25e6b?source=collection_archive---------2-----------------------#2019-12-12">https://medium.com/analytics-vidhya/practical-approach-of-state-of-the-art-flair-in-named-entity-recognition-46a837e25e6b?source=collection_archive---------2-----------------------#2019-12-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/f1eb14a3c8e5a7ce9f4432bc9aa579a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LhVTl0WNvpsJX38BCefrWA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">NLP中的NER</figcaption></figure><p id="66e0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">今天我们来讨论自然语言处理中最流行的用例，即NER——命名实体识别。在本帖中，我们将介绍一种最先进的算法Flair的实际应用。</p><h1 id="e868" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">什么是NER？</h1><p id="41a8" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">NER可用于识别实体，如给定文本中的组织、位置、个人和其他实体。</p><h1 id="5980" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">NER有哪些使用案例？</h1><p id="617c" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">许多商业或现实世界的问题都可以通过NER解决:</p><ol class=""><li id="0e60" class="kv kw hi iw b ix iy jb jc jf kx jj ky jn kz jr la lb lc ld bi translated">分类将非常容易，我们可以容易地识别文档/文本与公司、地点或人等相关。</li><li id="19d9" class="kv kw hi iw b ix le jb lf jf lg jj lh jn li jr la lb lc ld bi translated">基于大量文本数据中存在的实体，快速识别隐藏的见解。</li><li id="5ef3" class="kv kw hi iw b ix le jb lf jf lg jj lh jn li jr la lb lc ld bi translated">对于从文本中进行信息检索，实体识别非常重要。使用NER，可以将信息提取到正确的搜索查询中。</li></ol><h1 id="1fb1" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">我们今天的算法是:</h1><p id="a291" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">今天，我提出了我们的NER任务的天赋框架。这是NLP任务中最先进的图书馆之一。它使用Pytorch。NER天赋的好处在于它是基于上下文工作的。它是由Zalando研究小组开发的。让我们开始看看结果。</p><h1 id="7add" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">天赋装置</h1><p id="2d08" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">首先我们需要安装pytorch框架。根据您的系统兼容性，选择pytorch.org网站中的选项，并运行如下所示的命令。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lj"><img src="../Images/fd1e344e341bb6ececaedfe787071258.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S3JyO6kysxOTNNDKqXaaCg.png"/></div></div></figure><p id="6582" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我在管理员模式下运行Anaconda命令提示符，如下所示:</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/b5f0be06aac89edf8ade9d4e12b370c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pJASqRT8yu050tDKE-cgFQ.png"/></div></div></figure><p id="34fe" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">安装完成后，使用以下命令安装Flair:</p><pre class="lk ll lm ln fd lp lq lr ls aw lt bi"><span id="901e" class="lu jt hi lq b fi lv lw l lx ly"><strong class="lq hj">pip install flair</strong></span></pre><h1 id="2e8e" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">NER天赋的实际应用</h1><p id="17fe" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">让我们编写基本脚本来查看NER的输出。前两行代码导入flair模型，如下所示。它将首次下载NER模型。</p><pre class="lk ll lm ln fd lp lq lr ls aw lt bi"><span id="b524" class="lu jt hi lq b fi lv lw l lx ly"><strong class="lq hj">#import commands for flair NER<br/>from flair.data import Sentence<br/>from flair.models import SequenceTagger</strong></span></pre><p id="e003" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来，加载下载的NER模型，如下所示:</p><pre class="lk ll lm ln fd lp lq lr ls aw lt bi"><span id="3f85" class="lu jt hi lq b fi lv lw l lx ly"><strong class="lq hj">#Load NER Model<br/>tagger = SequenceTagger.load('ner')</strong></span></pre><p id="f9a0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">之后，让我们给一些样本文本。接下来，我们将文本转换成句子语法。这将把文本转换成标记。</p><pre class="lk ll lm ln fd lp lq lr ls aw lt bi"><span id="7607" class="lu jt hi lq b fi lv lw l lx ly"><strong class="lq hj">#Sample text to run NER<br/>text = 'Jackson is placed in Microsoft located in Redmond'</strong></span><span id="1717" class="lu jt hi lq b fi lz lw l lx ly"><strong class="lq hj">#passing text to sentence<br/>sentence = Sentence(text)</strong></span></pre><p id="b13d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来是非常重要的一行，用来识别句子中的实体。为了查看实体，我们运行最后两行代码。</p><pre class="lk ll lm ln fd lp lq lr ls aw lt bi"><span id="e29f" class="lu jt hi lq b fi lv lw l lx ly"><strong class="lq hj"># Run NER on sentence to identify Entities<br/>tagger.predict(sentence)</strong></span><span id="f201" class="lu jt hi lq b fi lz lw l lx ly"><strong class="lq hj"># print the entities with below command<br/>for entity in sentence.get_spans('ner'):<br/>    print(entity)</strong></span></pre><p id="9973" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">上面的打印命令将给出下面的输出。正如我们在下面看到的，它将杰克逊标记为个人(PER)，将微软标记为组织(ORG)，将雷德蒙标记为位置(LOC)。</p><p id="00b1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">PER-span[1]:" Jackson "<br/>ORG-span[5]:"微软"<br/> LOC-span [8]: "Redmond" </strong></p><p id="7971" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">仅用8行简单的代码，我们就能够获得实体。让我们来看一下带有标签的句子，标签是为同一个句子标识的。</p><pre class="lk ll lm ln fd lp lq lr ls aw lt bi"><span id="ef1b" class="lu jt hi lq b fi lv lw l lx ly"><strong class="lq hj">print(sentence.to_tagged_string())</strong></span></pre><p id="582d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">下面是上面语句的输出。</p><p id="e49b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">杰克森&lt; S-PER &gt;放在微软&lt; S-ORG &gt;位于雷德蒙&lt;S-LOC&gt;T5】</strong></p><p id="bdfa" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在我们再写一个句子，看看输出。</p><pre class="lk ll lm ln fd lp lq lr ls aw lt bi"><span id="d637" class="lu jt hi lq b fi lv lw l lx ly"><strong class="lq hj">#Sample text<br/>text1 = ‘Redmond is coming to New York city’</strong></span><span id="2153" class="lu jt hi lq b fi lz lw l lx ly"><strong class="lq hj">#passing text to sentence<br/>sentence = Sentence(text1)</strong></span><span id="5cf5" class="lu jt hi lq b fi lz lw l lx ly"><strong class="lq hj"># Run NER on sentence to identify Entities<br/>tagger.predict(sentence)</strong></span><span id="764e" class="lu jt hi lq b fi lz lw l lx ly"><strong class="lq hj"># print the entities with below command<br/>for entity in sentence.get_spans(‘ner’):<br/>    print(entity)</strong></span></pre><p id="1c1b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">输出如下所示:</p><p id="eb15" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> PER-span [1]:"雷德蒙"<br/> LOC-span [5，6]:"纽约"</strong></p><p id="265b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">有点棘手吧！现在Flair说Redmond是人，在第一个例子中Redmond是位置。所以在这两个地方，NER是正确的。上下文在这里起着关键的作用。基于上下文的天赋NER给出输出，这在数据驱动的项目中非常重要。这也在一定程度上解决了词语歧义。例句:一个词是人还是地点？公司还是人？</p><h1 id="07cd" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">天才模特</h1><p id="2359" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">在Flair NER，有各种预训练模型可供选择。在本帖中，我们将只讨论NER模型。ner型号需要GPU，但我们也有ner-fast型号的CPU版本。我在下面列出了其中的一些。Flair也有多语言模型。你也可以在这里看到它们<a class="ae ma" href="https://github.com/zalandoresearch/flair/blob/master/resources/docs/TUTORIAL_2_TAGGING.md" rel="noopener ugc nofollow" target="_blank"/></p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/aa3000a4ff50a50bafd92de784987b9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Qff3FiitB05Gn15lHIVyQ.png"/></div></div></figure><h1 id="cf31" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">在文章文本上使用天赋</h1><p id="4a9e" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">到目前为止，我们已经看到通过一个句子和预测实体。现在让我们通过一段，看看结果。</p><p id="4913" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">下面这段话我是从彭博<a class="ae ma" href="https://www.bloomberg.com/news/articles/2019-11-13/elon-musk-s-solar-deal-has-become-top-threat-to-tesla-s-future" rel="noopener ugc nofollow" target="_blank">这里</a>拿过来的:</p><pre class="lk ll lm ln fd lp lq lr ls aw lt bi"><span id="8c99" class="lu jt hi lq b fi lv lw l lx ly"><strong class="lq hj">text2 = “During a heated deposition this past June, Elon Musk finally seemed to admit that his harshest critics were right. Since forcing through the controversial 2016 purchase of SolarCity Corp., the struggling solar sales-and-installation business he co-founded with his cousins, Tesla Inc.’s chief executive officer has faced almost-constant criticism: The move was called a catastrophe for Tesla, a $2 billion-plus bailout of a debt-saddled company of which Musk himself was chairman and the largest shareholder. Despite plummeting sales and substantial layoffs in the solar division under Tesla after the merger, Musk has fervently defended the SolarCity acquisition, once calling it “blindingly obvious” and a “no-brainer.””</strong></span></pre><p id="219f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">一个额外的步骤，我们必须做之前，通过上述文本到NER的天赋，即分割成句子的段落。为了拆分句子，NER内置了一个名为segtok库。它将与NER天赋一起安装。现在让我们写代码来分割段落。</p><pre class="lk ll lm ln fd lp lq lr ls aw lt bi"><span id="0bc7" class="lu jt hi lq b fi lv lw l lx ly"><strong class="lq hj">#Import segtok library to split the paragraph into sentences<br/>from segtok.segmenter import split_single</strong></span><span id="73ff" class="lu jt hi lq b fi lz lw l lx ly"><strong class="lq hj">sentences = [Sentence(sent, use_tokenizer=True) for sent in split_single(text2)]</strong></span></pre><p id="6d28" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">从上面的代码行，我们只是简单地传递段落，我们将得到预测实体的句子。让我们用下面的代码预测并打印输出。</p><pre class="lk ll lm ln fd lp lq lr ls aw lt bi"><span id="05f8" class="lu jt hi lq b fi lv lw l lx ly"><strong class="lq hj">#predicting entities<br/>tagger.predict(sentences)</strong></span><span id="e57c" class="lu jt hi lq b fi lz lw l lx ly"><strong class="lq hj"># print the entities with below command<br/>for sent in sentences:<br/>    for entity in sent.get_spans('ner'):<br/>        print(entity)</strong></span></pre><p id="eb8e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">以下是我们从Flair NER获得的上述段落的输出。看起来很正确。</p><p id="f55a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> PER-span [9，10]:“埃隆·马斯克”<br/> ORG-span [9，10]:“SolarCity corp .”<br/>ORG-span[23，24]:“特斯拉公司”<br/> ORG-span [42]:“特斯拉”<br/> PER-span [55]:“马斯克”<br/> ORG-span [12]:“特斯拉”<br/> PER-span [17]:“马斯克”<br/> ORG-span [22]:“</strong></p><p id="e420" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我把示例代码文件放在这里的<a class="ae ma" href="https://github.com/punna111/Flair" rel="noopener ugc nofollow" target="_blank"> github上</a>。</p><p id="e89d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这是我在这个博客上的第一篇文章。请让我知道你是否喜欢这个帖子，以及你对这个帖子的想法。您可以将您的意见/反馈分享给我。</p><p id="5706" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">参考资料:</p><p id="2d70" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">py torch—<a class="ae ma" href="https://pytorch.org/" rel="noopener ugc nofollow" target="_blank">https://pytorch.org/</a></p><p id="c64f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Github的天才链接—<a class="ae ma" href="https://github.com/zalandoresearch/flair" rel="noopener ugc nofollow" target="_blank">https://github.com/zalandoresearch/flair</a></p><p id="c10b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Flair NER车型—<a class="ae ma" href="https://github.com/zalandoresearch/flair/blob/master/resources/docs/TUTORIAL_2_TAGGING.md" rel="noopener ugc nofollow" target="_blank">https://github . com/zalandor research/flair/blob/master/resources/docs/TUTORIAL _ 2 _ tagging . MD</a></p></div></div>    
</body>
</html>