<html>
<head>
<title>Exploring Other Face Detection Approaches(Part 2) — SSH</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索其他人脸检测方法(第2部分)——SSH</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/exploring-other-face-detection-approaches-part-2-ssh-7c85179cd98d?source=collection_archive---------11-----------------------#2020-07-26">https://medium.com/analytics-vidhya/exploring-other-face-detection-approaches-part-2-ssh-7c85179cd98d?source=collection_archive---------11-----------------------#2020-07-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="9f08" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这一系列的文章中，我们将探索不同于普通方法的各种其他人脸检测方法。在上一篇文章(第1部分)中，我们讨论了关于<a class="ae jd" rel="noopener" href="/analytics-vidhya/exploring-other-face-detection-approaches-part-1-retinaface-9b00f453fd15"> RetinaFace </a>。<br/>在这一部分我们将讨论<em class="je"> SSH:单级无头人脸检测器</em>。</p><p id="8725" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将讨论四种不同类型的人脸检测架构。<a class="ae jd" rel="noopener" href="/analytics-vidhya/exploring-other-face-detection-approaches-part-1-retinaface-9b00f453fd15"> RetinaFace </a> <br/> <strong class="ih hj"> 2。SSH:单级无头人脸检测器</strong> <br/> 3。<a class="ae jd" rel="noopener" href="/analytics-vidhya/exploring-other-face-detection-approaches-part-3-pcn-395d3b07d62a"> PCN:渐进校准网络</a> <br/> 4。<a class="ae jd" rel="noopener" href="/analytics-vidhya/exploring-other-face-detection-approaches-part-4-tiny-face-684c8cba5b01">微型人脸检测器</a></p></div><div class="ab cl jf jg gp jh" role="separator"><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk"/></div><div class="hb hc hd he hf"><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/b4ff111eadf998991fe68da4c0df765b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aMpPj6sD0IHyQ4nG6cMJ1A.png"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">SSH的输出</figcaption></figure><h1 id="4451" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">SSH:单级无头人脸检测器</h1><p id="833f" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">大多数基于CNN的检测器，无论是检测对象还是仅检测人脸，都将分类网络转换成两阶段检测系统。在第一阶段，卷积层为对象提出一组边界框，然后分类网络的剩余层被称为“头”用于对提议进行分类。分类网络的头部在计算上可能非常昂贵，并且必须对每个提议的边界框执行。</p><p id="1e2c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SSH的作用来了，因为它是无头的，即它不需要任何完全连接的层来执行建议的分类，而是可以通过仅使用卷积在单个阶段中执行检测和分类，从而减少推理时间。SSH在设计上也是规模不变的。它不是依赖外部多尺度金字塔作为输入来检测各种尺度的人脸，而是从网络的不同深度检测人脸。</p><h2 id="1d61" class="lf kd hi bd ke lg lh li ki lj lk ll km iq lm ln kq iu lo lp ku iy lq lr ky ls bi translated">体系结构</h2><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es lt"><img src="../Images/69250c25e62f27f9d509f2b4fe140b0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bjjb9btN0Zp2kXq3i73NhA.png"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">SSH架构</figcaption></figure><p id="fc43" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，为了更好的理解，我将整个架构分成3个部分。<br/> 1。检测模块，用于检测人脸。<br/> 2。上下文模块，检测模块的一部分。<br/> 3。训练和损失函数。</p><ol class=""><li id="74fb" class="lu lv hi ih b ii ij im in iq lw iu lx iy ly jc lz ma mb mc bi translated"><strong class="ih hj">检测模块</strong></li></ol><p id="7917" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如您所看到的，这是一个完全卷积的网络，后面是3个检测模块(M1、M2和M3)，位于跨距为8、16和32的功能图之上。检测模块由二元分类器和回归器组成，用于检测和定位人脸。</p><p id="3471" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了解决定位问题，他们以密集重叠滑动窗口的方式定义了<a class="ae jd" rel="noopener" href="/@andersasac/anchor-boxes-the-key-to-quality-object-detection-ddf9d612d4f9">锚</a>集。在每个滑动窗口位置，定义K个锚，其具有与窗口相同的中心和不同的尺度，但是仅考虑纵横比为1的锚，以减少锚的数量。如果连接到M <em class="je"> i </em>的特征地图具有尺寸<br/> (W <em class="je"> i </em> x H <em class="je"> i) </em>，那么将会有(W<em class="je">I</em>x H<em class="je">I</em>x K<em class="je">I</em>纵横比为1且比例为{S，S，… }的锚点</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es md"><img src="../Images/dc02748136ece0d9810d63872e9dc821.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*89XfT0fsDET4v4P0e6kXQQ.png"/></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">检测模块:用于检测和定位人脸的一组conv图层</figcaption></figure><p id="e288" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它包括一个有效感受野的上下文模块[讨论如下]。对于M1，输出通道的数量X设置为128，对于M2和M3，设置为256。</p><p id="7656" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在M <em class="je"> i </em>中的每个卷积层，分类器决定锚是否包含人脸。带有2xK输出通道的1x1 conv层充当人脸/非人脸的分类器，另外还有1x！具有4xK输出通道的conv图层会回归边界框。</p><p id="796f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有3个检测模块有3个不同的步幅，分别有助于检测小，中，大脸{使其比例不变}。总体架构中定义的所有卷积层都来自VGG-16网络。对于M1，为了减少存储器消耗，通道数量从512个减少到128个，并且通过将上采样的conv5-3特征与conv 4-3特征相加来完成特征图融合。对于大脸检测，M3具有步幅为2的最大池层。</p><p id="69fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.<strong class="ih hj">上下文模块</strong></p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es me"><img src="../Images/ee3c649aa44a7be5611a15af4289f3de.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*9jfr_hpKDWYLak78-ThYYQ.png"/></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">上下文模块:由检测模块使用</figcaption></figure><p id="aa66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于锚在检测模块中以卷积方式被分类和回归，使用更大的卷积滤波器将类似于在2级检测器中增加提议周围的窗口大小。以这种方式模拟环境将增加与相应层的步幅成比例的感受野，导致每个检测模块中的目标尺度。<br/> 5x5和7x7过滤器用于上下文模块中的卷积，但为了减少使用3x3过滤器部署的参数数量。</p><p id="7034" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.<strong class="ih hj">训练和损失功能</strong></p><p id="8332" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于每个检测模块，网络有三个多任务丢失。为了使每个模块专用于不同的尺度范围，反向传播只对那些被分配面对其特定范围的锚进行。<br/>这是通过根据锚的大小将锚分配给三个检测模块来实现的(最小的锚被分配给M1，然后是M2和M3)。如果其<a class="ae jd" rel="noopener" href="/@nagsan16/object-detection-iou-intersection-over-union-73070cb11f6e"> IoU </a>高于0.5，则锚被分配给地面真实面。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es mf"><img src="../Images/20e5eed838edcc9e333e19058b3e8dd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*BfQukI_xEPq-YCK-_8hh-g.png"/></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">损失函数</figcaption></figure><p id="7887" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，损失函数的第一部分是用于人脸分类的交叉熵损失。indec k表示网络中检测模块的数量，<em class="je"> A_k </em>定义了<em class="je"> M_k </em>检测模块中的锚点集合。预测和地面真实标签分别是<em class="je"> pi </em>和<em class="je"> gi </em>。<br/>如上所述，如果锚的IoU大于0.5，则锚被分配给真实边界框，并且类似地，对于任何真实边界框，如果锚的IoU小于0.3，则负标签被分配给锚。这种锚的组合在参与分类损失的模块<em class="je"> M_k </em>中形成<em class="je"> ((N_k)^c) </em>。</p><p id="d847" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">损失函数的第二部分是平滑l1包围盒回归损失。<em class="je"> pi </em>表示预测的四个边界框值【x，y，w，h】并且<em class="je"> ti </em>是模块<em class="je"> Mk. I(.)</em>是将回归损失仅限制到正锚点的指示函数。<em class="je"> ((N_k)^r) </em>成为模块<em class="je"> M_k </em>中参与回归损失的锚个数。</p><p id="5633" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，<a class="ae jd" href="https://nextjournal.com/tempdata73/dealing-with-class-imbalances" rel="noopener ugc nofollow" target="_blank"> OHEM </a>用于训练宋承宪。它被分别应用于每个检测模块，即对于每个<em class="je"> Mk </em>，我们选择相对于该迭代中网络的权重具有最高分数的负锚和具有最低分数的正锚，以创建小批量。小批量的25%是留给阳性锚的，因为阴性锚的数量更多。</p><p id="a87d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在推理时，使用<a class="ae jd" href="https://towardsdatascience.com/non-maximum-suppression-nms-93ce178e177c" rel="noopener" target="_blank"> NMS </a>将不同尺度的预测盒连接在一起，以获得最终输出。</p><h2 id="b83b" class="lf kd hi bd ke lg lh li ki lj lk ll km iq lm ln kq iu lo lp ku iy lq lr ky ls bi translated">结论</h2><p id="bb31" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">我们了解了一种新的人脸检测器，它是一种快速、轻量级的人脸检测器，与两阶段提议/分类方法不同，它在一个阶段中检测人脸。</p><h2 id="72ed" class="lf kd hi bd ke lg lh li ki lj lk ll km iq lm ln kq iu lo lp ku iy lq lr ky ls bi translated">参考</h2><p id="cc5a" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">代号:<a class="ae jd" href="https://github.com/mahyarnajibi/SSH" rel="noopener ugc nofollow" target="_blank">https://github.com/mahyarnajibi/SSH</a></p><p id="4ea3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">论文:<a class="ae jd" href="https://arxiv.org/pdf/1708.03979.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1708.03979.pdf</a></p></div></div>    
</body>
</html>