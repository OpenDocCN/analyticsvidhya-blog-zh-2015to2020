<html>
<head>
<title>Create your first ML Web App with Flask</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Flask创建您的第一个ML Web应用程序</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/create-your-first-ml-web-app-with-flask-ed0c4bb54312?source=collection_archive---------9-----------------------#2020-06-14">https://medium.com/analytics-vidhya/create-your-first-ml-web-app-with-flask-ed0c4bb54312?source=collection_archive---------9-----------------------#2020-06-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e1c089540a48f3d1cef2bee300fd9249.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wxSqKEREweDn4dyLF8UDHQ.png"/></div></div></figure><p id="08b9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建机器学习或深度学习模型很棒，但这种模型的部署将更棒。如果你在这里，你已经知道一些关于机器学习和模型构建的知识。模型部署部分是数据科学生命周期中最重要的部分之一。因此，我们将创建一个迷你web应用程序，以了解如何将您的ml模型转换为web应用程序。Web应用程序提供了一个更棒的外观来与您的模型进行交互。</p><p id="b9f2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里，我将采用整个机器学习中最流行的数据集，你猜对了，我们将在<strong class="is hj"> IRIS </strong>数据集上工作。我把一个玩具数据集作为这里的主要目标是理解我们如何用一个简单的ml模型创建一个web应用程序。</p><p id="baa9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们在iris数据集上快速创建我们的模型</p><p id="dac7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">导入重要库</strong></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="142f" class="jx jy hi jt b fi jz ka l kb kc">import pandas as pd<br/>from sklearn.linear_model import LogisticRegression<br/>from sklearn.metrics import classification_report<br/>from sklearn.metrics import accuracy_score<br/>from sklearn.model_selection import train_test_split<br/>import pickle</span></pre><p id="5012" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Pickle —保存我们将要训练的模型，以便我们可以在web应用程序中直接使用它。</p><p id="9509" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">数据</strong></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="9519" class="jx jy hi jt b fi jz ka l kb kc">data=pd.read_csv('iris.csv')<br/># X = feature values, all the columns except the last column<br/>X = data.iloc[:, :-1]</span><span id="cc1a" class="jx jy hi jt b fi kd ka l kb kc"># y = target values, last column of the data frame<br/>y = data.iloc[:, -1]</span><span id="f48b" class="jx jy hi jt b fi kd ka l kb kc">#Split the data into 80% training and 20% testing<br/>x_train, x_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)<br/></span></pre><p id="2e27" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们已经加载了数据，并将其分为测试和训练。</p><p id="d5ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">创建并保存模型</strong></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="f001" class="jx jy hi jt b fi jz ka l kb kc">#Train the model<br/>model = LogisticRegression()<br/>model.fit(x_train, y_train) #Training the model<br/>#Test the model<br/>predictions = model.predict(x_test)<br/>print( classification_report(y_test, predictions) )</span><span id="9938" class="jx jy hi jt b fi kd ka l kb kc">print( accuracy_score(y_test, predictions))</span></pre><p id="bc18" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">输出:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="e94f" class="jx jy hi jt b fi jz ka l kb kc">precision    recall  f1-score   support<br/><br/>    Iris-setosa       1.00      1.00      1.00        10<br/>Iris-versicolor       1.00      1.00      1.00         9<br/> Iris-virginica       1.00      1.00      1.00        11<br/><br/>       accuracy                           1.00        30<br/>      macro avg       1.00      1.00      1.00        30<br/>   weighted avg       1.00      1.00      1.00        30<br/><br/>1.0</span></pre><p id="a775" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们终于训练好了我们的模型，我们有100 %的准确率，所以现在让我们保存我们的模型，并在我们的web应用程序中使用它。</p><p id="a5b7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">酸洗我们的模型</strong></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="b839" class="jx jy hi jt b fi jz ka l kb kc">pickle.dump(model,open('model.pkl','wb'))</span></pre><p id="4d53" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们已经用moel.pkl名称保存了我们的模型。让我们快速地看看如何预测一个单一的身份。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="06ec" class="jx jy hi jt b fi jz ka l kb kc">p=model.predict([[5.1,3.5,1.4,0.2]])<br/>print(p[0])</span><span id="53b0" class="jx jy hi jt b fi kd ka l kb kc">'Iris-setosa'   # Output</span></pre><p id="99f5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们刚刚通过以数组的形式传递所有特性做出了我们的预测，并且我们成功地得到了我们的结果，现在让我们开始构建我们的Web应用程序。</p><p id="5ea7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以在这里查看实现的网站演示。</p><p id="e387" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae ke" href="https://floweriris.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://floweriris.herokuapp.com/</a></p><h1 id="86a5" class="kf jy hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">Web应用程序</h1><p id="57e4" class="pw-post-body-paragraph iq ir hi is b it lc iv iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn hb bi translated">让我们开始创建我们的web应用程序。首先，创建一个文件名<strong class="is hj"> app.py。</strong>现在让我们从<strong class="is hj"> </strong>开始编码。</p><figure class="jo jp jq jr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/c81d13e8ee961047f8cfdb522353893e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vLwXfc4UlxiR09V_"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">杰弗逊·桑托斯在<a class="ae ke" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="0cfc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">导入库</strong></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="3bc1" class="jx jy hi jt b fi jz ka l kb kc">import numpy as np</span><span id="ce8e" class="jx jy hi jt b fi kd ka l kb kc">from flask import Flask, request, jsonify, render_template</span><span id="14d0" class="jx jy hi jt b fi kd ka l kb kc">import pickle</span></pre><p id="c33e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，让我们使用pickle命令加载已经保存的模型。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="c733" class="jx jy hi jt b fi jz ka l kb kc">model = pickle.load(open('model.pkl', 'rb'))</span></pre><p id="ba7f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请确保您将模型保存在同一目录中，或者尝试提供模型的完整路径。</p><p id="b3ce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们开始创建我们的应用程序</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="b7d8" class="jx jy hi jt b fi jz ka l kb kc">app = Flask(__name__)</span><span id="601c" class="jx jy hi jt b fi kd ka l kb kc">@app.route('/')</span><span id="d79b" class="jx jy hi jt b fi kd ka l kb kc">def home():</span><span id="fcc6" class="jx jy hi jt b fi kd ka l kb kc">      return render_template('index.html')</span></pre><p id="f046" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">@app.route:表示当浏览器点击特定的URL时要做什么，为此，我们在它下面编写函数。在这种情况下，当用户试图打开我们的网页，它将呈现<strong class="is hj">index.html。</strong></p><p id="65b3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们写我们的函数来做预测，并打印在我们的网页上。</p><figure class="jo jp jq jr fd ij"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="7bc8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们来理解一下上面的代码，首先我们写了一个函数，当我们浏览到<strong class="is hj"> /predict时返回预测值。</strong></p><p id="4c51" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">int_features:这里我们从HTML表单中取出所有的特性，并将其转换成float。</p><p id="1572" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">final_features:这里我们将它们转换成NumPy数组。这样我们就可以直接预测值了。</p><p id="5651" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">预测:在加载模型的帮助下，我们正在进行预测</p><p id="e567" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">输出:这里我们将输出保存为一个字符串</p><p id="849a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">return:这里我们将输出返回给index.html</p><p id="0d8f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">__name__ == "__main__ ":在这里，我们终于在这个里面运行应用程序了。</p><h1 id="e8eb" class="kf jy hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">网站(全球资讯网的主机站)</h1><figure class="jo jp jq jr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/f89eef2467dbae66a2d513cd47c4038e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zkEkqG0eKf70INZ8"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">由<a class="ae ke" href="https://unsplash.com/@glenncarstenspeters?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">格伦·卡斯滕斯-彼得斯</a>在<a class="ae ke" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="e11d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们快速看看我们将如何创建我们的网站。</p><p id="b34d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在创建一个<strong class="is hj">模板文件夹</strong>，在里面你需要创建<strong class="is hj">index.html</strong></p><p id="73dc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">书写我们的index.html</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="8504" class="jx jy hi jt b fi jz ka l kb kc">&lt;!DOCTYPE html&gt;</span><span id="5200" class="jx jy hi jt b fi kd ka l kb kc">&lt;html &gt;</span><span id="cf0d" class="jx jy hi jt b fi kd ka l kb kc">&lt;head&gt;</span><span id="16bf" class="jx jy hi jt b fi kd ka l kb kc">&lt;meta charset="UTF-8"&gt;</span><span id="2b1b" class="jx jy hi jt b fi kd ka l kb kc">&lt;title&gt;ML API&lt;/title&gt;</span><span id="928b" class="jx jy hi jt b fi kd ka l kb kc">&lt;/head&gt;</span><span id="4c9c" class="jx jy hi jt b fi kd ka l kb kc">&lt;body&gt;</span><span id="f11f" class="jx jy hi jt b fi kd ka l kb kc">&lt;div class="login"&gt;</span><span id="77a7" class="jx jy hi jt b fi kd ka l kb kc">&lt;h1&gt;Predict Salary Analysis&lt;/h1&gt;</span><span id="2569" class="jx jy hi jt b fi kd ka l kb kc">&lt;!-- Main Input For Receiving Query to our ML --&gt;</span><span id="bbd5" class="jx jy hi jt b fi kd ka l kb kc">&lt;form action="{{ url_for('predict')}}"method="post"&gt;</span><span id="182a" class="jx jy hi jt b fi kd ka l kb kc">&lt;input type="text" name="SepalLength" placeholder="SepalLength" required="required" /&gt;</span><span id="1418" class="jx jy hi jt b fi kd ka l kb kc">&lt;input type="text" name="SepalWidth" placeholder="SepalWidth" required="required" /&gt;</span><span id="e6aa" class="jx jy hi jt b fi kd ka l kb kc">&lt;input type="text" name="PetalLength" placeholder="PetalLength" required="required" /&gt;</span><span id="beb8" class="jx jy hi jt b fi kd ka l kb kc">&lt;input type="text" name="PetalWidth" placeholder="PetalWidth" required="required" /&gt;</span><span id="bb47" class="jx jy hi jt b fi kd ka l kb kc">&lt;button type="submit" class="btn btn-primary btn-block btn-large"&gt;Predict&lt;/button&gt;</span><span id="3811" class="jx jy hi jt b fi kd ka l kb kc">&lt;/form&gt;</span><span id="e1e6" class="jx jy hi jt b fi kd ka l kb kc">&lt;br&gt;</span><span id="e85c" class="jx jy hi jt b fi kd ka l kb kc">&lt;br&gt;</span><span id="a76f" class="jx jy hi jt b fi kd ka l kb kc">{{ prediction_text }}</span><span id="fd2d" class="jx jy hi jt b fi kd ka l kb kc">&lt;/div&gt;</span><span id="74f1" class="jx jy hi jt b fi kd ka l kb kc">&lt;/body&gt;</span><span id="f6fc" class="jx jy hi jt b fi kd ka l kb kc">&lt;/html&gt;</span></pre><p id="9d60" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lp">在这个简单的HTML中，我们创建了一个包含所有文本类型输入的简单表单，当我们填充所有表单时，当我们单击predict</em><strong class="is hj">{ { URL _ for(' predict ')} }</strong>，这是一个<strong class="is hj"> Jinja </strong>，意思是<strong class="is hj"> /predict。</strong></p><p id="72b6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦用户提交表单，app.py中的预测函数就会被撤销，然后它会返回预测值，该值显示在我们的index.html中，使用的是{{ prediction_text }}。</p></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><h1 id="4bf3" class="kf jy hi bd kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx mb kz la lb bi translated">结论</h1><p id="8836" class="pw-post-body-paragraph iq ir hi is b it lc iv iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn hb bi translated">这就是全部。如果你想要完整的代码，它在我的Github仓库里，我也在Heroku上部署了它。你也可以添加更多的HTML和CSS，使网站更具互动性。我会写更多关于你如何做任何NLP项目的相同过程的帖子，所以一旦我这样做了，请确保你跟随我获得更新。</p><div class="mc md ez fb me mf"><a href="https://github.com/CreatorGhost/IriisApi" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab dw"><div class="mh ab mi cl cj mj"><h2 class="bd hj fi z dy mk ea eb ml ed ef hh bi translated">CreatorGhost/IriisApi</h2><div class="mm l"><h3 class="bd b fi z dy mk ea eb ml ed ef dx translated">这是一个简单的网络应用程序，由机器学习驱动，从最受欢迎的虹膜数据集预测花的类型…</h3></div><div class="mn l"><p class="bd b fp z dy mk ea eb ml ed ef dx translated">github.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt io mf"/></div></div></a></div></div></div>    
</body>
</html>