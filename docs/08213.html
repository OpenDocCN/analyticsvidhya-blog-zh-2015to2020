<html>
<head>
<title>Real time Face Mask Detection System</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实时面罩检测系统</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/real-time-face-mask-detection-system-8d8254c86cfb?source=collection_archive---------9-----------------------#2020-07-21">https://medium.com/analytics-vidhya/real-time-face-mask-detection-system-8d8254c86cfb?source=collection_archive---------9-----------------------#2020-07-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/28b33aa2f84efdc89fa013d180b63a3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fyfSOSKswsmV0n7Wdy6R4Q.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">实时面罩检测器</strong></figcaption></figure><blockquote class="iv iw ix"><p id="a80f" class="iy iz ja jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">" P <strong class="jb hj">生产力就是能够做你以前从来不能做的事情."——</strong><em class="hi">弗兰茨·卡夫卡</em></p></blockquote><p id="b5d4" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">最近的冠状病毒疫情将全世界的人类推向了新的挑战。在这种不确定的情况下，我们都可以发挥自己的作用，为抗击这一疾病作出贡献。这是一个让技术为人类服务的绝佳机会。因此，我们可以通过实施对其有利的有成效的事情来为这种流行病做出贡献。</p><p id="7ff8" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">如果我们有一个系统可以监控我们周围的人是否遵守所有的安全措施，会怎么样？那么为什么不使用<strong class="jb hj"> <em class="ja"> TensorFlow </em> </strong>与<strong class="jb hj"> <em class="ja"> Keras </em> </strong>库和<strong class="jb hj"> <em class="ja"> OpenCV </em> </strong>项目建立一个非常简单和基本的卷积神经网络(CNN)模型来检测你是否戴了面罩来保护自己，这也显示了你对它的准确性。</p><h1 id="97fb" class="ka kb hi bd iu kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">卷积神经网络(CNN) —深度学习</h1><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/b919150f197ebe58baeabb3cce49d7ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ecpZ6msohkOBrDtG1BxNw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">具有多个卷积层的神经网络</strong></figcaption></figure><p id="e1eb" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">CNN的灵感来自大脑的结构，但我们的重点不会放在神经科学上，因为我们没有任何生物学方面的专业知识或学术知识。还要注意的是，它们与真正的人脑相差甚远。CNN是一类神经网络，已被证明在图像识别、处理和分类领域非常有效。</p><p id="2f97" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">根据维基—<a class="ae lc" rel="noopener" href="/@srivastavasaumy2001/machine-learning-everything-you-need-to-know-9d4a415a5695"><strong class="jb hj"><em class="ja">机器学习</em> </strong> </a> <em class="ja">中的<em class="ja">，卷积神经网络(CNN，或ConvNet)是一类深度前馈人工神经网络，最常用于分析视觉图像。</em></em></p><p id="76a4" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">它们已经存在了几十年，但是当使用大的标记数据集时，它们被证明是非常强大的。这需要快速的计算机(例如GPU)！</p><p id="78b1" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">这个网络是多层感知器用于处理和分类的一个很好的例子。这是一种深度学习算法，它将输入作为图像，并有效地对其对象进行加权和偏置，最终能够区分图像。</p><h1 id="84e9" class="ka kb hi bd iu kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated"><strong class="ak"> <em class="ld"> TensorFlow </em> </strong>与<strong class="ak"> <em class="ld"> Keras </em> </strong>库</h1><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es le"><img src="../Images/091a94e73962ad471c0fb29ba6beff3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*wY34CRC0PCn1hOkXvzk_Mw.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">带Keras的张量流</strong></figcaption></figure><p id="dc47" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">在这里，我们将讨论众多库和框架中的两个——tensor flow和Keras。</p><h1 id="8ed0" class="ka kb hi bd iu kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">什么是张量流？</h1><p id="5dad" class="pw-post-body-paragraph iy iz hi jb b jc lf je jf jg lg ji jj jx lh jm jn jy li jq jr jz lj ju jv jw hb bi translated">TensorFlow是一个开源库。当涉及到处理深度神经网络时，它是最著名的库之一。TensorFlow受欢迎的主要原因是使用TensorFlow构建和部署应用程序非常容易。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es lk"><img src="../Images/f7c7c9c27ccae4838910b35768a41b68.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*droUHHrbdQEuEodhaT00pw.png"/></div></figure><p id="d96c" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">TensorFlow擅长数值计算，这对深度学习至关重要。它提供了深度学习所需的大多数主要语言和环境的API</p><h1 id="cdfc" class="ka kb hi bd iu kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">Keras是什么？</h1><p id="b316" class="pw-post-body-paragraph iy iz hi jb b jc lf je jf jg lg ji jj jx lh jm jn jy li jq jr jz lj ju jv jw hb bi translated">Keras是一个完全基于Python的框架，这使得它易于调试和探索。这是一个构建在TensorFlow之上的高级库。它为构建神经网络提供了scikit-learn类型的API。开发人员可以使用Keras快速构建神经网络，而无需担心张量代数、数值技术和优化方法的数学方面。</p><p id="be06" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">Keras开发背后的关键思想是通过快速原型制作来促进实验。从一个想法到结果尽可能不拖延的能力是好的研究的关键。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/d3fb989712b8415916e8c9d79fd766e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*7AhVlQFWIG9M9ltC62q10Q.png"/></div></figure><p id="68d1" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">这为科学家和初级开发人员提供了巨大的优势，因为他们可以直接进入深度学习，而不会被低级计算弄脏手。</p><h1 id="34be" class="ka kb hi bd iu kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated"><strong class="ak"> <em class="ld"> OpenCV </em> </strong></h1><p id="513c" class="pw-post-body-paragraph iy iz hi jb b jc lf je jf jg lg ji jj jx lh jm jn jy li jq jr jz lj ju jv jw hb bi translated">OpenCV是一个跨平台库，使用它我们可以开发实时<strong class="jb hj">计算机视觉应用</strong>。它主要专注于图像处理、视频捕捉和分析，包括人脸检测和对象检测等功能。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/405acd78298df406284d213ffe94b71c.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/format:webp/1*7xZzon4tPud-1SzNe7pLUA.png"/></div></figure><p id="6786" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">OpenCV 旨在为计算机视觉应用提供一个公共基础设施，并加速机器感知在商业产品中的应用。</p><h1 id="6dc6" class="ka kb hi bd iu kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">用OpenCV实现实时视频流中的新冠肺炎人脸检测器</h1><p id="61fb" class="pw-post-body-paragraph iy iz hi jb b jc lf je jf jg lg ji jj jx lh jm jn jy li jq jr jz lj ju jv jw hb bi translated">让我们看看如何检测实时视频流的脸。首先安装必要的软件包。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/a354fc8b6c154d7b6836e6ff8515829d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p33o8q-RZsCBS4syvtG5Xw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">导入必要的包</strong></figcaption></figure><p id="89f5" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated"><strong class="jb hj">检测人脸的功能，然后将我们的人脸面具分类器应用于每个人脸。</strong></p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/52379944cae0b914ca9feb38da29c175.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kJH0LzLWXUm-yplYDNpoOg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">检测面部和应用掩模分类器的功能</strong></figcaption></figure><p id="4498" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">上述detect_and_predict_mask函数接受三个参数:</p><ul class=""><li id="fee5" class="lp lq hi jb b jc jd jg jh jx lr jy ls jz lt jw lu lv lw lx bi translated">帧:来自我们流的帧</li><li id="e367" class="lp lq hi jb b jc ly jg lz jx ma jy mb jz mc jw lu lv lw lx bi translated">faceNet:这是用于检测图像中人脸的模型</li><li id="61ed" class="lp lq hi jb b jc ly jg lz jx ma jy mb jz mc jw lu lv lw lx bi translated">maskNet:人脸面具分类模型</li></ul><p id="73b3" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">在内部，我们构造一个blob，检测人脸，初始化列表，其中两个函数被设置为返回。这些列表包括我们的脸部(即，ROI)、loc(脸部位置)和preds(遮罩/无遮罩预测列表)。</p><p id="6a49" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">从这里开始，我们将循环检测面部:</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/33accc05f3cabe16368de95b1feaa8d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nmrhew7BKpCYavDXd81B8Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">循环人脸检测</strong></figcaption></figure><p id="2ade" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">现在，我们可以实现为预测人脸而创建的掩码预测器。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/be1c7a614d83c8b41ee7ac6b6b99c5e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*29Q7myfGaWDp4uzGhiVYuw.png"/></div></div></figure><p id="3cfb" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">接下来，定义一些命令行参数:</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/21f02de3e9901e88ab0902093dc46ddf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZLa1jcqwBQv2yG2dmUfx9Q.png"/></div></div></figure><p id="b588" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">上面提到的命令行参数包括:</p><ul class=""><li id="b5d3" class="lp lq hi jb b jc jd jg jh jx lr jy ls jz lt jw lu lv lw lx bi translated">face:人脸检测器目录的路径</li><li id="af9c" class="lp lq hi jb b jc ly jg lz jx ma jy mb jz mc jw lu lv lw lx bi translated">模型:通向我们训练过的人脸面具分类器的道路</li><li id="89e6" class="lp lq hi jb b jc ly jg lz jx ma jy mb jz mc jw lu lv lw lx bi translated">置信度:过滤弱人脸检测的最小概率阈值</li></ul><p id="3798" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">导入、便利函数和命令行参数都准备好了，在循环遍历帧之前，我们只需要处理一些初始化:</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/13996b6a25f7d36ad89a6b0490f06b8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YqW5M8UJwbGOYjJ-sRDtyg.png"/></div></div></figure><p id="98c9" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">这里我们已经初始化了:</p><ul class=""><li id="6fcf" class="lp lq hi jb b jc jd jg jh jx lr jy ls jz lt jw lu lv lw lx bi translated">人脸检测器</li><li id="9b05" class="lp lq hi jb b jc ly jg lz jx ma jy mb jz mc jw lu lv lw lx bi translated">面罩检测器</li><li id="d0e7" class="lp lq hi jb b jc ly jg lz jx ma jy mb jz mc jw lu lv lw lx bi translated">网络摄像头视频流</li></ul><p id="461f" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">现在，我们将继续循环播放网络摄像头实时视频流中的帧:</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/2c7eb87b97ce26326659cf9faa4850aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rQnosTFzz2Ity3hNrmlvLA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">循环流中的帧</strong></figcaption></figure><p id="e55a" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">上面提到的所有代码片段都是用来检测网络视频流中的人脸面具的。这只是为了理解通过实时流部分的检测。这样就可以用Python、OpenCV实现实时的人脸面具检测器，用TensorFlow/Keras实现深度学习。</p><div class="ky kz la lb fd ab cb"><figure class="mh ij mi mj mk ml mm paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/b4f0ba2eef9a57ab577534bce5accd56.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*sOU2_sB0uoXqBGvHcPq_ug.jpeg"/></div></figure><figure class="mh ij mn mj mk ml mm paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/b5946622ffe425ff36ddae599ba977d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*hYdMkseid8LtrQ09GJ3yRg.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx mo di mp mq translated"><strong class="bd iu">面具检测</strong></figcaption></figure></div><p id="0226" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">从上面的快照中，我们可以看到它能够正确地检测到我是否戴着面具，并显示面具的准确性，这也非常好。</p><p id="e289" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">在本文中，我们看到了如何检测一个人是否戴着口罩。这可以用于许多应用中。考虑到目前的疫情，戴口罩在不久的将来可能是必要的，这种检测人是否戴口罩的方法可能会非常有用。</p><p id="0ee7" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">注意安全！</p></div></div>    
</body>
</html>