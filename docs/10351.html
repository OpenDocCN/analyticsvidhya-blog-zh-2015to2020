<html>
<head>
<title>Parsing XML files in python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用python解析XML文件</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/parsing-xml-files-in-python-d7c136bb9aa5?source=collection_archive---------0-----------------------#2020-10-15">https://medium.com/analytics-vidhya/parsing-xml-files-in-python-d7c136bb9aa5?source=collection_archive---------0-----------------------#2020-10-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4943" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如何使用简单的python代码以易于操作的形式有效地从XML文件中提取数据</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/172e55d5cc0b0270e02d45e2675ca04d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*05YSlYUvUa56m_pL"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">马库斯·温克勒在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><p id="0450" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">XML(可扩展标记语言)是一种非常类似于HTML(超文本标记语言)的标记语言。XML用于组织数据以便于传输和存储。它使用文本和标签来描述文件中的组件。XML文件是一种半结构化数据。</p><p id="5cc6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在使用Python进行个人项目时，我意识到需要将XML文件中的数据提取为合适的格式，如CSV。使用这种格式的数据更容易。以下是我用来完成任务的简单方法。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kb kc l"/></div></figure><h2 id="3e43" class="kd ke hi bd kf kg kh ki kj kk kl km kn iq ko kp kq iu kr ks kt iy ku kv kw kx bi translated"><strong class="ak">如何解释XML文件中的数据？</strong></h2><p id="b03d" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">以上是我们将用于提取数据的XML文件的一部分。可以从<a class="ae jt" href="https://www.kaggle.com/promptcloud/uk-jobs-on-monster" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>下载原文件。</p><p id="04c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该文件记录了英国的职位，每个职位都有特定的信息字段，如职位名称、职位描述等。这个方法的先决条件是我们需要知道XML文件的结构。这里的<strong class="ih hj">&lt;uniq _ id&gt;</strong><em class="ld"/>是用来提记录的唯一ID。<strong class="ih hj"> &lt;网址&gt; </strong>，<strong class="ih hj"> &lt;职务_职称&gt; </strong>，<strong class="ih hj"> &lt;类别&gt; </strong>等。标签包含当前唯一ID引用的每个作业的描述性值。</p><h1 id="0cf5" class="le ke hi bd kf lf lg lh kj li lj lk kn ll lm ln kq lo lp lq kt lr ls lt kw lu bi translated"><strong class="ak"> 1。导入必要的python库</strong></h1><pre class="je jf jg jh fd lv lw lx ly aw lz bi"><span id="7a5b" class="kd ke hi lw b fi ma mb l mc md">import pandas as pd<br/>import numpy as np</span><span id="0f6e" class="kd ke hi lw b fi me mb l mc md">import xml.etree.cElementTree as et</span></pre><p id="70ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了工作简单起见，我们将使用<strong class="ih hj"> xml </strong>包，从中导入<strong class="ih hj"> etree.cElementTree </strong>作为“et”。“元素”是一个灵活的容器对象，用于在内存中存储分层数据结构。</p><h1 id="f2c7" class="le ke hi bd kf lf lg lh kj li lj lk kn ll lm ln kq lo lp lq kt lr ls lt kw lu bi translated">2.<strong class="ak">解析XML文件</strong></h1><pre class="je jf jg jh fd lv lw lx ly aw lz bi"><span id="01df" class="kd ke hi lw b fi ma mb l mc md">tree=et.parse('/content/drive/My Drive/Colab Notebooks/Monster_UK_Jobs/monster_uk-job_sample.xml')</span><span id="9bba" class="kd ke hi lw b fi me mb l mc md">root=tree.getroot()</span></pre><p id="ff6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<strong class="ih hj"> et.parse() </strong>函数，我们将XML文件解析成对象“树”(用XML文件的路径替换文件路径)。我们文件的解析将从树的根开始。使用<strong class="ih hj">。getroot() </strong>函数，我们得到解析树的根。我们现在可以使用根来遍历我们的文件。</p><h1 id="475f" class="le ke hi bd kf lf lg lh kj li lj lk kn ll lm ln kq lo lp lq kt lr ls lt kw lu bi translated">3.<strong class="ak">创建记录值列表</strong></h1><p id="e9ac" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">我们可以观察XML文件的结构，并确定与每个记录相关联的字段。在我们的例子中，这些字段只不过是标签中的值，如<strong class="ih hj"> &lt; url &gt; </strong>，<strong class="ih hj"> &lt; job_title &gt; </strong>，<strong class="ih hj"> &lt; category &gt; </strong>等。为了存储提取的数据，我们为每个这样的标签值/字段创建空列表。</p><pre class="je jf jg jh fd lv lw lx ly aw lz bi"><span id="0b35" class="kd ke hi lw b fi ma mb l mc md">Timestamp = []<br/>URL = []<br/>Job_Title = []<br/>Category = []<br/>Company_Name = []<br/>City = []<br/>Post_Date = []<br/>Job_Description = []<br/>Company_Description = []<br/>Job_Board = []<br/>Geo = []<br/>Location = []</span></pre><h1 id="3743" class="le ke hi bd kf lf lg lh kj li lj lk kn ll lm ln kq lo lp lq kt lr ls lt kw lu bi translated">4.<strong class="ak">转换数据</strong></h1><p id="0ad2" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">现在使用根，我们遍历我们的文件并将值存储在我们在上一步中创建的列表中。</p><pre class="je jf jg jh fd lv lw lx ly aw lz bi"><span id="fb4b" class="kd ke hi lw b fi ma mb l mc md">for time in root.iter('crawl_timestamp'):<br/>print(time.text)<br/>print("step1")<br/>Timestamp.append(time.text)</span><span id="bcd6" class="kd ke hi lw b fi me mb l mc md">for url in root.iter('url'):<br/>print(url.text)<br/>print("step2")<br/>URL.append(url.text)</span><span id="39c4" class="kd ke hi lw b fi me mb l mc md">for title in root.iter('job_title'):<br/>print("step3")<br/>Job_Title.append(title.text)</span><span id="e61d" class="kd ke hi lw b fi me mb l mc md">for cat in root.iter('category'):<br/>print("step4")<br/>Category.append(cat.text)</span><span id="9d03" class="kd ke hi lw b fi me mb l mc md">for cname in root.iter('company_name'):<br/>print("step5")<br/>Company_Name.append(cname.text)</span><span id="9ed0" class="kd ke hi lw b fi me mb l mc md">for ct in root.iter('city'):<br/>print("step6")<br/>City.append(ct.text)</span><span id="4ffd" class="kd ke hi lw b fi me mb l mc md">for pdate in root.iter('post_date'):<br/>print("step7")<br/>Post_Date.append(pdate.text)</span><span id="cf6d" class="kd ke hi lw b fi me mb l mc md">for jd in root.iter('job_description'):<br/>print("step8")<br/>Job_Description.append(jd.text)</span><span id="2030" class="kd ke hi lw b fi me mb l mc md">for cd in root.iter('company_description'):<br/>print("step9")<br/>Company_Description.append(cd.text)</span><span id="7378" class="kd ke hi lw b fi me mb l mc md">for job_bd in root.iter('job_board'):<br/>print("step10")<br/>Job_Board.append(job_bd.text)</span><span id="26fb" class="kd ke hi lw b fi me mb l mc md">for go in root.iter('geo'):<br/>print("step11")<br/>Geo.append(go.text)</span><span id="e0fa" class="kd ke hi lw b fi me mb l mc md">for loc in root.iter('location'):<br/>print("LAST STEP")<br/>Location.append(loc.text)</span></pre><p id="444a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<strong class="ih hj"> root.iter('__') </strong>函数，为每个字段/标签填充值，我们可以为每个字段的循环编写一个单独的<strong class="ih hj">。我在每个for循环中添加了一个print语句，以便理解执行过程中的流程。</strong></p><p id="51d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们已经解析了数据，并将值存储在单独的列表中。下一步是将它转换成一个熊猫数据框架，使数据更容易使用。</p><h1 id="6aa1" class="le ke hi bd kf lf lg lh kj li lj lk kn ll lm ln kq lo lp lq kt lr ls lt kw lu bi translated">5.<strong class="ak">创建熊猫数据框架</strong></h1><pre class="je jf jg jh fd lv lw lx ly aw lz bi"><span id="5444" class="kd ke hi lw b fi ma mb l mc md">Jobs_df = pd.DataFrame(<br/>                       list(zip(Job_Title, Category, Company_Name, Job_Description, Company_Description, Post_Date, Job_Board, City, Geo, Location, Timestamp, URL)), <br/>                       columns=['Job_Title', 'Category', 'Company_Name', 'Job_Description', 'Company_Description', 'Post_Date', 'Job_Board', 'City', 'Geo', 'Location', 'Timestamp', 'URL'])</span></pre><p id="ee16" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">按照期望的顺序选择所有列表，并为各个列添加列名，我们使用了<strong class="ih hj"> pd。DataFrame() </strong>函数创建一个数据帧。</p><p id="9ff6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">执行上述代码后，您可以查看创建的数据帧，如下所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mf"><img src="../Images/d63f180a3fae486974506ed8f524b2c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dIkVdWdUV20z2sKz-PEwKA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">数据帧预览</figcaption></figure><h1 id="70ad" class="le ke hi bd kf lf lg lh kj li lj lk kn ll lm ln kq lo lp lq kt lr ls lt kw lu bi translated">6.<strong class="ak">保存提取的数据(CSV格式)</strong></h1><p id="6f25" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">我们现在可以将数据帧保存为csv文件，以便于存储和以后使用。</p><pre class="je jf jg jh fd lv lw lx ly aw lz bi"><span id="060a" class="kd ke hi lw b fi ma mb l mc md">Jobs_df.to_csv("monster_uk-job_sample.csv")</span></pre><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kb kc l"/></div></figure><p id="81a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经成功解析了XML文件并提取了数据以供使用！</p><p id="ac35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要获得完整的代码和数据，您还可以访问下面的Github资源库。</p><div class="mg mh ez fb mi mj"><a href="https://github.com/prajwalkhairnar/Extract_XML_Data" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab dw"><div class="ml ab mm cl cj mn"><h2 class="bd hj fi z dy mo ea eb mp ed ef hh bi translated">prajwalkhairnar/Extract _ XML _ Data</h2><div class="mq l"><h3 class="bd b fi z dy mo ea eb mp ed ef dx translated">用python解析XML文件</h3></div><div class="mr l"><p class="bd b fp z dy mo ea eb mp ed ef dx translated">github.com</p></div></div><div class="ms l"><div class="mt l mu mv mw ms mx jn mj"/></div></div></a></div></div></div>    
</body>
</html>