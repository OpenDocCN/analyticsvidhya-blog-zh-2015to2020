<html>
<head>
<title>TalkingData AdTracking Fraud Detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TalkingData AdTracking欺诈检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/talkingdata-adtracking-fraud-detection-71581e788d06?source=collection_archive---------6-----------------------#2019-11-26">https://medium.com/analytics-vidhya/talkingdata-adtracking-fraud-detection-71581e788d06?source=collection_archive---------6-----------------------#2019-11-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b84c8606178f7af265109bae80dde909.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-AQ2xxW0Agy8BxC0"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://unsplash.com/@launchpresso?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">启动按钮</a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">上打开</a></figcaption></figure><h1 id="e7d2" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">描述</h1><p id="81cb" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">欺诈风险无处不在，但对于在网上做广告的公司来说，点击欺诈可能会大量发生，导致误导性的点击数据和金钱浪费。广告渠道可以通过大规模点击广告来推高成本。每月有超过10亿台智能移动设备在使用，中国是世界上最大的移动市场，因此遭受着大量的欺诈流量。</p><p id="74cc" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><a class="ae iu" href="https://www.talkingdata.com/" rel="noopener ugc nofollow" target="_blank"> TalkingData </a>，中国最大的独立大数据服务平台，覆盖全国70%以上的活跃移动设备。他们每天处理30亿次点击，其中90%是潜在的欺诈。他们目前为应用程序开发人员防止点击欺诈的方法是测量用户点击其产品组合的旅程，并标记产生大量点击但从未最终安装应用程序的IP地址。根据这些信息，他们建立了一个IP黑名单和设备黑名单。</p><p id="4355" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj">目标:</strong>建立一个机器学习模型，预测用户点击移动应用添加后是否会下载应用。</p><h2 id="4d0c" class="kw iw hi bd ix kx ky kz jb la lb lc jf ke ld le jj ki lf lg jn km lh li jr lj bi translated">先决条件</h2><p id="5349" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">本文假设读者熟悉机器学习的基本概念，如逻辑回归、决策树、随机森林、梯度提升决策树、K-Fold交叉验证、超参数调整、数据编码、过度拟合、离群值、一键编码、混淆矩阵、Python语法、数据结构、冷启动问题等。</p><h2 id="9835" class="kw iw hi bd ix kx ky kz jb la lb lc jf ke ld le jj ki lf lg jn km lh li jr lj bi translated">数据集概述</h2><p id="7284" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">每行包含一个点击记录，具有以下特征。</p><ul class=""><li id="c87b" class="lk ll hi jv b jw kr ka ks ke lm ki ln km lo kq lp lq lr ls bi translated"><code class="du lt lu lv lw b">ip</code>:点击的ip地址。</li><li id="1d6e" class="lk ll hi jv b jw lx ka ly ke lz ki ma km mb kq lp lq lr ls bi translated"><code class="du lt lu lv lw b">app</code>:营销用app id。</li><li id="3811" class="lk ll hi jv b jw lx ka ly ke lz ki ma km mb kq lp lq lr ls bi translated"><code class="du lt lu lv lw b">device</code>:用户手机的设备类型id(如iphone 6 plus、iphone 7、华为mate 7等。)</li><li id="e91d" class="lk ll hi jv b jw lx ka ly ke lz ki ma km mb kq lp lq lr ls bi translated"><code class="du lt lu lv lw b">os</code>:用户手机的os版本id</li><li id="ed1a" class="lk ll hi jv b jw lx ka ly ke lz ki ma km mb kq lp lq lr ls bi translated"><code class="du lt lu lv lw b">channel</code>:移动广告发布商的渠道id</li><li id="9011" class="lk ll hi jv b jw lx ka ly ke lz ki ma km mb kq lp lq lr ls bi translated"><code class="du lt lu lv lw b">click_time</code>:点击时间戳(UTC)</li><li id="f4c3" class="lk ll hi jv b jw lx ka ly ke lz ki ma km mb kq lp lq lr ls bi translated"><code class="du lt lu lv lw b">attributed_time</code>:如果用户点击广告后下载应用，这是应用下载的时间</li><li id="d490" class="lk ll hi jv b jw lx ka ly ke lz ki ma km mb kq lp lq lr ls bi translated"><code class="du lt lu lv lw b">is_attributed</code>:要预测的目标，表示app已下载</li></ul><p id="0369" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">特征(<code class="du lt lu lv lw b">ip</code>、<code class="du lt lu lv lw b">app</code>、<code class="du lt lu lv lw b">device</code>、<code class="du lt lu lv lw b">os</code>和<code class="du lt lu lv lw b">channel)</code>被编码。</p><h2 id="7cda" class="kw iw hi bd ix kx ky kz jb la lb lc jf ke ld le jj ki lf lg jn km lh li jr lj bi translated">现实世界/业务目标和约束</h2><ul class=""><li id="b19e" class="lk ll hi jv b jw jx ka kb ke mc ki md km me kq lp lq lr ls bi translated">错误分类的成本很高。</li><li id="1b33" class="lk ll hi jv b jw lx ka ly ke lz ki ma km mb kq lp lq lr ls bi translated">没有严格的延迟要求。</li><li id="a9d6" class="lk ll hi jv b jw lx ka ly ke lz ki ma km mb kq lp lq lr ls bi translated">需要数据点属于每个类(0，1)的概率。</li><li id="0d47" class="lk ll hi jv b jw lx ka ly ke lz ki ma km mb kq lp lq lr ls bi translated">可解释性很重要。</li></ul><h2 id="155a" class="kw iw hi bd ix kx ky kz jb la lb lc jf ke ld le jj ki lf lg jn km lh li jr lj bi translated">性能指标</h2><p id="344a" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">来源:<a class="ae iu" href="https://www.kaggle.com/c/talkingdata-adtracking-fraud-detection/overview/evaluation" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/talking data-ad tracking-fraud-detection/overview/evaluation</a></p><ul class=""><li id="f8f0" class="lk ll hi jv b jw kr ka ks ke lm ki ln km lo kq lp lq lr ls bi translated">AUC ROC</li><li id="1034" class="lk ll hi jv b jw lx ka ly ke lz ki ma km mb kq lp lq lr ls bi translated">二元混淆矩阵</li></ul><h2 id="398f" class="kw iw hi bd ix kx ky kz jb la lb lc jf ke ld le jj ki lf lg jn km lh li jr lj bi translated">读取数据</h2><p id="4e76" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">首先，我们需要导入我们将使用的导入库。</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/b102e0164745cac1668a5a094df79497.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*wSepQmm4HGnwtlsqI3wquw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图0:导入重要的包</figcaption></figure><p id="50e8" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">我们将使用Pandas来加载数据集。</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/229f3dd6f895e88a8c35374edad6878a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*4Xc-FuFzGZayZE_OI_Cn4g.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图1:数据集的前五行</figcaption></figure><p id="2786" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">我们可以观察到属性时间有一个值。对于在点击应用广告之后没有下载应用的用户，特征attributed_time将是NaN(is _ attributed = 0)，而对于在点击应用广告之后下载了应用的用户，attribute_time将具有类似于click_time的时间值(is_attribute = 1)。</p><h2 id="92eb" class="kw iw hi bd ix kx ky kz jb la lb lc jf ke ld le jj ki lf lg jn km lh li jr lj bi translated">探索性数据分析</h2><p id="bd51" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">探索性数据分析是指对数据进行初步调查的关键过程，以便发现模式，发现异常，测试假设，并借助汇总统计数据和图表检查假设。</p><ul class=""><li id="fbf2" class="lk ll hi jv b jw kr ka ks ke lm ki ln km lo kq lp lq lr ls bi translated">首先，我们将删除数据集中所有重复的行，因为这将影响我们模型的结果。</li></ul><figure class="mg mh mi mj fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/fabd198754e54b1f84df0ebd2bc82c8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*pK7LSCPmNxB6gEVQgUSs3g.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图2:删除重复的数据点</figcaption></figure><p id="5a05" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">我们可以看到，在我们的数据集中总共有3619254个重复数据点，在我们的数据集中总共有181284636个(大约18亿)数据点。</p><ul class=""><li id="fa5e" class="lk ll hi jv b jw kr ka ks ke lm ki ln km lo kq lp lq lr ls bi translated">让我们检查基于类别标签的数据分布，即属于类别0和类别1的点的百分比。</li></ul><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/cefc576344bcad2c4893eed731b4a967.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EqofR9Gk1ScDbV_yjhtiTQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图3:类别标签的分布</figcaption></figure><p id="8947" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">我们可以看到数据集是高度不平衡的。这是机器学习中常见的问题之一。请通过<a class="ae iu" href="https://towardsdatascience.com/methods-for-dealing-with-imbalanced-data-5b761be45a18" rel="noopener" target="_blank">这篇</a>(博客)了解更多。</p><ul class=""><li id="aa6c" class="lk ll hi jv b jw kr ka ks ke lm ki ln km lo kq lp lq lr ls bi translated">让我们检查一下每个要素有多少个唯一值。</li></ul><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/568dbc8b8342a1b1863df99caccc37d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gDquFe3tFh5G74leuk5udw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图4:特性的唯一值</figcaption></figure><ul class=""><li id="feb9" class="lk ll hi jv b jw kr ka ks ke lm ki ln km lo kq lp lq lr ls bi translated">检查除attribute_time之外的给定要素的缺失值。</li></ul><figure class="mg mh mi mj fd ij er es paragraph-image"><div class="er es mo"><img src="../Images/83358c0647f60e16b7ff4bd5f3e7ff84.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*ZqBw2pVsdLhQmIQsuQthRw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图5:检查缺失值</figcaption></figure><p id="e64a" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">使用上面的代码，我们还可以检查其他特性的缺失值，结果发现不存在缺失值。</p><ul class=""><li id="20eb" class="lk ll hi jv b jw kr ka ks ke lm ki ln km lo kq lp lq lr ls bi translated">现在，让我们检查是否有点击后总是下载应用程序的ip和点击后从不下载应用程序的ip。这可能是非常有用的信息。</li></ul><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/63fcdd6192a1b1bf177ed0ffe4ae35d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xMrMY3RSSOB2rTxq37GFoQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图6:总是下载和从不下载</figcaption></figure><p id="a3c1" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">我们可以对其他功能(应用程序、操作系统、渠道、设备)进行同样的检查。</p><ul class=""><li id="e2f9" class="lk ll hi jv b jw kr ka ks ke lm ki ln km lo kq lp lq lr ls bi translated">我们还应该每小时检查一次点击的分布情况。它会告诉我们，一天中什么时候点击量高，什么时候点击量低。有了这些信息，我们可以创建基于时间的功能，如时间间隔。</li></ul><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/90f6c352c815d9450978d0646f7b64bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WTGz0n-SLc7Rw4Gb4FSODw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图7:点击次数与小时数</figcaption></figure><p id="ed75" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">我们可以观察到每天的点击数和每小时的点击数几乎是一样的。</p><ul class=""><li id="f6b1" class="lk ll hi jv b jw kr ka ks ke lm ki ln km lo kq lp lq lr ls bi translated">我们可以检查attributed_time功能中的数据异常，这可以通过创建一个新的功能difference_time来完成，该功能将具有用户在单击广告后下载应用程序所用的时间(以分钟为单位)。现在，根据常识，这个特性的值不能是负的，因为属性time是用户点击广告的时间(click_time)。因此，删除负值。此外，在下载应用程序之前，人们会阅读应用程序的评论，或查看应用程序的内容。因此，他最多需要15分钟来点击下载，因为一些游戏应用程序可能有视频，一个人可能希望看到它并决定他是否要下载它。因此，差异属性不应大于15分钟。这里我们将负值和大于15的值视为异常值。</li></ul><figure class="mg mh mi mj fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/cd02d7c74528dc9c79ae552eda7309f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*lO2CVnV_Z_KwdwAqVqtYbg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图8:移除异常值</figcaption></figure><h2 id="5a1c" class="kw iw hi bd ix kx ky kz jb la lb lc jf ke ld le jj ki lf lg jn km lh li jr lj bi translated">数据的采样和分割</h2><p id="1eab" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">让我们取一个小的数据样本，因为18000万对计算来说太多了，我们取了30万个随机采样的数据点，两个类都有1.5万个数据点。</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/54bfbaf1c8697446afccf12d76234744.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZrVbWfpb8mE_9yQmkhwNZw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图9:采样数据</figcaption></figure><p id="838c" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">我们在该数据中使用了基于时间的分割。对于训练，我们有整个数据集的80%，对于交叉验证，我们有训练数据集的20%，对于测试，我们有整个数据集的20%。</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/430f179918f884329417da6fcec2db2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*WfQE7zIoQcvJFobQBIepiQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图10:分割数据</figcaption></figure><h2 id="39ed" class="kw iw hi bd ix kx ky kz jb la lb lc jf ke ld le jj ki lf lg jn km lh li jr lj bi translated">特征工程</h2><p id="39a6" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">特征工程是使用数据的领域知识来创建使机器学习算法工作的特征的过程。</p><p id="ec9f" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">在这种情况下，我们也可以创建新功能，如果我们将ip视为区域(位置)，我们可以说，拥有特定设备的特定区域的用户不会使用特定的应用程序，即使在单击广告后也不会下载它。在这里，我们可以结合ip +设备来创建新功能。这样，我们可以创建功能(ip、应用程序、设备、操作系统、通道)的电源集，并通过检查是否有仅对应于0类和1类的ip和设备组合来检查这些新创建的功能有多好。</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/55fc156eff6ffcb94844e13a1f9afebe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AqtV2fEWbgPUdkQ7MHXrTA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图11:新特性</figcaption></figure><p id="6dba" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">同样，我们可以做其他组合，检查结果。如果我们观察上述结果，几乎有70%的唯一ip_device对应于类别1和大约。对应于类别0的唯一ip设备的23%。因此，我们可以说这个特性非常有用，因为它具有唯一的值，可以将我们的类标签彼此分开。</p><p id="9ab8" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">在我们的例子中，发现包含ip的特征组合比不包含ip的特征组合具有更高的可分性。</p><p id="83bb" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">下面我们借助click_attribute特性介绍一些基本特性。我们可以引入一天中的几个小时作为该功能，因为一些小时可能会有更多的欺诈点击，因为欺诈者可能在那个时间很活跃。引入星期几没有用，因为数据集中的星期是星期一、星期二、星期三和星期四，它们是工作日。我们可以引入一个时间间隔特征，即[0–3]，[4–7]，[8–11]…[20–23]。</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div class="er es mv"><img src="../Images/07dd05154424bbf61c62655a198c245d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*VNK5CwTxC-YPhMMoHHHu_g.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图12:小时和时间间隔</figcaption></figure><h2 id="f572" class="kw iw hi bd ix kx ky kz jb la lb lc jf ke ld le jj ki lf lg jn km lh li jr lj bi translated">冷启动问题</h2><p id="f28a" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">冷启动是基于计算机的信息系统中的一个潜在问题，它涉及一定程度的自动化数据建模。具体而言，它涉及这样的问题，即系统不能对其尚未收集足够信息的用户或项目做出任何推断，即如果我们的模型在训练时间内没有看到类似的数据，则我们的模型将不能对数据点是否属于哪个类别标签进行分类。当我们在测试数据集中拥有全新的数据点时，就会出现这种情况。</p><p id="a353" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">因此，为了检查我们的模型在测试期间可能会面临多大的冷启动问题。我们检查我们的训练数据与我们的cv数据有多大的不同。我们担心冷启动问题，因为随着时间的推移，趋势会发生变化，即在我们部署模型后可能会引入新的应用程序，而我们的模型可能没有足够的信息将其分类到特定的类别标签。</p><p id="9160" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">为了克服这个问题，我们必须在一段时间间隔后用新数据训练我们的模型，以保持其预测正确类别标签的性能。</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div class="er es mw"><img src="../Images/2a04262a8d74bb67f2eea3831e1921de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*KbrCM1oRFHEge_6IEmBANg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图13.1:冷启动问题</figcaption></figure><figure class="mg mh mi mj fd ij er es paragraph-image"><div class="er es mx"><img src="../Images/72b190bc9442d55ecbdfba87c7c01fd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:506/format:webp/1*7kdm7Qxop2Cn1OkiG2hsug.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图13.2:冷启动问题</figcaption></figure><p id="3f03" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">我们可以看到，与ip相关的特征具有更高的可分性机会，但是由于它具有冷启动问题，所以它可能会影响我们的模型。因此，我们可以使用不同的特征训练不同的模型，看看哪一个表现最好。</p><p id="7732" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj"> Feature_Set 1:它将包含所有基本功能+添加了欺诈和下载百分比&gt; 90 +时间功能的新功能。</strong></p><p id="faef" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj"> Feature_Set 2:将包含所有基本功能+添加了欺诈的新功能和下载百分比&gt; 90 +冷启动问题少于10%的功能+时间功能。</strong></p><p id="5944" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj">特征集3:将包含所有基本特征+冷启动问题少于10%的新特征+时间特征。</strong></p><p id="be1a" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj"> Feature_Set 4:将包含所有基础特性app、os、渠道特性+时间特性的组合。</strong></p><p id="3abf" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj"> Feature_Set 5:将包含所有基础特性app、os、渠道、设备特性+时间特性的组合。</strong></p><h2 id="b973" class="kw iw hi bd ix kx ky kz jb la lb lc jf ke ld le jj ki lf lg jn km lh li jr lj bi translated">数据特征化</h2><p id="c58c" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">在我们建模之前，我们必须始终特征化我们的数据。这里我们的特征是分类的，所以我们可以选择一次性编码。因为每个特征有太多的类别，我们可能最终会有非常高维的数据。所以我们会做响应编码。从给定的图中可以粗略估计出响应编码实际上是什么。</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es my"><img src="../Images/447290886455c05a6c5bf4d8a07082a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UmmURkgwzouCKnDk8CvqCQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图14响应编码(参考:<a class="ae iu" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank">https://www.appliedaicourse.com/</a></figcaption></figure><p id="1ea8" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">在响应编码中，给定一个特征，我们将其转换成“<strong class="jv hj"> k </strong>”(类别标签的数量)特征。在上面的例子中，我们只有2个类(0和1 ),我们得到了两个特征状态的特征。</p><p id="0b68" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">state_[i]的每个值表示属于类[i]的值的概率，该概率由类中出现次数/总出现次数给出。这里[i]属于0和1。</p><p id="0d08" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">我们可以用同样的方式为所有特性实现响应编码。</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mz"><img src="../Images/af5671925ed90551291d0c4314819773.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_1Yw8IDmvNB-SmW2UNbnjg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图15.1:响应编码功能定义</figcaption></figure><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/520883f4393f40e994cb163d78906ba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HWbv_CvxVQCWTjInMKJ_tA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图15.2:响应编码功能调用</figcaption></figure><p id="137d" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">我们使用pickle保存响应编码向量，并在需要训练模型时使用它们。</p><h2 id="4969" class="kw iw hi bd ix kx ky kz jb la lb lc jf ke ld le jj ki lf lg jn km lh li jr lj bi translated">建模</h2><p id="69ed" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">我们应该为每个特性集创建模型，并决定哪个模型是最好的。</p><p id="ef50" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">该模型的代码如下:</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nb"><img src="../Images/5995a536ddce95c1fa52aedfcd46337a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eAw5FSzTzEd_Qp5rYrgLvA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图16.1列车/测试响应编码</figcaption></figure><p id="641e" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">这里我们使用np.hstack来添加所有的响应编码特性。上图只显示了两个特征。类似地，可以对所有需要的特征进行这种处理，我们可以获得最终的训练和测试响应编码。</p><p id="fb42" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj">混淆矩阵</strong>:混淆矩阵是一个表格，通常用来描述一个分类模型(或者“分类器”)在一组真实值已知的测试数据上的性能。它允许算法性能的可视化。要了解更多信息，请点击<a class="ae iu" href="https://towardsdatascience.com/understanding-confusion-matrix-a9ad42dcfd62" rel="noopener" target="_blank">这个</a>。</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/10fd65d040a2b6bf761a75572be9464b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AxkC3v8QhhnWAEw3lOR5SQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图16.2:混淆矩阵函数定义</figcaption></figure><p id="a32d" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj">具有超参数调整的GBDT模型:</strong></p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/2c0839e4609fe4be6f118897a27fb48e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wKluo2HaOwAMVFXPVv4hEg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图16.3:型号代码</figcaption></figure><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nd"><img src="../Images/db628dd84a309527c2d05cb6c7cc66ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oFjKI2gRA6JGFT1wOow7Bw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图16.4:模型结果</figcaption></figure><h1 id="3c35" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">结论</h1><p id="86a4" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">我们发现，具有特征集4的GBDT模型表现最好，对于测试数据集的AUC为98.18%。98.18%的AUC表示，对于一个数据点，如果我们的模型预测类别标签为0，那么我们的数据点有98.18%的机会被正确分类。</p></div><div class="ab cl ne nf gp ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="hb hc hd he hf"><p id="e367" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">我希望我已经让你很好地理解了手头的问题以及我是如何解决它的。这是我第一次尝试写博客，所以我希望读者能慷慨一点，忽略我可能犯的小错误。如果你认为他们可以改善这个博客，请随时提供意见/批评，我一定会努力做出必要的改变。</p><p id="f13b" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj"> <em class="nl">感谢阅读！</em>T13】</strong></p><p id="7cc9" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hj"> <em class="nl">领英:</em></strong>【https://www.linkedin.com/in/mohit-angrish-873026130/】T4</p></div><div class="ab cl ne nf gp ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="hb hc hd he hf"><h1 id="5ee0" class="iv iw hi bd ix iy nm ja jb jc nn je jf jg no ji jj jk np jm jn jo nq jq jr js bi translated">参考资料:</h1><ul class=""><li id="332b" class="lk ll hi jv b jw jx ka kb ke mc ki md km me kq lp lq lr ls bi translated"><a class="ae iu" href="https://www.kaggle.com/c/talkingdata-adtracking-fraud-detection" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/talking data-ad tracking-fraud-detection</a></li><li id="d644" class="lk ll hi jv b jw lx ka ly ke lz ki ma km mb kq lp lq lr ls bi translated"><a class="ae iu" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank">https://www.appliedaicourse.com/</a></li><li id="15cb" class="lk ll hi jv b jw lx ka ly ke lz ki ma km mb kq lp lq lr ls bi translated"><a class="ae iu" href="https://stackoverflow.com/" rel="noopener ugc nofollow" target="_blank">https://stackoverflow.com/</a></li></ul></div></div>    
</body>
</html>