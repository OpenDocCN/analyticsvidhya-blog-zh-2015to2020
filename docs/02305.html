<html>
<head>
<title>An Overview of K Nearest Neighbor</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">K近邻综述</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/an-overview-of-k-nearest-neighbor-99daf8a019ea?source=collection_archive---------11-----------------------#2019-12-10">https://medium.com/analytics-vidhya/an-overview-of-k-nearest-neighbor-99daf8a019ea?source=collection_archive---------11-----------------------#2019-12-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4f1d00eb1071f2dbe72af6902e9cd7a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QqihqCPEby2GcJGagSRBqA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来源:<a class="ae iu" href="https://www.google.com/search?q=fruits+surrounded+knn&amp;tbm=isch&amp;ved=2ahUKEwiFnJ-qp6vmAhUIIisKHTjODZIQ2-cCegQIABAA&amp;oq=fruits+surrounded+knn&amp;gs_l=img.3...13553.14454..14586...0.0..0.137.640.3j3......0....1..gws-wiz-img.aFOmL718wdk&amp;ei=xa3vXcWlEojErAG4nLeQCQ&amp;bih=640&amp;biw=1499&amp;rlz=1C1RLNS_enIN844IN844&amp;hl=en#imgrc=MsLaGUb9B5SosM" rel="noopener ugc nofollow" target="_blank">超链接</a></figcaption></figure><p id="19b2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> ***我热烈欢迎所有的读者！*** </strong></p><h1 id="9ce6" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">内容:</h1><ol class=""><li id="d070" class="kr ks hi ix b iy kt jc ku jg kv jk kw jo kx js ky kz la lb bi translated">KNN简介</li><li id="ba85" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">以玩具为例理解KNN</li><li id="372d" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">K值的选择</li><li id="66bc" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">KNN的应用</li><li id="8fe0" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">摘要</li><li id="7bde" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated">参考</li></ol><h1 id="f04e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">1.KNN简介</h1><p id="c7f9" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated"><strong class="ix hj"> K近邻</strong>简而言之KNN是众多机器学习算法中的一种。KNN属于监督学习的范畴。它既是一种分类算法，也是一种回归算法。它基于<strong class="ix hj">“基于多数类的最近邻分类”的基本思想工作</strong>这里，<strong class="ix hj">‘K’</strong>是自然数，最好选择奇数。假设，我们一边有红色的球，另一边有蓝色的球。我们在红色和蓝色球附近放置一个新球(颜色未知，需要分类)。我们需要弄清楚新球属于红球类别还是蓝球类别。我们现在要做的是，我们将K作为新球的5个最近邻。我们发现在5个最近的邻居中，3个是蓝球，2个是红球。基于多数计数，我们可以将新球归类为蓝色。</p><h1 id="2007" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">2用玩具例子理解KNN:</h1><p id="c756" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">让我们考虑分类技术(二元分类器)。</p><blockquote class="lk ll lm"><p id="007e" class="iv iw ln ix b iy iz ja jb jc jd je jf lo jh ji jj lp jl jm jn lq jp jq jr js hb bi translated">我没有采用包含n个维度的大数据集，因为在我们的脑海中描绘n个维度并理解算法是如何工作的变得很困难。为了更好和更容易理解，我正在创建一个玩具的例子。</p></blockquote><h2 id="3358" class="lr ju hi bd jv ls lt lu jz lv lw lx kd jg ly lz kh jk ma mb kl jo mc md kp me bi translated">2.1创建玩具数据框:</h2><p id="807e" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">我已经创建了一个包含10行2列的玩具示例。列<strong class="ix hj">‘数字’</strong>代表一个自变量(x)，其数字从1到10。列<strong class="ix hj">‘Label’</strong>代表一个因变量(y ),它有一个二进制类标签‘0’和‘1’。</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/153d277c90cc44e3092044c91ba654ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*0jPbGDDM6lpSsD-4c8w2Fg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">玩具数据框</figcaption></figure><p id="cdf1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从上图我们可以看出，1到5的数字属于0类，6到10的数字属于1类。我们现在的目标是给定任何数字(实数或分数)，我们的模型应该能够预测新数据点的类别，即0或1。</p><p id="6401" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将“数字”列指定为“x”，将“标签”列指定为“y”。下面是代码图像。</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/08a6a088d9f2fb64d501e975711259ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d_kYli8poQyEznAjDqEzrQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">分配列</figcaption></figure><h2 id="ea8f" class="lr ju hi bd jv ls lt lu jz lv lw lx kd jg ly lz kh jk ma mb kl jo mc md kp me bi translated">2.2培训模式:</h2><p id="c9d7" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">我们现在将用<strong class="ix hj"> n_neighbors (K) </strong>作为<strong class="ix hj"> 3 </strong>和<strong class="ix hj">‘公制’</strong>作为<strong class="ix hj">‘欧几里德’</strong>来训练模型。k为3意味着我们将只考虑3个最近的邻居，并决定给定点属于0类还是1类。这里，我们正在寻找具有“欧几里得”距离的最近邻居，也称为“L2范数”。它的工作原理类似于毕达哥拉斯定理。点击<a class="ae iu" href="https://en.wikipedia.org/wiki/Euclidean_distance#:~:targetText=In%20mathematics%2C%20the%20Euclidean%20distance,is%20called%20the%20Euclidean%20norm." rel="noopener ugc nofollow" target="_blank">欧几里德距离</a>的超链接。下面是训练模型的代码。</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/127a7a3fcb96299690c301be195b6145.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dpGpP-u5Ufd3t-mcT8gv2w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">培训模型的代码示例</figcaption></figure><blockquote class="lk ll lm"><p id="873e" class="iv iw ln ix b iy iz ja jb jc jd je jf lo jh ji jj lp jl jm jn lq jp jq jr js hb bi translated"><strong class="ix hj">注:</strong>我们可以使用其他距离方法作为度量，如曼哈顿距离(L1范数)、闵可夫斯基距离、汉明距离、余弦距离等。</p></blockquote><h2 id="3aad" class="lr ju hi bd jv ls lt lu jz lv lw lx kd jg ly lz kh jk ma mb kl jo mc md kp me bi translated">2.3预测查询点</h2><p id="fca5" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">有趣的部分来了——预测一个新的点。让我们进入想象。在脑海中想象所有10个数字(1到10)，其中1-5属于0类，6-7属于1类。假设，我想预测数字的类别<strong class="ix hj">‘5.4’</strong>。我们将找到最接近5.4的3个数字，分别是4、5和6。在3个最近的点中，2个点属于0类，1个点属于1类。我们可以根据两种方法来决定5.4的等级。<strong class="ix hj"> 1-基于多数的</strong>和<strong class="ix hj"> 2-基于概率的</strong>。</p><p id="ef76" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 1-基于多数:</strong>多数点(2)属于0类，少数点(1)属于1类。因此，数字5.4将被归类为0。</p><p id="fb6f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 2-基于概率:</strong>数字5.4属于0类的概率是<strong class="ix hj"> 0.66666667 </strong>属于1类的概率是<strong class="ix hj"> 0.33333333 </strong>。基于最高概率，数字5.4将被归类为0。</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/23d8e20eb97737a38bb132d2e84467ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ixd6uquOxPfDeUH_PH1eJQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">用于预测的代码示例</figcaption></figure><h1 id="2a28" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">3K值的选择:</h1><h2 id="7f44" class="lr ju hi bd jv ls lt lu jz lv lw lx kd jg ly lz kh jk ma mb kl jo mc md kp me bi translated">3.1奇数K值:</h2><p id="a704" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">正如我上面提到的，K值最好取一个奇数，并且有一个很好的令人信服的理由。如果K值是偶数，那么K/2个最近的点很可能属于一个类，而其他K/2个可能属于另一个类。假设，我们把K值取为10。不幸的是，如果5个最近的点属于类0，而另外5个属于类1，那么确定新点属于哪个类肯定是一件非常困难的事情。这是取奇数K值的唯一原因。</p><h2 id="8e17" class="lr ju hi bd jv ls lt lu jz lv lw lx kd jg ly lz kh jk ma mb kl jo mc md kp me bi translated">3.2 sci kit封装的右K值:</h2><p id="c49f" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">选择正确的K值对模型性能起着很大的作用。如果我们取了错误的K值，可能会导致<strong class="ix hj">过拟合</strong>或<strong class="ix hj">欠拟合</strong>的问题。那么我们如何选择正确的K值呢？嗯，我们有很多方法，比如<strong class="ix hj"> GridSearchCV、K-Fold交叉验证、RandomizedSearchCV、For循环、</strong>等等，我们可以利用这些方法找到正确的K值。</p><blockquote class="lk ll lm"><p id="b68b" class="iv iw ln ix b iy iz ja jb jc jd je jf lo jh ji jj lp jl jm jn lq jp jq jr js hb bi translated"><strong class="ix hj">注意:</strong>随着K值的减小，模型会导致过拟合，反之则欠拟合。因此，选择正确的K值是一个主要部分。</p></blockquote><h2 id="3f87" class="lr ju hi bd jv ls lt lu jz lv lw lx kd jg ly lz kh jk ma mb kl jo mc md kp me bi translated">3.3带图表的右侧K值:</h2><p id="5a92" class="pw-post-body-paragraph iv iw hi ix b iy kt ja jb jc ku je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">在用scikit软件包调优不同K值的hyperparameter时，我们肯定会有不同的K值和相应的精度或误差。为了以图形方式选择正确的K值，我们需要绘制训练和验证准确度/误差。我已经绘制了训练和验证准确性，我们将使用它来了解。下面是图表图像。</p><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/5d1290bf3611a773cb9677e98e4efa22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b9jM5Kw8ZyOyKKeoJFeoeQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">训练和验证准确度图</figcaption></figure><p id="3f51" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从上图中，我们可以看到训练曲线逐渐下降，验证曲线逐渐上升。我们应该选择K值，使得训练曲线和验证曲线在该值上彼此接近。在我们的例子中，在K 47，训练和验证曲线彼此接近。所以，我们可以选择K为47。</p><blockquote class="lk ll lm"><p id="80c1" class="iv iw ln ix b iy iz ja jb jc jd je jf lo jh ji jj lp jl jm jn lq jp jq jr js hb bi translated"><strong class="ix hj">注:</strong>如果从某个K值(比如43)开始，训练和验证曲线都变成常数，即曲线既不下降也不倾斜。在这种情况下，我们在选择K值时可能会陷入困境，因为曲线在不止一个点上彼此接近。在这种情况下，我们应该选择较小的K值，即如果曲线在K值43、45、47、49处彼此接近，那么我们应该选择K值43。</p></blockquote><h1 id="8a1b" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">4 KNN的应用:</h1><ol class=""><li id="fbec" class="kr ks hi ix b iy kt jc ku jg kv jk kw jo kx js ky kz la lb bi translated"><strong class="ix hj">推荐系统:</strong>像在亚马逊和Flipkart中一样，根据我们之前观看、搜索和购买的数据来推荐产品。在网飞，IMDB等，根据我们的搜索和观看数据推荐电影和网络系列。</li><li id="cefd" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated"><strong class="ix hj">概念搜索:</strong>基于相似概念对文档进行分类。然而还有更多应用。</li></ol><h1 id="9d53" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">5.总结:</h1><ul class=""><li id="3d87" class="kr ks hi ix b iy kt jc ku jg kv jk kw jo kx js mo kz la lb bi translated">KNN是一种监督学习算法，用于分类和回归。</li><li id="2a06" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js mo kz la lb bi translated">使用scikit软件包很容易理解和应用算法。</li><li id="4cd3" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js mo kz la lb bi translated">如果数据有一个巨大的维度，KNN变得非常耗时。因此，当数据具有巨大维度时，应用KNN是不可取的。</li><li id="fb71" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js mo kz la lb bi translated">在大多数情况下，只调整K就足够了，不像其他算法需要调整一个以上的超参数。</li></ul><h1 id="bd45" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">6参考文献:</h1><ol class=""><li id="95cd" class="kr ks hi ix b iy kt jc ku jg kv jk kw jo kx js ky kz la lb bi translated"><a class="ae iu" href="https://www.appliedaicourse.com/course/11/Applied-Machine-learning-course" rel="noopener ugc nofollow" target="_blank">https://www . Applied ai course . com/course/11/Applied-Machine-learning-course</a></li><li id="1408" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js ky kz la lb bi translated"><a class="ae iu" href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsClassifier.html" rel="noopener ugc nofollow" target="_blank">https://sci kit-learn . org/stable/modules/generated/sk learn . neighbors . kneighborsclassifier . html</a></li></ol><h2 id="4df1" class="lr ju hi bd jv ls lt lu jz lv lw lx kd jg ly lz kh jk ma mb kl jo mc md kp me bi translated">帮我连接:</h2><ul class=""><li id="9beb" class="kr ks hi ix b iy kt jc ku jg kv jk kw jo kx js mo kz la lb bi translated"><strong class="ix hj">领英:</strong>【https://www.linkedin.com/in/sandeep-panchal-682734111/】T4</li><li id="1297" class="kr ks hi ix b iy lc jc ld jg le jk lf jo lg js mo kz la lb bi translated"><strong class="ix hj">GitHub:</strong><a class="ae iu" href="https://github.com/Sandeep-Panchal" rel="noopener ugc nofollow" target="_blank">https://github.com/Sandeep-Panchal</a></li></ul><p id="9910" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> ***感谢大家阅读这篇博客。非常感谢您的建议！*** </strong></p></div></div>    
</body>
</html>