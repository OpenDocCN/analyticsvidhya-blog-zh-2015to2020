<html>
<head>
<title>Analyze Public Data with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python分析公共数据</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/analyze-covid-19-cases-data-with-python-74d6c43f9e1c?source=collection_archive---------19-----------------------#2020-04-03">https://medium.com/analytics-vidhya/analyze-covid-19-cases-data-with-python-74d6c43f9e1c?source=collection_archive---------19-----------------------#2020-04-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/732726bca0bceefb1e25acd32c741651.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*u_lzP8Y0Pa3Fks9GD3CjPQ.jpeg"/></div></figure><div class=""/><p id="ab22" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">本文讨论了如何使用Python和Pandas库来分析官方的新冠肺炎案例数据。您将看到如何从实际数据集收集见解，发现乍看之下可能不太明显的信息。特别是，文章中提供的例子说明了如何获得有关疾病在不同国家的传播速度的信息。</p><h1 id="af22" class="jk jl hp bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">准备您的工作环境</h1><p id="8e93" class="pw-post-body-paragraph im in hp io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">为了跟进，您需要在Python环境中安装Pandas库。如果您还没有它，您可以使用pip命令安装它:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="a512" class="kw jl hp ks b fi kx ky l kz la">pip install pandas</span></pre><p id="0b52" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后，您需要挑选一个实际的数据集来使用。对于本文提供的例子，我需要一个数据集，其中包括按国家和日期分列的新冠肺炎确诊病例总数的信息。这样的数据集可以从<a class="ae lb" href="https://data.humdata.org/dataset/novel-coronavirus-2019-ncov-cases" rel="noopener ugc nofollow" target="_blank">https://data . hum data . org/dataset/novel-coronavirus-2019-ncov-cases</a>下载为CSV文件:time _ series _ covid 19 _ confirmed _ global _ narrow . CSV</p><h1 id="4856" class="jk jl hp bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">加载数据并为分析做准备</h1><p id="ecba" class="pw-post-body-paragraph im in hp io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">在将下载的CSV文件读入熊猫数据帧之前，我手动删除了不必要的第二行:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="9877" class="kw jl hp ks b fi kx ky l kz la">#adm1+name,#country+name,#geo+lat,#geo+lon,#date,#affected+infected+value+num</span></pre><p id="8131" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后我把它读入一个熊猫数据帧:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="eed6" class="kw jl hp ks b fi kx ky l kz la">&gt;&gt;&gt; import pandas as pd<br/>&gt;&gt;&gt; df= pd.read_csv("/home/usr/dataset/time_series_covid19_confirmed_global_narrow.csv")</span></pre><p id="b72f" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在让我们仔细看看文件结构。最简单的方法是使用dataframe对象的head方法:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="c49f" class="kw jl hp ks b fi kx ky l kz la">&gt;&gt;&gt; df.head()<br/> Province/State Country/Region Lat Long Date Value<br/>0 NaN Afghanistan 33.0 65.0 2020–04–01 237<br/>1 NaN Afghanistan 33.0 65.0 2020–03–31 174<br/>2 NaN Afghanistan 33.0 65.0 2020–03–30 170<br/>3 NaN Afghanistan 33.0 65.0 2020–03–29 120<br/>4 NaN Afghanistan 33.0 65.0 2020–03–28 110</span></pre><p id="59a5" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">由于我们不会执行复杂的分析来考虑受影响国家在地理上的相互距离，因此我们可以安全地从数据集中移除地理纬度和地理经度列。这可以通过以下方式完成:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="fff5" class="kw jl hp ks b fi kx ky l kz la">&gt;&gt;&gt; df.drop("Lat", axis=1, inplace=True)<br/>&gt;&gt;&gt; df.drop("Long", axis=1, inplace=True)</span></pre><p id="2c73" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们现在看到的应该是这样的:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="9dc2" class="kw jl hp ks b fi kx ky l kz la">&gt;&gt;&gt; df.head()<br/> Province/State Country/Region Date Value<br/>0 NaN Afghanistan 2020–04–01 237<br/>1 NaN Afghanistan 2020–03–31 174<br/>2 NaN Afghanistan 2020–03–30 170<br/>3 NaN Afghanistan 2020–03–29 120<br/>4 NaN Afghanistan 2020–03–28 110</span></pre><p id="dd5d" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在我们开始删除不必要的行之前，了解数据集中有多少行也是很有趣的:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="9a06" class="kw jl hp ks b fi kx ky l kz la">&gt;&gt;&gt; df.count<br/>…</span><span id="624b" class="kw jl hp ks b fi lc ky l kz la">[18176 rows x 4 columns]&gt;</span></pre><h1 id="3a19" class="jk jl hp bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">压缩数据集</h1><p id="a23f" class="pw-post-body-paragraph im in hp io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">浏览数据集中的行，您可能会注意到有些国家的信息是按地区详细列出的，例如中国。但你需要的是全国的综合数据。要完成此合并步骤，您可以对数据集应用groupby操作，如下所示:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="f7a0" class="kw jl hp ks b fi kx ky l kz la">&gt;&gt;&gt; df = df.groupby(['Country/Region','Date']).sum().reset_index()</span></pre><p id="e39b" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">该操作应该减少数据集中的行数，并消除省/州列:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="4363" class="kw jl hp ks b fi kx ky l kz la">&gt;&gt;&gt; df.count<br/>...</span><span id="92c0" class="kw jl hp ks b fi lc ky l kz la">[12780 rows x 3 columns]</span></pre><h1 id="08f1" class="jk jl hp bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">执行分析</h1><p id="807f" class="pw-post-body-paragraph im in hp io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">假设你需要在初始阶段确定疾病在不同国家的传播速度。比方说，您想知道从报告至少100个病例的那一天起，该疾病达到1500个病例需要多少天。</p><p id="bd0c" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先，你需要筛选出那些没有受到太大影响、确诊病例人数没有达到大量的国家。这可以通过以下方式完成:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="f054" class="kw jl hp ks b fi kx ky l kz la">&gt;&gt;&gt; df = df.groupby(['Country/Region'])<br/>&gt;&gt;&gt; df = df.filter(lambda x: x['Value'].mean() &gt; 1000)</span></pre><p id="b20e" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后，您可以只检索满足指定条件的那些行:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="61b8" class="kw jl hp ks b fi kx ky l kz la">&gt;&gt;&gt; df = df.loc[(df['Value'] &gt; 100) &amp; (df['Value'] &lt; 1500)]</span></pre><p id="791c" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">完成这些操作后，行数应该会显著减少。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="c27b" class="kw jl hp ks b fi kx ky l kz la">&gt;&gt;&gt; df.count<br/>… Country/Region Date Value<br/>685 Austria 2020–03–08 104<br/>686 Austria 2020–03–09 131<br/>687 Austria 2020–03–10 182<br/>688 Austria 2020–03–11 246<br/>689 Austria 2020–03–12 302<br/>… … … …<br/>12261 United Kingdom 2020–03–11 459<br/>12262 United Kingdom 2020–03–12 459<br/>12263 United Kingdom 2020–03–13 802<br/>12264 United Kingdom 2020–03–14 1144<br/>12265 United Kingdom 2020–03–15 1145</span><span id="b7eb" class="kw jl hp ks b fi lc ky l kz la">[118 rows x 3 columns]</span></pre><p id="5647" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">此时，您可能想要查看整个数据集。这可以通过下面一行代码来完成:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="8abe" class="kw jl hp ks b fi kx ky l kz la">&gt;&gt;&gt; print(df.to_string())</span><span id="ea70" class="kw jl hp ks b fi lc ky l kz la">Country/Region Date Value<br/>685 Austria 2020–03–08 104<br/>686 Austria 2020–03–09 131<br/>687 Austria 2020–03–10 182<br/>688 Austria 2020–03–11 246<br/>689 Austria 2020–03–12 302<br/>690 Austria 2020–03–13 504<br/>691 Austria 2020–03–14 655<br/>692 Austria 2020–03–15 860<br/>693 Austria 2020–03–16 1018<br/>694 Austria 2020–03–17 1332<br/>1180 Belgium 2020–03–06 109<br/>1181 Belgium 2020–03–07 169</span><span id="e7c8" class="kw jl hp ks b fi lc ky l kz la">…</span></pre><p id="c61c" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">剩下的工作就是计算每个国家的行数。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="095e" class="kw jl hp ks b fi kx ky l kz la">&gt;&gt;&gt; df.groupby(['Country/Region']).size()<br/>&gt;&gt;&gt; print(df.to_string())</span><span id="efbf" class="kw jl hp ks b fi lc ky l kz la">Country/Region<br/>Austria        10<br/>Belgium        13<br/>China          4<br/>France         9<br/>Germany        10<br/>Iran           5<br/>Italy          7<br/>Korea, South   7<br/>Netherlands    11<br/>Spain          8<br/>Switzerland    10<br/>Turkey         4<br/>US             9<br/>United Kingdom 11</span></pre><p id="3411" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">上述列表回答了这样一个问题，即在某个国家，从报告至少100例病例的那一天起，该疾病需要多少天才能达到大约1500例确诊病例。</p><p id="975b" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">免责声明:重要的是要意识到官方确诊病例的比率可能与实际情况有所偏差。问题是，上述分析中使用的数据集忽略了延迟。</p></div></div>    
</body>
</html>