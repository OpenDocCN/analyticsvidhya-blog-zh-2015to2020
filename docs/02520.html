<html>
<head>
<title>Processing Big Datasets in Python using Unix Commands</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Unix命令在Python中处理大数据集</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/dealing-with-big-datasets-in-python-using-unix-commands-5d278da0e8f2?source=collection_archive---------17-----------------------#2019-12-20">https://medium.com/analytics-vidhya/dealing-with-big-datasets-in-python-using-unix-commands-5d278da0e8f2?source=collection_archive---------17-----------------------#2019-12-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/73e35250caff9f71016822969b66f1e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/0*AltN1EaLSMZiuRxb"/></div></figure><div class=""/><p id="6b18" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">作为一名数据科学家，在您的分析过程中，您肯定会遇到比系统上的可用内存更大的大数据集。在这种情况下，一次性加载整个数据集是不可能的。例如，我的系统通常有4GB的空闲内存，而我处理过的一些数据集的大小超过了4GB。对于这篇文章，作为一个例子，我决定使用一个我在以前的文章中用过的小型CSV数据集，即SF犯罪数据集。</p><p id="30a4" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当你发现自己在处理这样的情况时，有两个广泛的选择可以帮助你。</p><p id="25d5" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先，您可以读取文件的前几行或文件的一半，在这种情况下使用pandas中的read_csv函数，并在处理数据集之前感受一下它的结构。这种方法的主要缺点是，您分析所需的数据可能不在您刚刚加载的样品中。例如，因为我只想要数据集中与特定地区和犯罪类别相对应的行；加载整个数据集的一部分对我的分析没有任何帮助。我们当然可以解决这个问题，但这是另一篇博文的内容。</p><p id="fd07" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第二种方法(我实际上想讨论的一种)是使用Unix命令按原样浏览整个文件。如果你像我在这个例子中一样在Jupyter笔记本上工作，它允许通过在前面加上一个“！”来运行Unix命令符号。因为CSV文件已经是结构化的，所以使用这种方法可以使浏览它的任务变得更容易。</p><p id="4745" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在我进入命令之前，我只想说Unix为您提供了许多不同的选项来执行特定的操作。例如，您可以使用命令“grep”、“sed”甚至“awk”来提取具有特定模式的行。下面使用的命令是我在许多可用选项中挑选出来的，并发现它们是合适的。另一个人可能觉得不同的命令组合更适合他们的目的。</p><p id="2c7d" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">那么，让我们来看看我用来获取数据集信息的一些Unix命令。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="0e80" class="jt ju hp jp b fi jv jw l jx jy">wc -l &lt;filename&gt;</span></pre><ul class=""><li id="a3fb" class="jz ka hp io b ip iq it iu ix kb jb kc jf kd jj ke kf kg kh bi translated">这里，wc(字数)和选项“l”一起给出了文件中的行数</li><li id="d2d5" class="jz ka hp io b ip ki it kj ix kk jb kl jf km jj ke kf kg kh bi translated">这当然包括表头！</li></ul><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es kn"><img src="../Images/506e6c8f0d2eb6d6b3faa02076a4bdf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*958IyXWgrj90s8XcuHSS7g.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">“wc”的输出</figcaption></figure><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="cf03" class="jt ju hp jp b fi jv jw l jx jy">head -n &lt;filename&gt;</span></pre><ul class=""><li id="8764" class="jz ka hp io b ip iq it iu ix kb jb kc jf kd jj ke kf kg kh bi translated">类似于pandas中的head(n)函数，它给出了文件的前n行</li><li id="a5a0" class="jz ka hp io b ip ki it kj ix kk jb kl jf km jj ke kf kg kh bi translated">此输出将让您对文件中的数据结构有一个大致的了解；标题将为您提供列名，前几行将为您提供每列中包含的数据类型</li></ul><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es kw"><img src="../Images/2778b3c4a01813107286683fb07e9e35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TD1SQDurqwB-0pXyU7UOug.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">“头”的输出</figcaption></figure><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="db96" class="jt ju hp jp b fi jv jw l jx jy">cut -d’,’ -f6 &lt;filename&gt; | sort | uniq -c</span></pre><ul class=""><li id="b130" class="jz ka hp io b ip iq it iu ix kb jb kc jf kd jj ke kf kg kh bi translated">类似于pandas中的value_counts()函数，我使用这个命令获得我感兴趣的列的唯一值及其计数</li><li id="570a" class="jz ka hp io b ip ki it kj ix kk jb kl jf km jj ke kf kg kh bi translated">这就是管道运营商介入的地方。管道是一种形式重定向，在这里它重定向一个命令的输出作为下一个命令的输入</li><li id="107d" class="jz ka hp io b ip ki it kj ix kk jb kl jf km jj ke kf kg kh bi translated">“d”选项用于指定分隔符，在本例中为“，”</li><li id="bf6d" class="jz ka hp io b ip ki it kj ix kk jb kl jf km jj ke kf kg kh bi translated">“f”选项用于指定字段编号(在本例中为一列)</li><li id="e42f" class="jz ka hp io b ip ki it kj ix kk jb kl jf km jj ke kf kg kh bi translated">然后对cut的输出进行排序，最后显示第6列中的唯一值(这里列的编号不是从0开始)</li><li id="09f7" class="jz ka hp io b ip ki it kj ix kk jb kl jf km jj ke kf kg kh bi translated">“c”选项给出了每个唯一值的计数</li><li id="23ce" class="jz ka hp io b ip ki it kj ix kk jb kl jf km jj ke kf kg kh bi translated">你可能想知道为什么sort要用在‘uniq’之前；这是因为“uniq”命令从输入中删除重复的行，并且只检测这些重复是相邻的；这是通过“排序”实现的</li><li id="664f" class="jz ka hp io b ip ki it kj ix kk jb kl jf km jj ke kf kg kh bi translated">我再次使用了sort，以降序显示计数；“n”表示数字排序(升序)，“r”表示相反的结果</li></ul><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es kx"><img src="../Images/a4b6f593fa5279cb5fa66f1438b29bec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2UIaVIgMwcLhdrDJkEf1Eg.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">“剪切、排序、唯一”的输出</figcaption></figure><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="0a85" class="jt ju hp jp b fi jv jw l jx jy">head -1 $f &gt; output.csv<br/>awk -F, ‘{ if(($2 == “LARCENY/THEFT”) &amp;&amp; ($7 == “SOUTHERN”)) { print} } $f &gt;&gt; output.csv</span></pre><ul class=""><li id="5ae4" class="jz ka hp io b ip iq it iu ix kb jb kc jf kd jj ke kf kg kh bi translated">这里，第一个命令将标题行打印到输出文件，第二个命令使用条件语句选择行，并将它们打印到同一个输出文件</li><li id="daba" class="jz ka hp io b ip ki it kj ix kk jb kl jf km jj ke kf kg kh bi translated">&gt;'运算符创建一个新文件(如果它不存在)或覆盖现有文件</li><li id="0fca" class="jz ka hp io b ip ki it kj ix kk jb kl jf km jj ke kf kg kh bi translated">&gt;&gt;'运算符创建一个不存在的新文件，或者追加到现有文件中</li></ul><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es ky"><img src="../Images/552b7cf53d5b773308ae158420e2a258.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FWh3AO0Dow2JQfy2dPJQAQ.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">“awk”的输出</figcaption></figure></div></div>    
</body>
</html>