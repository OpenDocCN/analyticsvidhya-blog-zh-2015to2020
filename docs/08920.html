<html>
<head>
<title>CNN: Convolutional Neural Network in Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CNN:深度学习中的卷积神经网络</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/cnn-convolutional-neural-network-in-deep-learning-5d8b39a3c283?source=collection_archive---------19-----------------------#2020-08-18">https://medium.com/analytics-vidhya/cnn-convolutional-neural-network-in-deep-learning-5d8b39a3c283?source=collection_archive---------19-----------------------#2020-08-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2cd0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">什么是卷积神经网络？？</p><p id="d722" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">卷积神经网络是深度学习中的一类，它以图像为输入，识别图像之间的边缘和特征，并给出结果。</p><p id="b452" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">CNN 是如何运作的？</p><p id="3b85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">CNN 使用过滤器和最大池来识别水平和垂直的边缘，并仅获得所需的特征或给出相关信息的特征。</p><p id="1e31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">过滤器:</strong></p><p id="7514" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输入图像用滤波器执行卷积运算以提取边缘。有多个滤波器的例子:索贝尔滤波器，沙尔滤波器等。</p><p id="dc83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设有一个 7×7 矩阵和 3×3 滤镜的图像。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/2861b3b8d886bf9f83f0a1939a7fc4c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*4XwRJD_UIRt6A9qAVhjEEA.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">卷积函数</figcaption></figure><p id="68b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自输入图像的第一个 3×3 块与滤波器(图像中的特征检测器)相乘，并且获得特征图的第一个值。如下图所示:</p><p id="7549" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(0x 0)+(0x 1)+(0x 0)+(0x 0)+(1x 0)+(0x 1)+(0x 1)+(0x 0)+(0x 1)= 0</p><p id="17b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类似地，对于第一行中的第二块，</p><p id="ddec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(0x 0)+(1x1)+(0x 0)+(0x 0)+(0x 0)+(0x 1)+(0x 1)+(0x 0)+(0x 1)= 1</p><p id="e5ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">像这样，取一个步长，计算每个块的值，这表示图像的边缘</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jp"><img src="../Images/9daf891dcd51d19879286d076f5e3f39.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*dMHotwha4QAnOJWYW9pxMw.jpeg"/></div></figure><p id="9c8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">特征映射矩阵的大小=输入图像的大小-滤波器的大小+ 1，即在给定的示例中，它将是 7–3+1 = 5，即 5×5。</p><p id="440b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但有时这会产生一个问题，即随着尺寸的减小，一些特征或信息会丢失。在将填充应用于输入图像的情况下，该信息可能很重要。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jq"><img src="../Images/166cfce490e6edab51c723cf599d8482.png" data-original-src="https://miro.medium.com/v2/resize:fit:416/format:webp/1*Cy0o4YjieW-IpHfWXEk-eg.jpeg"/></div></figure><p id="7bf8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">填充后，7x7 矩阵变为 9x9，因此特征图大小将为 9–3+1 = 7，即 7x7，这意味着没有信息丢失。</p><p id="2382" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">最大池层:</strong></p><p id="97d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在 maxpooling 中，假设 maxpooling 层的矩阵大小为 2×2，则从输入图像中每个 2×2 矩阵的最大值中提取，并形成矩阵，该矩阵是 maxpooling 层的输出矩阵或输出，其包含重要特征或包含关于输入的更多信息的特征。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jr"><img src="../Images/7a8df20b646f4eadba51d340b20bcfc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*Yks8-D0ZyrgUsbs4DIOE3w.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">最大池层</figcaption></figure><p id="7a94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">filter 和 maxpooling 的一个优点是，我们从输入图像中获得了重要的特征，并且图像的大小也减小了。</p><p id="f00e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们看看使用 keras 的 filter 和 maxpooling 的代码:</p><pre class="je jf jg jh fd js jt ju jv aw jw bi"><span id="4d48" class="jx jy hi jt b fi jz ka l kb kc">import tensorflow as tf<br/><br/>model = models.Sequential()<br/><br/>model.add(layers.Conv2D(64, (3, 3), activation='relu', input_shape=(32, 32, 3)))<br/><br/>model.add(layers.MaxPooling2D((2, 2)))<br/><br/>model.add(layers.Conv2D(32, (3, 3), activation='relu'))<br/><br/>model.add(layers.MaxPooling2D((2, 2)))<br/><br/>model.add(layers.Conv2D(32, (3, 3), activation='relu'))</span><span id="a8f4" class="jx jy hi jt b fi kd ka l kb kc">model.add(layers.Flatten())<br/><br/>model.add(layers.Dense(64, activation='relu'))<br/><br/>model.add(layers.Dense(10))</span></pre><p id="dfeb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的代码中，第一层包含 64 个大小为 3x3 的滤镜，输入形状为(32，32，3)，表示一个 32x32 的图像，有 3 个通道。层 1 的输出形状将是(30，30，3)。第二层是大小为 2x2 的 maxpooling 层。第二层的输出形状将是(15，15，3)。类似地，第三层具有 32 个大小为 3×3 的滤波器，输出形状为(13，13，3)，第四层的输出形状为(6，6，3)。最后 3 层是扁平化，密集和 10 类输出层。</p><pre class="je jf jg jh fd js jt ju jv aw jw bi"><span id="cec7" class="jx jy hi jt b fi jz ka l kb kc">model.summary()</span><span id="cc4b" class="jx jy hi jt b fi kd ka l kb kc">Model: "sequential_1" _________________________________________________________________ Layer (type)                 Output Shape              Param #    ================================================================= conv2d_3 (Conv2D)            (None, 30, 30, 64)        1792       _________________________________________________________________ max_pooling2d_2 (MaxPooling2 (None, 15, 15, 64)        0          _________________________________________________________________ conv2d_4 (Conv2D)            (None, 13, 13, 32)        18464      _________________________________________________________________ max_pooling2d_3 (MaxPooling2 (None, 6, 6, 32)          0          _________________________________________________________________ conv2d_5 (Conv2D)            (None, 4, 4, 32)          9248       _________________________________________________________________ flatten (Flatten)            (None, 512)               0          _________________________________________________________________ dense (Dense)                (None, 64)                32832      _________________________________________________________________ dense_1 (Dense)              (None, 10)                650        ================================================================= Total params: 62,986<br/>Trainable params: 62,986 <br/>Non-trainable params: 0 _________________________________________________________________</span></pre></div></div>    
</body>
</html>