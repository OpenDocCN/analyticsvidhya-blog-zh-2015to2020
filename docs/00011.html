<html>
<head>
<title>How to finish in the top 10 percentile in Bike Sharing Demand Competition In Kaggle? (part -1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Kaggle的自行车共享需求竞赛中名列前10%？(第一部分)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-finish-top-10-percentile-in-bike-sharing-demand-competition-in-kaggle-part-1-c816ea9c51e1?source=collection_archive---------0-----------------------#2017-05-03">https://medium.com/analytics-vidhya/how-to-finish-top-10-percentile-in-bike-sharing-demand-competition-in-kaggle-part-1-c816ea9c51e1?source=collection_archive---------0-----------------------#2017-05-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2d735977911229bc31b9c02d36295c3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8xkwV6r-i6tHPZz0jZt0Vw.jpeg"/></div></div></figure><p id="b801" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi jo translated"><span class="l jp jq jr bm js jt ju jv jw di"> E </span>非常有抱负的数据科学专业人士一直想参加<em class="jx"> Kaggle </em>竞赛。像他们中的大多数人一样，我通过著名的<a class="ae jy" href="https://www.kaggle.com/c/titanic" rel="noopener ugc nofollow" target="_blank"> <em class="jx">泰坦尼克号-机器从灾难中学习</em> </a> <em class="jx"> </em>比赛开始了我卑微的<em class="jx"> Kaggle </em>旅程。Kaggle有一些从简单到复杂的数据集，用户可以探索这些数据集，并获得数据科学方面的实际专业知识。</p><p id="ba4f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jy" href="https://www.kaggle.com/c/bike-sharing-demand" rel="noopener ugc nofollow" target="_blank"> <em class="jx">自行车共享需求</em> </a> <strong class="is hj"> <em class="jx"> </em> </strong>就是这样一个对数据科学世界的初学者特别有帮助的比赛。这是一个相当简单的数据集，适合应用一些具体的统计技术，如<em class="jx">回归</em>，也适合一些高级的<code class="du jz ka kb kc b">ensemble</code>模型，如<code class="du jz ka kb kc b">Random Forest</code>和<code class="du jz ka kb kc b">Gradient Boosting</code>算法。</p><p id="4ae8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du jz ka kb kc b">bike-sharing </code>需求分析分为两部分。博客的第一部分帮助你从数据集开始，发现因变量和解释变量之间一些有趣的模式。博客的第二部分介绍了模型构建，我们从基本的技术开始，如<code class="du jz ka kb kc b">Regression </code>，通过<code class="du jz ka kb kc b">Regularization </code>，最终构建复杂的<code class="du jz ka kb kc b">ensemble </code>模型。在分析结束时，我们将在公共排行榜上达到前10个百分点。</p><p id="cb84" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">就这个博客而言，所有的<code class="du jz ka kb kc b">exploratory </code>分析和<code class="du jz ka kb kc b">model </code>构建都是使用python完成的。Python有一些优秀的数据科学库，如<code class="du jz ka kb kc b">pandas</code>、<code class="du jz ka kb kc b">numpy</code>、<code class="du jz ka kb kc b">seaborn </code>和<code class="du jz ka kb kc b">sklearn </code>，我们将在这篇博客中使用它们。</p><blockquote class="kd ke kf"><p id="1f61" class="iq ir jx is b it iu iv iw ix iy iz ja kg jc jd je kh jg jh ji ki jk jl jm jn hb bi translated">完整的Ipython笔记本参考<a class="ae jy" href="https://github.com/viveksrinivasanss/blogs/tree/master/bike_sharing_demand" rel="noopener ugc nofollow" target="_blank"><strong class="is hj"><em class="hi">Github</em></strong></a>链接。</p></blockquote><h2 id="a466" class="kj kk hi bd kl km kn ko kp kq kr ks kt jb ku kv kw jf kx ky kz jj la lb lc ld bi translated">比赛详情</h2><p id="3d8f" class="pw-post-body-paragraph iq ir hi is b it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn hb bi translated">系统是一种租赁自行车的方式，通过遍布城市的信息亭网络，获得会员资格、租赁和归还自行车的过程是自动化的。使用这些系统，人们可以从一个地方租一辆自行车，并根据需要将其归还到不同的地方。目前，全世界有超过500个自行车共享项目。</p><p id="eabf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些系统生成的数据对研究人员很有吸引力，因为旅行的持续时间、出发地点、到达地点和经过的时间都被明确记录下来。<code class="du jz ka kb kc b">Bike-sharing</code>因此，系统的功能相当于一个传感器网络，可用于研究城市中的移动性。在这场比赛中，参赛者被要求将历史使用模式与天气数据相结合，以预测华盛顿特区首都自行车共享计划的自行车租赁需求</p><p id="a559" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有关数据集和比赛的更多信息，请访问以下链接<a class="ae jy" href="https://www.kaggle.com/c/bike-sharing-demand" rel="noopener ugc nofollow" target="_blank"> <em class="jx">自行车共享需求</em> </a></p><h2 id="3bf8" class="kj kk hi bd kl km kn ko kp kq kr ks kt jb ku kv kw jf kx ky kz jj la lb lc ld bi translated">数据汇总</h2><p id="bd10" class="pw-post-body-paragraph iq ir hi is b it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn hb bi translated">首先，让我们对数据做三件简单的事情。</p><ul class=""><li id="0903" class="lj lk hi is b it iu ix iy jb ll jf lm jj ln jn lo lp lq lr bi translated">数据集大小。</li><li id="07be" class="lj lk hi is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated">通过打印几行数据来浏览数据。</li><li id="9079" class="lj lk hi is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated">什么类型的变量对我们的数据有贡献。</li></ul><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/02a82260142958bd120dfc1ce78a6eed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jqy2tLqGiacvqqouqjTCAA.png"/></div></div><figcaption class="mc md et er es me mf bd b be z dx translated"><strong class="bd kl">数据汇总</strong></figcaption></figure><h2 id="b060" class="kj kk hi bd kl km kn ko kp kq kr ks kt jb ku kv kw jf kx ky kz jj la lb lc ld bi translated">特征工程</h2><p id="b8e9" class="pw-post-body-paragraph iq ir hi is b it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn hb bi translated">从上面的结果可以看出，<code class="du jz ka kb kc b">season</code>、<code class="du jz ka kb kc b">holiday</code>、<code class="du jz ka kb kc b">workingday </code>和<code class="du jz ka kb kc b">weather </code>列应该是<em class="jx">分类数据类型</em>。但是这些列的当前数据类型是<em class="jx"> int </em>。让我们以下列方式转换数据集，以便我们可以开始使用EDA。</p><ul class=""><li id="62c7" class="lj lk hi is b it iu ix iy jb ll jf lm jj ln jn lo lp lq lr bi translated">从<code class="du jz ka kb kc b">datetime </code>列创建新列<code class="du jz ka kb kc b">date</code>、<code class="du jz ka kb kc b">hour</code>、<code class="du jz ka kb kc b">weekday</code>、<code class="du jz ka kb kc b">month </code>。</li><li id="5c56" class="lj lk hi is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated">将<code class="du jz ka kb kc b">season</code>、<code class="du jz ka kb kc b">holiday</code>、<code class="du jz ka kb kc b">workingday </code>和<code class="du jz ka kb kc b">weather </code>的数据类型强制转换为<em class="jx">分类数据类型</em>。</li><li id="68f2" class="lj lk hi is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated">删除<code class="du jz ka kb kc b">datetime </code>列，因为我们已经从中提取了有用的特性。</li></ul><p id="4f4f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们从一个非常简单的变量数据类型计数的可视化开始。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/70a2ef09c8a92be37fd043fb9e31e9b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6D4u4ZrXV5GE4GBH0HXpaw.png"/></div></div></figure><h2 id="0d83" class="kj kk hi bd kl km kn ko kp kq kr ks kt jb ku kv kw jf kx ky kz jj la lb lc ld bi translated">缺失值分析</h2><p id="5b7d" class="pw-post-body-paragraph iq ir hi is b it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn hb bi translated">一旦我们掌握了数据和属性，我们通常做的下一步就是找出我们的数据中是否有任何缺失的值。幸运的是，我们在数据中没有任何缺失值。我通常更喜欢可视化数据中缺失值的一种方式是通过python中的<code class="du jz ka kb kc b">missingno</code>库。</p><p id="8f82" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是一个非常方便的库，可以快速可视化属性中缺失的值。正如我前面提到的，这次我们很幸运，因为数据中没有丢失值。但是我们在<code class="du jz ka kb kc b">windspeed </code>列中有很多0，我们将在稍后构建机器学习模型时处理这些0。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/b2bb8e8d38c6d11f408be5112c25ccd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wfB_a8D-cd0M5cDYXG058A.png"/></div></div></figure><h2 id="8b53" class="kj kk hi bd kl km kn ko kp kq kr ks kt jb ku kv kw jf kx ky kz jj la lb lc ld bi translated">异常值分析</h2><p id="8f55" class="pw-post-body-paragraph iq ir hi is b it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn hb bi translated">乍一看，<code class="du jz ka kb kc b">count </code>变量包含许多异常数据点，使分布向右倾斜(因为在<code class="du jz ka kb kc b">Outer Quartile Limit</code>之外有更多的数据点)。此外，下面的推论也可以从下面给出的简单箱线图中得出。</p><ul class=""><li id="d1c5" class="lj lk hi is b it iu ix iy jb ll jf lm jj ln jn lo lp lq lr bi translated">春季的数量相对较少。<code class="du jz ka kb kc b">boxplot</code>中的中间值<br/>的下降为其提供了证据。</li><li id="f18d" class="lj lk hi is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated">带变量<code class="du jz ka kb kc b">Hour Of The Day</code> <em class="jx"> </em>的盒子剧情挺有意思的。在<code class="du jz ka kb kc b">7AM — 8AM</code>和<code class="du jz ka kb kc b">5PM — 6PM</code>处，中值相对较高。可以归功于当时正规的学校和办公用户。</li><li id="e981" class="lj lk hi is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated">大部分的<code class="du jz ka kb kc b">outlier</code>分主要是<code class="du jz ka kb kc b">Working Day</code>比<code class="du jz ka kb kc b">Non Working Day</code>贡献的。这在图4中非常明显。</li></ul><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/ad905cbeda8a297b6178b9bd9b813726.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ghem6VimptvyKUixSmVNeA.png"/></div></div></figure><h2 id="866a" class="kj kk hi bd kl km kn ko kp kq kr ks kt jb ku kv kw jf kx ky kz jj la lb lc ld bi translated">相关分析</h2><p id="c55e" class="pw-post-body-paragraph iq ir hi is b it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn hb bi translated">要了解<em class="jx">因变量</em>如何受到<em class="jx">数字特征</em>的影响，一个常见的方法是找到它们之间的<em class="jx">相关矩阵</em>。我们在count和[ <code class="du jz ka kb kc b">temp</code>、<code class="du jz ka kb kc b">atemp</code>、<code class="du jz ka kb kc b">humidity</code>、<code class="du jz ka kb kc b">windspeed</code> ]之间构造一个<code class="du jz ka kb kc b">correlation plot</code>。</p><ul class=""><li id="6c63" class="lj lk hi is b it iu ix iy jb ll jf lm jj ln jn lo lp lq lr bi translated"><code class="du jz ka kb kc b">temp </code>和<code class="du jz ka kb kc b">humidity </code>特征分别与<code class="du jz ka kb kc b">count </code>正相关和负相关。虽然它们之间的相关性不是很突出，但是计数变量仍然对<code class="du jz ka kb kc b">temp</code>和<code class="du jz ka kb kc b">humidity</code>有一点依赖。</li><li id="e36e" class="lj lk hi is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated"><code class="du jz ka kb kc b">windspeed </code>不会是一个真正有用的数字特征，这一点可以从带有<code class="du jz ka kb kc b">count</code>的<code class="du jz ka kb kc b">correlation </code>值中看出。</li><li id="1019" class="lj lk hi is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated">由于<code class="du jz ka kb kc b">atemp </code>和<code class="du jz ka kb kc b">temp</code>具有很强的相关性，因此不考虑<code class="du jz ka kb kc b">atemp </code>变量。在建模过程中，必须删除任何一个变量，因为它们会在数据中显示<code class="du jz ka kb kc b">multicollinearity </code>。</li><li id="21ff" class="lj lk hi is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated"><code class="du jz ka kb kc b">casual </code>和<code class="du jz ka kb kc b">registered </code>属性也没有考虑在内，因为它们本质上是<code class="du jz ka kb kc b">leakage variables</code>，需要在建模过程中删除。</li></ul><figure class="ly lz ma mb fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/25cb5d0fed99f8e2c68097bb738777c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*Y3TA8KyQA1XJ8yIrqP1KrQ.png"/></div></figure><p id="2412" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">python中的<code class="du jz ka kb kc b">seaborn </code>库中的<code class="du jz ka kb kc b">regression</code>图是描述两个特征之间关系的一种有用方式。这里我们考虑<code class="du jz ka kb kc b">count </code> vs <code class="du jz ka kb kc b">temp</code>、<code class="du jz ka kb kc b">humidity </code>和<code class="du jz ka kb kc b">windspeed</code>。虽然我们有三个与因变量相关的数字特征，但它不会对我们的预测有太大帮助，从下面显示的回归图中可以清楚地看到这一点。因此，下一步让我们看看分类变量如何帮助我们建立模型。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/11edd6241591733c5f3f260d9c1e2635.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TnLt3kGTK-R1ZbJ7qzgPKg.png"/></div></div></figure><h2 id="7bce" class="kj kk hi bd kl km kn ko kp kq kr ks kt jb ku kv kw jf kx ky kz jj la lb lc ld bi translated">独立变量分布的可视化</h2><p id="44c7" class="pw-post-body-paragraph iq ir hi is b it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn hb bi translated">从下图中可以看出<code class="du jz ka kb kc b">count </code>变量向右倾斜。最好有<code class="du jz ka kb kc b">normal </code>分布，因为大多数机器学习技术要求因变量为<code class="du jz ka kb kc b">normal</code>。一个可能的解决方案是在移除异常数据点后，对<code class="du jz ka kb kc b">count </code>变量采用<code class="du jz ka kb kc b">log transformation</code>。转换后，数据看起来好多了，但仍不理想地遵循<code class="du jz ka kb kc b">normal </code>分布。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/8d607cce64b0185a80d88ec786f18cab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fjtak-55cBQhGcYPRrhwKg.png"/></div></div></figure><h2 id="5775" class="kj kk hi bd kl km kn ko kp kq kr ks kt jb ku kv kw jf kx ky kz jj la lb lc ld bi translated">可视化计数与(月、季节、小时、工作日、用户类型)</h2><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/2c3d9ff262e16b55402f6700f9030bdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*76DdfqqjYlk5aAppzeWTxA.png"/></div></div></figure><p id="773d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从上面的图表我们可以推断:</p><ul class=""><li id="a207" class="lj lk hi is b it iu ix iy jb ll jf lm jj ln jn lo lp lq lr bi translated">很明显，人们倾向于在夏季租自行车，因为在那个T21季节骑自行车非常方便。因此，六月、七月和八月对自行车的需求相对较高。</li><li id="1f94" class="lj lk hi is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated">平日更多的人倾向于在<em class="jx"/><code class="du jz ka kb kc b">7AM-8AM</code><code class="du jz ka kb kc b">5PM-6PM</code>附近租自行车。正如我们之前提到的，这可以归因于普通的学校和办公室通勤者。</li><li id="2ffb" class="lj lk hi is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated">在更多人倾向于在<code class="du jz ka kb kc b">10AM and 4PM</code>之间租赁自行车的周六和周日，没有观察到上述模式。</li><li id="41ee" class="lj lk hi is b it ls ix lt jb lu jf lv jj lw jn lo lp lq lr bi translated"><code class="du jz ka kb kc b">7AM-8AM</code>和<code class="du jz ka kb kc b">5PM-6PM</code>左右的峰值用户数纯粹是注册用户贡献的。</li></ul><p id="8b19" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以我们现在已经将数据可视化到了更高的程度。让我们继续构建一些模型，看看我们如何能够进入排行榜的前10%。</p><p id="85af" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jy" rel="noopener" href="/@viveksrinivasan/how-to-finish-top-10-percentile-in-bike-sharing-demand-competition-in-kaggle-part-2-29e854aaab7d"> <em class="jx">如何在Kaggle的自行车共享需求大赛中完成前10个百分点？</em>(第二部)</a></p></div></div>    
</body>
</html>