<html>
<head>
<title>Learn web app development while solving a real world problem</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">学习web应用程序开发，同时解决现实世界中的问题</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/practical-web-scraping-94203cdd6461?source=collection_archive---------15-----------------------#2020-01-06">https://medium.com/analytics-vidhya/practical-web-scraping-94203cdd6461?source=collection_archive---------15-----------------------#2020-01-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/47eb67e46385efd7acca0a30363ae9b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Mh245eSDxm5CQchB"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">卢卡·布拉沃在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="ebcd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这个系列中，我们将学习从头创建一个web应用程序，web抓取和存储抓取的数据。同时解决一个现实世界的问题。</p><p id="d26d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这将是一个有趣的实践系列，分为三个部分:</p><p id="1c9a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">1.搜集数据</p><p id="08a8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.储存它</p><p id="a3d8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.创建web应用程序</p><blockquote class="jt ju jv"><p id="ac81" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">注意:我不确定网络抓取是否违法。这是一个需要讨论的复杂话题。本系列不讨论web抓取的法律方面。然而，我相信合乎道德的网络抓取对于被废弃的网站来说不应该是一个问题。</p></blockquote><h1 id="8fda" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">我们要解决的问题</strong></h1><p id="6177" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">假设你住在美国，想给你在印度的朋友或家人寄些钱。你会先用谷歌搜索美元对印度卢比的汇率，然后寻找一个允许你从美元向印度卢比汇款的汇款服务。但是，有许多不同的服务提供不同的汇率，不同的服务费。首先，你收集一份此类汇款服务的清单，然后访问他们的网站，查看他们提供的费率。这需要花费大量的时间和精力。</p><p id="ce11" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本教程中，我们将通过创建一个web应用程序来解决这个问题，该应用程序将只在一个地方显示这些服务提供的汇率。所以，你只需要打开一个网站就可以决定使用哪种服务。</p><p id="f566" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们把问题分成三部分来解决:</p><ol class=""><li id="5b98" class="ld le hi ix b iy iz jc jd jg lf jk lg jo lh js li lj lk ll bi translated">从各种服务中收集数据</li><li id="7004" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">存储数据</li><li id="f4cc" class="ld le hi ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">使用数据创建web应用程序</li></ol><p id="53ca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">本文将涵盖第一点。</strong></p><p id="11b0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">听起来很有趣？</p><p id="87f3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们有很多内容要讲，所以不要浪费时间，让我们开始吧。</p><h2 id="1c21" class="lr kb hi bd kc ls lt lu kg lv lw lx kk jg ly lz ko jk ma mb ks jo mc md kw me bi translated">要求</h2><p id="94bc" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">1.<a class="ae iu" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank"> Python(网页抓取)</a></p><p id="15c1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.<a class="ae iu" href="https://pypi.org/project/beautifulsoup4/" rel="noopener ugc nofollow" target="_blank"> BeautifulSoup(用于网络抓取的Python库)</a></p><p id="e597" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.<a class="ae iu" href="https://docs.python.org/3/library/urllib.html" rel="noopener ugc nofollow" target="_blank"> urllib.request(用于打开URL的Python库)</a></p><p id="cc2f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这一部分，我们将讨论网页抓取部分。</p><h1 id="337c" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">基础知识</strong></h1><p id="475d" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">在典型的客户机服务器场景中，客户机(例如web浏览器)向服务器发送请求。服务器用数据响应。例如，当我们在任何网络浏览器中打开google.com时，浏览器会向谷歌服务器发送请求以获取谷歌搜索页面。google服务器返回HTML格式的数据，然后浏览器呈现HTML并向用户显示漂亮的UI。当我们打开任何其他网站时，也会发生同样的事情。Web抓取是读取HTML并从HTML中获取所需的数据/信息。</p><p id="b6a9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们在解决手头问题的同时理解这一点。遵循以下步骤:</p><h2 id="0855" class="lr kb hi bd kc ls lt lu kg lv lw lx kk jg ly lz ko jk ma mb ks jo mc md kw me bi translated">第一步:选择目标</h2><p id="f6a1" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">因为我们要创建一个应用程序，用户可以查看各种服务提供的美元对印度卢比的汇率，让用户从美国向印度汇款。显而易见的需求是这些服务的列表。我们将使用Remitly和Transferwise(随机选择)。</p><h2 id="a2f2" class="lr kb hi bd kc ls lt lu kg lv lw lx kk jg ly lz ko jk ma mb ks jo mc md kw me bi translated">第二步:在网站中找到要抓取的元素</h2><p id="1437" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">我们在《基础》中了解到，所有网站都是HTML(超文本标记语言)。在常用浏览器(chrome、safari、edge、firefox)中打开的网站的底层HTML，在页面上点击右键，选择<em class="jw"> Inspect </em>选项，就可以轻松看到。</p><p id="7d2d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们想把美元兑换成印度卢比，所以打开第一个网站(<a class="ae iu" href="https://www.remitly.com/us/en/india/pricing" rel="noopener ugc nofollow" target="_blank"/>)，右键点击显示你想刮的印度卢比汇率的地方。在打开的开发人员控制台中，右键单击选中的元素并复制- &gt;复制选择器。</p><figure class="mf mg mh mi fd ij"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="a555" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">选择器</strong>被复制到剪贴板，现在保存它(！重要)，我们以后会用到。同样，打开第二个网站(<a class="ae iu" href="https://transferwise.com/us/currency-converter/usd-to-inr-rate" rel="noopener ugc nofollow" target="_blank">transferwise</a>)，做同样的事情。</p><figure class="mf mg mh mi fd ij"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="5e1e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们有了选择器(这是DOM中显示INR比率的元素的CSS路径)。我们将以编程方式编写Python脚本到<a class="ae iu" href="https://go.skimresources.com/?id=126542X1588076&amp;xs=1&amp;url=https://en.wiktionary.org/wiki/programmatically" rel="noopener ugc nofollow" target="_blank"/>make请求(使用urllib)来发送和转换web页面，读取HTML响应(使用BeautifulSoup库)并使用选择器提取INR比率(在上一步中获得)。</p><figure class="mf mg mh mi fd ij"><div class="bz dy l di"><div class="ml mk l"/></div></figure><p id="85fa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上面的脚本包含了所有解释每一行是做什么的注释。如果需要更多的解释，请在评论区告诉我:)。简而言之，上面的脚本执行以下步骤:</p><p id="68fe" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">1.调用显示美元对印度卢比汇率的页面(url)。</p><p id="cbef" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.获取HTML。</p><p id="1ad2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.创建一个BeautifulSoup对象来轻松导航html。</p><p id="7e2e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">4.使用我们在步骤2中得到的选择器提取比率。</p><h1 id="eded" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">执行</h1><p id="59b4" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">将上述脚本复制到一个文件中，用<strong class="ix hj">保存。py </strong>扩展(例如scrapper.py)。</p><p id="0ca1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通过在terminal/cmd中执行以下命令来运行脚本(python3应该已经安装了)</p><pre class="mf mg mh mi fd mm mn mo mp aw mq bi"><span id="8ebc" class="lr kb hi mn b fi mr ms l mt mu">CopyCopyCopypython scrapper.py </span></pre><p id="8788" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们有了从两个货币兑换服务(Remitly &amp; Transferwise)获取汇率的好脚本。这个脚本可以很容易地扩展到包括更多的服务，而不需要对代码做太多的修改。只需为新服务创建新类，并将服务名包含在MONEY _ TRANSER _ SERVICES数组中。就是这样。</p><h1 id="ed9a" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">结论</h1><p id="824e" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">在这一部分中，我们看到了如何从网页中提取信息。在下一部分中，我们将看到如何构建数据并将其存储在MongoDB中以便长期存储。敬请期待！</p></div></div>    
</body>
</html>