<html>
<head>
<title>Outlier Detection in Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习中的离群点检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/outlier-detection-in-machine-learning-26e0bc7105cd?source=collection_archive---------5-----------------------#2020-11-29">https://medium.com/analytics-vidhya/outlier-detection-in-machine-learning-26e0bc7105cd?source=collection_archive---------5-----------------------#2020-11-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/413b11afa6e8b0ad14f761af5f52a5d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*H_33KLpv0JiD2DXY.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://www.google.com/search?q=outliers+image+with+human+example&amp;tbm=isch&amp;ved=2ahUKEwjqmNrAgKPtAhWPgEsFHVPUA9gQ2-cCegQIABAA&amp;oq=outliers+image+with+human+example&amp;gs_lcp=CgNpbWcQAzoECAAQQzoCCAA6BAgAEBg6BAgAEB5QwP4DWJatBGDNrgRoAHAAeACAAeQCiAHLIpIBCDAuMTQuOC4xmAEAoAEBqgELZ3dzLXdpei1pbWfAAQE&amp;sclient=img&amp;ei=ZxbBX6rJBY-BrtoP06iPwA0&amp;bih=657&amp;biw=1366#imgrc=PXB5MV2WT6xXeM" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><blockquote class="iv iw ix"><p id="316d" class="iy iz ja jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated"><strong class="jb hj">什么是离群值？</strong></p></blockquote><p id="18e4" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">异常值是那些与给定数据集中的其他观察值有显著差异的数据点。这可能是由于测量中的可变性和填充数据点中的错误解释造成的。</p><p id="58a6" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">假设我们有一个数据集，包含学校和学生家之间的距离，单位为公里，给定为<strong class="jb hj"> 5，6，7，8，9，10，6，7，100 </strong>，在此数据集<strong class="jb hj"> 100 </strong>将表现得像一个异常值。</p><blockquote class="iv iw ix"><p id="82b5" class="iy iz ja jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated"><strong class="jb hj">是否应该剔除离群值？</strong></p></blockquote><p id="933f" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">并不总是需要删除异常值，取决于业务案例的要求，我们作为机器学习工程师决定是否应该删除异常值。我们可以在人们最喜欢的电视节目的数据集中去掉离群值，但是当我们有关于信用卡欺诈的数据集时，我们不能去掉离群值。你是否应该移除它取决于你的常识和观察。</p><p id="b7ac" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">假设至少 30%(或大量)的数据点是异常值，这意味着异常值中有一些有趣和有意义的见解，您不应该删除它。</p><p id="cfae" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated"><strong class="jb hj">为什么要剔除离群值？</strong></p><p id="3a92" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">离群值增加了数据集中的可变性，这降低了统计显著性，使我们的模型不太准确。有各种各样的方法来检测它。在这篇博客中，我将讨论基于分布的异常值检测。</p><blockquote class="iv iw ix"><p id="9267" class="iy iz ja jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated"><strong class="jb hj">基于分布的异常值检测</strong></p></blockquote><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es ka"><img src="../Images/abe3acf974f9fb2902ead18e44ac30ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*PrDtQyBrr22WgxCYzlmCEA.png"/></div></figure><h2 id="e064" class="kf kg hi bd kh ki kj kk kl km kn ko kp jx kq kr ks jy kt ku kv jz kw kx ky kz bi translated">一、正态分布数据:</h2><p id="d9c5" class="pw-post-body-paragraph iy iz hi jb b jc la je jf jg lb ji jj jx lc jm jn jy ld jq jr jz le ju jv jw hb bi translated">在正态分布的情况下，如果数据点远离范围(<strong class="jb hj"> μ + 3σ) </strong>和<strong class="jb hj"> (μ — 3 σ) </strong>被视为<strong class="jb hj">异常值。</strong></p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es lf"><img src="../Images/cbb258ed53f0e2a407402845ed778829.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*M9mXrWViyj_bN1YO2-G9wA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">正态分布</figcaption></figure><pre class="kb kc kd ke fd lg lh li lj aw lk bi"><span id="b6ef" class="kf kg hi lh b fi ll lm l ln lo"># Plotting and observing whether dataset has outliers or not<br/>plt.figure(figsize=(16, 4)) # figure size<br/>plt.subplot(1, 3, 1) #multiple plot plottig and 1st position of fig<br/>sns.distplot(df["RM"], bins=30) #checking is data normally dist ?<br/>plt.title('Histogram') <br/>plt.subplot(1, 3, 2)  #plotting second position of figure<br/>sns.boxplot(y=df["RM"]) #boxplot<br/>plt.title('Boxplot')<br/>plt.subplot(1, 3, 3) #plotting third position of figure<br/>stats.probplot(df["RM"], dist="norm", plot=plt) #q-q plot to check #how our data is distributed in reference with normal distribution<br/>plt.ylabel('RM quantiles')<br/>plt.show()</span></pre><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/2eaf0c984866477ba0cf2120cbc0653a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v2pRUc8-gUKQWUP7UVAJFw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图 1</figcaption></figure><p id="d9e0" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">正如我们看到的图 1 <strong class="jb hj">分布图</strong>说明数据集是正态分布的，<strong class="jb hj">箱线图</strong>和<strong class="jb hj"> Q-Q 图</strong>我们可以说数据集中存在一些异常值。现在，我们的下一步将是找到最小和最大边界值，其中每个数据点将被视为离群值。</p><pre class="kb kc kd ke fd lg lh li lj aw lk bi"><span id="17f5" class="kf kg hi lh b fi ll lm l ln lo">#outlier boundary value for normally distributed dataset<br/>def min_max_boundary(data,col):<br/>    min_value=df[col].mean()-3*df[col].std()<br/>    max_value=df[col].mean()+3*df[col].std()<br/>    return min_value,max_value<br/>min_max_boundary(df,"RM")</span></pre><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/0c57af16434889b7e4cfa89d5adeac34.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*u34tX1F40u6lm-F_bsFeXg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">最小和最大边界值</figcaption></figure><h2 id="4183" class="kf kg hi bd kh ki kj kk kl km kn ko kp jx kq kr ks jy kt ku kv jz kw kx ky kz bi translated">任何大于 8.39 且小于 4.17 的值都将被视为异常值。</h2><h2 id="f161" class="kf kg hi bd kh ki kj kk kl km kn ko kp jx kq kr ks jy kt ku kv jz kw kx ky kz bi translated">移除异常值:</h2><pre class="kb kc kd ke fd lg lh li lj aw lk bi"><span id="313b" class="kf kg hi lh b fi ll lm l ln lo">#filtering all the value mabove maximum boundary value and below #minimum  boundary value <br/>df=df[(df["RM"] &gt;4.683568137432223) &amp; (df["RM"] &lt; 7.7636498112857)]<br/>--------------------------------------------------------------------<br/>#plotting the df["RM"] after removing outliers<br/>plt.figure(figsize=(16, 4)) <br/>plt.subplot(1, 3, 1)  <br/>sns.distplot(df["RM"], bins=30)  <br/>plt.title('Histogram') <br/>plt.subplot(1, 3, 2)   <br/>sns.boxplot(y=df["RM"]) <br/>plt.title('Boxplot')<br/>plt.subplot(1, 3, 3) <br/>stats.probplot(df["RM"], dist="norm", plot=plt)<br/>plt.ylabel('RM quantiles')<br/>plt.show()<br/>--------------------------------------------------------------------</span></pre><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/4e507b394cda0ae39a548bdb5ab11777.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ewlDMF2zPSLBMjT8o3_xRw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图 2</figcaption></figure><h2 id="5d34" class="kf kg hi bd kh ki kj kk kl km kn ko kp jx kq kr ks jy kt ku kv jz kw kx ky kz bi translated"><strong class="ak">二。偏斜分布数据:</strong></h2><p id="5e7c" class="pw-post-body-paragraph iy iz hi jb b jc la je jf jg lb ji jj jx lc jm jn jy ld jq jr jz le ju jv jw hb bi translated">如果值不在以下范围内:-<strong class="jb hj">25 个百分点-(1.5 * IQR)&amp;75 个百分点+(1.5*IQR) </strong>，则 datpoint 被视为异常值。</p><p id="b2c1" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">这里<strong class="jb hj"> IQR= Q3-Q1 </strong>(如下图所示)</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/a60f77e5a971a70a08aa6a055771bf15.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*qv36tttadUvnoK6jGVqorw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">箱形图</figcaption></figure><pre class="kb kc kd ke fd lg lh li lj aw lk bi"><span id="eef5" class="kf kg hi lh b fi ll lm l ln lo">#plotting different plot to analyse presence of outliers<br/>plt.figure(figsize=(16, 4)) # figure size<br/>plt.subplot(1, 3, 1) #multiple plot plottig and 1st position of figure<br/>sns.distplot(df["LSTAT"], bins=30) #checking data is normally distributed or not<br/>plt.title('Histogram',fontsize=20) <br/>plt.subplot(1, 3, 2)  #plotting second position of figure<br/>sns.boxplot(y=df["LSTAT"]) #boxplot<br/>plt.title('Boxplot',fontsize=20)<br/>plt.subplot(1, 3, 3) #plotting third position of figure<br/>stats.probplot(df["LSTAT"], dist="norm", plot=plt)#q-q plot to check how our data is distributed in reference with normal distribution<br/>plt.title("Q-Q plot",fontsize=20)<br/>plt.show()</span></pre><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/3a41c1c46a5af9b1f598d15047e1b791.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1atQQYNvXa_RlohhfosJ4A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图 3</figcaption></figure><p id="1d28" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">正如我们看到的图 2 <strong class="jb hj">分布图</strong>解释了数据集是右偏的<strong class="jb hj">箱线图</strong>显示了一些远离上须的数据点，因此数据集中存在异常值。<strong class="jb hj"> Q-Q 图的</strong>对齐偏离 45 度角，表明数据集中存在异常值。现在，我们的主要任务是找到最小值和最大值的边界，超出该边界的数据将被视为异常值。</p><pre class="kb kc kd ke fd lg lh li lj aw lk bi"><span id="62bb" class="kf kg hi lh b fi ll lm l ln lo">#finding upper and lower boundary limit<br/>def non_normal_outliers(data,col):<br/>    IQR=df[col].quantile(0.75)-df[col].quantile(0.25)<br/>    lower_limit=data[col].quantile(0.75) + (1.5*IQR)<br/>    upper_limit=data[col].quantile(0.25) - (1.5*IQR)<br/>    return "lower limit of dataset : {0},  upper limit of dataset <br/>            {1}".format(lower_limit,upper_limit)</span><span id="9726" class="kf kg hi lh b fi lt lm l ln lo">  non_normal_outliers(df,"LSTAT")</span></pre><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="ab fe cl lu"><img src="../Images/e30451e3b88f9658a4f3a7dbe4e56d0d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Gxeb3zqE7vGiU7n8AKoh4w.png"/></div></figure><p id="f0d1" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">我们可以用另一种方式编写相同的代码，以列表的形式打印最小值和最大值。</p><pre class="kb kc kd ke fd lg lh li lj aw lk bi"><span id="c39c" class="kf kg hi lh b fi ll lm l ln lo">list1=[]<br/>def outer_function(data,col):<br/>    # Hidden from the outer code<br/>    IQR=df[col].quantile(0.75)-df[col].quantile(0.25)<br/>    def max_value(data,col):<br/>        max_=df[col].quantile(0.75) + (1.5*IQR)<br/>        return max_<br/>    list1.append(max_value(data,col))<br/>    def min_value (data,col):<br/>        min_=df[col].quantile(0.25) - (1.5*IQR)<br/>        return min_ <br/>    list1.append(min_value(data,col))<br/>#inner_increment(5)<br/>outer_function(df,"LSTAT")<br/>list1<br/>--------------------------------------------------------------------</span><span id="575d" class="kf kg hi lh b fi lt lm l ln lo">[out]&gt;&gt; [31.962500000000006, -8.057500000000005]</span></pre><h2 id="e2c7" class="kf kg hi bd kh ki kj kk kl km kn ko kp jx kq kr ks jy kt ku kv jz kw kx ky kz bi translated">移除异常值:</h2><pre class="kb kc kd ke fd lg lh li lj aw lk bi"><span id="779a" class="kf kg hi lh b fi ll lm l ln lo">#filtering values lie above and below min and max value<br/>df=df.loc[(df["LSTAT"]&lt;list1[0]) &amp; (df["LSTAT"]&gt;list1[1])]<br/>--------------------------------------------------------------------<br/>#plotting the dataset after eliminating outliers<br/>plt.figure(figsize=(16, 4)) <br/>plt.subplot(1, 3, 1)  <br/>sns.distplot(df["LSTAT"], bins=30)  <br/>plt.title('Histogram') <br/>plt.subplot(1, 3, 2)   <br/>sns.boxplot(y=df["LSTAT"]) <br/>plt.title('Boxplot')<br/>plt.subplot(1, 3, 3) <br/>stats.probplot(df["LSTAT"], dist="norm", plot=plt)<br/>plt.ylabel('RM quantiles')<br/>plt.show()</span></pre><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/ee4929d4f0d0c6fdf3ead0b44b09515c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O0mjgChPZIcSpBv25v9LMw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图 4</figcaption></figure><h2 id="899f" class="kf kg hi bd kh ki kj kk kl km kn ko kp jx kq kr ks jy kt ku kv jz kw kx ky kz bi translated">结论:-</h2><p id="58a5" class="pw-post-body-paragraph iy iz hi jb b jc la je jf jg lb ji jj jx lc jm jn jy ld jq jr jz le ju jv jw hb bi translated">希望你对这个话题有足够的了解，请分享你对这个博客的看法。不断学习，不断成长。</p></div></div>    
</body>
</html>