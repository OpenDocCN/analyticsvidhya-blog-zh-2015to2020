<html>
<head>
<title>Webscrape from online shopping retailer — John Lewis (Part I)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">来自在线购物零售商约翰·刘易斯的网络搜索(上)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/webscrape-from-online-shopping-retailer-john-lewis-part-i-96de3a9dbed1?source=collection_archive---------20-----------------------#2020-10-09">https://medium.com/analytics-vidhya/webscrape-from-online-shopping-retailer-john-lewis-part-i-96de3a9dbed1?source=collection_archive---------20-----------------------#2020-10-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="68f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">想象一下，有一个机器人可以自动搜索购物网站，并提供关于任何新上市商品或你喜欢的特定时尚品牌商品降价的每日电子邮件更新。那会节省很多时间和精力！更不用说你将能够在它脱销之前得到它！</p><p id="b662" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我将重点介绍英国主要零售商John Lewis的网上购物网站。我以前在它的网上商店发现了一些很好的便宜货，但我也错过了一些便宜货，因为我没有定期查看网站。因此，我启动了这个项目来创建一个自动更新，更新我感兴趣的品牌列表中的所有变化。在这里，我将把重点放在web抓取过程上，第二篇文章将解释如何创建自动向您的帐户发送电子邮件的bot。</p><p id="fefa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">警告:由于每个网站的html代码不同，这里适用的代码可能不适用于所有在线平台。此外，网页有时会更新，现在有效的可能在将来无效。然而，它通常只需要一些代码的调整。此外，我还在Challenger(一家新加坡科技零售商)的在线购物平台上测试了我的代码，其逻辑非常相似。</em></p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h1 id="755c" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">步骤1:检查开发人员代码</h1><p id="e6f6" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">在许多网页抓取教程中，第一步自然是审查开发人员的代码，因为不同的网站有不同的结构。</p><p id="1812" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我发现在许多网站中，他们通常会在“概述”页面隐藏物品的信息(如下面的一个—‘aria-hidden’)。物品的价格和描述仍然可以通过互联网浏览器访问，但不能通过网络抓取提取。为了解决这个问题，我把重点放在了抓取url链接上，例如“href: '/coach-central-leather…".</p><p id="e7a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我将web抓取过程分为两个部分— (i)提取url链接，以及(ii)获取各个url页面中的信息。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es ko"><img src="../Images/a80fec17d57a666358eea47621752aae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N6jhTd5U_qzDDxtZcMM2PA.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">隐藏html片段的示例</figcaption></figure></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h1 id="77fb" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">步骤2:检索url链接列表</h1><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="ab fe cl le"><img src="../Images/ee8558af89e0cd6ab2849eb3ad03fc9e.png" data-original-src="https://miro.medium.com/v2/1*Mc5VWqvTcJf36PCWsZnlvQ.gif"/></div></figure><p id="9c55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过检查“概述”页面中项目的url，我发现每个项目的搜索URL都是一致的。网址链接将以(“https://www . John Lewis . com/search？search-item= ")后跟品牌名称。如果品牌名称是两个或两个以上的单词，则用“%20”分隔。例如，如果我对“coach”或“fred perry”商品感兴趣，url是"https://www.johnlewis.com/search？search-item=coach”和"https://www.johnlewis.com/search？search-item=fred%20perry”。</p><p id="f753" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，我将用“蔻驰”这个品牌来说明。</p><p id="b9d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我在主搜索页面中检索所有信息(“https://www . John Lewis . com/search？search-item=coach”)并使用BeautifulSoup库，我收集了'<a>'标签下的所有url_links。然而，并不是所有的url链接都是相关的。在检查了一些相关的url链接后，我注意到所有相关的url链接都以“/”开头，后跟品牌名称，即“/coach”。于是，我在收集的url_links中搜索关键字，用“https://www.johnlewis.com”将它们连接起来。这为我们提供了我们感兴趣的特定品牌商品的所有相关url链接的列表。</a></p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lf"><img src="../Images/961be1141c7637554b1013212f9640e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EwoHifRmiXmhJB_293cy7w.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">url链接必须以“/”开头，后跟品牌名称</figcaption></figure></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><figure class="kp kq kr ks fd kt"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="la lb et er es lc ld bd b be z dx translated">提取所有相关url链接的代码</figcaption></figure></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h1 id="0e7c" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">第三步:在每个url链接中找到相关部分并整合信息</h1><p id="4f96" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">接下来，我(再次)检查每个相关url的开发者代码，发现该项目的信息可以在“<script>”标签下找到。使用“find_all”，我进一步观察到可以在索引6或7下找到产品信息(对于“coach”项目)。该信息是一个字符串，但是是“类似json”的格式，因此，我将该信息转换成json数据，这样就可以提取并合并到一个dataframe中。&lt;/root&gt;</script></p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es li"><img src="../Images/7d05aedb2f628ec7964aab0487243b23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vP3bHtypI8a89ArAYfA1WQ.png"/></div></div></figure><figure class="kp kq kr ks fd kt"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="la lb et er es lc ld bd b be z dx translated">从每个url链接中检索产品信息</figcaption></figure><p id="38df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我生成的最终数据框架，只过滤“库存”商品，并按价格升序排序。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lj"><img src="../Images/33ffaef4d06528a4967a5ad922cd33ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wae4eKF4AYslAhvDOtppXA.png"/></div></div></figure></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h1 id="165c" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">步骤4:列表表格的周期性更新</strong></h1><p id="80ec" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">上表是一次性提取。下一步是创建一个算法，这样新的信息将与以前提取的信息进行比较，并突出显示这些变化，这样当我收到信息时，我会被告知该产品是否是新上市的产品，或者现有产品是否有降价等。</p><p id="c96d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，我将把以前的表合并到当前的表中(即包含最新信息)。然后，如上所述的附加信息将被添加到表格中。最后，我也根据上述信息对列表进行排序。</p><figure class="kp kq kr ks fd kt"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="la lb et er es lc ld bd b be z dx translated">比较新旧信息的条件</figcaption></figure><figure class="kp kq kr ks fd kt"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="la lb et er es lc ld bd b be z dx translated">更新列表</figcaption></figure><h1 id="6842" class="jl jm hi bd jn jo lk jq jr js ll ju jv jw lm jy jz ka ln kc kd ke lo kg kh ki bi translated">结果</h1><p id="bcae" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">下面是生成的每日刷新表的一个片段。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lp"><img src="../Images/7446c26e7f42c3daf7bc6efef7514996.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FgfV6QN3JTQp1LoIB03DDg.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx translated">约翰·路易斯网站上每日更新的“蔻驰”项目列表</figcaption></figure></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h1 id="84bc" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">结论</h1><p id="cd1d" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">通过这个关于约翰·刘易斯的网上购物平台的项目，我希望展示网上购物可以是一种有趣的练习。这些步骤通常是非常系统的，我希望你也能为自己的购物需求建立一个网络抓取工具:)</p></div></div>    
</body>
</html>