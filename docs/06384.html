<html>
<head>
<title>Git Squash Commit With Git Rebase</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Git Rebase提交Git Squash</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/git-squash-commit-with-git-rebase-34443d271f62?source=collection_archive---------16-----------------------#2020-05-20">https://medium.com/analytics-vidhya/git-squash-commit-with-git-rebase-34443d271f62?source=collection_archive---------16-----------------------#2020-05-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/04c3a4b16b09a5ca040d34bbdf783b0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4jIUAmZMSDWka6ic.png"/></div></div></figure><p id="d929" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当提交一个pull请求以将您的代码与Master/Develop合并时，您最好压缩您的提交。一些与git repos交互的应用程序将提供一个挤压用户界面。但是让我们走有趣的路线— <em class="jo">终点站</em>。</p><p id="8358" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">做git壁球有多种方法。第一，在你的系统中本地完成，然后推到远程。另一种方法是，在进行rebase之前，在remote中保存一份所有更改的副本，以便在出现问题时在remote中保存一份更改的副本。</p><p id="bdb7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们先看看更安全的方法。确保您的分支与远程服务器保持同步。现在做<code class="du jp jq jr js b">git log --pretty=oneline</code>来理解在你的分支中发生的提交。</p><pre class="jt ju jv jw fd jx js jy jz aw ka bi"><span id="029c" class="kb kc hi js b fi kd ke l kf kg">* c88bc5 Implement search inputs for user<br/>* 8f4917 Enriched plots for better understanding<br/>* 59c01d Add pyplot for better analysis<br/>* ba6f1f Add listing feature to quality checks<br/>* 9f2adb Add feature to pipeline<br/>* f796c1 Initial commit</span></pre><p id="e080" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果将最后6次提交打包在一起，看起来会更好，所以让我们通过交互式的重新调整来实现。</p><p id="c585" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要交互地重置提交，您可以遵循下面的格式，并通过命令行输入您的命令。</p><pre class="jt ju jv jw fd jx js jy jz aw ka bi"><span id="f00b" class="kb kc hi js b fi kd ke l kf kg">git rebase -i HEAD~&lt;n&gt; (n is the number of commits you want to squash)</span><span id="3233" class="kb kc hi js b fi kh ke l kf kg">git rebase -i HEAD~6 (This will roll up all 6 commits in the current branch)</span></pre><p id="1712" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">或者</p><pre class="jt ju jv jw fd jx js jy jz aw ka bi"><span id="4754" class="kb kc hi js b fi kd ke l kf kg">git rebase -i &lt;sha code&gt; (sha code of the commit until which you want to squash)</span><span id="9e8b" class="kb kc hi js b fi kh ke l kf kg">git rebase -i f796c1 (sha code of the initial commit)</span></pre><p id="b9c5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">-i标志表示这个重定基础过程将是一个交互式会话。</p><p id="3f70" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦您输入上述命令，您将看到以下内容。</p><pre class="jt ju jv jw fd jx js jy jz aw ka bi"><span id="5ed3" class="kb kc hi js b fi kd ke l kf kg">pick f796c1 Initial commit<br/>pick 9f2adb Add feature to pipeline<br/>pick ba6f1f Add listing feature to quality checks<br/>pick 59c01d Add pyplot for better analysis<br/>pick 8f4917 Enriched plots for better understanding<br/>pick c88bc5 Implement search inputs for user</span><span id="ad96" class="kb kc hi js b fi kh ke l kf kg"><em class="jo"># Rebase 8db7e8b..fa20af3 onto 8db7e8b</em> <br/><em class="jo">#</em> <br/><em class="jo"># Commands:</em> <br/><em class="jo">#  p, pick = use commit</em> <br/><em class="jo">#  r, reword = use commit, but edit the commit message</em> <br/><em class="jo">#  e, edit = use commit, but stop for amending</em> <br/><em class="jo">#  s, squash = use commit, but meld into previous commit</em> <br/><em class="jo">#  f, fixup = like "squash", but discard this commit's log message</em> <br/><em class="jo">#  x, exec = run command (the rest of the line) using shell</em> <br/><em class="jo">#</em> <br/><em class="jo"># These lines can be re-ordered; they are executed from top to bottom.</em> <br/><em class="jo">#</em> <br/><em class="jo"># If you remove a line here THAT COMMIT WILL BE LOST.</em> <br/><em class="jo">#</em> <br/><em class="jo"># However, if you remove everything, the rebase will be aborted.</em> <br/><em class="jo">#</em> <br/><em class="jo"># Note that empty commits are commented out</em></span></pre><p id="4227" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们看到最后6次提交，从旧的到新的。看到提交列表下面的评论了吗？解释得好，饭桶！<code class="du jp jq jr js b">pick</code>是默认操作。在这种情况下，它将按原样重新应用提交，内容或消息不变。保存此文件不会对存储库进行任何更改。</p><p id="0c70" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们只对以下行为感兴趣。</p><ul class=""><li id="6c65" class="ki kj hi is b it iu ix iy jb kk jf kl jj km jn kn ko kp kq bi translated"><code class="du jp jq jr js b">squash</code>(简称为<code class="du jp jq jr js b">s</code>)，它将提交合并到前一个(前一行中的那个)</li><li id="d3c6" class="ki kj hi is b it kr ix ks jb kt jf ku jj kv jn kn ko kp kq bi translated"><code class="du jp jq jr js b">fixup</code>(简称为<code class="du jp jq jr js b">f</code>)，其行为类似于“挤压”，但会丢弃提交消息</li></ul><p id="5f94" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">假设我们想要压缩所有的提交，因为它们属于同一个逻辑变更集。我们将保留初始提交，并将所有后续提交压缩到前一个提交中。除了第一次提交，我们必须在所有提交中将<code class="du jp jq jr js b">pick</code>改为<code class="du jp jq jr js b">squash</code>。</p><pre class="jt ju jv jw fd jx js jy jz aw ka bi"><span id="0434" class="kb kc hi js b fi kd ke l kf kg">pick f796c1 Initial commit<br/>squash 9f2adb Add feature to pipeline<br/>squash ba6f1f Add listing feature to quality checks<br/>squash 59c01d Add pyplot for better analysis<br/>squash 8f4917 Enriched plots for better understanding<br/>squash c88bc5 Implement search inputs for user</span></pre><p id="05ea" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">保存编辑器，您将进入另一个编辑器来决定合并的三个提交的提交消息。在这个编辑器中，您可以选择添加/删除提交消息。一旦保存了提交消息并退出了编辑器，所有的提交都会被转换成一个。</p><p id="7c7d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您想跳过编辑提交消息部分，您可以使用<code class="du jp jq jr js b">fixup</code>命令，这将使您的提交消息已经被注释掉。</p><p id="6d7f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦保存了提交消息部分，您必须做的最后一件事就是git push将您的所有更改推送到remote。而且这种推动是必须的，因为你的本地和远程的分支在重定基数后已经分开了。</p><pre class="jt ju jv jw fd jx js jy jz aw ka bi"><span id="f1ae" class="kb kc hi js b fi kd ke l kf kg">git push --force</span></pre></div><div class="ab cl kw kx gp ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="hb hc hd he hf"><p id="fa55" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">另外，如果你有太多的提交，要被压制，你必须手动更新每一个<code class="du jp jq jr js b">pick</code>到<code class="du jp jq jr js b">squash</code>，<code class="du jp jq jr js b">vim</code>提供了一个简单的方法来实现它。</p><pre class="jt ju jv jw fd jx js jy jz aw ka bi"><span id="bcc2" class="kb kc hi js b fi kd ke l kf kg">:%s/pick/squash/gc</span></pre><p id="91d8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该命令将在您确认后更新每个要挤压的拾取。</p></div><div class="ab cl kw kx gp ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="hb hc hd he hf"><p id="d174" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您在想要编辑的提交中说<code class="du jp jq jr js b">reword</code>(简称<code class="du jp jq jr js b">r</code>):</p><pre class="jt ju jv jw fd jx js jy jz aw ka bi"><span id="20ca" class="kb kc hi js b fi kd ke l kf kg">pick f796c1 Initial commit<br/>pick 9f2adb Add feature to pipeline<br/>reword ba6f1f Add listing feature to quality checks<br/>pick 59c01d Add pyplot for better analysis<br/>pick 8f4917 Enriched plots for better understanding<br/>pick c88bc5 Implement search inputs for user</span><span id="2f45" class="kb kc hi js b fi kh ke l kf kg"><em class="jo"># Rebase 8db7e8b..fa20af3 onto 8db7e8b</em> <br/><em class="jo">#</em> <br/><em class="jo"># Commands:</em> <br/><em class="jo">#  p, pick = use commit</em> <br/><em class="jo">#  r, reword = use commit, but edit the commit message</em> <br/><em class="jo">#  e, edit = use commit, but stop for amending</em> <br/><em class="jo">#  s, squash = use commit, but meld into previous commit</em> <br/><em class="jo">#  f, fixup = like "squash", but discard this commit's log message</em> <br/><em class="jo">#  x, exec = run command (the rest of the line) using shell</em> <br/><em class="jo">#</em> <br/><em class="jo"># These lines can be re-ordered; they are executed from top to bottom.</em> <br/><em class="jo">#</em> <br/><em class="jo"># If you remove a line here THAT COMMIT WILL BE LOST.</em> <br/><em class="jo">#</em> <br/><em class="jo"># However, if you remove everything, the rebase will be aborted.</em> <br/><em class="jo">#</em> <br/><em class="jo"># Note that empty commits are commented out</em></span></pre><p id="4bde" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当您保存并退出编辑器时，git将遵循reword命令，并将您再次带入编辑器，就像您修改了commit <code class="du jp jq jr js b">ba6f1f</code>一样。现在，您可以编辑提交消息，保存并退出编辑器。</p><p id="188f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你喜欢这篇文章，请点击👏所以其他人会在媒体上看到它。</p></div></div>    
</body>
</html>