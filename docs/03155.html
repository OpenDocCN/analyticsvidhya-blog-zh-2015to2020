<html>
<head>
<title>Electrocardiogram Classification Deep Learning Approach</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">心电图分类深度学习方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/electrocardiogram-classification-deep-learning-approach-8bb201e10164?source=collection_archive---------13-----------------------#2020-01-18">https://medium.com/analytics-vidhya/electrocardiogram-classification-deep-learning-approach-8bb201e10164?source=collection_archive---------13-----------------------#2020-01-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/1038be3aabf2843569d22cac6e718f31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X_ZbtHxc_9Q-L70lonxCJg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">概述:心电图分类系统设计示例(抱歉分辨率低)</figcaption></figure><p id="3076" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这篇文章中，我将谈论我建立的一个心电图分类系统。分类系统获取记录并将其映射到标签中。这篇论文有七个部分，为了帮助你阅读，我标出了一些你可以跳过的段落。我的ECG分类系统在分类记录方面做得不错，它给出了81.2%的平均F1分数。在最后一节，我还会把自己的作品和别人的进行比较。</p><h1 id="67ec" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">概述</h1><p id="358d" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">第1部分:数据描述</p><p id="f244" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">第2部分:数据可视化和形态学</p><p id="d63d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">第3部分:评估标准</p><p id="5a34" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">第4节:心电图分类系统</p><p id="7ac9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">第5部分:结果和数据分析</p><p id="ab33" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">第6节:系统利弊</p><p id="336e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">第七部分:参赛模特(与他们比较)</p><h1 id="7958" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">第1部分:数据描述</h1><p id="215a" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">心电图数据集来自<a class="ae kv" href="http://2018.icbeb.org/Challenge.html" rel="noopener ugc nofollow" target="_blank">2018中国心理学大赛</a>，它有九个类别(见下文)。该数据集中有<strong class="iw hj"> 6877条记录</strong>。每条记录以<strong class="iw hj"> 500 Hz </strong>采样，并有<strong class="iw hj"> 12个通道/导联</strong>。此外，每个记录还包含那个人的性别和年龄，但是我没有使用它们作为输入。</p><p id="bb6c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">九个类别:</p><ol class=""><li id="a02f" class="kw kx hi iw b ix iy jb jc jf ky jj kz jn la jr lb lc ld le bi translated">正常(N)</li><li id="5e07" class="kw kx hi iw b ix lf jb lg jf lh jj li jn lj jr lb lc ld le bi translated">心房纤维性颤动</li><li id="698f" class="kw kx hi iw b ix lf jb lg jf lh jj li jn lj jr lb lc ld le bi translated">一级房室传导阻滞(AVB)</li><li id="f81e" class="kw kx hi iw b ix lf jb lg jf lh jj li jn lj jr lb lc ld le bi translated">左束支传导阻滞(LBBB)</li><li id="5215" class="kw kx hi iw b ix lf jb lg jf lh jj li jn lj jr lb lc ld le bi translated">右束支传导阻滞(RBBB)</li><li id="ee0f" class="kw kx hi iw b ix lf jb lg jf lh jj li jn lj jr lb lc ld le bi translated">房性早搏</li><li id="0ab9" class="kw kx hi iw b ix lf jb lg jf lh jj li jn lj jr lb lc ld le bi translated">室性早搏</li><li id="ec61" class="kw kx hi iw b ix lf jb lg jf lh jj li jn lj jr lb lc ld le bi translated">ST段抬高(STE)</li><li id="668d" class="kw kx hi iw b ix lf jb lg jf lh jj li jn lj jr lb lc ld le bi translated">ST段压低(性病)</li></ol><p id="4cc7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">数据删除:很少有记录属于一个以上的类别，为了使研究更简单，我删除了它们。还剩<strong class="iw hj"> 6397条记录</strong>。</p><p id="a059" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">数据删除后，数据分布如下图所示。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lk"><img src="../Images/808a6d93183e4e079a20a470ea987ae5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LoL4j2bYJQ-FLfWrCFbJNg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">心电图数据分布</figcaption></figure><p id="165c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">下表显示了每个类别中的记录数。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/cc14959c6772ae6b4a1724dc1c0bd3da.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*tlwi8uTT8vYdq7t9WCwetA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">每个类别中的记录数</figcaption></figure><h1 id="52cd" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">第2部分:数据可视化和形态学</h1><p id="516a" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">在我们进入数据集之前，我想谈谈PQRST-waves。<strong class="iw hj">如果你对这部分不感兴趣，可以跳过下面一段，跳转到“各个范畴的形态学”。</strong></p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/a869319feeeed574faad6e2ec9188ff3.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/0*S7qKxHuHLigv_5_V.jpg"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">心脏的电系统。来源:<a class="ae kv" href="https://www.healthlinkbc.ca/health-topics/zm6205" rel="noopener ugc nofollow" target="_blank"> www.healthlinkbc.ca </a></figcaption></figure><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/1f037d44d45008b491589de191589c2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/0*YYKU9bSyZykT7UDF.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">一个周期的心跳信号。来源:<a class="ae kv" href="https://www.aclsmedicaltraining.com/basics-of-ecg/" rel="noopener ugc nofollow" target="_blank">aclsmedicaltraining.com</a></figcaption></figure><p id="d83a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">(跳过)</strong>。心跳的起点是窦房结。窦房结是天然的和平缔造者，它启动心跳并决定心率。窦房结的放电遍及两个心房，并使它们去极化，即P波。PR段是P波结束和Q波开始之间的持续时间，它代表信号从窦房结传播到房室结的时间。房室结是心室的电通道。它接收来自窦房结的信号，并将它们传递到房室束(希氏束)。房室束分为左束支和右束支。室间隔的去极化从左束开始到右束，这导致Q波的负偏转。然后，电信号同时移动到左心室和右心室，但是左心室的信号占优势，因此ECG在R波处显示大的正偏移。s波代表心室去极化的最后阶段。心房复极被心室去极化所掩盖，所以我们在QRS复合体中看不到它。ST段代表心肌动作电位的平稳状态。最后，T波反映了心室的复极。基于这些波、间隔和段的形态，我们可以分析心电图。</p><p id="a3d9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">形态学中的每一类</strong></p><p id="4094" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了形象化，我将使用引线I <strong class="iw hj"> </strong>(见下图)。下面我将展示的每一个ECG信号都来自我的数据集。对于快速阅读，您可以跳过关于异常形成的详细解释，您可以直接阅读每个类别部分中的粗体字。例如，在“AF类型部分”，你可以只阅读“QRS复合体之前的振荡”。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/d8bf7cfe78ce160ef8b2a2cfbcb20c44.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*z6F9xVMkUrF9JbDx0AwfPg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">无创12导联心电图。来源于<a class="ae kv" href="https://www.firstaidforfree.com/recording-a-12-lead-ecgekg/12-lead-ecg-planes/" rel="noopener ugc nofollow" target="_blank">firstaidforfree.com</a></figcaption></figure><p id="f94b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> N型</strong></p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/0463b9ce435f7c6d5b3290ab6e04438d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*8G0ez-tMvjBaiFEQ7U-xig.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">情节1</figcaption></figure><p id="6b35" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在N型中，RR间隔是一致的，这表明患者具有正常的心率。PQRST波无异常形态。</p><p id="ea13" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">自动对焦类型</strong></p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/24ea173e0c5383f3b54d626087f9bbf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*PX0KCdA5H2tjPqaDpHyDEQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">情节2</figcaption></figure><p id="fdf3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">房颤是最常见的心律失常。心跳的起点不是窦房结，而是异位的部位。电脉冲是从许多引起心房纤维性颤动的异位部位随机产生的。在图2中，<strong class="iw hj">QRS复合物</strong>前的振荡反映了许多异位位点的电脉冲。有时这些异位点激活房室结，因此心室去极化(QRS复合体)。因此，<strong class="iw hj">P波缺失</strong>。房颤会导致心房低效收缩，进而形成血凝块。血凝块进入血液并卡在大脑的小动脉中会导致中风。</p><p id="91cb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> IAVB型</strong></p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/8ea2f054fd1552637922fb7e4e3f7b67.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*90lWVdIfHYXWUL0Lvs4PmA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">曲线3:时间= (105个样本)×(1秒)/(500个样本)=0.21秒</figcaption></figure><p id="d0fa" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">IAVB的症状是房室结传导延迟，导致<strong class="iw hj">PR间期延长(&gt; 0.2s)或PR段延长</strong>。大多数IAVBs是良性的，不需要治疗。图3显示了IAVB心跳的示例，PR间隔有105个样本。通过计算绿色矩形中的时间，PR-interval约为0.21秒，因此PR-interval大于0.2秒。</p><p id="12b1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> LBBB式</strong></p><p id="61f3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">正常情况下，两个心室同时去极化，然后同时收缩。在束支传导阻滞(BBB)中，未受影响的心室先去极化，然后另一个心室再去极化。这导致受影响心室的延迟去极化，因此QRS复合物的形态是异常的。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/aed019834f79b686cfbfd777e2bf5e01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*UzWn1sNKjIMBV6raWXaCqg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">情节4</figcaption></figure><p id="f8d7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">对于LBBB，我们使用图4来说明异常QRS复合物的形成。不正常的是，隔膜的去极化是从右向左开始的，因此在QRS综合征的起点显示出正的偏转。右心室首先激活，这将导致一个小的向下偏转。然后，电信号传播到大左心室，这将导致另一个正偏转，因此<strong class="iw hj">一个宽特征“兔子耳朵”QRS复合体</strong>。有时，由右心室去极化引起的小的向下偏转是不可见的，或者左心室去极化的幅度小于隔膜去极化的幅度。</p><p id="57bd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> RBBB型</strong></p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/98f19dc71c3be689dc65bccf21f79c97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*ihWEqFd7I0QmS6UuH4NqrA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">地块5</figcaption></figure><p id="61d1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">地块5是RBBB的一个例子。正常情况下，隔膜的去极化从左向右开始。左心室正常去极化，这导致正常的R波。然后电脉冲传播到右心室，导致<strong class="iw hj">大的负偏转和更宽的S波。</strong></p><p id="3a95" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">包装类型</strong></p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/676380381f2429fc9c90ae658e57938b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*05RkCMTTwJURuZgPLZ0wCg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">地块6</figcaption></figure><p id="acf2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">当一个心房中有异位点放电时，就会发生PAC。PAC有几种形态。首先，<strong class="iw hj">由于异位部位的激活，P波可以合并到前面的T波</strong>。其次，<strong class="iw hj">P波可以反转，出现负偏转</strong>。第三，异位心房激动可进入窦房结，使其去极化并重置其时序，从而<strong class="iw hj">改变PP间期。</strong>曲线6显示了合并的PT波。</p><p id="3abb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> PVC类型</strong></p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/898cfe4f475b89a5c099ce95829a0b27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*voRlxWZyuCkuie0ojHVZRg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">情节7</figcaption></figure><p id="d341" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">当一个心室的异位部位过早放电时，就会发生PVC。因为PVC不影响SA节点，所以<strong class="iw hj">PP-interval保持不变</strong>。QRS复合体的形态取决于异位部位的位置。QRS情结可以更广、更高、更深。图7显示了QRS复合体的两个负偏差。</p><p id="a2fc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> STE型</strong></p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/dae8ccc2d4d770447299a64fd6e8af13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*FJHPxIkX5mR3tEobDvpZ2A.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">地块8</figcaption></figure><p id="7037" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">STE的形态是以基线为参照，ST段抬高。<strong class="iw hj"> </strong>图8显示<strong class="iw hj">与PR段相比，每个ST段具有向上的斜率</strong>和更大的振幅。</p><p id="c382" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">标准类型</strong></p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/c60c43b47ca4db75a3427702b0def8db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*bVt4holD25tkyx379wHViA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">情节9</figcaption></figure><p id="a211" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">STD的形态学是以基线为参照，ST段压低。图9显示<strong class="iw hj">每个ST段都有负振幅，且低于基线。</strong></p><p id="b733" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">根据这九种形态，在数据预处理中从每个记录中提取心跳是必要的，因为每个异常部分都出现在每个心跳信号中，除了PAC(它涉及PP间隔，但在本研究中我将忽略这一事实)。</p><h1 id="7484" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">第3部分:评估标准</h1><p id="c6c3" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">因为数据集非常不平衡，所以我将选择F1分数作为评估指标。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/ae7619b845d3718b99f3fe5e86f0f1dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:458/format:webp/1*tfHEypsuLJ3PATMxesryXw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">等式1</figcaption></figure><p id="4157" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">等式1对应每个类别的F1分数，其中N_ij是预测为类别j的类别I的测试样本的数量。从1到9的数字对应N、AF、I-AVB、LBBB、RBBB、PAC、PVC、STE和STD。</p><p id="cab9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi">— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — —</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/cdd11bb4fb8cc9c0038286d30064f263.png" data-original-src="https://miro.medium.com/v2/resize:fit:298/format:webp/1*UfF2N2mDQ8NttIo5LLjMyw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">等式2</figcaption></figure><p id="2bad" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">其中F1是F1的平均分数。</p><p id="a774" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi">— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — —</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/99de453ecb129c8340082f9c97e86f2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*QoRskRZ7hxTMD6Suh20qVw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">等式3</figcaption></figure><p id="2aeb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">F_AF测量AF。</p><p id="2f4e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">F_Block测量LBBB、RBBB和IAVB。</p><p id="6a4a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">F_PC测量PAC和PVC。</p><p id="3144" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">F_ST测量标准偏差和STE。</p><h1 id="8fd1" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">第4节:心电图分类系统</h1><p id="7f8e" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">在本节中，有四个小节。</p><p id="63c9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在第4.1节:基于r峰数量的数据集分割中</p><p id="c341" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在4.2节:数据预处理和数据扩充中</p><p id="cb99" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在4.3节:神经网络设计中</p><p id="d0eb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在第4.4节:模型训练和测试中</p><p id="6190" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">第4.1节:基于r峰数量的数据集分割</strong></p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/c60823b716242d0e8647c472ce18305c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*egA2jbU07Xrk9KAsMV5Dow.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">直方图:“记录的长度”与“记录的数量”</figcaption></figure><p id="09aa" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">上面的直方图显示了“记录的长度”与“记录的数量”。我们可以看到大多数记录都属于短长度，大约5000条，但仍有大量记录分布在不同的长长度中。对于批量训练，重要的是将所有训练数据预处理成统一的长度。首先，我将整理我的数据集。</p><p id="e88b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我将根据r峰的数量将数据集分为训练和测试两部分。感谢我的朋友艾哈迈德，他帮我开发了r峰检测算法。这个算法我就不细说了，简单说一下。基于小波变换提出了r峰检测算法。重构信号后，大部分噪声被去除。通过以滑动窗口方式计算局部能量，峰值被增强。因为有12个通道，所以我们用投票法来寻找最可靠的峰值。然后有一些细化工作，以消除假峰。图10显示了一个例子。在我的研究中，由于分割过程，我删除了第一个和最后两个r峰(这四个峰有时会导致程序错误，因为样本不够)。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/91d8255c2b6c444d1ad6f4947b9b1dcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A3nClJEftuoddxBz0nwe6A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">地块10</figcaption></figure><p id="fe32" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在每个类别中，我希望有80%的数据用于训练，20%的数据用于测试。通过使用r峰检测算法，大多数记录具有少于20个r峰，我决定使用20作为边界来分割数据集。如果记录具有小于或等于20个r峰，则该记录被移动到训练数据集，否则被移动到测试数据集。</p><p id="ba79" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">以上流程无法承诺80%的训练和20%的测试。拆分数据集后，一个类别可以有87%的训练数据和13%的测试数据，或者70%的训练数据和30%的测试数据。第一种情况很容易处理，其中7%的训练数据可以移动到13%的测试数据，因此在数据预处理期间不会产生问题。然而，第二种情况会产生问题。如果10%的测试数据移动到70%的训练数据，我不再知道我想要复制到一个统一心跳中的心跳数。因此，我需要找到r峰的数量，它可以用作从测试数据集中选择一些记录并将它们移动到训练数据集中的参考。我仔细检查了每个类别的测试数据集，发现40 r-peaks和60 r-peaks是最佳选择。因此，我进一步将具有“小于或等于40个r峰”和“小于60个r峰且大于40个r峰”的记录从测试数据集中移到训练数据集中。最后，对于每个类别，数据集分为80%的训练和20%的测试。下表显示了培训和测试记录的数量。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/1a841d8791472cecde44e1b7b1a81a3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*qsTW7kFCunLS8VXVmAMaDQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">资料组</figcaption></figure><p id="25de" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">第4.2节:数据预处理和数据扩充</strong></p><p id="8e5a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这个数据预处理的关键是提取心跳。一旦提取了每个记录的心跳，就更容易操作数据集。下图显示了数据预处理的四个步骤。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/b7e78f772ac16436172a1b3ddeba243c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*qeSOLLkqFi6dLmqoyouXlA.png"/></div></figure><p id="eb3a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">步骤1 </strong>，通过使用r峰检测算法，找到r峰的位置。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/91d8255c2b6c444d1ad6f4947b9b1dcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A3nClJEftuoddxBz0nwe6A.png"/></div></div></figure><p id="5dd7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">第二步</strong>，通过选取相应r峰前后的样本，可以分割或提取每一次心跳。在本文中，我将选取r峰之前的119个样本和r峰之后的180个样本，因此每个心跳有300个样本。因为有12个导联，所以每个提取的心跳的形状是300乘12。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/2fbca557bd44925ad18fd538b1273077.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T2ajUtLAV988XqlDc8Hhyw.png"/></div></div></figure><p id="6741" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">第三步</strong>，复制过程允许神经网络批量训练。在这里，我将跳过这个演示。</p><p id="9e70" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">步骤4 </strong>，我们连接从每个记录中提取的所有心跳。对于每个预处理数据，它具有300n乘12的形状，其中n是心跳或R峰的数量。下面的图是指步骤2中的图。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/24f4fd391f2ff5c0e4cc7651b3009a75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m3A5qw9cfWJMqNnGLMyEEA.png"/></div></div></figure><p id="40be" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">数据增强</strong></p><p id="42a5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">心跳提取之后，操纵数据就容易多了。我可以利用数据预处理的优势进行数据扩充。因为检测到的r峰位置总是有序的。对于数据扩充，我可以随机改变r峰的顺序，这可以帮助神经网络增强对心跳形状的学习，而不是记住异常心跳的位置。数据预处理中的复制步骤也有助于数据扩充。这是因为它随机复制了与记录相关的现有心跳。然后，复制的心跳也会随着连接前的所有心跳随机改变它们的顺序。下图显示了数据扩充。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es ma"><img src="../Images/06ade98613a4b8c1fd475c5f59fb4977.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*sh6TqieLIBiV3Yeqk-c_sg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">原始预处理记录</figcaption></figure><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es ma"><img src="../Images/0e803b9ef596328b2ee0469ad8b5d883.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*wH2Wy9qCdqMl0q-_I4Xwpg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">扩充原始预处理记录</figcaption></figure><p id="7565" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">第4.3节:神经网络设计</strong></p><p id="bc6b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">对于现实生活中的应用，我们总是希望算法能够快速准确地执行。当我在设计神经网络的时候，我把速度和架构都记在了脑子里，你会明白我为什么要这样设计。神经网络有三个部分:特征提取器、心跳分析器和分类器。我将讨论如何为神经网络选择超参数，特别是为特征提取器。</p><p id="32b7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">特征提取器</strong></p><p id="cba5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">特征提取器是串行连接的卷积层的堆栈。预处理记录是心跳的连接，因此在每两个相邻心跳之间，信号不是自然连接的。换句话说，我应该避免每两个相邻心跳之间的卷积运算。为了实现这一点，<strong class="iw hj">内核大小应该等于步长大小</strong>，以便在卷积期间没有重叠。此外，在每个卷积层中有一个挑选内核大小的规则。我希望特征提取器在不涉及其他心跳的情况下提取每个心跳的特征，以便心跳分析器可以在一个时间步长内处理每个心跳的特征。<strong class="iw hj">现在我们开始吧。</strong></p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/597cada762a5d3cd66d2fa01138e12ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*C3fDkfYb_MuM10lIf2Fc2Q.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">在每个卷积层中，核的大小总是等于步长</figcaption></figure><p id="b981" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">因为每次心跳的样本数是300，<strong class="iw hj">内核大小一定是300的约数</strong>。在选择每个卷积层的核大小<strong class="iw hj">之前，需要首先决定卷积层的数量</strong>，这是因为卷积层的数量也是300的除数。例如，如果有两个卷积层，那么内核大小可以是10和30，或者12和25，等等。如果有三个卷积层，那么内核大小可以是5和6和10，或者5和5和12，等等。每组数的乘积是300。一个插图显示在这一段的旁边(很抱歉分辨率低)。</p><p id="ada5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我在特征提取器中选择超参数的方式不能捕获心跳的所有潜在特征，这是因为在卷积期间没有重叠。心跳的各种异常需要不同尺度的滤波器来检测。为了更好地捕捉心跳的特征，我需要沿着卷积层的其他分支并行添加具有不同内核大小的卷积层。下图显示了具有不同内核大小的卷积层的两个分支。每个分支的输出大小是相同的，所以这些输出可以连接成一个张量。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/1035295ef0f78fa3beee3aa09ad0386f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*p5Y-uxWvksxSaeyS7JEHYw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">分配有不同内核大小的卷积层的两个分支，其中N是心跳数，N是滤波器数，F是内核大小，S是步幅大小。来自两个分支的输出可以连接成一个张量。在这种情况下，串联输出的大小为n乘以24。</figcaption></figure><p id="7011" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">心跳分析仪</strong></p><p id="a216" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Heartbeat analyzer是长短期记忆(LSTM)层的堆栈。来自特征提取器的输出具有两个维度:第一个维度表示心跳的数量，第二个维度表示关于每个心跳的不同尺度的一组特征。因此，第一维决定了LSTM层过程中的时间步数。在每个时间步骤中，心跳分析器将一个心跳的一组特征作为输入。它从每个LSTM层产生一系列输出，直到到达最后一层。最后的LSTM层输出固定大小的矢量。固定大小的向量是概括整个记录的一组聚集特征。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/400c2548ce63c481876b2ff96a910a5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*1Wf6zz7EVCRJgWVSgAeIwg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">心跳分析仪的流程，其中“HB”表示“心跳”</figcaption></figure><p id="98fd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">左图显示了心跳分析器如何处理特征提取器的输出。有20个心跳，因此每个LSTM层有20个时间步长。每个心跳都有一组特征，其中特征的大小为d。第三LSTM层是心跳分析器的最后一层，因此输出大小是固定的。此外，我将LSTM层替换为双向LSTM层，这有助于顺序学习。</p><p id="bf99" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">分类器</strong></p><p id="9e59" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我可以使用全连接层(fcl)作为分类器，因为输入大小是固定的。fcl也称为多层感知器。该层不共享权重。一层中的每个神经元连接前一层和后一层中的每个单个神经元，如果层的宽度很大，这会导致大量的参数。在我们的小数据集中使用大尺寸的分类器是不切实际的。然而，<strong class="iw hj">特征提取器和心跳分析器大大降低了输入数据的维度</strong>。首先，特征提取器提取心跳的有用信息，并丢弃冗余信息，其中有用信息是代表原始心跳的低维特征集。然后，心跳分析器分析每组特征，并进一步降低数据的维度。最后，heartbeat analyzer的输出是一个紧凑的特性，它表示来自一个记录的所有心跳。通过使用用于分类的紧凑特征，分类器的大小可以非常小。</p><p id="c7ee" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">神经网络设计的一个实例</strong></p><p id="32c0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">下图显示了我们的神经网络的实例。特征提取器具有卷积层的五个分支，参数的数量是23，184。心跳分析器有74，240个参数，分类器有3，689个参数。除了最后一个FCL，图中的每一层后面都有一个批量标准化层和ReLu激活函数。最后一层只是跟着Softmax激活函数。损失函数是分类交叉熵损失函数。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/030b5ed9274e04dbb1ba5025a8861e53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*_6AqTPSVaO4DZTNv3RgOWA.png"/></div></figure><p id="3a93" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">第4.4节:模型训练和测试</strong></p><p id="668f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在是时候讨论如何训练神经网络了。我在三个不同的文件夹里有训练记录:20个r峰，40个r峰，60个r峰。因此，在每个训练迭代中有三个训练阶段。为了避免神经网络偏向一个类别而不是另一个类别，我们希望均匀地训练每个类别。培训过程的细节如下所示:</p><p id="109e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="mc">对于每次迭代:</em></p><p id="e8d9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="mc"> == &gt;在20次心跳记录中(第一阶段):</em></p><p id="4955" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="mc"> ====== &gt;在每个类别中随机挑选128个录像</em></p><p id="e3f5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="mc"> ========== &gt;数据预处理和扩充</em></p><p id="80cc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="mc"> ========== &gt;列车128*9个记录全部在一起</em></p><p id="dff7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="mc"> == &gt;在40次心跳记录中(第2阶段):</em></p><p id="ef09" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="mc"> ====== &gt;在每个类别中随机选择32个录像</em></p><p id="e9fb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="mc"> ========== &gt;数据预处理和扩充</em></p><p id="cbc8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="mc"> ========== &gt;列车32*9个记录全部在一起</em></p><p id="aa2a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="mc"> == &gt;在60次心跳记录中(第三阶段):</em></p><p id="6b34" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="mc"> ====== &gt;在每个类别中随机选择16个录像</em></p><p id="ac26" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="mc"> ========== &gt;数据预处理和扩充</em></p><p id="83a7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="mc"> ========== &gt;列车16*9个录音全部在一起</em></p><p id="43a0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="mc">如果F1平均分数饱和，则通过乘以0.1来降低学习率</em></p><p id="2955" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">对于测试数据集，我们不使用复制步骤和数据扩充。</strong></p><h1 id="6434" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">第五部分:结果和分析</h1><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es md"><img src="../Images/070d1896ff5cd14655edcdbee5281b7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*9wvypUAZmRO6RgDfub02eA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd ju">表5.1:每个模型和集合模型的结果</strong></figcaption></figure><p id="911b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">集成模型是多种学习算法的组合，比单一学习算法具有更好的预测性能(见表5.1)。我用相同的设计理念独立训练四个神经网络。每个神经网络都有不同数量的参数(见表5.1)。例如，神经网络的特征提取器可以具有或多或少的卷积层分支。双向LSTM层的大小可以是32或50。重点是将神经网络的损失函数减少到不同的局部最小值，以便每个神经网络可以在不同的方向学习数据集。<strong class="iw hj">所有模型的训练数据集和测试数据集都是相同的</strong>，这里我不使用交叉验证。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es me"><img src="../Images/12724ed9ada3968b9012cc0946d4594b.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*TV5LNTLebhVOWEGB3sxC0A.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图5.1:集合模型</figcaption></figure><p id="f2f7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">最后一个全连接层的输出是九个概率的向量。在图5.1中，我通过分段求和的方式组合了四个向量，得到了一个有九个值的向量。最大值的索引决定了输入数据的类别。图5.1中的“9”是每个神经网络输出的大小。我的集成模型的大小是703，153个参数，这是四个神经网络的总和。此外，与比赛中的其他模型相比，系综模型相对较小(稍后我将展示其他模型结果)。</p><p id="5399" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">下表是集合模型的详细结果。现在，让我们分析结果。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/c3c78e3d5498b6e6ad7451ac914bb849.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*SwdYYDLSqlEauXT0-NH9kA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">表5.2:测试数据集的结果(平均F1分= 0.812)</figcaption></figure><p id="1573" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> PAC记录分析</strong></p><p id="e177" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">表5.2显示了最差的F1分数在PAC中，其中大多数数据落入n。我提到过PAC的形态包括PP间隔的变化。我们的数据预处理是提取心跳，去除心跳之间的相关性。因此，系统不能学习P波到P波之间的时间。为了更好地理解为什么大多数PAC数据归入N，我们需要可视化归入N的PAC数据(图5.1)和正确分类的N数据(图5.2)。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/6c6517eedb2cfe945eecfda307ea72b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*vrRaVSq3fAgruARUR65K0A.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">地块5.1</figcaption></figure><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/64328d6abf3c0fae146c823d182bc3ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*dV5O62gQq3vWpWZmWsYs1Q.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">地块5.2</figcaption></figure><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/1095c4cd503bf69b16df02e23b336398.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*aSZu4WrVAyfQZZ705NXh0Q.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">地块5.3</figcaption></figure><p id="0f36" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">通过比较两个图(5.1和5.2)，我们可以看到它们看起来很相似。如果我们看一看这个PAC数据的原始信号，我们会看到根本问题来自数据预处理。图5.3是未经数据预处理的图5.1中的PAC数据。在图5.3中，绿色矩形是P波与前一个T波融合的异常部分。在分割步骤，我使用固定的阈值来提取心跳，因此<strong class="iw hj">异常在分割步骤后消失</strong>。这是另一种情况，在图5.4中，我们可以看到PP间隔在变化。因为我们的数据预处理，分段的部分看起来就像N个数据。因此，这解释了为什么大多数PAC记录被错误分类为n。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/9f4c158a229b1ce3e9304bb6f4734441.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*E9w_bi22DsRpSfcbxv1kOw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图5.4:显示数据预处理问题的PAC数据</figcaption></figure><p id="9d84" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> STE和性病记录分析</strong></p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/bb1e06ee6e44204c54373d01d56ba5d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*DCcF8WCN1LXd1tIRAKhmJg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">地块5.5</figcaption></figure><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/d398ec7cff97069018a61c81a070020a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*6blABUljqFWT8k2hChWnoQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">地块5.6</figcaption></figure><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/5e54e2354822005d8dfd10794bd16e2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*1YjsvXtmtfq2ymePRkcV3A.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">情节5.7</figcaption></figure><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lk"><img src="../Images/808a6d93183e4e079a20a470ea987ae5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LoL4j2bYJQ-FLfWrCFbJNg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图5.2:心电图数据分布</figcaption></figure><p id="341a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">根据表5.2，STE和STD的F1分数也相对较低，低于80%。他们的大部分数据被错误分类为n，我们将使用lead V5来可视化这种情况下的数据。我们比较了正确分类的N数据(图5.5)和归入N的STE数据(图5.6、5.7)。在所有的图中，ST段都有向上的坡度。就每次心跳的形态而言，图5.5和图5.7非常相似，这解释了为什么该stE记录被错误分类为n。然而，图5.6显示了ST段最陡的向上斜坡，很容易被识别为STE，但模型将其分类为n。我能想到的唯一原因是STE类别没有足够的数据(图5.2)进行训练，这导致了我们系统的学习偏差。STD的F1分数比STE的分数高6%，因为STD有更多的记录要训练，但STD对系统来说仍然很难学习。</p><p id="50ca" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> LBBB战绩分析</strong></p><p id="06e9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">LBBB的数据最少，但是F1的分数很高，0.896。这是因为LBBB在所有九个类别中具有最独特的形态。</p><p id="6f6f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">其他</strong></p><p id="099e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">此外，训练神经网络需要大数据集和复杂的数据扩充技术，以便神经网络可以从数据中捕捉某些类型的不变性。我的数据集很小，很难应用数据扩充技术。尽管我使用数据预处理来简化系统的训练，并使用数据扩充技术来增强系统的学习，但是系统不能完全捕获不变性，例如信号失真不变性。信号失真是原始心电图上的噪声，它导致信息的破坏。这些噪声包括基线漂移、运动伪影、电力线干扰、肌肉噪声等。模型的良好性能还需要数据集的良好质量。我的数据集包含大量噪声，一些导联没有有用的信息(图5.8、5.9)。另外，标签也有可能是错的。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/9d32353c4ac2e45a75e540f533c788bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*S8q_1cTqV44PnR_qNvO7dw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">情节5.8:线索不包含有用的信息</figcaption></figure><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/1b1b7dffbd851fa3b9156006fefb9eea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*ljOqLKD2fKqcG3ocoFpMYg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">情节5.9:铅是无用的</figcaption></figure><h1 id="ba53" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">第6节:系统利弊</h1><p id="66a8" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated"><strong class="iw hj">优点</strong></p><p id="dc13" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我的心电分类系统设计比较特别。它将每个心跳映射到单个时间步长的情况下，减少了双向LSTM层的处理时间。我在特征提取中选择超参数的方式也减少了处理时间，因为核大小等于每层中的步长。更重要的是，它可以并行运行四个神经网络，花费与单个神经网络相同的时间。</p><p id="46cc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">缺点</strong></p><p id="1277" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我已经提到了我的数据预处理的缺点。因为我提取的是单个心跳，所以预处理后的数据不提供心跳之间的关系信息，例如PP间隔。因此，我的神经网络无法学习导致PAC性能不佳的PP区间的统计信息。为了改善PAC的结果，我需要分割两到三个连续的心跳。</p><p id="711b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我的神经网络设计也有缺陷。在每个卷积层中，内核大小等于步幅大小，因此捕获心跳的所有底层特征是有限制的。相同大小的内核和步距的原因是卷积运算不应该在两个相邻的分段心跳之间卷积(它们不是自然连接的)。然而，如果我在心跳分析器中应用卷积运算，我们可以使用任何步长。这种类型的设计称为递归卷积神经网络，其中卷积运算用于递归层。但是，权衡当然是处理速度(可以很慢)。</p><h1 id="f873" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">第七部分:参赛模特</h1><p id="fd03" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">现在我的项目完成了，我想把我的工作和其他人的先驱研究进行比较。其他的成绩来自<a class="ae kv" href="http://2018.icbeb.org/Challenge.html" rel="noopener ugc nofollow" target="_blank">2018中国心理学大赛</a>。<strong class="iw hj">这里我需要声明一下，有两个数据集来自</strong><a class="ae kv" href="http://2018.icbeb.org/Challenge.html" rel="noopener ugc nofollow" target="_blank"><strong class="iw hj">2018中国心理学大赛</strong> </a> <strong class="iw hj">。我只使用数据集1，因为数据集2是隐藏的，没有人可以访问它，但参加这个比赛的人用隐藏的数据集评估他们的模型。不幸的是，比赛后我不被允许使用隐藏数据集，所以我的集合模型用4.1节中的测试数据集进行评估。不管怎样，我们开始吧。</strong></p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/07420fc580553f0b4c3b0d45bdc9e312.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*L07H8XnSB1I0ej-rXLF-Dw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">表7.1</figcaption></figure><p id="d424" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">表7.1总结了使用隐藏数据集的比赛结果。序列号表示每个型号的等级。比赛有34款，我只拿前15款。表7.1中的F1是平均F1分数，它决定了模型的位置。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/c972676c7888f45fa2255d924bf32634.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*nmQZcQO8fKFyboq3vEq4Qg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">地块7.1</figcaption></figure><p id="0334" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">图7.1是根据表7.1绘制的；它显示了模型的等级与F1分数的类型。水平虚线是某些类型F1分数的平均值。正如我们所见<strong class="iw hj">所有型号在学习PC型和ST型录音时都有困难。</strong>PC型和ST型的性能对模型的等级有很大的影响。在图7.1中，星形标记是我通过使用4.1节中的测试数据集的集合模型的结果。星形标记仅用于y轴可视化，x轴不适用于星形标记。虽然由于不同的测试数据集，我的模型的结果与其他模型的结果没有可比性，但它给出了我的模型的性能如何的一般概念。我ST型的F1分挺高的，PA型的F1分低于平均水平。房颤型和阻滞型的F1分数均高于平均水平。</p><p id="475a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果有任何问题，请告诉我。感谢您阅读我的作品！</p></div></div>    
</body>
</html>