# 探索性数据分析:对我的生物数据的另一种研究

> 原文：<https://medium.com/analytics-vidhya/exploratory-data-analysis-another-degree-of-research-for-my-biological-data-941a377a692?source=collection_archive---------23----------------------->

![](img/b7cbb68dc7947545be2f82c2cd1fbb20.png)

卢克·切瑟在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

作为生物学家，我经常和数据打交道。无论我在编程方面有多流利，为我的分析管道决定步骤总是一个反复试验的过程。有时需要参考其他参考书目，并与其他研究人员讨论。我的分析管道总是从探索性数据分析(EDA)开始。EDA 帮助我调查数据中发生了什么，并检测对进一步分析可能很重要的关键点。

我所说的 EDA 是指它是*我的分析*的第一步。但是，并不一定意味着 EDA 是数据分析的初始步骤。它是一种分析数据的方法，包括数据主要特征的总结和图解。数据分析的初始步骤还有一个术语，叫做初始数据分析(IDA)。IDA 侧重于检查模型拟合的假设，处理缺失值，并进行变量转换。他们经常一起去，EDA 本身也包括 IDA。

EDA 是一种实践，它来自于该学科的经验和知识。在这篇文章中，我想分享执行 EDA 的步骤。我举一个例子，我的实验数据在杨树的抗性。它由 93 个观察值和 7 个变量组成。

我用 R 来引导 EDA。我从导入我的数据开始。

我导入的是一个大数据集。在我的分析中使用所有的变量是不实际的。此外，它会占用我们计算机的大量内存空间，降低分析速度。在处理大型数据集时，记住这一点很重要。在选择相关变量之前，我会进行文献研究，构建我的分析目标和工作流程。这种方法帮助我确定关键变量，以达到我的分析目标。

在所有这些步骤之后，我选择了关键变量。

# 检查数据结构

在 EDA 中，下一步非常重要，这一点我怎么强调都不为过。

在进行任何分析之前，您总是需要检查每个变量的数据类。这是为了确保**变量包含正确的数据结构(或类，或类型)用于您的分析。**使用不合适的数据结构进行分析可能会导致误导性的结果甚至错误。

这一步之所以重要的另一个原因是它使您的分析管道高效。想象一下，你在做了一个很长的分析过程后发现了一个错误。你查了一下发现是因为你的数据结构不对。然后，您必须再次检查您的代码，并修改它以纠正您的分析。那比你应该花的时间要多。无论如何，随着您的学习，您将掌握创建高效分析管道的思想。

所以我通常使用这个函数来检查数据集的结构:

我发现了一些我不满意的类的变量。因为变量名是用法语写的，所以我将首先带您浏览一下。

*   分类:我们采集杨树的原始种群类型
*   种群:我们采集杨树的原始种群
*   克隆:杨树的身份名称
*   Notemax，latence，nbsores，taille:我在这个分析中使用的关键变量

有时你应该交叉引用实验记录或你的分析管道。你问自己这些变量更适合什么数据类？

在我的情况下，因为这是实验数据，我会回头看看我的实验记录。我知道我们从 4 种类型的种群中收集了杨树，至少从 30 个种群中收集了杨树。因此，这些类型的群体和起源群体中应该有几个杨树个体。因此，我不想把这些数据放在 string 类(chr)中，而是想把它们转换成 factor(或者一般来说，groups)。

我不想一个一个地观察数据点，而是想用图形可视化来评估数据点。所以我做了每个参数的分布图。

![](img/071d0af4c77f70c776b3198557dcc6a4.png)

阻力参数的原始分布

观察原始数据集的分布总是有益的。它将引导您看到数据中的异常。它还可以帮助您决定下一步，例如检查数据集中的值、检查结构、将异常与其他研究或其他研究进行交叉引用。

比如这个数据集中，我发现 taille 和 latence 不是正态分布。这让我产生了疑问。这是一种异常现象吗？这是生物系统中的规律吗？

为了回答这些问题并决定我的下一步(即我是否应该转换这些值)，我可以将我的数据与类似的调查研究进行交叉引用。我也可以阅读植物抗性背后的生物学。经过相互参照，我发现这是一个规律。因此，根据我的下一个目标，我可能需要用一个不严格假设正态分布的模型来继续我的分析。

# 为您的 EDA 定义目标

你可能会发现自己在 EDA 过程中迷失了。您知道如何对分析进行编码，但是有时您不知道您的代码将带您到哪里。我建议你设立小目标。这些目标会让你的 EDA 更高效，更有针对性。在其核心，EDA 应该给你的数据提供初步的见解，并指导你的分析管道。

使用这个数据集，我想看到我个人的五个想法。

1.  田间和实验室有没有完全抗性的杨树？
2.  田间和实验室中杨树的平均抗性是多少？
3.  哪些类型的杨树种群抗性较好？
4.  现场电阻和实验室电阻的参数之间有关联吗？
5.  lab 电阻的参数之间有关联吗？

您可以在这里查看回答所有问题的源代码:

[研究期刊(firzaariany.github.io)](https://firzaariany.github.io/field_resistance/index.html#Raw_distribution)

为了澄清，田间抗性是指杨树在环境中具有抗性，而实验室抗性是指在实验过程中杨树在实验室中具有抗性。场电阻仅由一个参数测量(此处称为 notemax)。Lab 电阻通过三个参数来衡量(latence、nbsores 和 taille)

# 田间和实验室有没有完全抗性的杨树？

图形可视化使我们更容易看到和解释数据中的模式。设定目标可以帮助我们确定显示数据模式的图表类型。

在这一步中，我只想知道在田间和实验室中具有抗性的杨树。我决定使用条形图。很容易看出，只有一种杨树在野外具有抗性(左)，另一种杨树在实验室具有抗性(右)。我搜索了所有的数据点，看看它们的名字。结果发现两者是不同的个体。这表明在野外具有抗性的杨树在实验室中并不自动产生抗性。

所以你走吧！你有一个问题的答案，所以你可以安全地转移到另一个问题。定义目标有助于你进行有针对性的分析。这也给人一种富有成效的感觉，在某种程度上，你实现了小目标，向更大的目标前进。

![](img/ef7dd98e4927bdcccfb71f1eeafe9881.png)![](img/cf7b9bc9dbaaacf0f695a819b7afdea9.png)

田间只有一株抗性杨树(左)和实验室有一株抗性杨树(右)

# 田间和实验室中杨树的平均抗性是多少？

除了图形可视化，汇总统计也很重要。汇总统计让您了解数据的平均性能、分布和变化。对于汇总统计，我通常做两步。

首先，我编写下面的代码来给我数据的快照。

汇总函数显示哪些数据是连续的，哪些是离散的。如果你还记得，我把变量类和人口从字符串(chr)转换成了因子(或组)。这意味着这些变量现在包含离散值。因此，summary 函数将返回每个因子中包含的数据点的总和。对于具有连续值的变量，summary 函数显示基本汇总统计的值，如变量 Notemax 所示。

其次，我可以很好地将汇总统计数据放入图形可视化中。

![](img/a38c181671e9e2d6d73baccb504a9d0d.png)

# 哪些类型的杨树种群抗性较好？

![](img/07e518ec35cb616433a1a3ad9e85c022.png)![](img/8a95ec367022c709a0d94548b2855dc6.png)

来自自然种群和亲本种群的杨树份额(左)和杨树的起源(右)。

你可以从你的数据中探索更多。在这一步中，我意识到杨树个体是从不同的种群类型中收集的。有些来自自然群体，有些来自亲代群体。只是简单介绍一下这两个:

1.  自然种群是指野生的种群。在这种情况下，杨树是野生杨树。
2.  亲代群体是育种计划的群体。在这种情况下，杨树是育种计划的亲本。它们是从野外挑选出来的，现在由人类出于繁殖目的管理。

因此，我想看看每种人口类型的个体比例(左)。我也想观察一下这些杨树是从哪里来的(右)。然后我想看看来自亲本种群的杨树是否比来自自然种群的杨树有更好的抗性。箱线图是一个合适的选择。

![](img/5f6ec267e98ae5f4aecb16da107adf62.png)![](img/7d0d42397075255a7575ff3e0c2cda7e.png)![](img/1f15160c410737277278e24c8db29605.png)

比较自然群体和亲本群体之间的田间抗性(左上)、孢子大小(右上)、潜伏期(左下)和孢子数量(右下)。箱线图是比较两组之间性能的有效图示。

提醒一下:1)田间抗性是田间的抗性，2)孢子大小、潜伏期、孢子数量是实验室的抗性参数。从这些方块图中，我可以得出结论，来自亲本种群的杨树比来自自然种群的杨树具有更好的田间抗性。在 lab 抗性的情况下，来自亲本种群的杨树表现出相反的模式。

# 现场电阻和实验室电阻的参数之间有关联吗？

我通常对变量做的是观察它们之间的关系。换句话说，我评估变量之间的相关性。根据您的下一步分析(即建模)，相关性可能至关重要。您可能需要删除相关变量或保留它们

在本步骤中，我将只评估场电阻与实验室电阻各参数之间的相关性。它们似乎没有任何关联。

![](img/92ec8d9aaca8469c664dfb794527586f.png)

田间电阻与实验室电阻参数的相关图

# lab 电阻的参数之间有关联吗？

仍然具有相关性，但是这次是在实验室阻力的参数之间。我发现孢子大小和潜伏期呈负相关。我还区分了杨树亲本和自然种群之间的回归线，只是为了看看性能的差异。

![](img/02359cf924039eb2501328e529ee46e0.png)

实验室阻力两个参数的相关性

# 结论

随着你的学习，你会有你分析数据的模式。它来自实际生活中的数据和主题知识的实践。不管你的工作流程和专业领域如何，你肯定需要理解你的数据。EDA 帮助您探索和发现数据中的潜力。它包括另一种程度的研究，因为有时你必须交叉引用和评估你的结果。做一个有针对性的 EDA，要学会定义目标。最后，你需要学习有效的视觉化。可视化使交流更加容易和有效。也是 EDA 的重要组成部分。