<html>
<head>
<title>An Introduction to Machine Learning with Scikit-Learn.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Scikit-Learn介绍机器学习。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/an-introduction-to-machine-learning-with-scikit-learn-9f72812dd413?source=collection_archive---------14-----------------------#2020-02-04">https://medium.com/analytics-vidhya/an-introduction-to-machine-learning-with-scikit-learn-9f72812dd413?source=collection_archive---------14-----------------------#2020-02-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/edf5ad655d8d911d4b71f7702d933d16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*m47UHiG4DlAnxBFW"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">照片由</strong> <a class="ae iv" href="https://unsplash.com/@askkell?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> <strong class="bd iu">安迪·凯利</strong> </a>拍摄</figcaption></figure><p id="7c3e" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">这个故事代表了一个简单的途径，使用<strong class="iy hj"> Scikit-Learn框架</strong>和使用<strong class="iy hj">批量推理</strong>来构建一个<strong class="iy hj">回归ML模型</strong>。</p><p id="7f4c" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">这里，一个住房贷款利率预测器是使用房地美单户住房贷款数据建立的。使用Scikit-Learn可以使用类似的方法构建任何回归模型。</p><h1 id="05d2" class="ju jv hi bd iu jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">使用的工具/软件:</h1><ol class=""><li id="f4b8" class="kr ks hi iy b iz kt jd ku jh kv jl kw jp kx jt ky kz la lb bi translated">服务— Jupyter笔记本。</li><li id="4adc" class="kr ks hi iy b iz lc jd ld jh le jl lf jp lg jt ky kz la lb bi translated">存储—电脑。</li><li id="cd5e" class="kr ks hi iy b iz lc jd ld jh le jl lf jp lg jt ky kz la lb bi translated">语言— Python。</li></ol><h1 id="b32e" class="ju jv hi bd iu jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">构建ML模型所遵循的清单:</h1><ol class=""><li id="b75f" class="kr ks hi iy b iz kt jd ku jh kv jl kw jp kx jt ky kz la lb bi translated">纵观全局。</li><li id="9007" class="kr ks hi iy b iz lc jd ld jh le jl lf jp lg jt ky kz la lb bi translated">导入和选择有效数据。</li><li id="7e50" class="kr ks hi iy b iz lc jd ld jh le jl lf jp lg jt ky kz la lb bi translated">数据分析和可视化。</li><li id="b9ad" class="kr ks hi iy b iz lc jd ld jh le jl lf jp lg jt ky kz la lb bi translated">数据准备管道。</li><li id="365b" class="kr ks hi iy b iz lc jd ld jh le jl lf jp lg jt ky kz la lb bi translated">尝试不同的模型并选择一个模型。</li><li id="9a0d" class="kr ks hi iy b iz lc jd ld jh le jl lf jp lg jt ky kz la lb bi translated">超参数调整、特征选择和最终流水线。</li><li id="8b8f" class="kr ks hi iy b iz lc jd ld jh le jl lf jp lg jt ky kz la lb bi translated">最终模型培训和评估。</li><li id="4252" class="kr ks hi iy b iz lc jd ld jh le jl lf jp lg jt ky kz la lb bi translated">解决方案演示。</li><li id="1a94" class="kr ks hi iy b iz lc jd ld jh le jl lf jp lg jt ky kz la lb bi translated">批量部署和监控。</li></ol><h1 id="7f26" class="ju jv hi bd iu jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">1.纵观全局。</h1><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/31fc222f334c25b8be38487ede17c529.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xjXjFekzs8OL6OOITurVXw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">纵观全局。</strong></figcaption></figure><blockquote class="lm ln lo"><p id="de8e" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">这里建立的ML模型将预测新住房贷款申请的准确利率，<strong class="iy hj"> <em class="hi">帮助</em> </strong>精算师快速做出&amp;准确的最终利率决定。这将有助于金融机构获得更多的业务，使家庭贷款收购过程更简单和准确。</p><p id="48a7" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">由于精算师需要确定每个新申请的确切利率，这里的问题被归类为<strong class="iy hj"><em class="hi"/></strong>监督多元单变量回归。<em class="hi">监督</em>作为历史数据具有利率标签，<em class="hi">多重</em>作为使用多个输入特征，<em class="hi">单变量</em>作为模型将预测每个贷款申请的单个输出。</p><p id="663a" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">用于模型评估的性能测量是RMSE，因为它对较大的误差给予较大的权重。最后，批量转换用于预测新应用的速率。</p></blockquote><h1 id="397d" class="ju jv hi bd iu jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">2.导入和选择有效数据。</h1><blockquote class="lm ln lo"><p id="3683" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">静态采集数据使用网络抓取技术从<em class="hi">房地美</em>网站下载。从2015年<em class="hi">到2017年</em>的样本采集数据用于建立模型，从2018年<em class="hi">到2018年</em>用于验证。因此，现在使用<em class="hi">2015–2017</em>数据，一旦我们都设定了最终模型，将使用<em class="hi"> 2018 </em>。</p><p id="4c15" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">总行数为<em class="hi"> 150000 </em>，等于<em class="hi">2015–2017</em>年样本文件中每笔贷款的<em class="hi"> 27个属性</em>的收购贷款总数。在<em class="hi"> 27个</em> <em class="hi">属性</em>，<em class="hi"> 2个是日期，13个是分类，12个是连续</em>。每年的数据每月都有。</p><p id="8057" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">一旦数据被下载，只有符合用户指南的有效记录被选择用于进一步分析，产生<em class="hi"> 149919 </em>行数。日期列类似<strong class="iy hj"> <em class="hi">到期_日期</em> </strong> <em class="hi">，</em>分类列<strong class="iy hj"> <em class="hi">产品_类型</em> </strong> <em class="hi">，</em> <strong class="iy hj"> <em class="hi">贷款_序列号</em> </strong> <em class="hi">，</em> <strong class="iy hj"> <em class="hi">超级_确认_标志</em> </strong> <em class="hi">和</em><strong class="iy hj"><em class="hi">pre _ harp _贷款_序列号</em><em class="hi"/></strong></p></blockquote><p id="ae53" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">请访问<a class="ae iv" href="http://www.freddiemac.com/fmac-resources/research/pdf/user_guide.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="iy hj"> <em class="lp">用户指南</em></strong></a><strong class="iy hj"/>&amp;<a class="ae iv" href="https://github.com/abhilash499/Scikit-Learn-Regression" rel="noopener ugc nofollow" target="_blank"><strong class="iy hj"><em class="lp">GIT链接</em> </strong> </a>了解<em class="lp">导入数据脚本</em>和<em class="lp">抄书分析。</em></p><h1 id="a284" class="ju jv hi bd iu jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak"> <em class="lt"> 3。数据分析和可视化。</em>T71】</strong></h1><h2 id="44fa" class="lu jv hi bd iu lv lw lx jz ly lz ma kd jh mb mc kh jl md me kl jp mf mg kp mh bi translated">3.1分类属性:</h2><blockquote class="lm ln lo"><p id="dfe9" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">在12个分类属性中，有9个用于我们来自初始数据分析的模型。</p><p id="edc2" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated"><strong class="iy hj">唯一值</strong>和<strong class="iy hj">计数</strong>被检查<em class="hi"> </em>以确保数据干净并符合用户指南。</p><p id="30a1" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated"><strong class="iy hj">还为分类属性<strong class="iy hj">绘制了关系、分布和比较图</strong>。</strong></p></blockquote><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/73925d8d8917ae45fb08ecdc1084c806.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sE-shzRpVuWrVHL92ebK5w.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">带状和箱形地块。</strong></figcaption></figure><h2 id="fa14" class="lu jv hi bd iu lv lw lx jz ly lz ma kd jh mb mc kh jl md me kl jp mf mg kp mh bi translated"><strong class="ak"> 3.2数值属性:</strong></h2><blockquote class="lm ln lo"><p id="8612" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">对所有数值属性的汇总计算如下。</p><p id="3eb8" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated"><strong class="iy hj">关系、分布和相关性</strong>也被绘制成数字属性<strong class="iy hj">。</strong></p></blockquote><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/382e822701e4284f1e4f7550d8113bf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bsO3QDtpmgHo_USZuzQGAw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">散点图、LM图和分布图。</strong></figcaption></figure><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/f27c13bdde8abfb0dce9539530b5af25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G63nfdB7gV2aCmnUQK0_Zg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">相互关系的热度图。</strong></figcaption></figure><h2 id="3299" class="lu jv hi bd iu lv lw lx jz ly lz ma kd jh mb mc kh jl md me kl jp mf mg kp mh bi translated">3.3拆分数据:</h2><blockquote class="lm ln lo"><p id="9444" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">数据(2015-2017年)现在分为训练集和测试集，80%作为训练集，20%作为测试集。在最终的推理管道建立之前，测试数据将保持不变。在这种情况下使用随机分裂，但是我们也可以基于某些特征使用分层分裂。列车数据有119935 <em class="hi"> </em>行。</p></blockquote><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/214fd8c0212c17f3b4f4ea061f77c80b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xLJGOyUPYk34_CaSK-3hfw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">随机列车试裂。</strong></figcaption></figure><h1 id="a6b5" class="ju jv hi bd iu jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">4.数据准备。</h1><p id="a08f" class="pw-post-body-paragraph iw ix hi iy b iz kt jb jc jd ku jf jg jh mm jj jk jl mn jn jo jp mo jr js jt hb bi translated">Scikit学习管道用于每个后续步骤。</p><h2 id="4982" class="lu jv hi bd iu lv lw lx jz ly lz ma kd jh mb mc kh jl md me kl jp mf mg kp mh bi translated">4.0设置数据和变量。</h2><blockquote class="lm ln lo"><p id="85a6" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated"><strong class="iy hj"> <em class="hi"> Train </em> </strong>和<strong class="iy hj"> <em class="hi"> Train_Labels </em> </strong>数据是从上面拆分步骤中创建的<strong class="iy hj"> <em class="hi"> Train数据</em> </strong>中提取的。像<strong class="iy hj"> <em class="hi"> num_cols </em> </strong>，<strong class="iy hj"> <em class="hi"> cat_cols </em> </strong>和<strong class="iy hj"> <em class="hi"> Index </em> </strong>这样的变量被设置为在管道中使用。</p></blockquote><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/540e322e1c0f26f7bc044cbf0d89214a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rajviYr0sSAocdmGqywEmA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">设置数据和变量。</strong></figcaption></figure><h2 id="a6c0" class="lu jv hi bd iu lv lw lx jz ly lz ma kd jh mb mc kh jl md me kl jp mf mg kp mh bi translated">4.1 <strong class="ak">创建邮政编码和分类字典。</strong></h2><blockquote class="lm ln lo"><p id="c6c5" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">输入数据中有三位数的邮政编码。提取所有可用的不同后代码，计数至<em class="hi"> 885 </em>。基于<strong class="iy hj"><em class="hi"/></strong><em class="hi"/><strong class="iy hj"><em class="hi">100个地点</em></strong><strong class="iy hj"><em class="hi">5公里</em> </strong> <em class="hi"> </em> <strong class="iy hj"> <em class="hi">半径<strong class="iy hj"> L <em class="hi">纬度</em> </strong> <em class="hi">在885个中，有883个只是聚集在一起，因为我们的纬度和经度确定算法无法定位两个邮政编码。在预处理期间，这两个邮政编码将被分配给<strong class="iy hj">其他</strong>类别，以便它们可以被一键编码器使用。</em></em></strong></p></blockquote><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/c66fc9f4950a30b6e6dee3f8b50b6b5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l3WtNWhwiG38TlAc8I61sg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">美国无团簇。</figcaption></figure><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/aa85f3f343256b1d3445c679eefe6407.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u7O9bMF25IRpp7qZM1xJiw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu"> US聚类成10个聚类。</strong></figcaption></figure><p id="5fec" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">最终的字典被保存以用于后面的预处理步骤。<em class="lp">聚类脚本</em>请访问<a class="ae iv" href="https://github.com/abhilash499/Scikit-Learn-Regression" rel="noopener ugc nofollow" target="_blank"> <strong class="iy hj"> <em class="lp"> Git链接</em> </strong> </a> <em class="lp"> </em>。</p><h2 id="78fd" class="lu jv hi bd iu lv lw lx jz ly lz ma kd jh mb mc kh jl md me kl jp mf mg kp mh bi translated">4.2 <strong class="ak">准备数值变量。</strong></h2><blockquote class="lm ln lo"><p id="27aa" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">由于此处所有数值变量都不为空，因此仅使用StandardScaler在管道中执行缩放。</p></blockquote><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/f86d133d9f0bddcba1929a175a91bd6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SOuxlUs75por-HtZIe3_ig.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">数值流水线。</strong></figcaption></figure><h2 id="d5f7" class="lu jv hi bd iu lv lw lx jz ly lz ma kd jh mb mc kh jl md me kl jp mf mg kp mh bi translated">4.3准备分类变量。</h2><blockquote class="lm ln lo"><p id="3805" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">作为分类预处理的一部分，构建管道以从首次付款日期开始<strong class="iy hj"> a. </strong>提取<strong class="iy hj">月</strong>。<strong class="iy hj"> b. </strong>估算<strong class="iy hj"> PPM </strong>标志，用Y表示任何不可用的值。<strong class="iy hj"> c. </strong>将<strong class="iy hj"> MSA </strong>分类为1表示任何可用的MSA代码，0表示其他<strong class="iy hj">。d. </strong>用之前创建的字典中的集群替换<strong class="iy hj">邮政编码</strong>。字典中不存在的任何邮政编码被分配给群10。<strong class="iy hj"> e .对所有分类变量执行一次热</strong>编码。</p></blockquote><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/2c570270b0cd18e0d5887871d5e26e07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ppU31-IXNl4IZ5Mxxni3RA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">分类管道。</strong></figcaption></figure><h2 id="66b9" class="lu jv hi bd iu lv lw lx jz ly lz ma kd jh mb mc kh jl md me kl jp mf mg kp mh bi translated">4.4定义完整的管道和预处理数据。</h2><blockquote class="lm ln lo"><p id="6b91" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">定义完整的管道，并对训练数据进行预处理，如下所示。</p></blockquote><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/2124255763d19576d9f75ade8f88ff5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m8YvbNlhFSdXnQv4bJx6kg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">全预处理管道。</strong></figcaption></figure><h1 id="4321" class="ju jv hi bd iu jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">5.尝试不同的模型并选择一个模型。</h1><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/6bc9f4f18bcc20b102f75fe65e741177.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jhQb6dqm8vY5zoZ8mM0lYA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu"> RMSE在训练后对所有训练数据进行评分，并使用来自同一训练集的少量记录进行测试。</strong></figcaption></figure><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/d818cf5ea31d5b833dbe8632b1226a9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gPWuf8XAh9ChML9DOTIT5w.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu"> RMSE评分和STD采用交叉验证。</strong></figcaption></figure><blockquote class="lm ln lo"><p id="3e0d" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">从上面来看，线性回归和树是过度拟合的，而森林稍好一些。因此将尝试使用XGBoost作为最终模型并继续。</p></blockquote><h1 id="af41" class="ju jv hi bd iu jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">6.超参数调整、特征选择和最终流水线。</h1><h2 id="e24a" class="lu jv hi bd iu lv lw lx jz ly lz ma kd jh mb mc kh jl md me kl jp mf mg kp mh bi translated">6.1使用默认参数定义最终模型。</h2><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/1c5c9b29f7773c827d5b9ff89e38a782.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p4QfjkgpJEppcvkTrBKK_Q.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">用一些参数定义最终回归模型。</strong></figcaption></figure><h2 id="53e3" class="lu jv hi bd iu lv lw lx jz ly lz ma kd jh mb mc kh jl md me kl jp mf mg kp mh bi translated"><strong class="ak"> 6.2 </strong>最终模型<strong class="ak">超参数调谐。</strong></h2><blockquote class="lm ln lo"><p id="c7f0" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">执行五次独立的随机搜索以获得最终的超参数值。</p></blockquote><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/ffd6879b573ac8e79547c444faf4553c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4l72dvG7zHPbKffTJCr8YQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu"> XGBoost随机搜索参数。</strong></figcaption></figure><blockquote class="lm ln lo"><p id="6a59" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">以下参数是通过随机搜索最终选定的。</p></blockquote><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/7290c430f1dca5b0c611157f91050137.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SaNnfKEDZqpMaKOfskvzNQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">最终XGBoost参数。</strong></figcaption></figure><h2 id="5e23" class="lu jv hi bd iu lv lw lx jz ly lz ma kd jh mb mc kh jl md me kl jp mf mg kp mh bi translated"><strong class="ak"> 6.3特征重要性使用随机森林。</strong></h2><blockquote class="lm ln lo"><p id="94b8" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">使用随机森林计算特征重要性。一旦计算出特征重要性，它们就与各自的特征名称相关联，如下所示。</p></blockquote><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es my"><img src="../Images/f5fee74b2a0af07073529f4faec1a623.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U3Rle-GZF61tY0aZ0EHejQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">使用随机森林随机搜索最佳特征。</strong></figcaption></figure><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mz"><img src="../Images/dfa896129522a3cb7b6e7489bf45fbbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*unr3AtcCzTDdhZ5NMQvGIw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">特征重要性与特征名称。</strong></figcaption></figure><blockquote class="lm ln lo"><p id="180f" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">Tuned XGBoost将使用计算出的特性重要性从175个原始特性中选择适当数量的特性。</p></blockquote><h2 id="dec2" class="lu jv hi bd iu lv lw lx jz ly lz ma kd jh mb mc kh jl md me kl jp mf mg kp mh bi translated">6.4最终管道和特征选择。</h2><blockquote class="lm ln lo"><p id="0281" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">创建特征选择类以在管道中使用，如下所示。</p></blockquote><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/14c50b0c0310312a026530a618fd5fae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k0H1FigTnMCoZ0KC2xZJTw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">特征选择类。</strong></figcaption></figure><blockquote class="lm ln lo"><p id="5a4f" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">使用以下管道进行特征选择。</p></blockquote><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nb"><img src="../Images/95cc3fb900479c45faaa855eee613cae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*32IA8vYi8lh64TmoC_TCIQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">特征选择管道。</strong></figcaption></figure><blockquote class="lm ln lo"><p id="69a5" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">最终选择前155个特征用于使用调整后的XGBoost模型进行预测。</p></blockquote><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/3478b40f5c922cb072f98190aea73c91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iKkuqYzabg-UJS16lwqGVA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">选择顶级功能。</strong></figcaption></figure><h1 id="162a" class="ju jv hi bd iu jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">7.最终模型训练、评估和保存。</h1><blockquote class="lm ln lo"><p id="e653" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">最终模型用训练数据训练，并用测试数据验证。</p></blockquote><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nd"><img src="../Images/880eb0b9fb96b60dacd6b6fe36720bbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jRTevJBtC3qjzoHK4nyPaQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">用训练数据训练模型。</strong></figcaption></figure><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/2de14bc938eee3582bd58a4b510fc40c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dF5dx-juFPWHdZtYClOmxA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">用测试数据预测。</strong></figcaption></figure><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nb"><img src="../Images/8d752c923e4afa4afad7c4fbd9423029.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a9Lem6GGgqRDtqJ7iTO2mg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">试验和预测数据的残差图。</strong></figcaption></figure><blockquote class="lm ln lo"><p id="2e9e" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">最后，根据所有可用数据(即2015年至2017年的数据)对模型进行训练，并进行筛选以进行推理。</p></blockquote><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ne"><img src="../Images/79cc423807cb3ebeae987ce80da95335.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*915nsGzKm-QyuMiUnEbdbw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">最终模型腌制备用。</strong></figcaption></figure><h1 id="674f" class="ju jv hi bd iu jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">8.解决方案演示:</h1><ol class=""><li id="8642" class="kr ks hi iy b iz kt jd ku jh kv jl kw jp kx jt ky kz la lb bi translated"><em class="lp">决定利率最重要的因素是信用评分，并且是负相关的。</em></li><li id="49cc" class="kr ks hi iy b iz lc jd ld jh le jl lf jp lg jt ky kz la lb bi translated"><em class="lp">单位数量与费率成正比。</em></li><li id="1c61" class="kr ks hi iy b iz lc jd ld jh le jl lf jp lg jt ky kz la lb bi translated"><em class="lp">原贷款期限与利率成正比。</em></li><li id="8589" class="kr ks hi iy b iz lc jd ld jh le jl lf jp lg jt ky kz la lb bi translated"><em class="lp">以下是决定房屋贷款利率的19大特征。它可能是直接相关的，也可能是反向相关的，这可以通过仔细观察LM图来确定。</em></li></ol><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nf"><img src="../Images/1e24dfd62961c178a04767a58796e399.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rb3IfXPM9oz6s6ly1qdrJw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">决定房屋贷款利率的19大特征。</strong></figcaption></figure><p id="c410" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><em class="lp"> OCCUPANCY_STATUS I =投资物业，首付款日期3月，邮政编码7(指办公区域)调用更多费率。</em></p><p id="0e93" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><em class="lp"> 5。下面也是关于聚集邮政编码的顶级场所的细节。</em></p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ng"><img src="../Images/4b63e18dcd0dc71b17dda2ddd9ebaeb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tpmSa2jav71P5Q2gv9Iecw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">邮政编码簇7代表官方区域。</figcaption></figure><p id="41fe" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">除此之外，通过仔细观察图表和数据，可以获得更多的观察结果。</p><h1 id="49a3" class="ju jv hi bd iu jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">9.批量部署和监控:</h1><blockquote class="lm ln lo"><p id="5902" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">一旦保存了模型，就为批量推理做好了准备。作为批量推断的一部分，将下载2018年的数据，并使用最终管道进行推断。</p></blockquote><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/2f0e75c2ab519c6fe379a111e9ed0544.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p2Cwciu4e1RsIdxPEY0V_A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu">已保存的模型被加载用于推理。</strong></figcaption></figure><blockquote class="lm ln lo"><p id="da80" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">残差图绘制如下。结果表明，该模型的预测率范围为+- 0.75。例如，对于5%的实际利率，最小预测利率为4.25%，最大预测利率为5.75%。对于许多应用来说，预测的速率在+-0.25之内，因为图表在轴附近非常密集。</p><p id="c68d" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">由于我们的目的是帮助精算师快速做出决定，这可能有助于节省一些时间。</p></blockquote><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nh"><img src="../Images/814b767f0960ebe75d4bcf2f2e6e48ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MnUzWAXHric3DKgee35L7A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd iu"> RMSE与2018年数据残差图。</strong></figcaption></figure><blockquote class="lm ln lo"><p id="4983" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">在推断过程中，由于出现了三个新的销售者名称和服务者名称，因此出现了错误。2015–2017年的数据中没有这些卖家名称和服务商名称。因此，在最终管道被调用之前，这些在有效数据选择部分被删除。要包含这些新名称，需要执行一键编码，即重新训练最终管道。</p></blockquote><p id="7ddc" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">这标志着使用Scikit Learn介绍ML管道的结束。使用<strong class="iy hj"> PySpark </strong>处理所有可用数据可以探索更多，比<strong class="iy hj"> Scikit Learn更快。风险预测器</strong>也可以使用近<strong class="iy hj">20年的性能数据构建。</strong></p><p id="f9ed" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">请访问<a class="ae iv" href="https://github.com/abhilash499/Scikit-Learn-Regression" rel="noopener ugc nofollow" target="_blank"> <strong class="iy hj"> <em class="lp"> Git链接</em> </strong> </a>获取所有Python脚本。</p><p id="0355" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">这种方法可能不是计算房屋贷款利率的完美方式。此示例仅用于演示Scikit Learn ML构建回归模型的步骤，可以作为构建 <strong class="iy hj"> <em class="lp">真实风险模型</em> </strong> <em class="lp">的起点。</em></p><p id="5260" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">感谢阅读。欢迎提问和建议。</p><p id="3a15" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">问候，</p><p id="bf09" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">阿比。</p></div></div>    
</body>
</html>