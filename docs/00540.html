<html>
<head>
<title>The Classifier — Evaluating a Car’s Acceptability</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分类器——评估汽车的可接受性</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/the-classifier-part-1-2-18f3c70d01fe?source=collection_archive---------2-----------------------#2019-07-25">https://medium.com/analytics-vidhya/the-classifier-part-1-2-18f3c70d01fe?source=collection_archive---------2-----------------------#2019-07-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="97ad" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">第1部分，共2部分:数据探索和预处理</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/78b61053d0d9e33a8dffec3c54cf1d9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a3ouX2YLXUjqL2aBMpPQqw.png"/></div></div></figure><p id="ed55" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">随着我探索和理解数据的追求的继续，我使用了UCI机器学习库中的数据集来分类，在给定一些相关特征的情况下，什么使汽车可以接受。数据科学的一个关键部分是理解数据。即使在机器学习中，我们也需要一个干净和定义良好的数据来训练我们的模型。所以我通常会花大量的时间来分析和/或可视化数据。我把这个项目分成两部分，一部分是数据分析，另一部分是模型选择。好吧，那么，让我们探索数据。</p><p id="9350" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在导入必要的库并将数据集作为数据框加载到项目中之后，让我们来看看数据的形状。形状就是数据框的尺寸，其中第一个值告诉我们行数，第二个值告诉我们数据集中的要素数。</p><pre class="iy iz ja jb fd kf kg kh ki aw kj bi"><span id="281d" class="kk kl hi kg b fi km kn l ko kp">cars = pd.read_csv('car_data.csv')<br/>cars.shape</span><span id="8e0c" class="kk kl hi kg b fi kq kn l ko kp">Output: (1727,7)</span></pre><p id="abb2" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们看到我们的数据有1727行和7个特征。让我们仔细看看我们的数据:</p><pre class="iy iz ja jb fd kf kg kh ki aw kj bi"><span id="3485" class="kk kl hi kg b fi km kn l ko kp">cars.describe()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es kr"><img src="../Images/4e20afe72c51e6a9d7ca61baa0490d8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*5qM7-P_5QA2AIHLGk9gBQg.png"/></div></figure><p id="9c4c" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">计数</strong>告诉我们每个特征中数据值的数量。我们看到每个特性的计数与行数相同，这意味着没有丢失值。这真的很神奇，因为你不必使用统计或其他技术来填充缺失的值，而且这将提供更好的结果，因为我们不需要填充数据缺口。</p><p id="1912" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">唯一值</strong>告诉我们给定特性中唯一值的数量。因为我们有分类数据，所以在该列中显示了不同的值。</p><p id="0166" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">顶部的<strong class="jl hj">告诉我们在特定列中出现最多的值。</strong></p><p id="cea6" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj"> freq </strong>告诉我们<strong class="jl hj"> top </strong>值在该列中出现的次数。</p><p id="d8d4" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">现在让我们来看看汽车可接受性的分布。</p><pre class="iy iz ja jb fd kf kg kh ki aw kj bi"><span id="b7fb" class="kk kl hi kg b fi km kn l ko kp">cars['Evaluation'].value_counts().sort_index()</span><span id="58e0" class="kk kl hi kg b fi kq kn l ko kp">Output :<br/>acc       384<br/>good       69<br/>unacc    1209<br/>vgood      65</span></pre><p id="d7ff" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">没有可视化有什么乐趣:)</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ks"><img src="../Images/53a9cf8aada54aeeab39533ce8ab3e80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WEaS2ZkPyuGzWQe0tRhwgA.png"/></div></div></figure><p id="e1be" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我用<em class="kt">很巧妙的</em>制作了这个圆环图。不到4%的汽车被评为<em class="kt">非常好</em>，70%被评为<em class="kt">不可接受</em>。</p><p id="2026" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">因此，我们需要预测给定6个特征的汽车的可接受性。让我们试着找出每个特征变量与目标变量之间的关系。我将使用pandas crosstab制作一个显示关系的表格，并绘制一个交互式图表。</p><pre class="iy iz ja jb fd kf kg kh ki aw kj bi"><span id="f966" class="kk kl hi kg b fi km kn l ko kp">buy = pd.crosstab(cars['Buying'], cars['Evaluation'])<br/>mc = pd.crosstab(cars['Maint'], cars['Evaluation'])<br/>drs = pd.crosstab(cars['Doors'], cars['Evaluation'])<br/>prsn = pd.crosstab(cars['Persons'], cars['Evaluation'])<br/>lb = pd.crosstab(cars['LugBoot'], cars['Evaluation'])<br/>sfty = pd.crosstab(cars['Safety'], cars['Evaluation'])</span></pre><p id="ba0b" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">这里，我针对我们的目标变量<em class="kt">评估，为6个特征制作了6个数据框表。</em>看起来是这样的:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ku"><img src="../Images/b36c03bcf2d70effe7db4579d12327e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*-jneDWm65kgR9m3rVmvR_A.png"/></div></figure><p id="fcb1" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们总共会得到6个这样的数据框，但出于演示目的，我只使用了购买V/s评估数据框。这显示了车辆的<em class="kt">评估</em>和<em class="kt">成本之间的关系。</em>因此，26辆成本中等的汽车被标记为非常好，324辆成本高的汽车被标记为不可接受，以此类推。</p><p id="e9de" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在可视化之前，我制作了一个变量‘a’来存储特征的每个类别的数量。这将有助于绘制图表。</p><pre class="iy iz ja jb fd kf kg kh ki aw kj bi"><span id="326a" class="kk kl hi kg b fi km kn l ko kp">features = cars.iloc[:,:-1]<br/>features[:5]<br/>a=[]<br/>for i in features:<br/>    a.append(features[i].value_counts())<br/>a</span><span id="57c3" class="kk kl hi kg b fi kq kn l ko kp">Output:<br/>[low      432<br/> high     432<br/> med      432<br/> vhigh    431<br/> Name: Buying, dtype: int64, low      432<br/> high     432<br/> med      432<br/> vhigh    431<br/> Name: Maint, dtype: int64, 4    432<br/> 5    432<br/> 3    432<br/> 2    431<br/> Name: Doors, dtype: int64, 4    576<br/> 5    576<br/> 2    575<br/> Name: Persons, dtype: int64, med      576<br/> big      576<br/> small    575<br/> Name: LugBoot, dtype: int64, high    576<br/> med     576<br/> low     575<br/> Name: Safety, dtype: int64]</span></pre><p id="6f07" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">到目前为止一切顺利，让我们制作图表:</p><pre class="iy iz ja jb fd kf kg kh ki aw kj bi"><span id="228e" class="kk kl hi kg b fi km kn l ko kp">data = [<br/>    go.Bar(<br/>        x=a[0].index, <br/>        y=buy['unacc'],<br/>        name='Unacceptable'<br/>    ),<br/>    go.Bar(<br/>        x=a[0].index,<br/>        y=buy['acc'],<br/>        name='Acceptable'<br/>    ),<br/>    go.Bar(<br/>        x=a[0].index,<br/>        y=buy['good'],<br/>        name='Good'<br/>    ),<br/>    go.Bar(<br/>        x=a[0].index,<br/>        y=buy['vgood'],<br/>        name='Very Good'<br/>    )</span><span id="19af" class="kk kl hi kg b fi kq kn l ko kp">]</span><span id="f80e" class="kk kl hi kg b fi kq kn l ko kp">layout = go.Layout(<br/>    barmode='stack',<br/>    title='Selling Price vs Evaluation'<br/>)</span><span id="2810" class="kk kl hi kg b fi kq kn l ko kp">fig = go.Figure(data=data, layout=layout)<br/>py.iplot(fig, filename='distri')</span></pre><p id="b2d4" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">如果你想知道我是如何使用Plotly进行可视化的，请查看我以前的一篇帖子，在那里我使用Plotly对钦奈水资源短缺进行了交互式数据可视化。不管怎样，我们得到的是:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ks"><img src="../Images/9340a49c8ffcfae35a1fcce0163d718a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rX3ONpY66nc3KvZvLCxPIw.png"/></div></div></figure><p id="0227" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">那么这种表现告诉了我们什么呢？我们可以看到，销售价格和可接受性之间没有线性关系。更确切地说，有些被标为非常好的中高售价。那么这两个变量之间没有线性关系意味着什么呢？这意味着，如果我们改变一个变量，比如说销售价格，那么我们不会看到另一个实体的任何恒定变化，这就是评估。</p><p id="b997" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">如果我们分析剩下的5张图，我们将看到变量之间同样的非线性关系。出于演示的目的，我只使用了一张图，但是您可以在我的GitHub存储库中的代码中查看其余的图。</p><p id="be1d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">现在我们进入数据预处理的最后一步，对分类数据进行编码。这里我们有两个选择，要么使用标签编码，要么使用虚拟变量。</p><p id="904a" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在标签编码中，我们为给定特征中的唯一值分配一个数值。在我们的数据集中，卖价(买价)分为4类，即<em class="kt">【高、高、中、低】。</em>现在，这些是字符串值，需要转换成整数。我们可以用数值代替它们，变成<em class="kt">【3，2，1，0】。</em>但这带来了一个问题，问题是我们的数据是分类的，这些分类数据<strong class="jl hj">显示特征和目标变量</strong>之间没有顺序。那么这意味着什么呢？</p><p id="a1d9" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">这意味着，如果我们增加或减少该特性的值，我们不会看到它们之间的任何有序关系，也就是说，如果值2导致更多的汽车被评估为非常好，这并不意味着值3将意味着更多或更少的汽车被评估为非常好。此外，数据不必是字符串数据类型，也可以是整数；因为如果我们看到乘客V/s评价的曲线图，乘客数量和汽车的可接受性之间并没有特定的顺序。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ks"><img src="../Images/1a317103bde82ecef12dde3759b6525e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jeNbkGwTp5PzBqQZmaUfiQ.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">这里的5代表5名或更多的乘客</figcaption></figure><p id="ba83" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">所以我们能做的是，我们为我们的分类数据集使用虚拟变量。虚拟变量的作用是为每个类别创建一个单独的列，如果该行包含该类别的值，它会将新创建的列数据设置为1。我知道现在有点晦涩，所以我会告诉你我的意思，</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es kz"><img src="../Images/7b7034a3bf6f4c34ac2a38ab8a12ef34.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*ovIIDoAFjYfdcpuzJt56CA.png"/></div></figure><p id="2525" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">所以回到我们的购买变量(销售价格)。如果你还记得，我们有4个购买类别，<em class="kt">【高，高，中，低】。</em>因此，我们为类别创建了新列，并删除了原来的列。你可以看到我们有3列而不是4列，这是因为如果Buying_low、Buying_med和Buting_vhigh都是0，这意味着汽车的售价肯定很高。因此，我们不需要为该类别增加一个额外的列。类似地，对于<em class="kt"> n </em>个类别，我们将有<em class="kt"> n-1 </em>列。</p><p id="4450" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">至此，我们已经完成了数据准备工作，接下来是预测给定这6个特征的汽车的可接受性。由于这篇博文越来越长，我将把这部分留给我博文的第二部分。所以请继续关注即将发布的博客文章。</p></div></div>    
</body>
</html>