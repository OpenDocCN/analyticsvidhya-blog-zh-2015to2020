<html>
<head>
<title>Deep Dive into Containers— Docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深入了解集装箱——码头工人</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/deep-dive-into-containers-docker-b6c9fd9e4e6d?source=collection_archive---------1-----------------------#2018-11-15">https://medium.com/analytics-vidhya/deep-dive-into-containers-docker-b6c9fd9e4e6d?source=collection_archive---------1-----------------------#2018-11-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8f55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jd translated">你是否听过很多关于Docker的事情，却不知道它是什么？还是一知半解？如果是的话，那么这篇文章可能会帮助你回答你头脑中所有关于docker的开放性问题。不要担心，即使您从未听说过Docker这个词，这篇文章也是为您准备的，因为它从最基本的开始，深入到它是如何工作的，一些最佳实践，也涵盖了动机。</p><p id="ae29" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在跳到<strong class="ih hj"> <em class="jm"> docker </em> </strong>之前，先回答这些快速问题:</p><ol class=""><li id="74c8" class="jn jo hi ih b ii ij im in iq jp iu jq iy jr jc js jt ju jv bi translated">您是否遇到过这样的情况:您的代码可以在您的机器上完美运行，但在其他人的机器上却无法运行😠？</li><li id="7279" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc js jt ju jv bi translated">你面临过开发缓慢的问题吗😫，测试和部署？</li><li id="ff26" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc js jt ju jv bi translated">您是否制作了生产代码的副本以在本地运行(但仍然无法重现某些问题)😏？</li><li id="dd8f" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc js jt ju jv bi translated">嗯，所有这些问题都可以用容器来解决👌</li></ol><blockquote class="kb kc kd"><p id="3605" class="if ig jm ih b ii ij ik il im in io ip ke ir is it kf iv iw ix kg iz ja jb jc hb bi translated">等等…什么是<strong class="ih hj">容器</strong>？</p></blockquote><p id="a25b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好的——让我们从应用程序开发的开始说起。</p><p id="9b0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">仔细看下面的图片。你怎么想呢?你看到了什么问题？把它写在一张纸上。让我们看看我们是否有相同的观点。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es kh"><img src="../Images/4096c56c02e61dc3f0d6fc8f62b86681.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*0Y2OnQ_fDJHGAOdOOlA_hw.png"/></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">每台机器一个应用程序</figcaption></figure><p id="e7b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">巨大努力👏 👏，现在让我们看看我认为它有什么问题。</p><ol class=""><li id="89a7" class="jn jo hi ih b ii ij im in iq jp iu jq iy jr jc js jt ju jv bi translated">一个应用程序在一台机器上运行😳，有自己的环境。</li><li id="11e0" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc js jt ju jv bi translated">机器上只有一个主机操作系统，您不能安装另一个主机操作系统来部署其他应用程序。</li><li id="77d1" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc js jt ju jv bi translated">现在，如果您的应用程序的资源使用率非常低，该怎么办呢？你只会浪费机器资源，这是非常不经济的。</li><li id="3650" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc js jt ju jv bi translated">那么解决方案是什么呢？看到下图，现在你怎么看？</li></ol><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es kt"><img src="../Images/48dc872e05d6523dcb871dc23c74dc1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k3Tq2Yu9Y-wLzuuhAXf1dw.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">虚拟机(虚拟机管理程序)</figcaption></figure><p id="3f82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好吧，那么这个显然更好。</p><p id="d8ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们有一个称为虚拟机管理程序的额外层，它为我们提供了在一台机器上部署多个操作系统的功能。这些就像单个物理机上的虚拟机。虚拟机是复制真实计算机行为的系统。</p><p id="000f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以现在你可以在一台物理机器上运行多个应用程序😍 在多个虚拟盒子里面托管不同的操作系统。与第一种方法相比，这是一个巨大的胜利。</p><blockquote class="kb kc kd"><p id="798f" class="if ig jm ih b ii ij ik il im in io ip ke ir is it kf iv iw ix kg iz ja jb jc hb bi translated">但是，我们可以做得更好。这仍然有很多冗余、开销，虚拟机很重，并且占用大量系统资源。</p></blockquote><p id="9d9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">行..现在看看下面的图表，看看你的应用程序看起来有多开心🚀，这是因为他们是。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es ky"><img src="../Images/f765d2b8d7727c9405e40a17e4236b4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sDzXDcucdIfT1T_KEGHznw.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">集装箱发动机👌</figcaption></figure><p id="b7e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好吧，让我们试着理解这意味着什么。因此，有一个新的层取代了虚拟机管理程序，被称为容器引擎。这个引擎提供了丰富的功能。它为您的应用程序提供了运行所需的库和环境，而没有不必要的客户操作系统开销。</p><p id="00b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，你可以把你的应用程序封装在一个容器里，里面有你的应用程序顺利运行所需的一切🏃。</p><blockquote class="kb kc kd"><p id="ecea" class="if ig jm ih b ii ij ik il im in io ip ke ir is it kf iv iw ix kg iz ja jb jc hb bi translated">嗯，有意思。但是这里的<strong class="ih hj"><em class="hi">docker</em>T3在哪里呢？</strong></p></blockquote><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es kz"><img src="../Images/f393b4cfb85c7334e0ca3c35384d8f44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*h0cwksZrltTJpVlx"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">照片由<a class="ae la" href="https://unsplash.com/@toshidog?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Toshi </a>在<a class="ae la" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="be1c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Docker是一个给你<strong class="ih hj"> <em class="jm">容器化</em> </strong>(操作系统级虚拟化)能力的软件。</p><p id="58e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这意味着(<strong class="ih hj">利益</strong>)—</p><ul class=""><li id="e244" class="jn jo hi ih b ii ij im in iq jp iu jq iy jr jc lb jt ju jv bi translated">使用容器构建和部署应用程序更快。</li><li id="0850" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc lb jt ju jv bi translated">您的应用程序将被打包到一个容器中，其中包含您的应用程序操作库、运行时环境、系统工具和其他依赖项所需的一切。</li><li id="e6b1" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc lb jt ju jv bi translated">最重要的是，你的软件可以在任何支持docker的平台上运行。</li><li id="fdef" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc lb jt ju jv bi translated">现在你不会有这样的问题…但它在我的机器上工作😞 😥</li></ul><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lc"><img src="../Images/badcb2e6de8d5919f60fa1abee20bde0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6dnzFnKh56w9pY7a"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated"><a class="ae la" href="https://unsplash.com/@raduflorin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Radu Florin </a>在<a class="ae la" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="73cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们开始吧，✈️ ✈️</p><blockquote class="kb kc kd"><p id="914d" class="if ig jm ih b ii ij ik il im in io ip ke ir is it kf iv iw ix kg iz ja jb jc hb bi translated"><strong class="ih hj">安装docker </strong> —官网上都有</p></blockquote><div class="ld le ez fb lf lg"><a href="https://docs.docker.com/install/" rel="noopener  ugc nofollow" target="_blank"><div class="lh ab dw"><div class="li ab lj cl cj lk"><h2 class="bd hj fi z dy ll ea eb lm ed ef hh bi translated">关于Docker CE</h2><div class="ln l"><h3 class="bd b fi z dy ll ea eb lm ed ef dx translated">Docker Community Edition (CE)非常适合希望开始使用Docker和……</h3></div><div class="lo l"><p class="bd b fp z dy ll ea eb lm ed ef dx translated">docs.docker.com</p></div></div><div class="lp l"><div class="lq l lr ls lt lp lu kn lg"/></div></div></a></div><blockquote class="kb kc kd"><p id="e13b" class="if ig jm ih b ii ij ik il im in io ip ke ir is it kf iv iw ix kg iz ja jb jc hb bi translated"><strong class="ih hj">一些重要的概念:</strong></p></blockquote><ul class=""><li id="9a9b" class="jn jo hi ih b ii ij im in iq jp iu jq iy jr jc lb jt ju jv bi translated"><strong class="ih hj">映像</strong> —映像是一个可执行文件，它包含了应用程序正常运行所需的一切，包括代码、运行时库和其他依赖项。它是只读的，可以使用容器激活。</li><li id="0f6c" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc lb jt ju jv bi translated"><strong class="ih hj">容器</strong> —这是一个图像的运行实例。它有一个可以改变的状态。</li></ul><p id="609f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jm">类比</em> </strong> <em class="jm"> —图像就像一个java类，容器就像它的对象🐣</em></p><ul class=""><li id="6403" class="jn jo hi ih b ii ij im in iq jp iu jq iy jr jc lb jt ju jv bi translated"><strong class="ih hj"> Docker Registry </strong> —一个存储所有Docker库的中心位置，以后可以下载。官方的、公开的docker图片在这里发布<a class="ae la" href="https://hub.docker.com/" rel="noopener ugc nofollow" target="_blank">https://hub.docker.com</a></li><li id="14c2" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc lb jt ju jv bi translated"><strong class="ih hj"> docker守护进程</strong> —一个(永久)运行在您的主机操作系统上的程序，它执行Docker命令，这些命令是使用Docker客户端及其REST Apis触发的。</li><li id="f927" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc lb jt ju jv bi translated"><strong class="ih hj"> Docker客户端</strong> —用于与守护程序通信以执行命令的CLI。</li></ul><p id="604e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好吧，还是没意思？让我们把手弄脏吧。</p><blockquote class="kb kc kd"><p id="56c6" class="if ig jm ih b ii ij ik il im in io ip ke ir is it kf iv iw ix kg iz ja jb jc hb bi translated"><strong class="ih hj"> Docker命令</strong> —这些是用于管理我们的图像和容器的指令。Docker有丰富的命令集。让我们来看看几个重要的命令。</p></blockquote><blockquote class="lv"><p id="b8f8" class="lw lx hi bd ly lz ma mb mc md me jc dx translated">docker图像</p></blockquote><p id="8099" class="pw-post-body-paragraph if ig hi ih b ii mf ik il im mg io ip iq mh is it iu mi iw ix iy mj ja jb jc hb bi translated">这列出了我们系统上的所有图像。它提供了详细信息，如存储库、标签、图像Id、创建日期。</p><p id="423e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">储存库 -这是一个你可以储存你的docker图片的地方。例如，如果你去docker hub，你可以看到官方的mysql、redis、nginx等等。这些宿主图像的许多版本(标签)。</p><p id="c113" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">图片Id </strong> -图片的唯一Id。看起来像是5cde56dc5a15</p><p id="43c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在你的机器上还没有任何图像。让我们用下一个命令下载一些图像。</p><blockquote class="lv"><p id="d92a" class="lw lx hi bd ly lz mk ml mm mn mo jc dx translated">docker pull {imagename:tag}</p></blockquote><figure class="mq mr ms mt mu km er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mp"><img src="../Images/9c3261a6edc56391e84ca623d6851675.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0_7a8wiTGi5dP4csUYPZkw.png"/></div></div></figure><p id="9914" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的命令'<strong class="ih hj"> <em class="jm"> nginx </em> </strong>'是一个repo/image名称，我没有提供任何标签，所以默认为<strong class="ih hj"> <em class="jm">最新的</em> </strong>标签。但是，建议提供一个标签。</p><p id="31a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果您再次运行docker images命令，您可以看到下载的图像。</p><p id="7b3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一步是什么？令人兴奋的东西。用图像运行你的容器。</p><blockquote class="lv"><p id="06a2" class="lw lx hi bd ly lz mk ml mm mn mo jc dx translated">docker run { image:tag } {在容器中运行的命令}</p></blockquote><p id="7ae9" class="pw-post-body-paragraph if ig hi ih b ii mf ik il im mg io ip iq mh is it iu mi iw ix iy mj ja jb jc hb bi translated">例如<strong class="ih hj"><em class="jm">docker run my image:1 . 15 . 6</em></strong><strong class="ih hj"><em class="jm">echo【hello world】</em></strong></p><p id="198c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将从前景中带有标签“1.15.6”的图像“myimage”启动一个容器(附加模式)。如果您想在分离模式下运行您的容器，该怎么办？好吧，-d选项来拯救。</p><p id="34c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="jm">docker run-d { my image:tag }睡眠1000 </em> </strong></p><p id="eb8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">sleep 1000将在您的容器中运行。</p><p id="d09d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要以交互模式运行容器，可以在docker run中使用-i选项。</p><p id="fccd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好的……所以我们的容器现在正在运行。真的..没有吗？好，您可以使用我们的下一个命令来检查自己。</p><blockquote class="lv"><p id="021c" class="lw lx hi bd ly lz mk ml mm mn mo jc dx translated">docker ps {-a}</p></blockquote><p id="39c3" class="pw-post-body-paragraph if ig hi ih b ii mf ik il im mg io ip iq mh is it iu mi iw ix iy mj ja jb jc hb bi translated">显示所有正在运行的容器。创建的每个容器都有一个唯一的id。您可以使用<strong class="ih hj"> <em class="jm"> — name </em> </strong>选项和您的<strong class="ih hj"> <em class="jm"> docker run </em> </strong>命令为您的容器提供名称。</p><p id="fd85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在你的容器正在运行，你的应用程序也在你的容器中运行。你如何访问它？</p><p id="cf79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设您有一个监听端口<strong class="ih hj"> 8080 </strong>的服务。然后您应该能够点击<strong class="ih hj"> localhost:8080 </strong>并看到您的响应。对吗？</p><p id="4521" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不，这是有原因的。您的应用程序运行在一个容器内，如果<strong class="ih hj"> <em class="jm">不暴露您的端口</em> </strong>，则无法在容器外访问该应用程序。</p><blockquote class="kb kc kd"><p id="4d49" class="if ig jm ih b ii ij ik il im in io ip ke ir is it kf iv iw ix kg iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">你容器里面的8080和你主机上的8080不一样。它需要被映射。</em> </strong></p></blockquote><p id="4625" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">怎么会？<strong class="ih hj"> <em class="jm"> -p选项。</em>T47】</strong></p><blockquote class="lv"><p id="eba2" class="lw lx hi bd ly lz mk ml mm mn mo jc dx translated">docker run-p {集装箱港口:主机港口}</p></blockquote><p id="72f7" class="pw-post-body-paragraph if ig hi ih b ii mf ik il im mg io ip iq mh is it iu mi iw ix iy mj ja jb jc hb bi translated">它用于将容器中的端口暴露给主机端口。</p><p id="fe8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果您尝试localhost:8080，您可以看到您的服务响应。</p><blockquote class="kb kc kd"><p id="581e" class="if ig jm ih b ii ij ik il im in io ip ke ir is it kf iv iw ix kg iz ja jb jc hb bi translated">注意，如果本地主机不起作用，你应该试试docker机器的ip。这取决于你的平台。</p></blockquote><p id="0fed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在你的容器正在运行，让我们也来谈谈图像和容器是如何工作的，以及它们是如何构造的。</p><blockquote class="kb kc kd"><p id="05b1" class="if ig jm ih b ii ij ik il im in io ip ke ir is it kf iv iw ix kg iz ja jb jc hb bi translated">Docker图像由<strong class="ih hj">层</strong>组成。要了解哪些图层组成了您的图像，请使用docker history命令。</p></blockquote><blockquote class="lv"><p id="b6ec" class="lw lx hi bd ly lz ma mb mc md me jc dx translated"><strong class="ak"> <em class="mv">码头工人历史{imagename:tag} </em> </strong></p></blockquote><p id="4cbb" class="pw-post-body-paragraph if ig hi ih b ii mf ik il im mg io ip iq mh is it iu mi iw ix iy mj ja jb jc hb bi translated">这将显示您的图像中的所有层。每一层标识一个不同的状态，该状态作为图像的一部分被捕获。</p><p id="0e9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">层到底是什么意思？好的，等一下，你知道如何建立自己的形象吗？到目前为止，我们只使用了来自docker hub的图片，这是由其他人创建的。但是现在是时候了，我们应该创造自己的形象。🖼</p><p id="ba86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jd translated">这是一个文本文件，包含了一些构建图像的指令。每条指令负责在现有层的顶部添加一层。</p><p id="74ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">示例:</p><pre class="ki kj kk kl fd mw mx my mz aw na bi"><span id="29ab" class="nb nc hi mx b fi nd ne l nf ng">FROM ubuntu:15.04  <strong class="mx hj">#layer1</strong><br/>COPY . /app        <strong class="mx hj">#layer2</strong><br/>RUN make /app      <strong class="mx hj">#layer3</strong><br/>CMD python /app/app.py <strong class="mx hj">#layer4</strong></span></pre><p id="cb79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的docker文件包含一些使用标准关键字的指令，如FROM、COPY、RUN、CMD等。</p><p id="9a93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">FROM指令构成了docker映像的基础层，可以使用docker文件构建该映像。</p><p id="4c4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在顶部，每条指令构建一个新的层。因此，当构建整个<strong class="ih hj"> <em class="jm"> Dockerfile </em> </strong>时，会在结果图像中产生多个层。</p><p id="d89c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好了，<strong class="ih hj"> <em class="jm">所以现在我们知道我们说docker图像有分层结构是什么意思了。</em> </strong>👊</p><p id="6048" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们使用docker build命令来构建我们的映像</p><blockquote class="lv"><p id="4775" class="lw lx hi bd ly lz mk ml mm mn mo jc dx translated"><strong class="ak"> docker构建{ imagename } { directory _ with _ docker file }</strong></p></blockquote><p id="1e07" class="pw-post-body-paragraph if ig hi ih b ii mf ik il im mg io ip iq mh is it iu mi iw ix iy mj ja jb jc hb bi translated">一旦你运行它，观察输出，就会清楚docker是如何构建图像的。</p><p id="3b2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">太神奇了！👏 👏让我们看看另一种创建图像的方法。</p><p id="e5a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一种方法是什么？<strong class="ih hj"> <em class="jm">使用容器</em> </strong>🎊</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es nh"><img src="../Images/526535b92b92eff2eb03463a1153f801.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bz-0PrjvxeH13014zFgfAw.png"/></div></div></figure><p id="6e68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是的，没错。它就像在Java中当你有一个<strong class="ih hj"> <em class="jm">对象(容器)</em> </strong>，你如何保存对象的状态？连载一下。类似地，如果你有一个正在运行的容器，你可以用图像的形式保存它的状态。</p><blockquote class="lv"><p id="7360" class="lw lx hi bd ly lz mk ml mm mn mo jc dx translated">docker提交{container_id} {imagename:tag}</p></blockquote><p id="c6aa" class="pw-post-body-paragraph if ig hi ih b ii mf ik il im mg io ip iq mh is it iu mi iw ix iy mj ja jb jc hb bi translated">一旦你这样做了，你会看到无论容器有什么状态，它都在映像中，如果你使用这个新映像创建一个容器，新容器将以新的状态启动。</p><p id="4fb1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我所说的<strong class="ih hj"> <em class="jm">状态</em> </strong>是什么意思？对文件系统、安装等进行的任何更改👍</p><blockquote class="kb kc kd"><p id="5bde" class="if ig jm ih b ii ij ik il im in io ip ke ir is it kf iv iw ix kg iz ja jb jc hb bi translated">现在是时候快速浏览一些重要的docker文件指令了:</p></blockquote><ul class=""><li id="066f" class="jn jo hi ih b ii ij im in iq jp iu jq iy jr jc lb jt ju jv bi translated"><strong class="ih hj">来自</strong>从给定的基础图像创建图像</li><li id="2c45" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc lb jt ju jv bi translated"><strong class="ih hj"> ENV </strong>更新容器中的环境变量。</li><li id="41f2" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc lb jt ju jv bi translated"><strong class="ih hj">复制</strong>将一个文件从构建上下文复制到容器中。</li><li id="109e" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc lb jt ju jv bi translated"><strong class="ih hj">添加</strong>类似于复制，但具有从互联网下载一些文件的附加功能</li><li id="578f" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc lb jt ju jv bi translated"><strong class="ih hj">运行</strong>运行一些安装，如apt-get更新、apt-get安装等。建议用&amp; &amp;链接运行指令，以避免创建不必要的图像层。</li><li id="362b" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc lb jt ju jv bi translated"><strong class="ih hj"> CMD </strong>运行镜像所包含的软件，并输入参数。</li><li id="0ff2" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc lb jt ju jv bi translated"><strong class="ih hj"> ENTRYPOINT </strong>主要用于为你的应用程序设置ENTRYPOINT，它是你的图像的主要命令。</li></ul><p id="d3e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么，你还在等什么？使用我们讨论过的各种命令开始探索docker，并向您的工具箱中添加更多命令，以最大限度地利用docker。🐳 🐳</p><p id="7472" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望，这篇文章能够提供一个关于docker是什么以及为什么它几乎在任何地方都被使用的好主意。🕺</p><p id="45e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">欢呼</strong>，🍻 🍻</p><p id="7992" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Kaivalya Apte </strong></p></div></div>    
</body>
</html>