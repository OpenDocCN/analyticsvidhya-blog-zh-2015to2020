<html>
<head>
<title>Exploratory Visualization for Data with Categorical Variables</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">具有分类变量的数据的探索性可视化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/exploratory-data-visualization-with-categorical-features-c3c372987421?source=collection_archive---------15-----------------------#2020-07-13">https://medium.com/analytics-vidhya/exploratory-data-visualization-with-categorical-features-c3c372987421?source=collection_archive---------15-----------------------#2020-07-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2363" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">探索性数据可视化允许我们在开始任何建模之前对数据有一个概念。通常散点图是用数字特征可视化数据的好选择，它允许我们看到数据中的关系/模式。</p><p id="b611" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当数据集包含分类变量(例如，国家、性别、种族)时，挑战就开始了。我们如何可视化这样的数据集来理解模式？</p><p id="e293" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">答案在于嵌入，它是文本数据的向量表示。我们可以使用<code class="du je jf jg jh b">keras</code>或<code class="du je jf jg jh b">gensim</code> <a class="ae jd" href="https://radimrehurek.com/gensim/models/word2vec.html" rel="noopener ugc nofollow" target="_blank"> Word2Vec </a>模块中的<a class="ae jd" href="https://keras.io/api/layers/core_layers/embedding/#embedding-class" rel="noopener ugc nofollow" target="_blank">嵌入层</a>来获得嵌入。在这篇文章中，我在Jupyter notebook中使用Altair库可视化了一组多维分类数据。</p><p id="17d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集可以从<a class="ae jd" href="https://archive.ics.uci.edu/ml/datasets/Census+Income" rel="noopener ugc nofollow" target="_blank"> UCI机器学习库</a>下载。它是由Ron Kohavi和Barry Becker捐赠的，发表在文章<em class="ji">“提高朴素贝叶斯分类器的准确性:决策树的混合体”</em>中。下面提供的数据是一个清除了<code class="du je jf jg jh b">'fnlwgt'</code>特征和缺失或格式错误的记录的干净版本。下面是数据集的前几行。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es jj"><img src="../Images/45090762875510cffba95903fdcb2b3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SqfE5SlF0QhpKVtaEt22TQ.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">图1:数据集的顶行</figcaption></figure><p id="2764" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集中有8个分类特征— <strong class="ih hj">工作阶级、教育水平、婚姻状况、职业、关系、种族、性别、祖国</strong>。为了创建Word2Vec的训练数据，我创建了一个新列，它包含记录的所有分类值的数组。例如，上面第0行的新列将保存<code class="du je jf jg jh b">[‘State-gov’, ‘Bachelors’, ‘Never-married’, ‘Adm-clerical’, ‘Not-in-family’, ‘White’, ‘Male’, ‘United-States’]</code>。然后，我创建了一个32维分类嵌入，将新创建的列的值作为训练数据传递给Word2Vec模型。我将数字特征添加到嵌入中，然后使用t-SNE降低维数。所有代码和指令都可以在我的<a class="ae jd" href="https://github.com/shahzeb-akhtar/Categorical_Embedding" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中访问。</p><p id="b8b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在执行了上面提到的步骤之后，我能够在散点图中可视化带有8个分类变量的数据集。将鼠标悬停在数据点上，不同要素的值会显示为工具提示。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es jz"><img src="../Images/c4e11f202c3ad39e1d2388d0bf63e819.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c-a26Ijt6vtGrAxCsWakjA.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">图2:数据集的散点图。参见<a class="ae jd" href="https://shahzeb-akhtar.github.io/Categorical_Embedding/interactive_charts/scatter_chart.html" rel="noopener ugc nofollow" target="_blank">互动版</a></figcaption></figure><p id="f5f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，我可视化了散点图以及分类变量的条形图。通过单击条形，散点图中的数据会更新，以帮助理解变量之间的关系。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es ka"><img src="../Images/f2b7c8f83b00f78d379c1df51441dfb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wbAcpP-bCTwj2FRo8apkBA.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">图3:散点图中突出显示性别为“女性”的数据点。参见<a class="ae jd" href="https://shahzeb-akhtar.github.io/Categorical_Embedding/interactive_charts/gender_marital_race_chart.html" rel="noopener ugc nofollow" target="_blank">互动版</a></figcaption></figure><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es ka"><img src="../Images/361a76f94d927abf2de8817906709e90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P23lYTB71EQmFWMzhmVuxA.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">图4:散点图中突出显示的婚姻状态为“已婚-未婚-配偶”的数据点。参见<a class="ae jd" href="https://shahzeb-akhtar.github.io/Categorical_Embedding/interactive_charts/gender_marital_race_chart.html" rel="noopener ugc nofollow" target="_blank">互动版</a></figcaption></figure><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es kb"><img src="../Images/7c32d672bd4f6ed41e2f918ad1621370.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*skJbqFmaJALm9z7SEA2REw.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">图5:散点图中突出显示了教育水平“学士”、“硕士”或“博士”的数据点。参见<a class="ae jd" href="https://shahzeb-akhtar.github.io/Categorical_Embedding/interactive_charts/workclass_education_occupation_chart.html" rel="noopener ugc nofollow" target="_blank">互动版</a></figcaption></figure><p id="bc87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我创建了一个<a class="ae jd" href="https://shahzeb-akhtar.github.io/Categorical_Embedding/interactive_charts/dashboard.html" rel="noopener ugc nofollow" target="_blank">仪表盘</a>来过滤散点图中所有变量的数据点，并创建了另一个仪表盘<a class="ae jd" href="https://shahzeb-akhtar.github.io/Categorical_Embedding/interactive_charts/alternate_dashboard.html" rel="noopener ugc nofollow" target="_blank">用户可以在散点图中选择数据点，所有变量的条形图会根据选择进行更新。</a></p></div><div class="ab cl kc kd gp ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hb hc hd he hf"><p id="b64d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">受到可视化结果的鼓舞，我决定使用分类嵌入而不是一次性编码作为特征，使用随机森林分类器预测收入范围(高于/低于50k ),以便比较两者之间的性能。</p><p id="51c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我的期望是，随着分类嵌入的使用，性能将会提高。然而，我使用分类嵌入实现了0.7290的f值和0.8605的准确度，并且我使用one-hot编码实现了几乎相似的性能，f值为0.7337，准确度为0.8608。此外，当使用分类嵌入而不是一次性编码时，训练和预测所用的时间更长(5.1834秒对3.9037秒)。</p><p id="dc2d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据上面的观察，我推断由于这个数据集的基数(分类特征的唯一值的数量)不是很高(97个唯一值)，使用一次性编码或分类嵌入对性能没有太大影响。然而，在一个基数较高的数据集上比较两者的性能会很有趣，我将在以后的文章中讨论这一点。</p></div></div>    
</body>
</html>