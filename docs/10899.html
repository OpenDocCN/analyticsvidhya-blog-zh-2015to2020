<html>
<head>
<title>Digit Recognizer aka “Hello World” of Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习的数字识别器，又名“Hello World”</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/digit-recognizer-aka-hello-world-of-machine-learning-d59a4d11d35f?source=collection_archive---------13-----------------------#2020-11-07">https://medium.com/analytics-vidhya/digit-recognizer-aka-hello-world-of-machine-learning-d59a4d11d35f?source=collection_archive---------13-----------------------#2020-11-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8534" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数字识别是一个崭露头角的机器学习工程师应该尝试的基本和首要问题之一。这是一个简单的问题，挑战在于识别手写数字。</p><p id="4a87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据Kaggle，这里是详细的描述…</p><blockquote class="jd je jf"><p id="0a9d" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">MNIST(“改进的国家标准和技术研究所”)是计算机视觉事实上的“hello world”数据集。自1999年发布以来，这个经典的手写图像数据集一直是基准分类算法的基础。随着新的机器学习技术的出现，MNIST仍然是研究人员和学习者的可靠资源。</p><p id="cb0f" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">在这场比赛中，你的目标是从成千上万的手写图像数据集中正确识别数字。我们策划了一套教程风格的内核，涵盖了从回归到神经网络的所有内容。我们鼓励您尝试不同的算法，以直接了解哪些算法运行良好以及技术之间的比较。</p><p id="139f" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><a class="ae jk" href="https://www.kaggle.com/c/digit-recognizer/overview" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/c/digit-recognizer/overview</a></p></blockquote><p id="2727" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第一步:导入库</strong></p><blockquote class="jd je jf"><p id="f1f4" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">导入熊猫作为pd <br/>导入numpy作为np <br/>导入matplotlib.pyplot作为plt <br/>导入seaborn作为sns</p></blockquote><p id="4794" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第二步:将数据文件加载到Pandas DataFrame </strong></p><blockquote class="jd je jf"><p id="dcb6" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">train _ data = PD . read _ CSV(r '/ka ggle/input/digit-recognizer/train . CSV ')<br/>test _ data = PD . read _ CSV(r '/ka ggle/input/digit-recognizer/test . CSV ')</p></blockquote><p id="bf21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第三步:预览数据文件</strong></p><blockquote class="jd je jf"><p id="d6be" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">print(' Train Data sample ')<br/>print(Train _ Data . head())<br/>print(' Train Data file { } '的形状)。format(train_data.shape)) <br/>打印('列车数据文件的形状{} '。测试_数据.形状))</p></blockquote><p id="b403" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤4:让我们将熊猫数据帧数据转换成一个Numpy数组</strong></p><blockquote class="jd je jf"><p id="3203" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">train_data = np.array(train_data，dtype = ' float 32 ')<br/>test _ data = NP . array(test _ data，dtype='float32') <br/> print('列车数据的形状{})。format(train_data.shape)) <br/>打印('列车数据的形状{} '。测试_数据.形状))</p></blockquote><p id="a8b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第五步:让我们从数据集中想象一个随机样本</strong></p><blockquote class="jd je jf"><p id="5517" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">导入random <br/> i = random.randint(1，42000)<br/>PLT . im show(train _ data[I，1:】。reshape(28，28)) <br/>标签= train_data[i，0] <br/>标签</p></blockquote><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es jl"><img src="../Images/74ea2a00e50573c06a5b0df9f35cb4a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*l3WaXiYSr-1HwigHmu2DHg.png"/></div></figure><p id="8dd1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第六步:从数据中可视化更多的样本</strong></p><blockquote class="jd je jf"><p id="ebf0" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">w _ grid = 15<br/>l_grid = 15<br/>fig，axes = plt.subplots(w_grid，l _ grid，figsize=(16，16))<br/>axes = axes . ravel()<br/>n _ training = len(train _ data)<br/>for I in NP . arange(0，w _ grid * l _ grid):<br/>index = NP . random . randint(0，n_training) <br/> axes[i]。imshow(train_data[index，1:]。整形(28，28)) <br/>坐标轴[i]。set_title(train_data[index，0]，fontsize=8) <br/>轴[i]。axis(' off ')<br/>PLT . subplots _ adjust(hspace = 0.4)</p></blockquote><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es jt"><img src="../Images/18f30ccebe94a50838431178ab48360c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ysJlv0736llOMX-PttO_hA.png"/></div></div></figure><p id="24c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第七步:将数据拆分成训练并验证数据</strong></p><blockquote class="jd je jf"><p id="f52f" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">x_train = train_data[:，1:] <br/> x_train = x_train/255。#归一化数据<br/> y_train = train_data[:，0]</p><p id="5c44" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">从sklearn.model_selection导入train_test_split <br/> x_train，x_validate，y_train，y _ validate = train _ test _ split(x _ train，y_train，test_size=0.2，random_state=5)</p><p id="2538" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">#检查列车的形状并验证数据</p><p id="1d58" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">打印(' x列数据的形状是{} '。format(x_train.shape)) <br/>打印(' y列车数据的形状为{} '。格式(y_train.shape)) <br/>打印(' x验证数据的形状是{} '。format(x_validate.shape)) <br/>打印(' y验证数据的形状是{} '。格式(y_validate.shape))</p><p id="3387" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">#大部分python模型只能处理一维数组的数据，所以我们将数据转换成一维数组<br/>x _ train = x _ train . shape(x _ train . shape[0]，*(28，28，1))<br/>x _ validate = x _ validate . shape(x _ validate . shape[0]，*(28，28，1))</p></blockquote><p id="f62a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第八步:导入模型包并训练</strong></p><blockquote class="jd je jf"><p id="f406" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">#从keras导入包<br/>从keras.models导入顺序<br/>从keras.layers导入Conv2D、MaxPooling2D、Dense、Flatten、Dropout <br/>从keras.optimizers导入Adam <br/>从keras.callbacks导入TensorBoard</p><p id="885d" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">#定义并拟合模型<br/> cnn_model = Sequential()</p><p id="3209" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">cnn_model.add(Conv2D(32，3，3，input_shape=(28，28，1)，activation = ' relu ')<br/>CNN _ model . add(MaxPooling2D(pool _ size =(2，2)))<br/>CNN _ model . add(Flatten())<br/>CNN _ model . add(Dense(32，activation = ' relu ')<br/>CNN _ model . add(Dense(10，activation='sigmoid '))</p><p id="f344" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">CNN _ model . compile(loss = ' sparse _ category _ cross entropy '，optimizer=Adam(lr=0.001)，metrics =[' accuracy '])<br/>epochs = 80<br/>CNN _ model . fit(x _ train，y_train，batch_size = 512，epochs = epochs，verbose = 1，validation_data = (x_validate，y_validate))</p><p id="2055" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">#查看型号<br/> cnn_model.summary()</p></blockquote><p id="a89c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤9:标准化和整形测试数据</strong></p><blockquote class="jd je jf"><p id="cdd9" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">x_test =测试数据/255。<br/>x _ test = x _ test . shape(x _ test . shape[0]，*(28，28，1))</p></blockquote><p id="686d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第十步:做一个预测并验证它</strong></p><blockquote class="jd je jf"><p id="b60e" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">import random<br/>I = random . randint(1，28000)<br/>PLT . im show(test _ data[I，]。reshape(28，28)) <br/>预测= CNN _ model . predict _ classes(x _ test)<br/>预测[i]</p></blockquote><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es jy"><img src="../Images/75dc98e69e2494a2b060f2787223dd07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hE3ifTDANTR-Mz5VbfQS5w.png"/></div></div></figure></div></div>    
</body>
</html>