<html>
<head>
<title>How to use PyCaret 2.0 to Predict House Prices</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用PyCaret 2.0预测房价</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-use-pycaret-2-0-to-predict-house-prices-bfc9ce6121b6?source=collection_archive---------16-----------------------#2020-08-03">https://medium.com/analytics-vidhya/how-to-use-pycaret-2-0-to-predict-house-prices-bfc9ce6121b6?source=collection_archive---------16-----------------------#2020-08-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="fec5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将设置并使用PyCaret 2.0，使用来自<a class="ae jd" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/overview" rel="noopener ugc nofollow" target="_blank">房价:高级回归技术</a> kaggle竞赛的数据来预测房价。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/c1704885dd44cdcfacb0ee2b6c92528e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bomFuu-16EVcV5bxVREgTA.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">来自<a class="ae jd" href="https://www.pexels.com/photo/aerial-view-of-buildigns-1642125/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae jd" href="https://www.pexels.com/@thelazyartist?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">懒艺术家画廊</a>的照片</figcaption></figure><h1 id="182d" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">PyCaret是什么？</h1><blockquote class="ks kt ku"><p id="cd4a" class="if ig kv ih b ii ij ik il im in io ip kw ir is it kx iv iw ix ky iz ja jb jc hb bi translated">PyCaret是一个开源的，Python中的低代码机器学习库，允许你在几分钟内从准备数据到在你选择的笔记本环境中部署你的模型。— <a class="ae jd" href="https://pycaret.org/" rel="noopener ugc nofollow" target="_blank"> PyCaret主页</a></p></blockquote><p id="2139" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">版本2中有大量的变化。关于这些变化的细节，你应该看这里<a class="ae jd" href="https://github.com/pycaret/pycaret/releases/tag/2.0" rel="noopener ugc nofollow" target="_blank">https://github.com/pycaret/pycaret/releases/tag/2.0</a>。</p><p id="6ccf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您还应该查看该库的作者<a class="kz la ge" href="https://medium.com/u/fba05660b60f?source=post_page-----bfc9ce6121b6--------------------------------" rel="noopener" target="_blank"> Moez Ali </a>在《走向数据科学》中写的一篇<a class="ae jd" href="https://towardsdatascience.com/announcing-pycaret-2-0-39c11014540e" rel="noopener" target="_blank">文章</a>。</p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h1 id="8ab2" class="ju jv hi bd jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn lm kp kq kr bi translated">只是一张纸条</h1><p id="100c" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">我在我的机器上使用的是Ubuntu，因此下面的一些安装代码可能无法在Windows机器上运行。没有一个设置代码是复杂的，如果您以前使用过Anaconda和pip，那么您应该熟悉替代方法。如果有足够的需求，我可能会包括一些特定于Windows的指令。</p><p id="14ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，我使用的是一台5年前的笔记本电脑，配有i7英特尔cpu和16GB内存。在运行任何模型时，我都尽量将处理时间控制在10分钟以内。如果你的机器比我的机器发出的声音更大，那就把它砸碎吧:-)。</p><p id="e9e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我还会把它写在笔记本上。</p><p id="64d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在开始表演。</p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h1 id="cd24" class="ju jv hi bd jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn lm kp kq kr bi translated">安装和设置PyCaret 2.0</h1><p id="b423" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">首先我们需要安装PyCaret 2.0。我建议使用Anaconda并建立一个新的conda环境，以避免与您可能使用的其他库发生冲突。我使用的是Python 3.7.6，我的环境叫做“pycaret_example”。</p><pre class="jf jg jh ji fd ls lt lu lv aw lw bi"><span id="9f9e" class="lx jv hi lt b fi ly lz l ma mb">conda create --name pycaret_example python=3.7.6</span></pre><p id="2ab0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦完成，我们需要激活环境。</p><pre class="jf jg jh ji fd ls lt lu lv aw lw bi"><span id="6b37" class="lx jv hi lt b fi ly lz l ma mb">conda activate pycaret_example</span></pre><p id="4b8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们可以继续使用pip安装PyCaret 2.0，这大约需要5分钟。这也将下载运行PyCaret 2.0所需的所有依赖项。</p><pre class="jf jg jh ji fd ls lt lu lv aw lw bi"><span id="046b" class="lx jv hi lt b fi ly lz l ma mb">pip install pycaret==2.0</span></pre><p id="3db0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦完成，我们应该检查版本，以确保我们有我们需要的。</p><pre class="jf jg jh ji fd ls lt lu lv aw lw bi"><span id="0e5f" class="lx jv hi lt b fi ly lz l ma mb">&gt; pip show pycaret<br/>Name: pycaret<br/>Version: 2.0<br/>Summary: PyCaret - An open source, low-code machine learning library in Python.<br/>Home-page: <a class="ae jd" href="https://github.com/pycaret/pycaret" rel="noopener ugc nofollow" target="_blank">https://github.com/pycaret/pycaret</a><br/>Author: Moez Ali<br/>Author-email: <a class="ae jd" href="mailto:moez.ali@queensu.ca" rel="noopener ugc nofollow" target="_blank">moez.ali@queensu.ca</a><br/>License: MIT<br/>Location: ....</span></pre></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h1 id="c2e2" class="ju jv hi bd jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn lm kp kq kr bi translated">获取数据</h1><p id="dbf2" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">我们将使用在<a class="ae jd" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/overview" rel="noopener ugc nofollow" target="_blank">房价:高级回归技术</a> Kaggle竞赛中找到的数据集。我建议花些时间阅读概述页面，了解数据是什么，以及评估选项卡，了解任务的一些背景。</p><p id="ef03" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为一个非常简短的总结，我们试图使用每栋房子的已知指标来预测房价。这是一个经典的回归问题，所以我们需要建立某种模型来完成这项任务。顺便提一下，在与非数据科学客户合作时，这通常是尽可能详细的。</p><p id="d4f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们来看看数据。我使用Kaggle API来下载数据，但是您也可以从竞赛的数据选项卡中简单地下载zip。</p><pre class="jf jg jh ji fd ls lt lu lv aw lw bi"><span id="cd73" class="lx jv hi lt b fi ly lz l ma mb">&gt; conda install -c conda-forge kaggle<br/>&gt; kaggle competitions download -c house-prices-advanced-regression-techniques</span></pre><p id="1f44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您现在应该有一个zip文件，可以从中提取所有内容。您应该有以下4个文件</p><ul class=""><li id="f09e" class="mc md hi ih b ii ij im in iq me iu mf iy mg jc mh mi mj mk bi translated">train.csv</li><li id="25e1" class="mc md hi ih b ii ml im mm iq mn iu mo iy mp jc mh mi mj mk bi translated">test.csv</li><li id="ec38" class="mc md hi ih b ii ml im mm iq mn iu mo iy mp jc mh mi mj mk bi translated">数据_描述. txt</li><li id="eae0" class="mc md hi ih b ii ml im mm iq mn iu mo iy mp jc mh mi mj mk bi translated">sample_submission.csv</li></ul><p id="58ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将<strong class="ih hj"> train.csv </strong>和<strong class="ih hj"> test.csv </strong>移动到一个名为data的新目录中。这对我来说看起来不错，有助于保持一切结构化。</p><p id="1e35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> data_description.txt </strong>包括对每列含义的解释，以及可能的值及其含义，例如。</p><pre class="jf jg jh ji fd ls lt lu lv aw lw bi"><span id="1cb9" class="lx jv hi lt b fi ly lz l ma mb">SaleType: Type of sale<br/>  <br/>       WD  Warranty Deed - Conventional<br/>       CWD Warranty Deed - Cash<br/>       VWD Warranty Deed - VA Loan<br/>       New Home just constructed and sold<br/>       ...</span></pre><p id="5110" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还有<strong class="ih hj"> sample_submission.csv </strong>文件，它向我们展示了我们需要以什么格式提交给竞争对手，例如。</p><pre class="jf jg jh ji fd ls lt lu lv aw lw bi"><span id="29cd" class="lx jv hi lt b fi ly lz l ma mb">Id,SalePrice<br/>1461,169277.0524984<br/>1462,187758.393988768<br/>1463,183583.683569555<br/>1464,179317.47751083<br/>1465,150730.079976501<br/>1466,177150.989247307<br/>...</span></pre><p id="7706" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这两个文件都非常有用，您应该试着熟悉它们。</p><p id="0892" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用的实际数据已经分为训练集和测试集。我们将在最后使用测试集来检查我们的最终模型。让我们开始查看<strong class="ih hj"> train.csv </strong>并将<strong class="ih hj"> test.csv </strong>留给测试。</p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h1 id="0d15" class="ju jv hi bd jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn lm kp kq kr bi translated">设置PyCaret环境</h1><p id="24e3" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">让我们首先导入PyCaret和pandas的回归库来读取数据。</p><pre class="jf jg jh ji fd ls lt lu lv aw lw bi"><span id="e24e" class="lx jv hi lt b fi ly lz l ma mb"># import libraries<br/>from pycaret.regression import *<br/>import pandas as pd</span></pre><p id="8af8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们读入数据，看看前5行。</p><pre class="jf jg jh ji fd ls lt lu lv aw lw bi"><span id="1618" class="lx jv hi lt b fi ly lz l ma mb"># read in the data<br/>df = pd.read_csv('data/train.csv')<br/>pd.options.display.max_columns = 500<br/>df.head()</span></pre><p id="9002" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您应该看到81列，包括我们的目标列SalePrice，就在最后。不做任何转换，让我们初始化PyCaret。</p><pre class="jf jg jh ji fd ls lt lu lv aw lw bi"><span id="a439" class="lx jv hi lt b fi ly lz l ma mb"># initialize the setup<br/>exp_reg = setup(df, target='SalePrice')</span></pre><p id="de83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将开始检查数据的过程，我检查了列的类型是否正确(即数字、分类)并按下enter键。我们得到PyCaret所做的总结，我们没有尝试做任何转换，所以任何转换应该是假的或没有。你应该看到<strong class="ih hj">我们有缺失值</strong>、<strong class="ih hj"> 21个数字特征</strong>和<strong class="ih hj"> 59个分类特征</strong> (PS，列和特征是一回事)。</p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h1 id="e7c1" class="ju jv hi bd jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn lm kp kq kr bi translated">比较模型</h1><p id="24db" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">现在让我们通过跑步来比较模型</p><pre class="jf jg jh ji fd ls lt lu lv aw lw bi"><span id="548b" class="lx jv hi lt b fi ly lz l ma mb">compare_models(sort='RMSE', blacklist=['tr'])</span></pre><p id="978f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们按照<strong class="ih hj"> RMSE </strong>进行排序，因为这是我们评估提交作品的方式。我还把TheilSen回归器列入了黑名单，因为估计的训练时间大约是10个小时。</p><p id="87cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">比较得出的最佳模型是正交匹配追踪模型。你可以在这里阅读更多关于车型<a class="ae jd" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.OrthogonalMatchingPursuit.html" rel="noopener ugc nofollow" target="_blank">的信息。上面的输出是</a></p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mq mr l"/></div></figure><p id="ba4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的RMSE是23474.3803或23，474.38美元。对于仅仅几行代码来说还不算太坏。这很好，但我们应该调整这些模型，以潜在地获得更好的结果。</p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h1 id="d422" class="ju jv hi bd jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn lm kp kq kr bi translated">调整您的模型</h1><p id="571f" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">让我们选择前3个模型，并在本文的剩余部分使用它们。这意味着我们需要为他们创建模型。我们可以如下使用<strong class="ih hj"> create_models() </strong>来实现。</p><pre class="jf jg jh ji fd ls lt lu lv aw lw bi"><span id="3838" class="lx jv hi lt b fi ly lz l ma mb"># create the top 3 models<br/>OMP = create_model('omp', verbose=False)<br/>LLAR = create_model('llar', verbose=False)<br/>CBR = create_model('catboost', verbose=False)</span></pre><p id="727a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我已经取消了输出，因为它将与我们运行<strong class="ih hj"> compare_models() </strong>时的输出相同。</p><p id="19be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们可以使用<strong class="ih hj"> tune_model() </strong>来调优模型。</p><pre class="jf jg jh ji fd ls lt lu lv aw lw bi"><span id="1fb6" class="lx jv hi lt b fi ly lz l ma mb">&gt; tuned_OMP = tune_model(OMP, optimize='RMSE')<br/>&gt; tuned_LLAR = tune_model(LLAR, optimize='RMSE')<br/>&gt; tuned_CBR = tune_model(CBR, optimize='RMSE')</span></pre><p id="a46a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我分别运行了上面的每一项，这样我就可以在输出中看到最终的RMSE。调整后，3的最佳表现模型是<strong class="ih hj">拉索最小角度回归</strong>模型，其<strong class="ih hj"> RMSE为23000.3172 </strong>。</p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h1 id="a6ff" class="ju jv hi bd jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn lm kp kq kr bi translated">绘制您的模型</h1><p id="2302" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">PyCaret还附带了一些非常有用的绘图工具，可以用来诊断和检查模型的性能。绘制残差很容易</p><pre class="jf jg jh ji fd ls lt lu lv aw lw bi"><span id="7de3" class="lx jv hi lt b fi ly lz l ma mb">plot_model(tuned_LLAR)</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ms"><img src="../Images/0142071bc0f1987e0bbeb927ccc45f38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*tR4i3rMh6mEto5ZV6NrtDg.png"/></div></figure><p id="b0e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们也可以看到预测误差</p><pre class="jf jg jh ji fd ls lt lu lv aw lw bi"><span id="3544" class="lx jv hi lt b fi ly lz l ma mb">plot_model(tuned_LLAR, plot='error')</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mt"><img src="../Images/de7fb4e48e461f2e983e96c7d74116b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*O0gN7bMb-dhqpzN2x3s7LQ.png"/></div></figure><p id="f3f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">和特征重要性</p><pre class="jf jg jh ji fd ls lt lu lv aw lw bi"><span id="708a" class="lx jv hi lt b fi ly lz l ma mb">plot_model(tuned_LLAR, plot='feature')</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mu"><img src="../Images/71a491efb9192ee95e492bd5875df754.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*Uvy8D2dmvy3AiLzFKf6JsQ.png"/></div></figure><p id="a317" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还可以绘制一系列其他可能更符合您需求的图</p><ul class=""><li id="10ff" class="mc md hi ih b ii ij im in iq me iu mf iy mg jc mh mi mj mk bi translated">残差图</li><li id="19e9" class="mc md hi ih b ii ml im mm iq mn iu mo iy mp jc mh mi mj mk bi translated">误差预测误差图</li><li id="fd29" class="mc md hi ih b ii ml im mm iq mn iu mo iy mp jc mh mi mj mk bi translated">库克的库克距离图</li><li id="8c48" class="mc md hi ih b ii ml im mm iq mn iu mo iy mp jc mh mi mj mk bi translated">rfe的递归壮举。选择</li><li id="c135" class="mc md hi ih b ii ml im mm iq mn iu mo iy mp jc mh mi mj mk bi translated">“学习”学习曲线</li><li id="3cf6" class="mc md hi ih b ii ml im mm iq mn iu mo iy mp jc mh mi mj mk bi translated">vc验证曲线</li><li id="f4ee" class="mc md hi ih b ii ml im mm iq mn iu mo iy mp jc mh mi mj mk bi translated">流形学习</li><li id="def7" class="mc md hi ih b ii ml im mm iq mn iu mo iy mp jc mh mi mj mk bi translated">“特征”特征重要性</li><li id="a074" class="mc md hi ih b ii ml im mm iq mn iu mo iy mp jc mh mi mj mk bi translated">参数模型超参数</li></ul></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h1 id="6a3f" class="ju jv hi bd jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn lm kp kq kr bi translated">测试模型</h1><p id="8e84" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">在我们最终确定模型之前，我们需要根据模型以前没有见过的一组测试数据来测试它的性能。默认情况下，设置步骤为此任务留出30%的时间。让我们来看一下我们的前三个模型，根据测试集再次进行测试。</p><pre class="jf jg jh ji fd ls lt lu lv aw lw bi"><span id="61e5" class="lx jv hi lt b fi ly lz l ma mb">&gt; predict_model(tuned_OMP)<br/>&gt; predict_model(tuned_LLAR)<br/>&gt; predict_model(tuned_GBR)</span></pre><p id="639a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就像生活中一样，现实世界中的事情并不总是那么顺利。我们的<strong class="ih hj">性能最好的模型现在是CatBoost回归器</strong>，其<strong class="ih hj"> RMSE为39805.99 </strong>。RMSE从训练交叉验证中增加了很多，意味着RMSE建议在所有三个模型上过度拟合。这就是你必须戴上数据科学家的帽子，回去找出原因的地方。现在我只想向前冲。</p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h1 id="3250" class="ju jv hi bd jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn lm kp kq kr bi translated">最终确定部署模型</h1><p id="69b3" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">现在我们已经决定了一个模型，<strong class="ih hj"> CatBoost </strong>，我们希望它可以在现实世界中使用。finalize_model()函数将训练您先前调优的模型，但将使用整个数据集。</p><pre class="jf jg jh ji fd ls lt lu lv aw lw bi"><span id="06a1" class="lx jv hi lt b fi ly lz l ma mb">final_CBR = finalize_model(tuned_CBR)</span></pre></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h1 id="0597" class="ju jv hi bd jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn lm kp kq kr bi translated">检查test.csv上的最终模型</h1><p id="161b" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">让我们读入测试集，并对照它检查我们的模型性能。我们需要创建预测，这样我们就可以将它们上传到kaggle比赛，并在那里进行检查。</p><pre class="jf jg jh ji fd ls lt lu lv aw lw bi"><span id="0509" class="lx jv hi lt b fi ly lz l ma mb">df_test = pd.read_csv('data/test.csv')<br/>test_predictions = predict_model(final_CBR, data=df_test)<br/>submission = test_predictions[['Id', 'Label']]<br/>submission.columns = ['Id', 'SalePrice']<br/>submission.to_csv('submission.csv', index=False)</span></pre><p id="53e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">跳转到比赛的排行榜选项卡，选择<strong class="ih hj">提交预测</strong>。一旦提交，你会得到一个分数。</p><p id="ca7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我提交的分数是0.14249，几乎没有赢得比赛，但它让我在5117份提交的作品中排名第2661位，因为我基本上没有使用任何数据科学技能，只需几分钟就可以编写几行代码。</p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h1 id="822e" class="ju jv hi bd jw jx li jz ka kb lj kd ke kf lk kh ki kj ll kl km kn lm kp kq kr bi translated">摘要</h1><p id="610a" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">PyCaret是一个很棒的工具，版本2建立在AutoML已经很强大的基础之上。作者<a class="ae jd" href="https://medium.com/u/fba05660b60f" rel="noopener"> Moez Ali </a>应该为这个令人敬畏的工具而受到祝贺。</p><p id="f60e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">自从学习PyCaret以来，我就把它放在了我的工具箱中，因为它允许我快速构建ML解决方案。</p><p id="fb00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本教程中，我没有涉及PyCaret可以做的所有事情，还有大量的附加功能可以将我的提交提升到一个新的水平。我鼓励你去看看<a class="ae jd" href="https://pycaret.org/" rel="noopener ugc nofollow" target="_blank">网站</a>和<a class="ae jd" href="http://www.github.com/pycaret/pycaret" rel="noopener ugc nofollow" target="_blank"> git repo </a>。</p><p id="034f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">想给我买杯咖啡吗？翻到我的 <a class="ae jd" href="https://www.patreon.com/DataRacoon" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">页，它有助于我继续写作。</strong></a></p></div></div>    
</body>
</html>