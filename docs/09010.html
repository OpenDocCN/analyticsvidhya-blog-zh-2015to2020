<html>
<head>
<title>What nobody tells you about binary classification metrics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">没人告诉你的二进制分类度量</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/what-nobody-tells-you-about-binary-classification-metrics-4998574b668?source=collection_archive---------8-----------------------#2020-08-22">https://medium.com/analytics-vidhya/what-nobody-tells-you-about-binary-classification-metrics-4998574b668?source=collection_archive---------8-----------------------#2020-08-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/ef8d728dd54f7b56ab76ec0c001e6ea8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*haZZ57l9-KsA_VZoCYrYHw.jpeg"/></div></figure><p id="a7d8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">您很可能知道(或至少听说过)评估分类器的指标，如准确度、精确度、召回率和 f1 值。但是，您是否知道有些类型的问题是他们没有指出的？还有，你已经了解 MCC，NPV，或者特异性了吗？我也很长时间不知道这些度量，因此我已经错过了评估一些分类器。因此，在本文中，我们将看到:</p><ul class=""><li id="97d5" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated"><strong class="io hj">对最受欢迎的指标的简单明了的解释</strong>——这样你就不会再对它们有疑问了；</li><li id="91ba" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated"><strong class="io hj">何时使用，主要是不使用每个指标</strong></li><li id="7ed3" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated"><strong class="io hj">评估分类器的最推荐指标是什么</strong></li></ul><p id="13ae" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">准备好了吗？加油…</p><figure class="jz ka kb kc fd ij er es paragraph-image"><div class="er es jy"><img src="../Images/89c405aae60f1be52015d06a213ad1b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*PdPTchPsMXarG75a.jpg"/></div></figure></div><div class="ab cl kd ke gp kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hb hc hd he hf"><h1 id="41fb" class="kk kl hi bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">准确(性)</h1><figure class="jz ka kb kc fd ij er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es li"><img src="../Images/48929410eb1ae854726927f7381f8238.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/0*P7AOiQtlA1UCuqAt.png"/></div></div></figure><p id="ce56" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">准确性是目前最流行的衡量标准。基本上，它表示在给定的数据集中，所有类别中有多少预测是正确的。虽然精确度被高度采用，但当数据集不平衡时，它并不十分适合。</p><p id="e622" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">举个例子，假设我们有一个数据集，其中的标签是男人/女人。还有，让我们考虑 80%的样本是女性，只有 20%是男性。如果你的模型只预测女性，那么它的准确率会轻松达到 80%。这同样适用于多类分类。例如，想象一个动物数据集，40%是狗，50%是狗。同样，如果你的模型只学习区分狗和猫，准确率将达到 90%。</p><p id="4c84" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">因此，<strong class="io hj">只有当您的数据集达到平衡时，准确性才能被视为有效的指标</strong>。换句话说，当类分布(be 2 或更多)有些均匀时。就个人而言，我不喜欢准确性，因为这种假设很难在现实世界的数据中发生。</p><h1 id="5d10" class="kk kl hi bd km kn ln kp kq kr lo kt ku kv lp kx ky kz lq lb lc ld lr lf lg lh bi translated">精确度、召回率和 F1 值(或 F 值)</h1><figure class="jz ka kb kc fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/e67a19bb6b30bed004d2ba36ee1f13e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*sWEZAO9iY9prQUpD.png"/></div></figure><ul class=""><li id="079e" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated"><strong class="io hj">回想一下</strong>:你的模型相对于正类有多准确？即:<strong class="io hj">“给定阳性样本，有多少预测是正确的？”</strong></li><li id="5b21" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated"><strong class="io hj"> Precision </strong>:当你的模型预测正类时，你有多信任它？即:<strong class="io hj">“给定正面预测，有多少是正确的？</strong></li></ul><p id="fd74" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">除了分类问题，精确度和召回率对于检测问题非常有用。例如，假设我们有一个检测人脸的模型。改变以前的定义，精度和召回将被定义如下:</p><ul class=""><li id="abdf" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated">回忆一下:“给定被标记的人脸，模型检测到了多少？”</li><li id="98cd" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated"><strong class="io hj">精度</strong>:“给定预测人脸，有多少是真实人脸？</li></ul><p id="01bd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">举个实际的例子，假设我们有一个有 10 张脸的图像。现在，让我们假设一个模型返回 5 个检测，其中 3 个是真正的人脸(TP ), 2 个是不正确的。在这种情况下，我们的召回率为 30%(10 个检测到的人脸中有 3 个)，精确度为 60%(5 个正确预测中有 3 个)。</p><p id="4020" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">那么，<strong class="io hj">f 值(或 f1 值)的目的是什么？</strong>假设在这个相同的图像中，另一个模型返回 2 个检测，并且它们是真实的人脸。在这种情况下，召回率为 20% (2/10)，准确率为 100%(所有检测都是真实人脸)。召回率 30%准确率 60%的模型和召回率 20%准确率 100%的模型哪个好？</p><p id="ad5a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了帮助这个决定，<strong class="io hj">我们使用 f 值</strong>。<strong class="io hj">它代表了精确和回忆的调和含义</strong>。为什么是谐波？因为与算术平均相比，<strong class="io hj">要提高 f1-score，精度和召回率都必须更高</strong>。</p><p id="9c56" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当你的积极类比消极类更重要时，这些指标是合适的。如果你仔细看看公式，精度和召回不考虑真正的负面影响(TN)。<strong class="io hj">他们只关心阳性样本</strong>。这并不总是好的。</p><p id="78b8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在检测问题中，就像例子中一样，它完全有意义。想一想:在一个检测问题中，如何定义真否定(TN)？除了难以定义，真正的否定没有太大意义。一种算法能很好的检测出不感兴趣的物体？至少，令人困惑…</p><figure class="jz ka kb kc fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/b6b5added4d0bc3d390dc5bbddebc6e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*IUX19RRq4R_z_SYq.gif"/></div></figure><p id="4068" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">另一方面，<strong class="io hj">在一些分类问题中，负类比正类</strong>更相关。对于这种情况，我们有 NPV 和特异性。</p><h1 id="2a19" class="kk kl hi bd km kn ln kp kq kr lo kt ku kv lp kx ky kz lq lb lc ld lr lf lg lh bi translated">阴性预测值(NPV)，特异性</h1><figure class="jz ka kb kc fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/58417a2eb07c38d74bd7b6dd48280738.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/0*t1jhiJweWCU_Rwpv.png"/></div></figure><p id="2029" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">指标特异性和 NPV 等同于召回率和精确度，但是对于负类:</p><ul class=""><li id="b14f" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated"><strong class="io hj">特异性</strong>:你的模型相对于负类有多准确？即:<strong class="io hj">“给定阴性样本，有多少预测是正确的？”</strong></li><li id="1620" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">NPV :当你的模型预测负类时，你有多信任它？即:<strong class="io hj">“给定负面预测，有多少是正确的？</strong></li></ul><p id="6ad5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">正如我之前所说的，<strong class="io hj">当消极类在实践中比积极类更重要时，这些度量标准是有用的</strong>。例如，假设我们有一个分类问题，我们想知道一个病人是健康的(阳性)还是有病的(阴性)。或者如果我们想知道某些信用卡交易是真实的(正面的)还是欺诈的(负面的)。在这些情况下，您必须计算 NPV 和特异性。此外，我们可以根据这些指标快速调整 F 值。</p><h1 id="577c" class="kk kl hi bd km kn ln kp kq kr lo kt ku kv lp kx ky kz lq lb lc ld lr lf lg lh bi translated">f-β</h1><figure class="jz ka kb kc fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/a0d05905f0fb6fb971109832eea588db.png" data-original-src="https://miro.medium.com/v2/resize:fit:446/format:webp/0*fan69GamiXzHApdd.png"/></div></figure><p id="25e4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">F-beta 是 f1 的推广。这个公式有一个衡量召回率的项，它比精确度更重要。我们可以看到，当<strong class="io hj">β= 1</strong>时，我们有 f1 的原始公式——分数。</p><p id="7666" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">另一个典型值是<strong class="io hj">β= 2</strong>，生成 F2-分数。在这种情况下，我们认为<strong class="io hj">召回的权重高于精度</strong>。也就是说，对于分类器来说，好的召回率比精确度更重要。<strong class="io hj">当我们希望确保分类器更好地识别阳性类别时，这很有用，即使它可能会产生更多的假阳性</strong>。在前面的检测示例中，我们的检测器会尝试检测尽可能多的真实人脸，但可能会返回更多的误报(不是真实人脸的检测)。</p><p id="e067" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">请注意，我们可以很容易地修改 f-beta，分别用 NPV 和特异性来代替精度和召回率。</p><h1 id="651a" class="kk kl hi bd km kn ln kp kq kr lo kt ku kv lp kx ky kz lq lb lc ld lr lf lg lh bi translated">马修斯相关系数</h1><figure class="jz ka kb kc fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/f1606b5790b290130a3d85b759576bd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/0*IOZmlJHny2o8v0hg.png"/></div></figure><p id="fba9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我决定以后再写 MCC，因为<strong class="io hj">是我最喜欢的指标。我总是在我处理的分类问题中计算 MCC</strong>。你想知道为什么吗？</p><p id="15e3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先，因为<strong class="io hj"> MCC 是一个考虑二元分类(TP，TN，FP，FN)所有可能性</strong>的度量。其次，<strong class="io hj"> MCC 对不平衡数据集具有鲁棒性</strong>。最后，<strong class="io hj">MCC 的结果是一个介于-1 和 1 之间的归一化系数，可以直接解释</strong>。换句话说:</p><ul class=""><li id="ac9a" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated"><strong class="io hj"> -1 </strong>:你的 MCC 越接近-1，你的分类器越差，也就是说，分类器产生的错误比正确的结果多。</li><li id="a57a" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated"><strong class="io hj"> +1 </strong>:另一方面，越接近+1，你的分类器就越好。</li><li id="3181" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated"><strong class="io hj"> 0 </strong>:当系数接近零时，MCC 告诉我们分类器正在预测最频繁的类别。</li></ul><blockquote class="lx"><p id="d53e" class="ly lz hi bd ma mb mc md me mf mg jj dx translated">不管你的问题是不平衡的还是你的正/负类的重要性，MCC 都是评估你的分类器结果的一个好的和公平的度量。</p></blockquote><h1 id="d307" class="kk kl hi bd km kn ln kp kq kr lo kt ku kv mh kx ky kz mi lb lc ld mj lf lg lh bi translated">综上</h1><ul class=""><li id="cbeb" class="jk jl hi io b ip mk it ml ix mm jb mn jf mo jj jp jq jr js bi translated"><strong class="io hj">只有当你的类分布均匀时才使用精度</strong>。尽管如此，也要计算(或优先考虑)其他指标。</li><li id="d0ca" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">当你的正面类比负面类更重要时，计算精度、召回率和 F 值。使用 F-measure 来决定两个或更多分类器。</li><li id="5772" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated"><strong class="io hj">当负类更相关时，使用 NPV 和特异性</strong>。</li><li id="aacf" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated"><strong class="io hj">有了 F-beta，就可以平衡精度和召回</strong>(甚至 NPV 和特异性)。</li><li id="2d8a" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated"><strong class="io hj">始终计算 MCC </strong>。该指标对不平衡的数据集是稳健的，它的系数是可解释的，并且给你的分类器一个更好的感觉。</li></ul><p id="ab2a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">就是这样。我希望你喜欢它。如果这篇文章对你也有帮助，请给点掌声👏👏。关注我在媒体上更多这样的职位。您也可以在以下位置查看我的作品:</p><ul class=""><li id="acdb" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated"><a class="ae mp" href="https://github.com/arnaldog12" rel="noopener ugc nofollow" target="_blank"> Github </a></li><li id="412a" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated"><a class="ae mp" href="https://www.linkedin.com/in/arnaldo-gualberto/" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="b3a4" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated"><a class="ae mp" href="http://www.arnaldogualberto.com/" rel="noopener ugc nofollow" target="_blank">个人网站</a></li></ul><figure class="jz ka kb kc fd ij er es paragraph-image"><div class="er es mq"><img src="../Images/8102d3fbbc05e91d5446f96941a5677a.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/0*Ab0hxJvqfIfJyqZV.png"/></div></figure></div></div>    
</body>
</html>