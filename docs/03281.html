<html>
<head>
<title>Facial Landmarks and Face Detection in Python with OpenCV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用OpenCV实现Python中的人脸标志和人脸检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/facial-landmarks-and-face-detection-in-python-with-opencv-73979391f30e?source=collection_archive---------0-----------------------#2020-01-24">https://medium.com/analytics-vidhya/facial-landmarks-and-face-detection-in-python-with-opencv-73979391f30e?source=collection_archive---------0-----------------------#2020-01-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es im"><img src="../Images/d606697e06f27df8b5151889fd341e4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*ok8GqsdARxBrF3kBdiYSlQ.png"/></div><figcaption class="iu iv et er es iw ix bd b be z dx translated">面部标志检测样本</figcaption></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><blockquote class="iy iz ja"><p id="ab95" class="jb jc jd je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">人脸检测是一种用于在数字图像中识别人脸的计算机技术。人脸检测也指人类在视觉场景中定位和注意人脸的心理过程。— <a class="ae ka" href="https://en.wikipedia.org/wiki/Face_detection" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></blockquote></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="4f8e" class="pw-post-body-paragraph jb jc hi je b jf jg jh ji jj jk jl jm kb jo jp jq kc js jt ju kd jw jx jy jz hb bi translated">面部标志检测是检测面部标志或感兴趣区域(关键点)的过程，如眉毛、眼睛、鼻子、嘴和下巴轮廓。</p><p id="8821" class="pw-post-body-paragraph jb jc hi je b jf jg jh ji jj jk jl jm kb jo jp jq kc js jt ju kd jw jx jy jz hb bi translated">面部标志检测的一些应用是面部交换、头部姿态检测、检测面部姿态、注视方向等。</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h1 id="6b89" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">安装和下载</h1><p id="3b5a" class="pw-post-body-paragraph jb jc hi je b jf lc jh ji jj ld jl jm kb le jp jq kc lf jt ju kd lg jx jy jz hb bi translated"><em class="jd">这个项目是在jupyter笔记本上完成的。</em></p><p id="17fb" class="pw-post-body-paragraph jb jc hi je b jf jg jh ji jj jk jl jm kb jo jp jq kc js jt ju kd jw jx jy jz hb bi translated">开始之前，您应该在计算机上安装以下软件:</p><ul class=""><li id="e8c5" class="lh li hi je b jf jg jj jk kb lj kc lk kd ll jz lm ln lo lp bi translated">Python，可用<a class="ae ka" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank">这里的<em class="jd"/>选择3.7或更高版本。</a></li><li id="0569" class="lh li hi je b jf lq jj lr kb ls kc lt kd lu jz lm ln lo lp bi translated">PIP，此处可用<a class="ae ka" href="https://pip.pypa.io/en/stable/installing/" rel="noopener ugc nofollow" target="_blank">T9T11】。Pip是Python的包安装程序。您可以使用pip从Python包索引和其他索引安装包。</a></li></ul><p id="0b08" class="pw-post-body-paragraph jb jc hi je b jf jg jh ji jj jk jl jm kb jo jp jq kc js jt ju kd jw jx jy jz hb bi translated"><em class="jd">下列软件包是必需的，您可以从命令行使用pip安装它们:</em></p><ul class=""><li id="140f" class="lh li hi je b jf jg jj jk kb lj kc lk kd ll jz lm ln lo lp bi translated">OpenCV代表开源计算机视觉库，<em class="jd">用来读取和处理我们的图像。</em></li></ul><pre class="in io ip iq fd lv lw lx ly aw lz bi"><span id="b7b4" class="ma kf hi lw b fi mb mc l md me">pip install opencv-python<br/>// or this<br/>pip install opencv-python — user</span></pre><ul class=""><li id="497e" class="lh li hi je b jf jg jj jk kb lj kc lk kd ll jz lm ln lo lp bi translated">对于URL请求处理，请安装:</li></ul><pre class="in io ip iq fd lv lw lx ly aw lz bi"><span id="c622" class="ma kf hi lw b fi mb mc l md me">pip install urllib3<br/>// or this<br/>pip install urllib3 — user</span></pre><ul class=""><li id="7e68" class="lh li hi je b jf jg jj jk kb lj kc lk kd ll jz lm ln lo lp bi translated">和matplotlib来绘制我们的图像:</li></ul><pre class="in io ip iq fd lv lw lx ly aw lz bi"><span id="61b1" class="ma kf hi lw b fi mb mc l md me">pip install matplotlib<br/>// or this<br/>pip install matplotlib — user</span></pre><ul class=""><li id="2558" class="lh li hi je b jf jg jj jk kb lj kc lk kd ll jz lm ln lo lp bi translated">人脸检测使用<strong class="je hj"> haarcascade <em class="jd"> </em> </strong>人脸分类器，<a class="ae ka" href="https://raw.githubusercontent.com/opencv/opencv/master/data/haarcascades/haarcascade_frontalface_alt2.xml" rel="noopener ugc nofollow" target="_blank"> <em class="jd">下载分类器</em> </a> <em class="jd"> </em> ( &lt; 1MB)。</li><li id="fa11" class="lh li hi je b jf lq jj lr kb ls kc lt kd lu jz lm ln lo lp bi translated">地标检测使用<strong class="je hj"> LBFmodel </strong>，<a class="ae ka" href="https://github.com/kurnianggoro/GSOC2017/raw/master/data/lbfmodel.yaml" rel="noopener ugc nofollow" target="_blank"> <em class="jd">下载model </em> </a> ( &lt; 54 MB)。</li></ul><p id="c25b" class="pw-post-body-paragraph jb jc hi je b jf jg jh ji jj jk jl jm kb jo jp jq kc js jt ju kd jw jx jy jz hb bi translated"><strong class="je hj">注</strong>:下载的分类器和模型必须移动到与你的同一个目录下。本教程的ipynb文件。</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h1 id="9089" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">导入包</h1><p id="7185" class="pw-post-body-paragraph jb jc hi je b jf lc jh ji jj ld jl jm kb le jp jq kc lf jt ju kd lg jx jy jz hb bi translated">在您的交互式Python笔记本(*。ipynb)导入以下内容</p><figure class="in io ip iq fd ir"><div class="bz dy l di"><div class="mf mg l"/></div></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h1 id="acdd" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">检索图像</h1><p id="f91e" class="pw-post-body-paragraph jb jc hi je b jf lc jh ji jj ld jl jm kb le jp jq kc lf jt ju kd lg jx jy jz hb bi translated">用于此检测的图像可用<a class="ae ka" href="https://upload.wikimedia.org/wikipedia/commons/archive/7/76/20170623195932%21Donald_Trump_Justin_Trudeau_2017-02-13_02.jpg" rel="noopener ugc nofollow" target="_blank"> <em class="jd">此处</em> </a>，您也可以使用您选择的任何图像，只需更改图像名称/路径。</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="er es mh"><img src="../Images/95bda2d173cb9dac39289d084f4ee072.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8WXOiaNfAAYFVySOgMTRhg.jpeg"/></div></div><figcaption class="iu iv et er es iw ix bd b be z dx translated">(R-L:美国总统川普和加拿大总理贾斯廷·特鲁多)</figcaption></figure><figure class="in io ip iq fd ir"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="5424" class="pw-post-body-paragraph jb jc hi je b jf jg jh ji jj jk jl jm kb jo jp jq kc js jt ju kd jw jx jy jz hb bi translated">在<em class="jd">第2行</em>和<em class="jd">第5行</em>中，图像的URL和名称分别保存在<code class="du mm mn mo lw b">pic_url</code>和<code class="du mm mn mo lw b">pic</code>变量中。<br/> <em class="jd">第8行</em>从网上获取图像并保存在本地的同一个工作目录下。<br/> <em class="jd">第11行</em>用OpenCV的<code class="du mm mn mo lw b">cv2.imread()</code>读取下载的图像。<br/> <em class="jd">第14行</em>绘制图像。</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h1 id="9c81" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">图像处理</h1><figure class="in io ip iq fd ir"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="595a" class="pw-post-body-paragraph jb jc hi je b jf jg jh ji jj jk jl jm kb jo jp jq kc js jt ju kd jw jx jy jz hb bi translated">在<em class="jd">行2 </em>上，将图像从BGR转换为RGB颜色<br/>在<em class="jd">行8，9 </em>上使用图像轴将图像裁剪为特定尺寸，图像的左上角为(0，0)。使用<code class="du mm mn mo lw b">image[y:y+depth, x:x+width]</code>，其中<code class="du mm mn mo lw b">x</code>和<code class="du mm mn mo lw b">y</code>为左侧轴，开始裁剪。<code class="du mm mn mo lw b">width</code>和<code class="du mm mn mo lw b">depth</code>分别是裁剪图像的x和y尺寸(长度)。<br/> <em class="jd">第15行</em>将图像转换为灰度，注意这里使用的人脸检测算法在灰度图像上表现更好。</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h1 id="6e17" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">人脸检测</h1><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="er es mp"><img src="../Images/bbfb226b68cfa44c0470d4f81a504c21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*nzZjJ9ln-HR5FFcoFn-tcQ.png"/></div></div><figcaption class="iu iv et er es iw ix bd b be z dx translated">面部检测输出</figcaption></figure><figure class="in io ip iq fd ir"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="784a" class="pw-post-body-paragraph jb jc hi je b jf jg jh ji jj jk jl jm kb jo jp jq kc js jt ju kd jw jx jy jz hb bi translated"><em class="jd">图像上检测到三张人脸。</em></p><p id="cc1e" class="pw-post-body-paragraph jb jc hi je b jf jg jh ji jj jk jl jm kb jo jp jq kc js jt ju kd jw jx jy jz hb bi translated">在<em class="jd">第2行</em>和<em class="jd">第5行</em>上，分类器的URL和名称分别保存在<code class="du mm mn mo lw b">haarcascade_url</code>和<code class="du mm mn mo lw b">haarcascade</code>变量中。<br/> <em class="jd">第8 </em>到<em class="jd"> 13 </em>行，检查haarcascade分类器是否下载到工作目录中，如果没有，则下载。<br/> <em class="jd">第16行</em>创建一个分类器实例，用<em class="jd">第19行</em>检测面部。<br/> <em class="jd">第24到29行</em>通过openCV的<code class="du mm mn mo lw b">cv2.rectangle()</code>方法，使用存储在<em class="jd"> faces </em>变量中的坐标，在每个检测到的面周围打印一个方框。</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h1 id="7fce" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">面部标志检测</h1><figure class="in io ip iq fd ir"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="e8d9" class="pw-post-body-paragraph jb jc hi je b jf jg jh ji jj jk jl jm kb jo jp jq kc js jt ju kd jw jx jy jz hb bi translated">上面的代码类似于<em class="jd">线2 </em>和<em class="jd"> 5 </em>上的人脸检测代码<br/>，模型的URL和名称分别保存在<code class="du mm mn mo lw b">LBFmodel_url</code>和<code class="du mm mn mo lw b">LBFmodel</code>变量中。<br/> <em class="jd">第8 </em>到<em class="jd"> 13 </em>行，检查LBFmodel是否下载到工作目录中，如果没有，则下载。<br/> <em class="jd">第16行</em>创建并加载地标检测模型。<br/>在<em class="jd">第20行</em>上，我们用灰度图像和检测到的人脸坐标来拟合模型。<br/> <em class="jd">第22行</em>到<em class="jd"> 26 </em>用openCV的<code class="du mm mn mo lw b">cv2.circle()</code>方法在每个检测到的人脸上标记地标，第<em class="jd">行28 </em>用检测到的地标绘制图像。</p><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es im"><img src="../Images/d606697e06f27df8b5151889fd341e4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*ok8GqsdARxBrF3kBdiYSlQ.png"/></div><figcaption class="iu iv et er es iw ix bd b be z dx translated">面部标志检测输出</figcaption></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="0865" class="pw-post-body-paragraph jb jc hi je b jf jg jh ji jj jk jl jm kb jo jp jq kc js jt ju kd jw jx jy jz hb bi translated">下面是放大的检测。</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="er es mq"><img src="../Images/7abcd27fa6364d667ce2638e4ddb8d9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yE8ZUBZf2ev7M5PdAgWw4w.png"/></div></div><figcaption class="iu iv et er es iw ix bd b be z dx translated">缩放输出</figcaption></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h1 id="e2c7" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">临时演员</h1><p id="db71" class="pw-post-body-paragraph jb jc hi je b jf lc jh ji jj ld jl jm kb le jp jq kc lf jt ju kd lg jx jy jz hb bi translated">笔记本的链接可以在<a class="ae ka" href="https://github.com/Danotsonof/facial-landmark-detection/blob/master/facial-landmark.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>找到。<br/><strong class="je hj"><em class="jd">Python 3.7</em></strong><em class="jd">和</em><strong class="je hj"><em class="jd">OpenCV 4 . 1 . 2</em></strong><em class="jd">用于此任务。通过网络摄像头进行地标检测，勾选</em> <a class="ae ka" href="https://github.com/Danotsonof/facial-landmark-detection" rel="noopener ugc nofollow" target="_blank"> <em class="jd"> GitHub链接</em> </a> <em class="jd">。</em></p><p id="4e84" class="pw-post-body-paragraph jb jc hi je b jf jg jh ji jj jk jl jm kb jo jp jq kc js jt ju kd jw jx jy jz hb bi translated">特别感谢以下分享的知识:<br/> <a class="ae ka" href="https://github.com/albertofernandezvillan" rel="noopener ugc nofollow" target="_blank">阿尔贝托·费尔南德斯·维兰</a> <br/> <a class="ae ka" href="https://github.com/kurnianggoro/GSOC2017" rel="noopener ugc nofollow" target="_blank">库尔尼昂戈罗</a> <br/> <a class="ae ka" href="https://github.com/sacchitchadha" rel="noopener ugc nofollow" target="_blank">萨奇特·查达</a> <br/> <a class="ae ka" href="https://github.com/tensorflowlagos" rel="noopener ugc nofollow" target="_blank">滕索福拉格斯</a></p><p id="a2fb" class="pw-post-body-paragraph jb jc hi je b jf jg jh ji jj jk jl jm kb jo jp jq kc js jt ju kd jw jx jy jz hb bi translated">感谢阅读！</p></div></div>    
</body>
</html>