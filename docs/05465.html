<html>
<head>
<title>Train your Deep Neural Network in Azure VM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Azure VM中训练你的深度神经网络</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/train-your-deep-neural-network-in-azure-vm-2bdc418405f8?source=collection_archive---------10-----------------------#2020-04-22">https://medium.com/analytics-vidhya/train-your-deep-neural-network-in-azure-vm-2bdc418405f8?source=collection_archive---------10-----------------------#2020-04-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/a2c3d8d67bc6bd7ed022360d1a95b7f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kpnWumRLRRcKFleYbaRLsQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://www.pexels.com/@willpicturethis?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <strong class="bd iv">威廉·乔奎特</strong> </a>发自<a class="ae iu" href="https://www.pexels.com/photo/an-on-treadmill-1954524/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <strong class="bd iv">派克斯</strong> </a></figcaption></figure><p id="c4a8" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">训练深度神经网络需要高计算资源，特别是非常高端的GPU。但是建造这样一台强大的机器是非常昂贵的，而且在很多情况下是不可行的。亚马逊(Amazon)、GCP (Google)、微软(Microsoft)等云服务提供商来拯救我们了。他们在云中提供强大的虚拟机，预装了所有驱动程序和大多数流行的深度学习软件和框架，因此您无需担心自己设置任何东西。你将按小时付费，这比建造一台本地机器要便宜得多。</p><p id="eee1" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">在这篇文章中，我将指导你在Azure中创建一个虚拟机(VM)来训练AI模型。</p><h1 id="6693" class="ju jv hi bd iv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">Azure帐户</h1><p id="44f3" class="pw-post-body-paragraph iw ix hi iy b iz kr jb jc jd ks jf jg jh kt jj jk jl ku jn jo jp kv jr js jt hb bi translated">您首先需要一个Azure帐户。如果你还没有帐户，注册Azure。你将获得30天免费的200美元信用额度来试用所有不同的Azure服务。或者，如果你是一名学生，并且有一个学术电子邮件，你可以注册“<a class="ae iu" href="https://azure.microsoft.com/en-us/free/students/" rel="noopener ugc nofollow" target="_blank"> Azure for Student </a>”优惠活动，该活动将为你提供为期1年的100美元免费积分。你将被收取虚拟机，所以你需要有一些信贷。</p><h1 id="fd55" class="ju jv hi bd iv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">Azure CLI</h1><p id="be4b" class="pw-post-body-paragraph iw ix hi iy b iz kr jb jc jd ks jf jg jh kt jj jk jl ku jn jo jp kv jr js jt hb bi translated">我们将使用Azure CLI(命令行界面)来创建和使用虚拟机。Azure CLI可在您的Azure门户网站的web浏览器中访问，或通过此<a class="ae iu" href="https://shell.azure.com" rel="noopener ugc nofollow" target="_blank">链接</a>，或从您的终端(Linux、Mac)、命令提示符和powershell (Windows)访问。如果您想从终端、cmd或powershell使用它，您需要首先在您的计算机中安装它。</p><p id="3466" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">如果您习惯使用浏览器中的CLI，您可以跳过安装步骤，但对我来说，这种体验是滞后的，所以我更喜欢从终端使用它。</p><p id="9ae3" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">对于Linux，运行以下命令(仅针对Ubuntu 16.04+和Debian 8+进行验证。如果它在您的发行版中不起作用，请尝试来自<a class="ae iu" href="https://docs.microsoft.com/en-us/cli/azure/install-azure-cli-apt?view=azure-cli-latest" rel="noopener ugc nofollow" target="_blank">官方文档</a>的手动安装说明</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="7bc7" class="lf jv hi lb b fi lg lh l li lj">curl -sL <a class="ae iu" href="https://aka.ms/InstallAzureCLIDeb" rel="noopener ugc nofollow" target="_blank">https://aka.ms/InstallAzureCLIDeb</a> | sudo bash</span></pre><p id="af9c" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">对于Windows，打开powerShell并运行以下命令，</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="c1a4" class="lf jv hi lb b fi lg lh l li lj">Invoke-WebRequest -Uri <a class="ae iu" href="https://aka.ms/installazurecliwindows" rel="noopener ugc nofollow" target="_blank">https://aka.ms/installazurecliwindows</a> -OutFile .\AzureCLI.msi; Start-Process msiexec.exe -Wait -ArgumentList '/I AzureCLI.msi /quiet'; rm .\AzureCLI.msi</span></pre><p id="f747" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">安装完成后重新启动powershell以使用Azure CLI。</p><p id="ba93" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">对于Mac来说，</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="d8ba" class="lf jv hi lb b fi lg lh l li lj">brew update &amp;&amp; brew install azure-cli</span></pre><p id="b7f6" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">安装完成后，在您的终端/cmd/powershell中运行下面一行来登录。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="ad95" class="lf jv hi lb b fi lg lh l li lj">az login</span></pre><h1 id="5d6f" class="ju jv hi bd iv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">正在创建虚拟机</h1><p id="6d7c" class="pw-post-body-paragraph iw ix hi iy b iz kr jb jc jd ks jf jg jh kt jj jk jl ku jn jo jp kv jr js jt hb bi translated">你可以创建任何运行Windows或Linux的虚拟机，但最好的方法是在Azure上使用DSVM(数据科学虚拟机)映像，因为它会预装所有必要的机器学习工具，所以你不必担心任何事情。我们将在这里使用DSVM映像。</p><p id="308c" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi lk translated"><span class="l ll lm ln bm lo lp lq lr ls di"> 1 </span>打开你的终端/命令提示符/powerShell/Azure CLI。我们将在当前工作目录下创建一个名为“<em class="lt"> parameter_file.json </em>”的<em class="lt"> json </em>文件。使用你喜欢的任何文本编辑器(VS Code，Sublime，Atom，nano等)创建文件。这里，我使用的是VS代码(它也可以在“浏览器”环境中使用)。为了打开当前目录中的VS代码，我将运行下面的命令，</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="7510" class="lf jv hi lb b fi lg lh l li lj">code .</span></pre><p id="a4e3" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi lk translated"><span class="l ll lm ln bm lo lp lq lr ls di"> 2 </span>将下面的代码保存在<em class="lt"> json </em>文件中。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="cc3a" class="lf jv hi lb b fi lg lh l li lj">{ <br/>  "$schema": "<a class="ae iu" href="https://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#" rel="noopener ugc nofollow" target="_blank">https://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#</a>",<br/>  "contentVersion": "1.0.0.0",<br/>  "parameters": {<br/>     "adminUsername": { "value" : "&lt;Your username here&gt;"},<br/>     "adminPassword": { "value" : "&lt;Create a PASSWORD for user&gt;"},<br/>     "vmName": { "value" : "&lt;your vm name, unique&gt;"},<br/>     "vmSize": { "value" : "A proper size from the list"},<br/>  }<br/>}</span></pre><p id="ef4c" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">相应地编辑“adminUsername”、“adminPssword”、“vmName”和“vmSize”的值(删除“”)。例如，在本文的其余部分，我将使用虚拟机名称“azuretestvm925”。想用什么就用什么。密码必须至少包含一个大写字母、一个数字和一个符号字符。</p><p id="08c3" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">“vmSize”很重要。这定义了您希望虚拟机拥有多少资源(CPU、RAM、存储、GPU)。检查此<a class="ae iu" href="https://docs.microsoft.com/en-us/azure/virtual-machines/linux/sizes" rel="noopener ugc nofollow" target="_blank">列表</a>并根据您的需要选择尺寸。对于基于GPU的虚拟机，我选择“Standard_NC6”大小，这是基本大小。请记住，不同的尺寸当然价格不同。价格可以查看这个<a class="ae iu" href="https://azure.microsoft.com/en-us/pricing/details/virtual-machines/linux/" rel="noopener ugc nofollow" target="_blank">链接</a>。以下是包含所有值的代码示例。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="38bc" class="lf jv hi lb b fi lg lh l li lj">{ <br/>  "$schema": "<a class="ae iu" href="https://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#" rel="noopener ugc nofollow" target="_blank">https://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#</a>",<br/>  "contentVersion": "1.0.0.0",<br/>  "parameters": {<br/>     "adminUsername": { "value" : "nazmul"},<br/>     "adminPassword": { "value" : "Secretpassword1#"},<br/>     "vmName": { "value" : "azuretestvm925"},<br/>     "vmSize": { "value" : "Standard_NC6"},<br/>  }<br/>}</span></pre><p id="f60e" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi lk translated">接下来，我们需要创建一个资源组。但是首先我们需要选择一个区域来创建组。地域很重要。并非所有区域都具有我们在步骤2中定义的所有虚拟机大小。因此，您需要选择一个具有您之前定义的vmSize的区域。例如，我将“vmSize”选择为“Standard_NC6”。英国南部是拥有这种vmSize的地区之一。所以我会把地点选在英国南部。要获得位置名称的列表，请运行下面一行。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="6510" class="lf jv hi lb b fi lg lh l li lj">az account list-locations -o table</span></pre><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/145bebc8a98292b2119c72e176a27069.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*A6ts0YKw0meU9tbaxOI3kQ.png"/></div></figure><p id="add1" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">从最右边的列中选择适当的名称。然后运行以下命令，</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="6d3a" class="lf jv hi lb b fi lg lh l li lj">az group create --location uksouth --name deep-learning-dsvm</span></pre><p id="7148" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">将“uksouth”替换为您选择的位置名称。“deep-learning-dsvm”是我正在创建的资源组的名称，你可以给它取别的名字。</p><p id="00b1" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi lk translated">现在，我们将在我们的资源组中创建我们的虚拟机。运行以下命令，</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="cea9" class="lf jv hi lb b fi lg lh l li lj">az deployment group create --resource-group deep-learning-dsvm --template-uri https://raw.githubusercontent.com/Azure/DataScienceVM/master/Scripts/CreateDSVM/Ubuntu/azuredeploy.json --parameters parameter_file.json</span></pre><p id="53a9" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">如果您将资源组命名为“deep-learning-dsvm”以外的名称，请确保在“- resource-group”参数中使用该名称。</p><p id="743a" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">控制台会暂时显示<code class="du lv lw lx lb b">- Running ..</code>。当操作完成时，将显示一个JSON响应。检查字段“provisioningState”的值“Succeeded”是否如其所言。现在您有了一个正在运行的虚拟机。</p><p id="3abb" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi lk translated"><span class="l ll lm ln bm lo lp lq lr ls di"> 5 </span>我们必须打开端口22，通过ssh连接到虚拟机。所以运行下面的命令，</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="6fbd" class="lf jv hi lb b fi lg lh l li lj">az vm open-port -g deep-learning-dsvm -n <!-- -->azuretestvm925<!-- --> --port 22 --priority 900</span></pre><p id="432a" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">和往常一样，在“-g”后面使用您的资源组名称，如果您的名称不同，则使用您的vmName代替“azuretestvm925”。输出将是一个JSON响应，检查字段“provisioningState”的值是否为“Succeeded ”,以进行确认。</p><p id="4ad5" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi lk translated"><span class="l ll lm ln bm lo lp lq lr ls di"> 6 </span>为了访问虚拟机中的Jupyter笔记本并进行远程连接，我们需要打开另一个端口8888，默认情况下，该端口由Jupyter笔记本服务器使用。运行以下命令，</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="eaae" class="lf jv hi lb b fi lg lh l li lj">az vm open-port -g deep-learning-dsvm -n <!-- -->azuretestvm925<!-- --> --port 8888 --priority 901</span></pre><p id="e785" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">如果您的资源组名称和虚拟机名称不同，请更改它们。</p><h1 id="6dc6" class="ju jv hi bd iv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">连接到虚拟机</h1><p id="641a" class="pw-post-body-paragraph iw ix hi iy b iz kr jb jc jd ks jf jg jh kt jj jk jl ku jn jo jp kv jr js jt hb bi translated">现在您的VM正在运行，您可以使用安全Shell (ssh)连接到它。您需要虚拟机的公共IP地址。要首先找到IP地址，请使用正确的组名和虚拟机名运行以下命令，</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="c0a8" class="lf jv hi lb b fi lg lh l li lj">az vm list-ip-addresses -g deep-learning-dsvm -n <!-- -->azuretestvm925<!-- --> --output table</span></pre><p id="105a" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">现在使用您的用户名(在<em class="lt"> "parameter_file.json" </em>文件中定义)和IP地址登录虚拟机。例如，我将用户名定义为“nazmul ”,假设IP地址是33.165.103.23。然后，我将运行以下命令来登录虚拟机。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="6375" class="lf jv hi lb b fi lg lh l li lj">ssh nazmul@33.165.103.23</span></pre><p id="4300" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">出现提示时，输入您在<em class="lt"> "parameter_file.json" </em>文件中定义的密码。您的提示应该更改为VM，您现在所做的任何事情都将在您的VM中执行。</p><h1 id="cd11" class="ju jv hi bd iv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">启动Jupyter笔记本</h1><p id="5d3a" class="pw-post-body-paragraph iw ix hi iy b iz kr jb jc jd ks jf jg jh kt jj jk jl ku jn jo jp kv jr js jt hb bi translated">当您通过ssh登录到您的虚拟机时，运行以下命令来启动Jupyter notebook server。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="7838" class="lf jv hi lb b fi lg lh l li lj">jupyter notebook --ip=0.0.0.0 --no-browser --allow-root</span></pre><p id="1124" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">您的Jupyter服务器将启动，在控制台中，您将看到一个URL，您可以在web浏览器中浏览该URL以访问Jupyter笔记本。复制链接，粘贴到浏览器的地址栏中。如果你按下回车键，你会得到“网站无法到达”的信息。下面的格式需要稍微修改一下地址，(不要碰后面的部分:8888，只修改IP部分)</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="ca38" class="lf jv hi lb b fi lg lh l li lj">http://&lt;public IP Here&gt;:8888/?token={some token}</span></pre><p id="06d8" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">在“http://”和“:8888”之间，用您的虚拟机的公共IP(您用来ssh到您的虚拟机的IP)替换任何内容。例如，如果我们的IP地址是33.165.103.23，地址栏将如下所示，</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="85a6" class="lf jv hi lb b fi lg lh l li lj">http://33.165.103.23:8888/?token={some token}</span></pre><p id="8fed" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">现在做你想做的事。创建您自己的笔记本，训练您的模型。完成后，要退出Jypyter服务器并返回到您的提示符，请按ctrl+c(按两次跳过确认)。</p><p id="ddc4" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">请记住，<strong class="iy hj">不要在不使用虚拟机的时候让它一直运行</strong>。即使您没有使用虚拟机，也要为虚拟机的运行时间付费。阅读以下部分，了解如何正确关闭您的虚拟机，这样您就不会被收费。</p><h1 id="b525" class="ju jv hi bd iv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">使用已创建的虚拟机</h1><p id="cd51" class="pw-post-body-paragraph iw ix hi iy b iz kr jb jc jd ks jf jg jh kt jj jk jl ku jn jo jp kv jr js jt hb bi translated">您不需要在每次需要使用时都创建新的虚拟机。不用的时候可以关机，需要的时候再打开。但是有两种方法可以关闭它。一个完全按照你的要求去做，让虚拟机保持关闭，让你免受指控。另一个只是关闭虚拟机，你仍然被收费。因此，请仔细阅读以下说明。</p><p id="6ebe" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">要获取有关虚拟机的信息，请运行以下命令。“powerState”字段将为您提供vm正在运行、停止或解除分配的信息(稍后解释)。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="d19a" class="lf jv hi lb b fi lg lh l li lj">az vm show -d --name azuretestvm925 --resource-group deep-learning-dsvm --output table</span></pre><p id="8ed7" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">要停止VM，您可以运行以下命令(在命令中的-g后面使用您自己的资源组名称，在-n后面使用VM名称)，</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="07fb" class="lf jv hi lb b fi lg lh l li lj">az vm stop -g deep-learning-dsvm -n azuretestvm925</span></pre><p id="c469" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">如果您通过运行此命令关闭虚拟机，您的虚拟机将被“停止”,但资源仍将保持分配给您的虚拟机。因此，即使虚拟机被关闭，您也将被收费，因为微软仍然保留连接到您的虚拟机的资源，并且不能使用它来服务其他客户端。</p><p id="eb16" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">如果您关闭虚拟机的时间较短，并且会很快恢复，这可能会有所帮助。</p><p id="c59b" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">第二种方法是“解除分配”,这将使你免于被收费。为此，使用正确的资源组名称和虚拟机名称运行以下命令，</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="f22a" class="lf jv hi lb b fi lg lh l li lj">az vm deallocate -g deep-learning-dsvm -n azuretestvm925</span></pre><p id="7ae4" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">这将从您的虚拟机中释放资源，以便Microsoft可以使用这些资源为另一个客户端提供服务。所以你不会被起诉。</p><p id="c5f2" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">可能会要求您登录。如果是，运行<code class="du lv lw lx lb b">az login</code>并遵循屏幕上的指示。</p><p id="8daf" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">要再次打开虚拟机，请使用正确的资源组名称和虚拟机名称运行以下命令，</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="4e0b" class="lf jv hi lb b fi lg lh l li lj">az vm start -g deep-learning-dsvm -n azuretestvm925</span></pre><p id="88e8" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">您也可以从Azure门户网站停止虚拟机。导航到主页&gt;虚拟机&gt;您的虚拟机名称&gt;概述，您将看到一个停止按钮，该按钮将取消分配资源。您也可以按“开始”按钮再次运行它。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/ecde1ad91ed318f6c1873fa25e938215.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LojBaliEcf4YR_L2DdWztg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">从Azure门户管理虚拟机</figcaption></figure><p id="2a07" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="iy hj">等等！</strong>你仍然会被收费，虽然不是针对虚拟机，而是针对虚拟机中保存你的持久数据的存储。尽管这个成本非常小。但是，如果您的虚拟机中没有您以后必须使用的文件，您应该清除这些资源，这样您就不会被收取任何不必要的费用。要删除所有内容，请运行以下命令(使用正确的资源组名称)，</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="7f2b" class="lf jv hi lb b fi lg lh l li lj">az group delete --name deep-learning-dsvm</span></pre><p id="b201" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">这将删除所有内容。下次您需要训练新模型时，只需创建另一个虚拟机。</p></div></div>    
</body>
</html>