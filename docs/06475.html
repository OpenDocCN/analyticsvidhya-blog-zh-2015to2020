<html>
<head>
<title>Model Calibration — the thing that an expert may miss</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模型校准——专家可能忽略的东西</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/model-calibration-the-things-that-a-experts-may-miss-62924aef09ed?source=collection_archive---------30-----------------------#2020-05-23">https://medium.com/analytics-vidhya/model-calibration-the-things-that-a-experts-may-miss-62924aef09ed?source=collection_archive---------30-----------------------#2020-05-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7aca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">自深度学习兴起以来，大量的深度神经网络模型出现在机器学习工程师、数据科学家或研究科学家的眼前。但是似乎没有太多的人意识到这些大而深的模型所带来的风险，可靠性问题。</p><h2 id="f6ba" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">可靠性是什么？</h2><p id="e502" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">假设有一个受监督的计算机视觉模型，<strong class="ih hj"> f(x) </strong>，我们将其用于自动驾驶汽车。我们在这个模型上定义的任务是识别街道上的行人以及他们相对于摄像机的位置。</p><p id="39b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于我们在构建架构、收集数据和优化模型训练过程中做得非常好，在城市的大多数场景中，模型的准确性能够达到非常高的水平，99%。所以在自动驾驶汽车上使用，我们似乎觉得如此安全。</p><p id="4ad8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，有时我们将它用于一辆真正的自动驾驶汽车后，我们发现它的性能并不像它所说的那样好，尽管模型预测的可信度很高。这个模型的表现不如它告诉我们它所相信的那样好。</p><p id="d1ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的例子是一个典型的与监督模型的可靠性有关的问题。可靠性是关于模型置信度和模型真实性能一致性的度量。一个可靠的模型能够通过对样本的置信度来反映其真实性能。因此，我们可以通过评估模型在推理过程中的可信度来直接评估模型的可用性。这给了我们一个非常下降和有效的方法来进行这种评估。</p><h2 id="a2c9" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">可靠性图表</h2><p id="620c" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">在我们开始量化度量之前，首先我们需要构建一个可靠性图。为了构建它，我们将执行以下操作:</p><ol class=""><li id="b41f" class="kd ke hi ih b ii ij im in iq kf iu kg iy kh jc ki kj kk kl bi translated">将置信空间分成几个具有恒定间隔的箱。</li><li id="6fa3" class="kd ke hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">对测试数据运行模型，并根据它们的置信度对它们进行分配。</li><li id="d992" class="kd ke hi ih b ii km im kn iq ko iu kp iy kq jc ki kj kk kl bi translated">计算每个箱的预期精度，并将其绘制为精度与置信度。</li></ol><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es kr"><img src="../Images/cf91455a6986c1599be4600d1003f44c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ia-FW6n6SsSCeCJib0POfA.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">监督概率模型的可靠性图。左边的是校准好的，右边的不是。</figcaption></figure><p id="3eee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看一下上面的图表，左边的图表在所有置信水平上都与模型的准确性一致，而右边的图表则不能。一些样本看起来在0.8和0.9之间有很高的可信度，但是精确度只有大约0.5。这意味着模型置信度对其性能没有任何意义。</p><h2 id="a655" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">可靠性的量化测量</h2><p id="2b04" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">为了测量可靠性，一种直观的方法是将可靠性图转换为度量图，映射到实数线上。由于理想的校准模型是对角线函数，我们可以只测量可靠性空间中模型和单位函数之间的距离，作为测量模型可靠性的度量。</p><h2 id="197b" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">预期校准误差(ECE)</h2><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="er es lh"><img src="../Images/38b8cff680a49906ca8c78193266d971.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*wKWWfh-6Bl9IEZ-_SlrGNg.png"/></div><figcaption class="ld le et er es lf lg bd b be z dx translated">公式ECE，B表示可靠性图的bin</figcaption></figure><p id="3d90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种度量仅仅是找到每个箱的模型精度和置信度之间的差异，并对它们的平均值求和。</p><h2 id="01d0" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">最大校准误差(MCE)</h2><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="er es li"><img src="../Images/52285905d4a291fce3987b7fd8b28809.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*vZ8bvpVC5ZVAkeHTLMK2gg.png"/></div><figcaption class="ld le et er es lf lg bd b be z dx translated">MCE的公式。</figcaption></figure><p id="2bd4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">MCE与ECE具有相同的核心概念，但MCE对模型的校准程度更强。如果非常小，则需要对最差情况进行更多校准。</p><p id="5136" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">到目前为止，我们刚刚进入模型校准的大门，故事还没有结束。还有很多关键点需要我们展开长时间的讨论。它们将在下一篇文章中展示。</p><p id="41c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你喜欢读这篇文章，如果你有任何问题要问或想说什么，请不要犹豫鼓掌并留下你的评论。</p><p id="191d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">干杯！</p><p id="70aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参考文件:</p><p id="c11d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae lj" href="https://arxiv.org/abs/1706.04599" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/1706.04599</a></p></div></div>    
</body>
</html>