<html>
<head>
<title>Non-Binary Image Classifying CNN Tutorial (5 categories) with Keras</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">非二值图像分类CNN教程(5个类别)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/non-binary-image-classifying-cnn-tutorial-5-categories-df431449c7d5?source=collection_archive---------4-----------------------#2019-11-16">https://medium.com/analytics-vidhya/non-binary-image-classifying-cnn-tutorial-5-categories-df431449c7d5?source=collection_archive---------4-----------------------#2019-11-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ba60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有大量的数据集和教程可以用来构建二元(两类)CNN图像分类器。然而，我看不到有那么多的资源可以用3个或更多的类别对CNN进行图像分类。与二进制CNN相比，在设计非二进制图像分类CNN时有一些重要的区别。本教程将带你了解如何为一个包含3个或更多类别的数据集构建CNN。</p><p id="aa45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，让我们得到我们的数据集。令人惊讶的是，很难找到一个原始图像数据集(相当大的样本量)有超过2个类别。然而，我最终在Kaggle上找到了一个由<a class="ae jd" href="https://www.kaggle.com/alxmamaev" rel="noopener ugc nofollow" target="_blank">亚历山大·马马耶夫</a>创建的可靠的<a class="ae jd" href="https://www.kaggle.com/alxmamaev/flowers-recognition" rel="noopener ugc nofollow" target="_blank">花朵识别数据集</a>。该数据集包含属于5个不同类别的花的图像——蒲公英、雏菊、郁金香、玫瑰和向日葵。每个类别有700到1100张图片。</p><p id="ee77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然该数据集的图像已经根据类别拆分到文件夹中，但它们没有拆分到测试/训练集中。我使用了一个快速的Python脚本来完成这个任务。你可以在这里的<a class="ae jd" href="https://gist.github.com/colleenDunlap/69b5cfe04a64339ef7d2191b9a9f6d6f" rel="noopener ugc nofollow" target="_blank">查看剧本。</a></p><p id="f260" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在来发展我们的CNN。我的模型的轮廓看起来像这样</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="b422" class="jn jo hi jj b fi jp jq l jr js">1. Input Convolution Layer, take in 32x32 size images, generate 32 3x3 feature maps<br/>2. Dropout Layer (to prevent Overfitting)<br/>3. Max Pooling Layer (Picks strongest features in feature map)<br/>4. Full Connection/ANN Layers (one with 1,024 units, another with 512 units, both with relu activation function)<br/>5. Output Layer (softmax function)</span></pre><p id="215a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个直观的展示。我们得到我们的图像数据矩阵，生成多个特征图，并从这些特征图中汇集。然后，我们将该数据“展平”成一个向量，以馈入我们的人工神经网络/全连接层。然后，我们有一个输出层，包含图像属于我们的5个类别的概率。</p><figure class="je jf jg jh fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es jt"><img src="../Images/22d976aa444c68d90d39d8a27ecc06e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RTLE7RYQW_qhorsVPispNw.png"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx translated"><a class="ae jd" href="https://adeshpande3.github.io/A-Beginner%27s-Guide-To-Understanding-Convolutional-Neural-Networks/" rel="noopener ugc nofollow" target="_blank">图片来源此处</a></figcaption></figure><p id="d4f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在来看代码。首先，让我们导入我们的依赖关系，并设置我们的卷积层。</p><figure class="je jf jg jh fd ju er es paragraph-image"><div class="er es kf"><img src="../Images/b568a6881df268d0c70db2b429348077.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*JSly6ju1SAy8bIotK-AOgw.png"/></div></figure><figure class="je jf jg jh fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es kg"><img src="../Images/3aaeeb1a5367a80605b6c2161dbb031b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*tV7iArTSIG7hqXU1c8uH7w.png"/></div></div></figure><p id="c75c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们的辍学层。我将它设置为10%，以防止过度拟合我们的模型。</p><figure class="je jf jg jh fd ju er es paragraph-image"><div class="er es kh"><img src="../Images/fd4ee7e0fff184290dd507462a24de58.png" data-original-src="https://miro.medium.com/v2/resize:fit:490/format:webp/1*QJ8BBUpKEd-4SBUpfhOOGA.png"/></div></figure><p id="be34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我们使用Max Pooling和flatten进行池化，以准备要传递给ANN层的数据</p><figure class="je jf jg jh fd ju er es paragraph-image"><div class="er es ki"><img src="../Images/6eb5f4f19faec6c56b276f1162377cf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*x-2HZQO3SlPWNCxdE82T1A.png"/></div></figure><p id="0eae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们创建我们的“完全连接”我为我们的人工神经网络使用了两层——一层取1024个单位，第二层取512个单位。然后，是我们的输出层，一个“softmax”函数，其中节点的数量等于类别的数量(在我们的例子中是5)。</p><figure class="je jf jg jh fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es kj"><img src="../Images/b4886736cc9f14476e8d01e4c1a3e853.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*76RuZAWkHnzMNlJ2B7No0w.png"/></div></div></figure><p id="72d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们设置图像数据生成器。这来自我们的测试和训练数据所在的目录，并为我们创建图像数据以用作模型的输入。在原始数据集中，图像大约为200x200像素。为了速度和防止过度拟合，我们将减少这个值。</p><figure class="je jf jg jh fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es kk"><img src="../Images/23af90ed68070bab1294f7fe852e8438.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sUH5p8SNfAwlc70b_JYajw.png"/></div></div></figure><p id="a4f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们训练我们的模型。我选定了10个时期，每个时期50步。你可以摆弄这些数字，看看这对你的准确度有什么影响。</p><figure class="je jf jg jh fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es kl"><img src="../Images/1c7623782be24b33db291db34d5c853d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*evvynwy2kMhcTZ-jW12Bzg.png"/></div></div></figure><p id="a839" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从这里，我们可以验证我们的模型的准确性，并绘制模型的准确性和训练时间的损失。</p><figure class="je jf jg jh fd ju er es paragraph-image"><div class="er es km"><img src="../Images/1be09d5abeb9d6d1ac6824c35ad73c8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*nOU3hZ0hZ4WRLzBM-2sHGg.png"/></div></figure><figure class="je jf jg jh fd ju er es paragraph-image"><div class="er es kn"><img src="../Images/c400181d86f7747f540682ea6d40fb1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*O6XOmkJl2LMtYxts3uzVgA.png"/></div></figure><figure class="je jf jg jh fd ju er es paragraph-image"><div class="er es ko"><img src="../Images/33b5a5af47753e598c58951a7fe4c9bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*HLkv506ymAKDE-YsoL5EsA.png"/></div></figure><p id="95cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后我们可以在单个图像上运行该模型，并查看结果！</p><figure class="je jf jg jh fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es kp"><img src="../Images/965e770ebbff71f2425f31d84604363f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zNppUZLiXwkzvoUx-yKjMw.png"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">成功了！结果[0][0]是图像是雏菊的概率(索引为0，因为雏菊是我们列出的第一个类别)</figcaption></figure><p id="c0b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在你知道了！没那么糟吧。现在你可以扩展这个方法来拥有你想要的任意多的类别！如果你有足够的数据质量和数量，它甚至会是准确的:D</p><p id="af4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有什么问题吗？评论？赞美的话？让我在下面的评论中知道❤</p></div></div>    
</body>
</html>