<html>
<head>
<title>ROC Curve, AUC value — Significance of thresholds and what do they really mean on the model performance?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ROC曲线、AUC值——阈值的显著性以及它们对模型性能的真正意义？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/roc-curve-auc-value-significance-of-thresholds-and-what-do-they-really-mean-on-the-model-723039baf35c?source=collection_archive---------6-----------------------#2020-03-03">https://medium.com/analytics-vidhya/roc-curve-auc-value-significance-of-thresholds-and-what-do-they-really-mean-on-the-model-723039baf35c?source=collection_archive---------6-----------------------#2020-03-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1c62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每个数据科学家/数据科学爱好者都会遇到ROC(受试者操作特征)曲线和AUC(曲线下面积)的概念及其在评估模型质量中的适用性。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/d84ea113110f6e30a42e3aa3f19d0357.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rGItsMtgjPJvpXnsJ0sQlQ.jpeg"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">理解是理想的src:<a class="ae jp" href="https://agurlblog.wordpress.com/2016/06/12/understanding-is-ideal/" rel="noopener ugc nofollow" target="_blank">https://agurlbog . WordPress . com/2016/06/12/understanding-is-ideal/</a></figcaption></figure><p id="70fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有许多博客和教程详细解释了它们。但是我总是对它与模型质量的相关性以及如何使用它们来选择正确的模型有疑问。它们不像准确度/F1分数那样简单，我总是觉得我错过了它的关键目的。在这篇文章中，我想解决这个问题，并与我的读者分享什么是ROC曲线和AUC值，以及如何使用它来评估模型。</p><p id="20b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> ROC曲线——受试者工作特性</strong></p><p id="e90e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">-定义和公式</p><p id="9fd3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有许多博客描述了ROC曲线、其公式及其背后的理论科学。所以我不打算在这上面花时间。有关有用的参考资料，请参考本文的参考资料部分。</p><p id="677c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">样本数据</strong></p><p id="0f0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们考虑“欺诈检测”问题的二进制分类结果作为我们的数据集，并参考本文中使用的数据和python笔记本的这个<a class="ae jp" href="https://github.com/VVasanth/MachineLearning/tree/master/ROCCurve" rel="noopener ugc nofollow" target="_blank">链接</a>。我们不会担心算法是什么，预测模型是如何建立的。假设预测模型已经建立，并且您已经用测试数据测试了该模型，并获得了结果。</p><p id="ac2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用以下数据计算ROC和AUC指标，并解释FPR(假阳性率)、TPR(真阳性率)等的显著性。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jq"><img src="../Images/db4292cf4684ebf4bf43e347770c460a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H7WSnFcpJDp2bNj8pT_YrA.jpeg"/></div></div></figure><p id="6adc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是数据汇总:</p><p id="ef65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">→结果文件包含大约1900条记录</p><p id="eb0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">→实际值出现在“True_Class”栏下</p><p id="c5f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">→二进制分类的预测值出现在“预测类”栏下。</p><p id="1cdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">→分类函数的预测概率值出现在“预测_概率”栏下</p><p id="4f4e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文的其余部分，我们将使用这些数据进行ROC、AUC计算。</p><p id="0148" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">预测概率的显著性:</strong></p><p id="6f9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大多数分类算法基于定义的概率阈值来确定预测值是否为真/假。Scikit-learn库默认将概率阈值视为“0.5”，当其值大于0.5时，预测为真，当值小于0.5时，预测为假。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jv"><img src="../Images/606db5e1009a5917fc2a19c553729f7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uQVWZB_V6Dt7_rqCTJg4mA.jpeg"/></div></div></figure><p id="c772" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但总是没必要把预测概率当成0.5。阈值可以设置为任何有助于我们更好地对结果进行分类的值。尤其是对于与高度不平衡的数据或异常检测相关的问题，处理阈值将有助于提高准确性。</p><p id="e385" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">混淆矩阵，FPR，TPR计算:</strong></p><p id="d148" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们计算阈值为0.5的结果的FPR、TPR和混淆矩阵值，结果如下所示:</p><p id="71c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如您所观察到的，考虑到真实类的概率阈值为0.5，该预测的准确性约为79.2%。TP、FP、TN和FN值分别为485、286、1043和115，如混淆矩阵所示。</p><p id="27f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们计算上述结果的FPR和TPR(阈值为0.5):</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jw"><img src="../Images/bfba624775df976ffc8cb34109c87afe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rzY692akWsZRyuYqg4kHDQ.png"/></div></div></figure><p id="6c4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">TPR = TP/(TP+FN)= 485/(485+115)= 0.80</p><p id="54ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">FPR = FP/(TN+FP)= 286/(1043+286)= 0.21</p><p id="3bb2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们用不同的阈值(比如0.6)重复相同的练习，观察混淆矩阵、TPR和FPR值如何变化。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jx"><img src="../Images/f92416721655af2e4dfb40b6c929bb86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jy2c0HZgny6-OzQ0TPQDxw.png"/></div></div></figure><p id="9082" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如您所观察到的，对于真实类的概率阈值0.6，该预测的准确性已经下降到79.2%。TP、FP、TN和FN值分别为677、94、307和851，如混淆矩阵所示。</p><p id="bf52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们计算上述结果的FPR和TPR(阈值为0.6)，几乎没有任何变化:</p><p id="c653" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">TPR = TP/(TP+FN)= 677/(677+307)= 0.68</p><p id="a3c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">FPR = FP/(TN+FP)= 307/(307+851)= 0.26</p><p id="b94c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，ROC曲线是我们将结果的TPR和FPR值相对于不同阈值绘制的曲线。</p><p id="2693" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Scikit learn library在提供不同阈值方面做得非常好，并为我们简化了FPR、TPR计算。</p><p id="4c74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于数据集，我们的ROC曲线如下所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jy"><img src="../Images/41015303ec058636f677a6e38a2b06f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f41x68MQtek0Zim5tL8bGA.png"/></div></div></figure><p id="d342" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一般来说，ROC曲线的理想值是(0，1)，从图中，我们需要确定更接近点(0，1)的“TPR”/“FPR”值，并可以确定相应的“阈值”值作为“概率阈值”。在上述情况下，黑色圆圈点是更接近理想值的点，因此对应于该点的阈值是这种情况下的最佳概率阈值。</p><p id="5e7b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">综上所述，考虑到FPR和TPR值的变化，ROC曲线有助于您确定问题的正确阈值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jq"><img src="../Images/4b97301318e0d1ef57f088f79eb5b9d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_n48CYkgfsdAy1XV1tdcWQ.jpeg"/></div></div></figure><p id="e2d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">给定问题的阈值选择基于假阳性和假阴性值之间的权衡。比如烟雾预测系统——以更大的假阳性(预测烟雾，当没有烟雾时)为代价，拥有更少假阴性(当有烟雾时，预测没有烟雾)的系统是更优选的。因为有更高的假阴性，将对人们的健康产生影响，通常最好是为更差的天气做好准备，当它不是。因此，数据科学家必须考虑问题的性质来确定最佳阈值。</p><p id="783c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">AUC——曲线下面积</strong></p><p id="ad7b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们谈到ROC时，不提到AUC，对它的讨论就永远不会结束。</p><p id="cee5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如您所观察到的，ROC主要是确定给定“模型”结果的最佳概率阈值。它通过一个单一的模型来计算FPR和TPR对于所提供结果的不同阈值。</p><p id="9758" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设您有多个模型为您提供不同的结果，您需要从给定的批次中识别出性能最佳的模型。这就是你要使用AUC的地方。</p><p id="c953" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">AUC提供了模型整体性能的总结，并提供了描述其整体性能的质量分数。AUC值越高，模型越好。</p><p id="93a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您有多个模型的AUC，那么您可以通过比较AUC值来确定哪个模型是最好的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jz"><img src="../Images/786686eb23b59f93214b89b0be311d9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*aXDNc2mlW_m-tABW-EcrAQ.jpeg"/></div></figure><p id="cddc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就其本身而言，它没有任何意义。然而，假设您有两个模型的预测结果，一个值为0.96，另一个值为0.88，那么您可以确定AUC较高的模型更适合您的数据。</p><p id="78f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参考资料:</p><div class="ka kb ez fb kc kd"><a href="https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5" rel="noopener follow" target="_blank"><div class="ke ab dw"><div class="kf ab kg cl cj kh"><h2 class="bd hj fi z dy ki ea eb kj ed ef hh bi translated">理解AUC - ROC曲线</h2><div class="kk l"><h3 class="bd b fi z dy ki ea eb kj ed ef dx translated">在机器学习中，性能测量是一项基本任务。所以说到分类问题，我们可以…</h3></div><div class="kl l"><p class="bd b fp z dy ki ea eb kj ed ef dx translated">towardsdatascience.com</p></div></div><div class="km l"><div class="kn l ko kp kq km kr jj kd"/></div></div></a></div><div class="ka kb ez fb kc kd"><a href="https://machinelearningmastery.com/roc-curves-and-precision-recall-curves-for-classification-in-python/" rel="noopener  ugc nofollow" target="_blank"><div class="ke ab dw"><div class="kf ab kg cl cj kh"><h2 class="bd hj fi z dy ki ea eb kj ed ef hh bi translated">如何在Python -机器学习中使用ROC曲线和精确召回曲线进行分类…</h2><div class="kk l"><h3 class="bd b fi z dy ki ea eb kj ed ef dx translated">在分类问题中，预测一个观察值属于每一类的概率会更加灵活…</h3></div><div class="kl l"><p class="bd b fp z dy ki ea eb kj ed ef dx translated">machinelearningmastery.com</p></div></div><div class="km l"><div class="ks l ko kp kq km kr jj kd"/></div></div></a></div></div></div>    
</body>
</html>