<html>
<head>
<title>Unreasonable Effectiveness of fast.ai</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">fast.ai 不合理的有效性</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/unreasonable-effectiveness-of-fast-ai-8f44fd1b0a41?source=collection_archive---------21-----------------------#2020-07-30">https://medium.com/analytics-vidhya/unreasonable-effectiveness-of-fast-ai-8f44fd1b0a41?source=collection_archive---------21-----------------------#2020-07-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/38e1cb3cd01af5b4dfcce58eb8284e43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WZSyUYH1Pxre7Nhv"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">塞萨尔·卡利瓦里诺·阿拉贡在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="ec9a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你和我一样吗？开始非常热衷于实现一个想法或模型，然后陷入了与<a class="ae iu" href="https://pytorch.org/" rel="noopener ugc nofollow" target="_blank"> PyTorch </a>、<a class="ae iu" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> Tensorflow </a>或<a class="ae iu" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>的库问题。混淆了哪些损失流过，你计算梯度的目的是什么？不要担心，因为<a class="ae iu" href="https://www.fast.ai/" rel="noopener ugc nofollow" target="_blank"> fast.ai </a>会保护你。</p><p id="dcf7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">很多天来，我从来没有真正想要深入研究 fast.ai 的文档，我总是低估了库只是一个工具，它涵盖了大部分细节，不支持“真正的研究”。我一直认为，对于初学者来说，用 4-5 行构建 SOTA 模型是一种看起来很酷的简单方法。</p><p id="ba26" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">昨天，我听了莱克斯·弗里德曼和杰瑞米·霍华德的播客。我可以理解他的许多想法，然后考虑再给它一次机会。当我今天尝试使用 fast.ai 实现一个简单的二进制分类模型时，我所有的假设都改变了。</p><p id="0cfb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我使用了<a class="ae iu" href="https://www.kaggle.com/sammy123/lower-back-pain-symptoms-dataset" rel="noopener ugc nofollow" target="_blank">脊柱数据集</a>，这是一个不错的数据集，需要简单的预处理和基本的网络建模。我的首选库一直是<a class="ae iu" href="https://pytorch.org/" rel="noopener ugc nofollow" target="_blank">py torch</a>；动态计算图非常灵活和直观。我必须编写大量样板代码来读取数据并成批加载，然后编写自己的训练循环，fast.ai 通过最佳实践自动完成所有这些部分，例如<a class="ae iu" href="https://docs.fast.ai/callbacks.one_cycle.html#The-1cycle-policy" rel="noopener ugc nofollow" target="_blank">一个周期训练</a>并使用<a class="ae iu" href="https://docs.fast.ai/basic_train.html#lr_find" rel="noopener ugc nofollow" target="_blank"> find_lr </a>找到最佳学习率。在这篇博客中，我将带你了解开发过程和结果</p><h1 id="adba" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">安装</h1><p id="5e6b" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">fastai 库依赖于 PyTorch 库，需要安装一个工作的 Torch。最好只是创造一个新的康达环境，以避免任何冲突。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="038b" class="lf ju hi lb b fi lg lh l li lj">conda create --name fastai<br/>conda activate fastai<br/>conda install -c pytorch -c fastai fastai</span></pre><p id="bf1d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它们还提供了一种使用<strong class="ix hj"> pip 进行安装的方法。</strong>要了解详情，关于这个你可以参考<a class="ae iu" href="https://github.com/asvskartheek/Spine-Dataset#setting-up" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><h1 id="974b" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">资料组</h1><p id="75d3" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">你可以在这里找到数据集<a class="ae iu" href="https://www.kaggle.com/sammy123/lower-back-pain-symptoms-dataset" rel="noopener ugc nofollow" target="_blank"/>，我希望我能提供一个 shell 脚本来下载它，但是<a class="ae iu" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>没有提供一个简洁的方法来做到这一点。解压缩下载的 zip 文件，您将获得一个数据集文件。</p><h1 id="7b74" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">预处理</h1><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="c680" class="lf ju hi lb b fi lg lh l li lj">df = pd.read_csv('Dataset_spine.csv')<br/>df.drop('Unnamed: 13',axis=1,inplace=True) # Drop useless feat</span><span id="4318" class="lf ju hi lb b fi lk lh l li lj">df['Class_att'] = df['Class_att'].astype('category')<br/>encode_map = {  'Abnormal': 1,  'Normal': 0}<br/>df['Class_att'].replace(encode_map, inplace=True)  # 1 HotEncoding</span><span id="9cb9" class="lf ju hi lb b fi lk lh l li lj">X = np.array(df.iloc[:, 0:-1]).astype(np.float64) # Features<br/>y = np.array(df.iloc[:, -1]).astype(np.float64) # Labels</span></pre><h1 id="50d3" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">模型</h1><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="19c9" class="lf ju hi lb b fi lg lh l li lj">class BinaryClassification(nn.Module):    <br/>  def __init__(self,input_feats,hidden_size):<br/>    super(BinaryClassification, self).__init__()<br/>    self.layer_1 = nn.Linear(input_feats, hidden_size)<br/>    self.layer_out = nn.Linear(hidden_size, 1)<br/>    self.relu = nn.ReLU()<br/>    self.sigmoid = nn.Sigmoid()</span><span id="3252" class="lf ju hi lb b fi lk lh l li lj">def forward(self, inputs):<br/>    x = self.relu(self.layer_1(inputs))<br/>    x = self.layer_out(x)<br/>    x = self.sigmoid(x)<br/>    return x</span></pre><h1 id="f831" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">训练循环</h1><p id="905b" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">训练循环是最好的部分，不再需要 model.backward()、model(x)和数十行代码来训练模型，不再需要样板代码。(看着你，PyTorch..)</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="1634" class="lf ju hi lb b fi lg lh l li lj">learner.fit_one_cycle(n_epochs, lr)<br/>learner.save('model')</span></pre><p id="bdb3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">看看代码有多可爱就知道了。我太喜欢 fast.ai 了</p><h2 id="759f" class="lf ju hi bd jv ll lm ln jz lo lp lq kd jg lr ls kh jk lt lu kl jo lv lw kp lx bi translated">骗局</h2><p id="a631" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">不要对 fast.ai 撒谎，它也不是玫瑰人生，文档也不是很清楚，尤其是对于 import 语句。我不得不挣扎一下，就一点点。</p><h1 id="f437" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">食品新闻</h1><p id="eb75" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">好消息，你不用再做了。我已经完成并发布了框架库，您可以在未来的项目中使用它。它对您使用的体系结构和数据集具有响应性和灵活性。我将发布整个代码库，里面有清晰的说明。</p><p id="9c7b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你所要做的只是分叉它，并在 model.py 文件中更改数据集和模型架构。事不宜迟，下面是到存储库的<a class="ae iu" href="https://github.com/asvskartheek/Training-Framework" rel="noopener ugc nofollow" target="_blank">链接。如果你喜欢，那就开始吧，关注我。README 有所有的说明，如果你有任何意见和想法，打开一个问题，我很乐意讨论或在下面留下评论。</a></p></div></div>    
</body>
</html>