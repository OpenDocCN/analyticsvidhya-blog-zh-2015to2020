<html>
<head>
<title>Few Shot Learning — A Case Study (2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">少数镜头学习——案例研究(2)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/few-shot-learning-a-case-study-2-805f5642acaf?source=collection_archive---------22-----------------------#2020-06-14">https://medium.com/analytics-vidhya/few-shot-learning-a-case-study-2-805f5642acaf?source=collection_archive---------22-----------------------#2020-06-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f758" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<a class="ae jd" rel="noopener" href="/@patel.maitreya57/few-shot-learning-a-case-study-1-d71eb06a33df">之前的博客</a>中，我们研究了为什么少投学习是必要的，以及它的应用是什么。在这篇文章中，我将以最简单的方式解释少镜头分类(尤其是图像分类)的关系网络。此外，我将从以下方面分析关系网络:</p><ol class=""><li id="1e7d" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">不同架构的有效性，如剩余网络和初始网络</li><li id="5849" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">ImageNet数据集上预训练分类器对迁移学习的影响</li></ol><p id="3fa4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，有效性将根据准确性、培训所需的时间以及所需培训参数的数量进行评估。</p><p id="724f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请观看<a class="ae jd" href="https://github.com/Maitreyapatel/Few-Shot-Learning-A-Case-Study" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>来检查实现并通过进一步的实验保持更新。</p><h1 id="d77f" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">少数镜头分类介绍</h1><p id="3407" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">在少镜头分类中，我们的目标是设计一种方法，可以通过分析同一类的少量样本图像来识别任何目标图像。让我们举一个例子来理解这一点。假设Bob有一个客户项目，要设计一个5类分类器，其中5类可以是任何东西，这5类甚至可以随时间变化。正如在以前的博客中所讨论的，收集大量的数据是非常繁琐的任务。因此，在这种情况下，Bob将依赖于少数镜头分类方法，其中他的客户可以为每个类别给出几组示例图像，之后他的系统可以在需要或不需要额外训练的情况下对这些示例执行分类。</p><p id="7dd3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通常，在少数镜头分类中，使用四个术语(N路、K镜头、支持集和查询集)。</p><ol class=""><li id="c018" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated"><strong class="ih hj"> N种方式:</strong>这意味着我们将使用总共N个类进行训练/测试，就像上面例子中的5个类。</li><li id="c9cf" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj"> K shot: </strong>这里，K表示在训练/测试期间，我们只有K个示例图像可用于每个类别。</li><li id="878d" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">支持集:</strong>它代表来自每个类的所有可用K个示例图像的集合。因此，在支持集中，我们总共有N*K个图像。</li><li id="9357" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">查询集:</strong>该集将包含我们想要预测其各自类别的所有图像。</li></ol><p id="37f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这一点上，对这个概念不熟悉的人会对支持和查询集的需求产生疑问。所以，我们来直观的了解一下。每当人类第一次看到任何物体时，我们都会对该物体有一个大致的了解。现在，将来如果我们第二次看到同一个物体，我们会将它与我们第一次看到它时存储在内存中的图像进行比较。这适用于我们周围的一切事物，无论是我们看到的、读到的还是听到的。类似地，为了从查询集中识别新图像，我们将为我们的模型提供一组示例，即支持集以进行比较。</p><p id="c5fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这也是关系网络背后的基本概念。在接下来的部分中，我将给出关系网络背后的粗略想法，并且我将在102朵花的数据集上进行不同的实验。</p><h1 id="a426" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">关于关系网络</h1><p id="2a6f" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">关系网络背后的核心思想是使用支持集来学习每个类的广义图像表示，以便我们可以将查询图像的低维表示与每个类表示进行比较。并且基于该比较来决定每个查询图像的类别。关系网络有两个模块，允许我们执行上述两项任务:</p><ol class=""><li id="51b6" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated"><strong class="ih hj">嵌入模块:</strong>该模块将从每个输入图像中提取所需的底层表示，而不考虑它们的类别。</li><li id="4399" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><strong class="ih hj">关系模块:</strong>该模块将对查询图像的嵌入与每一类嵌入的关系进行评分。</li></ol><p id="e640" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">培训/测试程序:</strong></p><p id="12e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以用5个步骤来定义整个过程。</p><ol class=""><li id="266d" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">使用支持集并使用嵌入模块获得每个图像的底层表示。</li><li id="ec8e" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">取每个类图像之间的平均值，并获得每个类的单一底层表示。</li><li id="515b" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">然后获得每个查询图像的嵌入，并将它们与每个类的嵌入连接起来。</li><li id="0cbb" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">使用关系模块获得分数。并且具有最高分数的类将是相应查询图像的标签。</li><li id="bcf7" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">[仅在训练期间]使用MSE损失函数来训练两个(嵌入+关系)模块。</li></ol><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es kv"><img src="../Images/4568db04331983bb984c531e913af404.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*w7cO3p5YufOhqdEQQE3npw.gif"/></div></div></figure><p id="b680" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在培训期间需要知道的几件事是，我们将只使用来自选择性类集合的图像，而在测试期间，我们将使用来自看不见的类的图像。例如，从102朵花的数据集，我们将使用50%的类进行训练，其余的将用于验证和测试。而且每集我们会随机选取5个类来创建支持和查询集，按照上面的5个步骤来做。</p><p id="f568" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是所有需要知道的关于实现的观点。虽然整个过程简单易懂，但我还是会推荐阅读已经发表的研究论文，<a class="ae jd" href="https://arxiv.org/abs/1711.06025" rel="noopener ugc nofollow" target="_blank">学习比较:少拍学习的关系网络，</a>更好理解。</p><h1 id="d7fe" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">结果和分析</h1><p id="0f0a" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">初始实验是针对5路和1/3/5/10镜头分类问题进行的。此外，本文中描述的相同架构也用于这两个模块。每个历元后的验证准确度图表如下所示。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es lh"><img src="../Images/02e5d7dcb75d14ca132c080582496821.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*Pqx1P9B3RhBV92HQwsZtbg.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx translated">n路-验证集上的K次射击精度</figcaption></figure><p id="cc05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上图中，我们可以观察到，对于单镜头分类，我们获得了几乎50 %的准确性，这是非常好的，因为我们只使用了一张图像进行比较。此外，我们可以观察到，通过将K从1增加到10，我们变得更加精确。</p><p id="4472" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有人可能会问，什么类型的架构将有助于提高性能。例如基于Inception和ResNet的体系结构已经显示出对于分类任务的优异性能。因此，为了扩展这个分析，我在嵌入模块中使用了Inception和ResNet。下图显示了1/5镜头分类的修改结果。</p><div class="kw kx ky kz fd ab cb"><figure class="lm la ln lo lp lq lr paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><img src="../Images/f77d5dc7412c2b51b95ea4a1cdb137c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*kSdT2x1GAUFVGx0-KCXQBg.png"/></div></figure><figure class="lm la ln lo lp lq lr paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><img src="../Images/b7b0a28679c9ad5b4654624315474ae9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*3u0GJCyV8DbL1b5Wx8VyrA.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx ls di lt lu translated">左:右:5路1枪</figcaption></figure></div><p id="829a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们可以观察到基于先启的模型表现得相当好，并且显示了大约10%的改进。此外，精确度的增加量随着K的增加而减少。然而，我们可以观察到，与基线相比，基于ResNet的架构表现不佳。Inception性能更好的原因是它可以在单层中提取不同稀疏度的特征，因为在每层中使用不同大小的核来提取稀疏特征。</p><p id="543b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，一个有迁移学习策略经验的人可能会怀疑它是否能改善结果或至少在更短的时间内获得类似的表现。上图还显示了该实验的结果，其中使用了预训练的DenseNet161。这里，我们可以观察到，基于迁移学习的模型在开始时表现很差，并且花费太多时间来获得足够好的准确度，而不管k的值如何。</p><p id="e95f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，下表显示了计算复杂性和训练模型所需的时间。在观察了每一个细节之后，我们可以说基于先启的关系网络总是一个更好的选择。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lv"><img src="../Images/5f5be2cb79da5584695dd1ef25203e78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C3_loLKyXo_zVLsT6zow3Q.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">* *训练完毕唱GTX 1070ti。和时间量会根据不同的系统而变化。</figcaption></figure><h1 id="3a66" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">结论</h1><p id="6bd2" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">以下是需要记住的几点结论:</p><blockquote class="lw lx ly"><p id="4571" class="if ig lz ih b ii ij ik il im in io ip ma ir is it mb iv iw ix mc iz ja jb jc hb bi translated">关系网络主要依靠嵌入模块来提取每幅图像的相关底层表示。</p><p id="d7b3" class="if ig lz ih b ii ij ik il im in io ip ma ir is it mb iv iw ix mc iz ja jb jc hb bi translated">基于初始的嵌入模块由于能够提取稀疏特征而表现良好。</p><p id="cf86" class="if ig lz ih b ii ij ik il im in io ip ma ir is it mb iv iw ix mc iz ja jb jc hb bi translated">当应用时间约束时，基于迁移学习的嵌入模块确实表现得足够好，因为这些模型仅出于分类目的而被训练，而不是提取少量镜头分类所需的图像的较低维度表示。</p></blockquote></div><div class="ab cl md me gp mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="hb hc hd he hf"><p id="d21b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关于上述所有实验的实现以及不同的结果图在<a class="ae jd" href="https://github.com/Maitreyapatel/Few-Shot-Learning-A-Case-Study" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中提供。</p><p id="0541" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下周我将为文本分类任务实现相同的关系网络。此外，我将分析不同的策略，以了解相同的所需嵌入。使用基于BERT的嵌入及其实现的初步结果可以在相同的GitHub存储库中找到，以供早期参考。</p><p id="5f18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">敬请期待！</strong>订阅<a class="ae jd" href="https://maitreyapatel.github.io/blog-home.html" rel="noopener ugc nofollow" target="_blank">此处</a>获取即将发布的新文章通知，跟上当前的研究趋势。</p></div><div class="ab cl md me gp mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="hb hc hd he hf"><h1 id="9772" class="js jt hi bd ju jv mk jx jy jz ml kb kc kd mm kf kg kh mn kj kk kl mo kn ko kp bi translated">参考资料:</h1><ol class=""><li id="ee14" class="je jf hi ih b ii kq im kr iq mp iu mq iy mr jc jj jk jl jm bi translated">宋，洪水，杨永信，张丽，向涛，菲利普HS托尔，和蒂莫西m。"学习比较:少量学习的关系网络."在<em class="lz">IEEE计算机视觉和模式识别会议记录</em>，第1199–1208页。2018.</li><li id="db02" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">塞格迪，克里斯蒂安，文森特·万霍克，谢尔盖·约菲，乔恩·施伦斯和兹比格涅夫·沃伊纳。"重新思考计算机视觉的初始架构."在<em class="lz">IEEE计算机视觉和模式识别会议记录</em>中，第2818–2826页。2016.</li><li id="bb4e" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">何、、、任、。"图像识别的深度剩余学习."在<em class="lz">IEEE计算机视觉和模式识别会议记录</em>中，第770–778页。2016.</li></ol></div></div>    
</body>
</html>