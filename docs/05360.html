<html>
<head>
<title>How did I predict customer churn before it knocked on my door?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在客户来敲门之前，我如何预测客户流失？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-did-i-predict-customer-churn-before-it-knocked-on-my-door-958ade92232b?source=collection_archive---------32-----------------------#2020-04-18">https://medium.com/analytics-vidhya/how-did-i-predict-customer-churn-before-it-knocked-on-my-door-958ade92232b?source=collection_archive---------32-----------------------#2020-04-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/dd8e4da784369d76f106e08a28525a0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cJL1VaY_GTGyC_SiY5DlhA.jpeg"/></div></div></figure><h1 id="f0cd" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">介绍</h1><p id="187e" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">Sparkify是一个虚拟音乐流媒体服务，旨在让听众体验更好，无论你的计划是什么，我们的产品都会伤害这种体验，为此，我们需要知道客户是否想在不久的将来流失，然后我们可以采取适当的决定来避免这种情况，今天我写这篇文章向你展示我是如何根据用户历史在用户流失发生之前预测用户流失的。</p><p id="92fd" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">在这个项目中，我遵循了这个过程:</p><ul class=""><li id="020f" class="kr ks hi jq b jr km jv kn jz kt kd ku kh kv kl kw kx ky kz bi translated">数据探索和清理。</li><li id="bfe7" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">特征工程和数据转换。</li><li id="399f" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">模型训练、改进和评估。</li></ul><p id="e14e" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">解决问题，实现项目目标。</p></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><h1 id="9d8f" class="iq ir hi bd is it lm iv iw ix ln iz ja jb lo jd je jf lp jh ji jj lq jl jm jn bi translated">数据探索</h1><h2 id="531e" class="lr ir hi bd is ls lt lu iw lv lw lx ja jz ly lz je kd ma mb ji kh mc md jm me bi translated">概观</h2><p id="9cdb" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">首先，这些数据得到了<a class="ae mf" href="https://www.udacity.com/course/data-scientist-nanodegree--nd025" rel="noopener ugc nofollow" target="_blank"> DSND </a>的支持，包含了一个大约(12GB)的良好数据集，但为了验证这个概念，我们使用了整个数据集的一个很小的子集(128MB)，使用<a class="ae mf" href="https://spark.apache.org/docs/latest/api/python/index.html" rel="noopener ugc nofollow" target="_blank"> Pyspark </a>来构建机器学习管道，并创建ETL。</p><p id="95ed" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">要开始加载数据，我们需要创建spark sessions，然后加载Sparkify跟踪用户活动的数据，记录还包含收听会话、艺术家、歌曲、持续时间、用户信息，包括一些人口统计数据和访问的页面，下面我们可以找到数据方案的初始视图和预期值的样本。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/943614830b1b6ce69525a10d0fbc119d.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*b4gkWpQHD4RG5NvBIA_9Ig.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[1]数据集方案</figcaption></figure><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/08d6a568eb37ccdabb06326bb72b8556.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*Zk8EHRiuojsD8mCJmvHTgw.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[2]数据集值示例</figcaption></figure><h2 id="7f95" class="lr ir hi bd is ls lt lu iw lv lw lx ja jz ly lz je kd ma mb ji kh mc md jm me bi translated">数据清理</h2><ul class=""><li id="82d7" class="kr ks hi jq b jr js jv jw jz mq kd mr kh ms kl kw kx ky kz bi translated"><strong class="jq hj">空值</strong></li></ul><p id="90be" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">处理空值是任何数据集清理阶段的基本操作，在这里，我研究了空值并在许多列中发现了它们。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/e7130c5ea4f2288a89b13a9356680413.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/1*H7Iyyr4lfs5WQOA0Mw5iSA.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[3]数据集中空值的平均值</figcaption></figure><p id="a755" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">但我总结成两种类型:—</p><p id="a749" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">I. ID列空值，如“userId”和“sessionId”。</p><p id="3194" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">二。非ID列为空值，如“艺术家”和“长度”。</p><p id="0a2c" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">对于ID列，最常见的决定是删除，因为您不知道这些数据具体指的是谁，但是对于其他列，我们可以在以后基于特性状态做出决定。</p><ul class=""><li id="38e2" class="kr ks hi jq b jr km jv kn jz kt kd ku kh kv kl kw kx ky kz bi translated"><strong class="jq hj">日期时间格式</strong></li></ul><p id="70fd" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">另一个常见的清理步骤是日期-时间列的格式化，它通常不是以人类可读的格式进行格式化的，因此我们需要以一种良好的方式对它们进行格式化，或者根据我们遵循的分析方法将它们提取到多个特征中，在我们的例子中，我们格式化这些列，并将它们拆分为“事件时间”、“注册时间”和“事件小时”，我们将在稍后的特征工程步骤中使用它们。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/dfcd7e55d15b043b27cffe43b02308a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OEBsfNXSKoJu9zMsc4VA7A.png"/></div></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[4]处理后的日期时间列</figcaption></figure><h2 id="e227" class="lr ir hi bd is ls lt lu iw lv lw lx ja jz ly lz je kd ma mb ji kh mc md jm me bi translated">定义流失</h2><p id="cf39" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated"><strong class="jq hj">什么时候顾客可以被定义为被搅动？</strong></p><p id="8a26" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">一旦用户点击了<code class="du mv mw mx my b">cancellation confirmation</code>页面，出现在用户日志中的活动就可以被定义为来自我们服务的流失，而不再出现在日志中。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es mz"><img src="../Images/6e60ab22ad1dbb944888e67254385271.png" data-original-src="https://miro.medium.com/v2/resize:fit:264/format:webp/1*FPjAaXaZXodjeaZJ8QG3lw.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[5]流失用户数</figcaption></figure><p id="fdfb" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">看了一下这个因素后，我们发现225个用户中有52个是被搅动的用户，所以我们需要将他们标记为被搅动的用户，并深入了解他们自注册服务以来的活动，并从我们在下面探索的一些方面来看:</p><p id="ac46" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj"> 1。性别之间的变动模式:</strong></p><p id="66e6" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">除了一种性别之外，还有其他性别可能会发生变动吗？</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es na"><img src="../Images/f30ba4bf5f0124132d527cd998e850a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*aSNcUCVQyTnGIWm61WySZA.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[6]不同性别的流失人数</figcaption></figure><blockquote class="nb nc nd"><p id="56ec" class="jo jp ne jq b jr km jt ju jv kn jx jy nf ko kb kc ng kp kf kg nh kq kj kk kl hb bi translated">男性顾客比女性顾客更容易流失。</p></blockquote><p id="0b5e" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj"> 2。用户计划类型和翻腾:</strong></p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es ni"><img src="../Images/807d41f17527a0da17cfa7bcf36285e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*pPsftpFlZIze30dRR6Xq-g.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[6]每个用户计划的搅拌</figcaption></figure><blockquote class="nb nc nd"><p id="a354" class="jo jp ne jq b jr km jt ju jv kn jx jy nf ko kb kc ng kp kf kg nh kq kj kk kl hb bi translated">客户流失通常发生在当客户使用免费计划时，他们可能觉得没有义务继续使用该服务</p></blockquote><p id="7c1e" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj"> 2。报名以来的听课活动:</strong></p><p id="7b8c" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj"> A .收听歌曲数量</strong></p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nj"><img src="../Images/14afd60c6e94178de8601e5cae2ab248.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*zsmSO2IShD8-ernXznJlTg.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[7]每个用户和性别类型的流媒体歌曲数量</figcaption></figure><p id="782e" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj"> B .竖起大拇指数歌曲数</strong></p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nk"><img src="../Images/1cbb0201aa05dddc9982f3dc842f2f88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*zivXAZDaR4ev3FXXm6620w.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[8]每个用户和性别类型的拇指上行歌曲数</figcaption></figure><blockquote class="nb nc nd"><p id="b653" class="jo jp ne jq b jr km jt ju jv kn jx jy nf ko kb kc ng kp kf kg nh kq kj kk kl hb bi translated">顾客一生中听过的歌曲无论是喜欢的还是只是听过的，变化都不大。</p></blockquote><p id="f2b6" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj"> 4。每次会话的歌曲活动</strong></p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nl"><img src="../Images/4bb88bb6bec9c1fe6ca3b885d38b2e4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*Fu1o_29RVACukqku9uSbFQ.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[9]每个用户类型的活动会话计数</figcaption></figure><blockquote class="nb nc nd"><p id="fcb4" class="jo jp ne jq b jr km jt ju jv kn jx jy nf ko kb kc ng kp kf kg nh kq kj kk kl hb bi translated">忠诚的用户比不忠诚的用户在服务上花费更多的时间</p></blockquote><p id="b0ce" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj"> 5。翻唱的用户比没翻唱的用户听歌多吗？</strong></p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nm"><img src="../Images/0f913e6dca51ee6af3cea8aaedce4667.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*GBmc3NlN-1R4mM3XGV3hZA.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[10]听歌对喝醉的用户很重要</figcaption></figure><blockquote class="nb nc nd"><p id="bf87" class="jo jp ne jq b jr km jt ju jv kn jx jy nf ko kb kc ng kp kf kg nh kq kj kk kl hb bi translated">没喝醉的用户比喝醉的用户听更多的歌</p></blockquote><p id="19ab" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj"> 6。一天中除了其他时段，还有其他时段有活动吗？</strong></p><figure class="mh mi mj mk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nn"><img src="../Images/a8361e0deafff2d0c477eab24157237f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nglWv_e9zWyqDM2SjjMmqQ.png"/></div></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[11] 24小时歌曲活动</figcaption></figure><blockquote class="nb nc nd"><p id="045a" class="jo jp ne jq b jr km jt ju jv kn jx jy nf ko kb kc ng kp kf kg nh kq kj kk kl hb bi translated">白天比晚上更活跃。</p></blockquote></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><h1 id="20b2" class="iq ir hi bd is it lm iv iw ix ln iz ja jb lo jd je jf lp jh ji jj lq jl jm jn bi translated">特征工程</h1><p id="6e9d" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">特征工程步骤将集中于为模型训练寻找有前途的特征，并且将关注以下特征:</p><p id="e112" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj"> 1。播放的歌曲总数</strong></p><p id="6543" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">用户听的歌曲越多，花在我们服务上的时间越多，用户参与度就越高，流失的机会就越少。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es no"><img src="../Images/703fee23b5d51a68ede915f8b252252d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*R16kLuA6NWoIpE1zzXORrg.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[12]关于总歌曲播放特征的统计</figcaption></figure><p id="ddba" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj"> 2。账户寿命</strong></p><p id="aaa7" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">自用户注册以来的时间长度。它可以反映用户参与度和忠诚度。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es np"><img src="../Images/ecab4d85a03b5b862d5eaa8b2ed90b8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*F1YffLa0HP0bLHcRqn9Zjg.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[13]关于寿命特征的统计</figcaption></figure><p id="1a42" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj"> 4。总收听时间</strong></p><p id="19d4" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">它在检测用户活动并将其分成许多功能方面非常有用。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nq"><img src="../Images/c6f50b4c25c0ae1a0b8e139917a53f07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*MRSaXKRx3MF7ikiRPrkiHQ.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[14]关于listen_time特性的统计数据</figcaption></figure><p id="5a59" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj"> 5。每位用户的平均会话歌曲数</strong></p><p id="b874" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">每个会话的歌曲数量将用户在长时间活动(如工作或只是小会话)中使用服务进行分类。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nr"><img src="../Images/7fe8900bce5727180e3eb4dd34923293.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*EM6ARR1HG973OARVOlDb3A.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[15]关于avg_session_songs_user特征的统计</figcaption></figure><p id="07ab" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">6。拇指向上/向下的总数</p><p id="386f" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">它们可能反映了两个方面，我们的服务质量和用户参与度。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es et"><img src="../Images/f7358e9ff948e69042cb10b6c69f08fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DQIP6KtmjMTKOjsni9HWXw.png"/></div></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[16]关于拇指向上和拇指向下数字特征的统计</figcaption></figure><p id="c0ed" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj"> 7。添加到播放列表的歌曲总数</strong></p><p id="7ea8" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">将歌曲添加到列表中可以帮助推荐和发现用户的口味，并改善用户体验，这可能在搅动中起作用。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es ns"><img src="../Images/11e566d973a46a8202f897f15cbf78d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*5QfA92FZBNfR5og2yPYO8w.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图17是关于添加到播放列表特征的统计</figcaption></figure><p id="2caf" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">最后，在将这些特征结合在一起之后，我们添加流失标签，以获得将成为我们模型的基本特征的这个方案。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nt"><img src="../Images/3ae34930054c27236a52e0c4214447fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*HzUA4d2E3ftakj-l210lvQ.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[18]准备引入模型的最终方案</figcaption></figure><p id="92d6" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">然后，我们应用3个步骤来完成数据处理，以引入培训阶段:</p><p id="47f7" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj">一、特征矢量化:</strong>使用<em class="ne"> VectorAssembler将目标列从特征列中分离出来。</em></p><p id="3537" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj">二。标准化数值特征:</strong>通过取平均值并除以每个特征的标准差。</p><p id="3e56" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj">三。数据分割:</strong>将数据分为训练、验证和测试集，分别为60%、20%和20%，如下所示。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nu"><img src="../Images/272d6f338f0a8bdbfc7f62139a44ae10.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*RxfYj5yBRkZSs0WJVCzstA.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[19]数据分割汇总</figcaption></figure></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><h1 id="0c35" class="iq ir hi bd is it lm iv iw ix ln iz ja jb lo jd je jf lp jh ji jj lq jl jm jn bi translated">建模</h1><h2 id="4ff9" class="lr ir hi bd is ls lt lu iw lv lw lx ja jz ly lz je kd ma mb ji kh mc md jm me bi translated">培养</h2><p id="429d" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">训练阶段的重点是通过交叉验证(5重)将训练数据传递给一些分类器，这里是初始训练的总结，可以很容易地观察到第一个模型(基础模型)和最后一个模型之间的巨大差异，通过<a class="ae mf" href="https://towardsdatascience.com/accuracy-precision-recall-or-f1-331fb37c5cb9" rel="noopener" target="_blank"> F1-score </a>指标，我们选择该指标作为本项目中验证集的评估指标。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nv"><img src="../Images/6b68a851bf191083969574db1701497b.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*5Ohg_Nib2J5mXM7vNJZCRg.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[20]训练模型比较(分数和时间)</figcaption></figure><h2 id="92e3" class="lr ir hi bd is ls lt lu iw lv lw lx ja jz ly lz je kd ma mb ji kh mc md jm me bi translated">选择和提炼</h2><p id="b001" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我们确实关心时间资源，由于数据大小仍然相对较小，并且性能差异巨大，我们将更喜欢性能最好的模型。因此，我们选择<strong class="jq hj">梯度增强树(GBT) </strong>模型作为最终使用的模型，并进行网格搜索，这次通过研究具有相同折叠数的GBT模型上的<code class="du mv mw mx my b">maxDepth</code>和<code class="du mv mw mx my b">maxIter</code>特征来微调我们的模型，并使用F1得分度量来评估它们。</p><h2 id="97c1" class="lr ir hi bd is ls lt lu iw lv lw lx ja jz ly lz je kd ma mb ji kh mc md jm me bi translated">估价</h2><p id="5e90" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在模型调优之后，我们发现<code class="du mv mw mx my b">maxDepth=5</code>和<code class="du mv mw mx my b">maxIter=20</code>是我们模型的最佳参数，在验证集上得到0.9 F1分，在测试集上得到0.71分。</p><h1 id="e573" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">结论</h1><p id="70e9" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">作为时间序列事件数据提供的数据详细说明了用户在使用Sparkify服务时的活动，但用户流失是一个大问题，data science通过<strong class="jq hj">根据事件数据预测将流失的用户来解决此类问题，</strong>我们遵循<a class="ae mf" href="https://www.sv-europe.com/crisp-dm-methodology/" rel="noopener ugc nofollow" target="_blank"> CRISP-DM </a>方法来解决此问题，并获得了一个良好的模型，在验证集上的得分为0.9 F1-得分，比我们的原始基础模型的0.56有所提高，并观察到了我们模型所基于的一些可靠功能。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nw"><img src="../Images/47b8883503dece92f44e3ad04f31ff7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*pQvo3aJqFJ5EnBPHtaJHGA.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">图[21]选择的模型特征重要性分数</figcaption></figure><p id="60b5" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">从上面的图表中，我们可以很容易地观察到这些特征是最重要的特征，它们可以决定用户在未来的预期行为:</p><ul class=""><li id="9553" class="kr ks hi jq b jr km jv kn jz kt kd ku kh kv kl kw kx ky kz bi translated">喜欢/不喜欢的歌曲总数。</li><li id="a3be" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">帐户生存期。</li><li id="34a8" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">在单个会话中或一般情况下播放的歌曲数量。</li></ul><p id="8d59" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj">改进</strong></p><p id="7afd" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">在考虑更多因素、添加更多功能后，功能可以得到很大改善，但随着用户群的增长，我们可以使用更多数据来获得更好的结果。</p><p id="ae81" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">目前，我们有一部分独立用户，我们只使用其中的60%进行培训。也就是说，如果样本量增加，模型有很大的改进潜力，预期性能也会提高。</p><p id="0bbd" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">最后，如果你对这个分析的细节很好奇，想深入了解，请不要犹豫，直接进入我的<a class="ae mf" href="https://github.com/DevMahmoud10/Sparkify" rel="noopener ugc nofollow" target="_blank"> <em class="ne"> GitHub </em> </a> <em class="ne"> repo。</em></p></div></div>    
</body>
</html>