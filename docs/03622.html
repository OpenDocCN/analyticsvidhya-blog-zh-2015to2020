<html>
<head>
<title>How to Train Your ResNet: The Jindo Dog</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何训练你的ResNet:珍岛狗</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-train-your-resnet-the-jindo-dog-50551117381d?source=collection_archive---------7-----------------------#2020-02-11">https://medium.com/analytics-vidhya/how-to-train-your-resnet-the-jindo-dog-50551117381d?source=collection_archive---------7-----------------------#2020-02-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="0785" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">用ResNet-50卷积神经网络实现图像分类的转移学习、Grad-CAM和其它技术</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/82bbd947a81256e753bb35771df29aff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q1wF8Wbk1KhFZYdLG2aXlA.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">《小森林》，Yim Soon-rye，2018。</figcaption></figure><p id="ab5f" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在本文中，我们将讨论<em class="kj">卷积神经网络</em>、<em class="kj">转移学习</em>、<em class="kj">瓶颈特性</em>、<em class="kj"> Grad-CAM </em>和<em class="kj">t-分布式随机邻居嵌入</em>。一大堆听起来很聪明的花哨词。通俗地说，我们将试验一种图像识别算法，并尝试让它识别它没有经过训练识别的东西:<a class="ae kk" href="https://en.wikipedia.org/wiki/Korean_Jindo" rel="noopener ugc nofollow" target="_blank">珍岛犬</a>。我们还将研究一种有助于理解算法决策的技术，以及另一种将相似图像分组在一起的技术。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kl"><img src="../Images/9af3a90b9c8938acb871deac3e7d63c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YAUsgI8hJWJGw0SvnSdVKw.jpeg"/></div></div></figure><p id="9242" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">该实验的代码和可视化可在此处获得<a class="ae kk" href="https://github.com/thierrylaplanche/DogBreedClassifier" rel="noopener ugc nofollow" target="_blank"/>:<a class="ae kk" href="https://github.com/thierrylaplanche/DogBreedClassifier/blob/master/DogBreedClassifier-1-Collecting%20images.ipynb" rel="noopener ugc nofollow" target="_blank">收集图像</a> / <a class="ae kk" href="https://github.com/thierrylaplanche/DogBreedClassifier/blob/master/DogBreedClassifier-2-Pretrained%20model.ipynb" rel="noopener ugc nofollow" target="_blank">预训练模型</a> / <a class="ae kk" href="https://github.com/thierrylaplanche/DogBreedClassifier/blob/master/DogBreedClassifier-3-Transfer%20learning.ipynb" rel="noopener ugc nofollow" target="_blank">迁移学习和Grad-CAM </a> / <a class="ae kk" href="https://github.com/thierrylaplanche/DogBreedClassifier/blob/master/DogBreedClassifier-4-Similarity%20search.ipynb" rel="noopener ugc nofollow" target="_blank">瓶颈特征和相似性搜索</a> / <a class="ae kk" href="https://github.com/thierrylaplanche/DogBreedClassifier/blob/master/DogBreedClassifier-5-Deployment%20to%20Google%20AI%20Platform.ipynb" rel="noopener ugc nofollow" target="_blank">部署到Google AI平台</a></p></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><h1 id="ad39" class="kt ku hi bd kv kw kx ky kz la lb lc ld io le ip lf ir lg is lh iu li iv lj lk bi translated">A.介绍ResNet-50和珍岛狗</h1><p id="669d" class="pw-post-body-paragraph jn jo hi jp b jq ll ij js jt lm im jv jw ln jy jz ka lo kc kd ke lp kg kh ki hb bi translated">研究人员已经用尽了大量的计算能力来训练将图像分类的深度神经网络。许多人都在ImageNet的一个子集上接受了训练(一个包含1400万张图像的庞大数据库，人工标记了超过22，000个类别)，作为<a class="ae kk" href="http://www.image-net.org/challenges/LSVRC/" rel="noopener ugc nofollow" target="_blank"> ImageNet大规模视觉识别挑战</a> (ILSVRC)的一部分，该挑战自2010年开始以来，每年都有很大的改进(该挑战于2017年结束)。每个实现<a class="ae kk" href="https://www.pyimagesearch.com/2017/03/20/imagenet-vggnet-resnet-inception-xception-keras/" rel="noopener ugc nofollow" target="_blank">在架构和性能</a>方面都有所不同，但都是我们所说的“卷积神经网络”(CNN)，这是一种深度学习网络，在检测图像特征方面具有出色的性能。</p><p id="e87f" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">幸运的是，这些预先训练好的模型已经被<a class="ae kk" href="https://keras.io/applications/" rel="noopener ugc nofollow" target="_blank">提供给任何人使用</a>进行实验，节省了我们从头开始训练的时间和费用。其中，<a class="ae kk" href="https://arxiv.org/pdf/1512.03385.pdf" rel="noopener ugc nofollow" target="_blank"> ResNet-50 </a>(代表“残差网络”)是速度和精度之间的一个很好的折中。</p><p id="b266" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">与为ImageNet challenge开发的其他模型一样，ResNet-50在分布于<a class="ae kk" href="http://image-net.org/explore?wnid=n02084071" rel="noopener ugc nofollow" target="_blank">1000个类别</a>的100多万张图像上进行了训练。其中包括不少于189个品种的狗，从Affenpinscher到Weimaraner(两个德国品种)，但与国际犬业联合会(FCI)认可的344个品种相差甚远。</p><p id="e958" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">ImageNet数据库中缺失的品种包括:珍岛犬，FCI注册的编号为334 ，这是一种斯皮兹猎犬，原产于朝鲜半岛西南海岸的珍岛。根据皇家犬科犬的说法，珍岛犬大胆、勇敢、机警、细心、格外忠诚，而且“不易动心”。</p><p id="cb95" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">那么，当ResNet-50看到一个Jindo时，它看到了什么？我们用几张图试试。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lq"><img src="../Images/2e89554396b672364de8b0ff6e419d49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*brsYEf39_5p62J4Y44WoKA.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">ResNet-50对珍岛犬图片的前2名预测</figcaption></figure><p id="888c" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">显然，它(还)没有看到一个进道。在接受测试的115张照片中，24张被归类为“爱斯基摩狗”，20张被归类为“澳洲野狗”，13张被归类为“库瓦斯”，一种匈牙利品种。看看那些狗，它们确实有一些相似之处。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lr"><img src="../Images/13198b544f6d1ce7ae4f6e3038af21c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V42ZYAmcEYDgNhoblvE1CQ.jpeg"/></div></div></figure></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><h1 id="6555" class="kt ku hi bd kv kw kx ky kz la lb lc ld io le ip lf ir lg is lh iu li iv lj lk bi translated">B.迁移学习:ResNet-50遇上珍岛狗</h1><p id="1d2f" class="pw-post-body-paragraph jn jo hi jp b jq ll ij js jt lm im jv jw ln jy jz ka lo kc kd ke lp kg kh ki hb bi translated">如果有一种方法可以教会ResNet-50模型识别Jindo狗(或任何其他未经训练识别的品种)，而无需重新训练整个模型，这将需要下载100多万张图像并花费数天或数月来训练，会怎么样？</p><p id="1d3c" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这就是迁移学习的用武之地。<a class="ae kk" href="https://towardsdatascience.com/transfer-learning-from-pre-trained-models-f2393f124751" rel="noopener" target="_blank">迁移学习</a>是一种方法，它利用通过在大规模数据集上训练的模型获得的<em class="kj">通用知识</em>，仅使用有限数量的新数据来开发更为<em class="kj">的特定于任务的知识</em>。虽然一般知识用于检测图像中的低级特征，如边缘和曲线，但特定任务知识使模型能够识别更高级的特征，如耳朵、鼻子或口鼻的形状，并最终区分不同的狗品种。</p><p id="3906" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">通用知识在CNN的下层形成(靠近输入图像)，而特定知识在上层增长，靠近分类器(输出)，如下图所示，该图摘自Anirudh Koul、Siddha Ganju和Meher Kasam (O'Reilly，2019)的《云、移动和边缘的实用深度学习》<em class="kj">。</em></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ls"><img src="../Images/5030f46999bbda39a2d97a72eceb3a2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jrupDnFdjxbmxhDmGKjq5w.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">CNN概述(<a class="ae kk" href="https://learning.oreilly.com/library/view/practical-deep-learning/9781492034858/" rel="noopener ugc nofollow" target="_blank">在此阅读本书</a>)</figcaption></figure><p id="d21a" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">如前所述，ResNet-50模型能够识别总共1，000个类别。这是通过模型的最后和最顶层(输出层)由正好1000个节点(或神经元)组成的事实来实现的，每个节点输出图像属于某个类别的概率。</p><p id="8cfa" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">现在，我们如何教ResNet-50一个新的类别，例如Jindo狗？虽然只需在该层中添加第1001个神经元并向网络提供一些新类别的图片会很方便，但这在实践中是不可能的。分类器部分需要在代表每个类别的一小组数据上完全重新训练。(为了获得更好的结果，如果我们有足够的图像用于每个类，我们也可以重新训练一些卷积层。我们就是这么做的)。</p><p id="5e4d" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">总而言之，我们必须:</p><ul class=""><li id="715d" class="lt lu hi jp b jq jr jt ju jw lv ka lw ke lx ki ly lz ma mb bi translated">用新类别的一个附加神经元重新创建顶层(分类器),</li><li id="4f42" class="lt lu hi jp b jq mc jt md jw me ka mf ke mg ki ly lz ma mb bi translated">重新训练上层，不仅要有珍岛犬的图片，还要有其他品种的图片，最好数量相近，以避免<a class="ae kk" href="https://machinelearningmastery.com/what-is-imbalanced-classification/" rel="noopener ugc nofollow" target="_blank">等级失衡</a>。</li></ul><p id="aca1" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">为了方便我们的任务，我们从<a class="ae kk" href="https://github.com/udacity/deep-learning-v2-pytorch/tree/master/project-dog-classification" rel="noopener ugc nofollow" target="_blank"> Udacity的GitHub库</a>下载了一个<a class="ae kk" href="https://s3-us-west-1.amazonaws.com/udacity-aind/dog-project/dogImages.zip" rel="noopener ugc nofollow" target="_blank">数据集</a>。它包含了133个品种的8351张图片。我们还在Google Images和Naver Images上收集了珍岛狗的图片。训练过程(重新训练ResNet-50模型的前8层，加上新的分类器部分)在配备单个GPU的机器上花费了一个多小时。</p><p id="b104" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">现在，让我们使用之前尝试过的同一组图像来测试我们微调过的模型。以下图片在培训期间没有使用，因此模型第一次看到它们:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mh"><img src="../Images/b833f3994710d33185b9b76dda7d416e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DCtqs8yvv1IPXb5ewtgf8w.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">微调ResNet-50对珍岛犬图片的前2名预测</figcaption></figure><p id="d394" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在10张测试图片中，7张被正确分类为Jindo，1张被正确分类为Akita，1张被正确分类为Norwegian Buhund，1张被正确分类为Canaan，所有这些图片都来自‘Spitz’犬家族。Jindo甚至是3张错误分类图片中的2张的第二个猜测。不错的成绩！</p><p id="e089" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">当然，这种模式也适用于其他品种:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mi"><img src="../Images/087e5553997e0e4fdf25d8a9cfd28349.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GkRzrxvkoUd-AUWBC1s2wA.jpeg"/></div></div></figure><p id="2af9" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">对于非类别品种:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mj"><img src="../Images/2848c1601293c1ecf24d7f4a83a4f64d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dDqWy_maO4j4zguxkVCTVA.jpeg"/></div></div></figure></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><h1 id="7d1e" class="kt ku hi bd kv kw kx ky kz la lb lc ld io le ip lf ir lg is lh iu li iv lj lk bi translated">C.你在看什么？</h1><p id="a756" class="pw-post-body-paragraph jn jo hi jp b jq ll ij js jt lm im jv jw ln jy jz ka lo kc kd ke lp kg kh ki hb bi translated">一个很酷的实验是可视化图像的哪些部分对模型将图像分类到某个类别的决定有最大的影响。这是“可解释的人工智能”的技术之一，人工智能的一个领域，旨在解释由“智能”系统做出的决定。随着越来越多的人工智能用例影响人们的生活(从调整保险费到处理工作申请)，依赖这些方法的企业正在为自己的决策负责。</p><p id="46fe" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在计算机视觉领域，研究神经网络“黑匣子”的一种方法是使用<a class="ae kk" href="https://arxiv.org/abs/1610.02391" rel="noopener ugc nofollow" target="_blank"> Grad-CAM </a>，这是一种通过突出显示图像中的重要区域来提供CNN类型模型预测的视觉解释的技术。</p><p id="d55e" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">假设你要训练一个模型去识别西伯利亚哈士奇，你的训练图大部分背景都是雪。存在模型学习等式“雪=西伯利亚哈士奇”并将任何背景中有雪的狗图片归类为西伯利亚哈士奇的风险。计算Grad-CAM可以确保图像的分类是有充分理由的。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mk"><img src="../Images/30efc420b5a9d79e0f6de00c7627e9cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*LAdfsjnQfKf37q0kQk8Y3A.jpeg"/></div></figure><p id="3657" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在上图中，Grad-CAM应用于网络的最后一个卷积层。第一个例子表明，模型正在关注狗本身，而不是场景中的其他对象。在第二个例子中，有趣的是看到模型主要在看眼睛周围的区域。在其他情况下，它将是枪口或耳朵。</p></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><h1 id="9f94" class="kt ku hi bd kv kw kx ky kz la lb lc ld io le ip lf ir lg is lh iu li iv lj lk bi translated">D.瓶颈特征:ResNet-50剥离</h1><p id="044d" class="pw-post-body-paragraph jn jo hi jp b jq ll ij js jt lm im jv jw ln jy jz ka lo kc kd ke lp kg kh ki hb bi translated">CNN中卷积层的作用是从图像中提取特征:低层(靠近输入端)的低层特征，如边缘和曲线，高层(靠近输出端)的高层特征，如物体的形状。</p><p id="b097" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">如果我们通过剥离其最顶层分类层的模型来提取最后一个卷积层的输出，我们会得到一个抽象的数字向量(通常是0到1之间的浮点值)图像表示。例如，ResNet-50模型的最后一个卷积层为每个图像输出一个大小为7x7x2048的矩阵，然后通过一个<a class="ae kk" href="https://machinelearningmastery.com/pooling-layers-for-convolutional-neural-networks/" rel="noopener ugc nofollow" target="_blank">全局平均池</a>操作对7x7切片进行平均，将该矩阵缩减为2048维向量。这就是<em class="kj">特征向量</em>。</p><h2 id="7317" class="ml ku hi bd kv mm mn mo kz mp mq mr ld jw ms mt lf ka mu mv lh ke mw mx lj my bi translated">1.寻找相似的图片</h2><p id="a8db" class="pw-post-body-paragraph jn jo hi jp b jq ll ij js jt lm im jv jw ln jy jz ka lo kc kd ke lp kg kh ki hb bi translated">特征向量(也称为<em class="kj">瓶颈特征</em>，因为它的维数降低了)可以与其他图像的特征向量进行比较，以找到相似的图片。实现这一点的一种方法是通过计算向量之间的欧几里德距离。相似的图片将使它们的特征向量彼此“更接近”。在Python中，我们可以使用来自<a class="ae kk" href="https://scikit-learn.org/stable/modules/neighbors.html" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a>库中的<em class="kj">最近邻</em>算法。</p><p id="1cb1" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">为我们数据集中的6，787张图像计算2048维向量用了不到一分钟的时间。如果我们保持“n”的值较低，找到向量的“n-最近邻”甚至更快。让我们看看随机选择的3张图片的结果，以及它们的3个最近的邻居和到参考图片的欧几里德距离。注意，长相相似的狗狗图片大部分时间是，但不总是，同一品种的图片。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mz"><img src="../Images/bf4476bde4574868efbc16ad827cf331.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*etbMEoLfAouypYhPR4eQLA.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">相似图片的特征向量具有较短的欧几里德距离</figcaption></figure><h2 id="0889" class="ml ku hi bd kv mm mn mo kz mp mq mr ld jw ms mt lf ka mu mv lh ke mw mx lj my bi translated">2.用t-SNE可视化图像簇</h2><p id="8fd6" class="pw-post-body-paragraph jn jo hi jp b jq ll ij js jt lm im jv jw ln jy jz ka lo kc kd ke lp kg kh ki hb bi translated">什么品种和其他品种相似？既然我们能够评估图像之间的相似程度，那么让我们试着找到相似图像的聚类。但是如何在2D屏幕上想象2048维的空间呢？这要归功于另一种算法，它还有一个奇怪的名字:<em class="kj">t-分布式随机邻居嵌入</em>。</p><p id="eea0" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">根据<a class="ae kk" href="https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding" rel="noopener ugc nofollow" target="_blank">维基百科</a>，“t-SNE是一种机器学习算法，用于在二维或三维的低维空间中可视化高维数据。它通过二维或三维点对每个高维对象进行建模，以这种方式，相似的对象通过附近的点进行建模，不相似的对象通过远处的点进行建模的概率很高”。</p><p id="e58f" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在我们的例子中，高维对象是每个具有2048维的特征向量。scikit-learn的<a class="ae kk" href="https://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html" rel="noopener ugc nofollow" target="_blank"> t-SNE算法</a>再次派上了用场。在6787幅图像上计算SNE霸王龙只需要几分钟。绘制结果产生了这幅美丽的点彩单色画:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es na"><img src="../Images/b461127913005fccc718c1105c559337.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NFxxIoYXXubHDQC-KUh0nQ.jpeg"/></div></div></figure><p id="2087" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">为了理解不同的圆圈代表什么，我们可以绘制一些相应的图像。为了实现这一点，我们从《云、移动和边缘的实用深度学习<a class="ae kk" href="https://learning.oreilly.com/library/view/practical-deep-learning/9781492034858/" rel="noopener ugc nofollow" target="_blank"> <em class="kj">一书中借用了Python代码</em> </a>。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nb"><img src="../Images/9be1e9346c5c54894ec95711990355ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Ab4pB58IciFy1BOTsvH1Q.jpeg"/></div></div></figure><p id="b378" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">重新排列图像后，我们得到了一个更清晰的画面:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nc"><img src="../Images/24ed96a22bfe90d34dbeb3728837c9f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uqP6R9SwnMxXUAx28_nX4Q.jpeg"/></div></div></figure><p id="7117" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">比熊犬(Bichon Frisés)和牛头犬(Bulldogs)处于相反的两端，这是实验取得圆满成功的标志。正如我们所料，我们的Jindo狗和更有声望的人一起出去玩。</p></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><h1 id="a7ee" class="kt ku hi bd kv kw kx ky kz la lb lc ld io le ip lf ir lg is lh iu li iv lj lk bi translated">E.微调后的ResNet-50的一些指标</h1><h2 id="ee37" class="ml ku hi bd kv mm mn mo kz mp mq mr ld jw ms mt lf ka mu mv lh ke mw mx lj my bi translated">1.预测准确度</h2><p id="0929" class="pw-post-body-paragraph jn jo hi jp b jq ll ij js jt lm im jv jw ln jy jz ka lo kc kd ke lp kg kh ki hb bi translated">对80 %的数据集进行训练，剩下20 %用于评估(验证和测试)。数据扩充用于通过自动生成图像的修改版本(应用诸如旋转、移位、缩放等变换)来扩展训练集的大小。).验证数据用于评估不同的算法参数(超参数)，测试数据用于提供模型的最终评估。</p><p id="4158" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">调整超参数(辍学率、学习率、时期数、全连接层中的神经元数)导致精确度略有提高。</p><ul class=""><li id="d704" class="lt lu hi jp b jq jr jt ju jw lv ka lw ke lx ki ly lz ma mb bi translated">准确度:正确预测的样本与样本总数的比率</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nd"><img src="../Images/40dc024c9add266d256a688a67f6da04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MXIPFdXx7bq705JgTaTrlQ.jpeg"/></div></div></figure><p id="0aac" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">考虑到我们用于迁移学习的少量图片，这些数字已经相当令人满意了。早几个时期停止训练会减少由训练和测试精度之间的差异所说明的“过拟合”效应。请注意，对于134个不同的类别，随机猜测只能达到不到1 %的准确率。</p><h2 id="b2c4" class="ml ku hi bd kv mm mn mo kz mp mq mr ld jw ms mt lf ka mu mv lh ke mw mx lj my bi translated">2.混淆矩阵</h2><p id="1b6d" class="pw-post-body-paragraph jn jo hi jp b jq ll ij js jt lm im jv jw ln jy jz ka lo kc kd ke lp kg kh ki hb bi translated">混淆矩阵(此处被截断以仅显示最后14个类别)允许容易地识别模型预测和实际类别(矩阵的对角线)之间的正确匹配，以及不正确的预测(所有其他值)。我们可以验证10个Jindo dog图片中的7个被正确分类(其他3个在截断矩阵上不可见)。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ne"><img src="../Images/7d4c6c7bf6df2be7e951c560b43d142e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sv3IIdslA1hixeUxMytpig.jpeg"/></div></div></figure><h2 id="023b" class="ml ku hi bd kv mm mn mo kz mp mq mr ld jw ms mt lf ka mu mv lh ke mw mx lj my bi translated">3.分类报告</h2><p id="a7c9" class="pw-post-body-paragraph jn jo hi jp b jq ll ij js jt lm im jv jw ln jy jz ka lo kc kd ke lp kg kh ki hb bi translated">评估分类模型性能的另一个有用工具是分类报告，它显示整个数据集和每个类的主要分类指标(精度、召回率、F1分数)。</p><ul class=""><li id="4990" class="lt lu hi jp b jq jr jt ju jw lv ka lw ke lx ki ly lz ma mb bi translated">精度:某个类别的预测实际上属于该类别的比例</li><li id="9f77" class="lt lu hi jp b jq mc jt md jw me ka mf ke mg ki ly lz ma mb bi translated">召回率:数据集中某个类别的预测占该类别所有样本的比例</li><li id="b8eb" class="lt lu hi jp b jq mc jt md jw me ka mf ke mg ki ly lz ma mb bi translated">f1-得分:精确度和召回率的加权平均值</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nf"><img src="../Images/f980181c51f443bd743d2f706df79dc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*kzdmgfZW5C4KkZLfdKaqtQ.jpeg"/></div></figure><p id="8211" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">关于“韩国珍岛”类，我们得到了78 %的准确率和70 %的召回率，这意味着:</p><ul class=""><li id="72e4" class="lt lu hi jp b jq jr jt ju jw lv ka lw ke lx ki ly lz ma mb bi translated">78 %被归类为珍岛狗的狗实际上是珍岛狗。剩下的22 %被误认为是珍岛犬</li><li id="81ca" class="lt lu hi jp b jq mc jt md jw me ka mf ke mg ki ly lz ma mb bi translated">所有Jindo狗的70 %被正确分类(即10张照片中的7张，因为我们在测试集中有10张Jindo狗的照片)。</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ng"><img src="../Images/a56ade683cd59446ff5e4a8da79dcef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*32pdKPN_dD-eAXUXpUfQow.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">《小森林》，Yim Soon-rye，2018。</figcaption></figure></div></div>    
</body>
</html>