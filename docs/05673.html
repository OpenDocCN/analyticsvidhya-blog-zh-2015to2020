<html>
<head>
<title>5 Data pre-processing techniques essential for your ML model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对您的ML模型至关重要的5种数据预处理技术</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/5-data-pre-processing-techniques-essential-for-your-ml-model-fb0096015128?source=collection_archive---------23-----------------------#2020-04-28">https://medium.com/analytics-vidhya/5-data-pre-processing-techniques-essential-for-your-ml-model-fb0096015128?source=collection_archive---------23-----------------------#2020-04-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/95705d3f233fcf885a025bfeda2e27b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*H_Mn0WORWFMRgufC"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">弗兰基·查马基在<a class="ae hv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><div class=""/><p id="34a6" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您已经参与了数据科学项目，那么您可能会意识到一件事，即数据挖掘的第一步和主要步骤是数据预处理。在现实生活问题中，我们获得的原始数据非常杂乱，机器学习模型无法识别模式并从中提取信息。因此，让我们逐一看看整理数据的各种方法:</p><ol class=""><li id="5e29" class="jt ju hy ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated"><strong class="ix hz">处理空值</strong>:空值是指任何行或列中的数据缺失的值。出现空值的原因可能是没有记录或数据损坏。在python中，它们被标记为“Nan”。您可以通过运行以下代码来检查它-</li></ol><figure class="kd ke kf kg fd hk er es paragraph-image"><div class="er es kc"><img src="../Images/78c860c16a032fb928f7fd311dcc6c81.png" data-original-src="https://miro.medium.com/v2/resize:fit:344/format:webp/1*WOCNyo1EF49tkbuU-FPOMw.jpeg"/></div></figure><p id="b00b" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以用该列的平均值或该列中最频繁出现的项目来填充这些空值。或者我们可以用-999这样的随机值代替Nan。我们可以使用pandas库中的<em class="kh"> fillna() </em>函数用所需的值填充Nan。但是如果一个列有大量的空值，比如说超过50%,那么最好将该列从数据帧中删除。您还可以用同一列中不为空的k个最近邻的值来填充空值。Sklearn的<em class="kh"> KNNImputer() </em>可以帮你做这个任务。</p><p id="9563" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.<strong class="ix hz">处理异常值:</strong>异常值是指与数据中的其余值相距较远的数据点。他们从人群中分离出来。我们可以使用可视化工具来检测异常值，如箱线图:</p><figure class="kd ke kf kg fd hk er es paragraph-image"><div class="er es ki"><img src="../Images/ae4eab4045ac98e86c5344ea68050a9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:204/format:webp/1*P0dYbXHJWykamZYbZ_Gr-Q.jpeg"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">箱线图</figcaption></figure><p id="24f3" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">并且通过绘制两个特征向量之间的散点图:</p><figure class="kd ke kf kg fd hk er es paragraph-image"><div class="er es kj"><img src="../Images/7f9c78b223765bc6b9165cdc92c100ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*EeDcC5m8UK9Atc-e0stAlA.jpeg"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">散点图中的异常值</figcaption></figure><p id="917b" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您知道数据背后的科学事实，例如这些数据点必须位于的范围，您可以丢弃离群值。例如，如果人的年龄是你的数据的一个特征，那么你很清楚它必须在0-100岁之间，或者在某些情况下在0-130岁之间。但是，如果数据中的年龄值有些荒谬，比如说300岁，那么它必须被删除。但是异常值并不总是指向错误，它们有时可以指向一些有意义的现象。如果你的模型的预测很关键，即小的变化很重要，那么你不应该放弃这些。此外，如果异常值大量存在，如25%或更多，那么它们很可能代表一些有用的东西。在这种情况下，您必须仔细检查那些异常值。</p><p id="2519" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.<strong class="ix hz">标准化或缩放数据</strong>:如果您正在使用基于距离的机器学习算法，如K-最近邻、线性回归、K-means聚类等或神经网络，那么在将数据输入模型之前，最好将数据标准化。归一化是指在不改变数值特征之间相关性的情况下，修改数值特征的值，使其达到一个共同的范围。不同数值要素中的值位于不同的范围内，这可能会降低模型的性能，因此归一化可确保在进行预测时为要素正确分配权重。一些流行的标准化技术有:</p><p id="087c" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">a) <em class="kh">最小-最大归一化</em> -它将特征缩放到最小值和最大值之间的给定范围。它被表述为:</p><blockquote class="kk"><p id="cf5d" class="kl km hy bd kn ko kp kq kr ks kt js dx translated">X(缩放)=a+ (b-a)(X - Xmin)/(Xmax - Xmin)</p></blockquote><p id="4906" class="pw-post-body-paragraph iv iw hy ix b iy ku ja jb jc kv je jf jg kw ji jj jk kx jm jn jo ky jq jr js hb bi translated">其中a是最小值，b是最大值。</p><p id="796a" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">b) <em class="kh"> Z分数归一化</em> -我们从每个特征中减去平均值，然后除以其标准偏差，这样得到的缩放特征具有零平均值和单位方差。它被表述为:</p><blockquote class="kk"><p id="3433" class="kl km hy bd kn ko kp kq kr ks kt js dx translated">X(缩放)=(X均值(X)) /σ</p></blockquote><p id="eb80" class="pw-post-body-paragraph iv iw hy ix b iy ku ja jb jc kv je jf jg kw ji jj jk kx jm jn jo ky jq jr js hb bi translated">通过这样做，您可以将数据的分布更改为正态分布。</p><p id="d316" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">4.<strong class="ix hz">编码分类特征- </strong>分类特征是包含离散数据值的特征。如果分类特征具有字符或单词或符号或日期作为数据值，那么这些必须被编码成数字，以便机器学习模型能够理解，因为它们只处理数字数据。有3种方法对数据进行编码:</p><p id="8f40" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">a) <em class="kh">标签编码-<em class="kh"/>中的</em>这种编码类型根据字母顺序为分类特征中的每个离散值分配一个唯一的整数。在下面的例子中，你可以看到每个水果都被分配了一个相应的整数标签:</p><figure class="kd ke kf kg fd hk er es paragraph-image"><div class="er es kz"><img src="../Images/9978186363d2250eb477bed3e0ee8164.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*X4XZT-Z1gzF_Y1dN8rCU-Q.jpeg"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">编码水果名称数组的标签</figcaption></figure><p id="62f6" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">标签编码通常适用于线性模型，如线性回归、逻辑回归以及神经网络。</p><p id="15eb" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">b) <em class="kh">独热编码- </em>在<em class="kh"> </em>中，这种类型的编码为分类特征中的每个离散值分配一个唯一的独热向量或由1和0组成的二进制向量。在独热向量中，只有离散值的索引标记为1，其余所有值标记为0。在下面的例子中，你可以看到每个水果都被分配了相应的长度为5的独热向量:</p><figure class="kd ke kf kg fd hk er es paragraph-image"><div class="er es la"><img src="../Images/7d1941d6c8a077b772724d85f071ce65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*ttFF6VhNT9sxJoNS8dLTIQ.jpeg"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">一键编码水果名称数组</figcaption></figure><p id="795a" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一键编码通常适用于基于树的模型，如随机森林和梯度增强机器。</p><p id="73d6" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">c)均值编码-在<em class="kh"> </em>中，这种类型的编码使用相应的均值目标标签对分类特征中的每个离散值进行编码。为了更好地理解，让我们看看下面的例子:</p><figure class="kd ke kf kg fd hk er es paragraph-image"><div class="er es lb"><img src="../Images/260fcca7323ada599ff37d7a92868a68.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*OCATtkD4a9tn2QdUvJ5dwg.jpeg"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">由平均编码特征组成数据帧</figcaption></figure><p id="b410" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们有三种水果标签['苹果'，'香蕉'，'桔子']。每个水果标签的平均编码公式如下:</p><blockquote class="kk"><p id="59ac" class="kl km hy bd kn ko kp kq kr ks kt js dx translated">编码特征=真实目标/总目标</p></blockquote><p id="932e" class="pw-post-body-paragraph iv iw hy ix b iy ku ja jb jc kv je jf jg kw ji jj jk kx jm jn jo ky jq jr js hb bi translated">对于苹果，真实目标是3，总目标是4，因此苹果的平均编码将是3/4 =0.75。类似地，对于橙色，平均编码将是1/2=0.5。对于香蕉，它将是3/3 =1。均值编码是标签编码的扩展版本，与它相比更符合逻辑，因为它考虑了目标标签。</p><p id="ab1d" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">5.<strong class="ix hz">离散化:</strong>这也是一种很好的预处理技术，有时可以通过减少数据的大小来提高我们模型的性能。它主要用于数字特征。在离散化过程中，数字特征被划分为仓/区间。每个容器包含在某个范围内数值。bin中值的数量可以相同，也可以不同。然后，每个容器被视为一个分类值。因此，我们可以使用离散化将数字特征转换为分类特征。</p><p id="302b" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，在实施ML模型时，您可以利用这些不同的方法来预处理您的数据。希望这篇文章对你有用。</p></div></div>    
</body>
</html>