<html>
<head>
<title>Improving meteorological and ocean models with Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用机器学习改进气象和海洋模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/improving-meteorological-and-ocean-models-with-machine-learning-part-0-set-up-a-data-frame-4abd3744ec75?source=collection_archive---------2-----------------------#2019-09-08">https://medium.com/analytics-vidhya/improving-meteorological-and-ocean-models-with-machine-learning-part-0-set-up-a-data-frame-4abd3744ec75?source=collection_archive---------2-----------------------#2019-09-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="9e13" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">第0部分:设置数据框</h2></div><p id="7071" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">气象和海洋模型是获取气象变量(如风强度、气温、云量、雨强度、浪高等)未来行为的基本工具。每个人都可以享受显示气象和海洋信息的各种应用程序和网页。</p><p id="7900" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">气象模型是数学表示。该模型计算了几个时间间隔和几个地点的气象或海洋变量的值。让我们看一个例子。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/9095aa6ae3fecbc19628e3a22937be73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0TKTt9Ab0dY_o5k_aUmPUA.png"/></div></div></figure><p id="dd26" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上图描绘了GFS模型的结果。气象变量是风速和风向。该模型采用初始条件(2019年9月03日星期二06时)并尝试计算45小时后(2019年9月05日星期四03时)的风力。模型只预测某些地方的气象变量的值。地点形成一个模型网格。图中显示了模型网格和Vigo(西班牙)机场位置</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es kf"><img src="../Images/b9c32078ebb5e219705b7a9c6aeff283.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mfM1GHAjFdctDxiKQ0Sseg.jpeg"/></div></div></figure><p id="3058" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从0到8命名的点是气象模型定义预测变量的值的点。气象站在维哥机场(OACI指示性的征收)。我们的目标是建立一个机器学习模型，其中的输入是气象模型的输出。气象模型预测未来不同时间点0至8的所有气象变量。</p><p id="0c81" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，当行是日期，列是观测变量(来自气象站)和预测变量(来自气象模型)时，我们需要建立一个数据库。</p><p id="033c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我用来建立数据库的气象模型由<a class="ae kg" href="https://www.meteogalicia.gal/web/inicio.action" rel="noopener ugc nofollow" target="_blank"> Meteogalicia </a>(一个公共气象服务)维护。Meteogalicia提供了一个应用于加利西亚地区(西班牙西北部)的WRF模型。他们使用主题实时环境分布式数据服务，这是科学数据提供者和最终用户之间的连接工具。我们可以从<a class="ae kg" href="http://mandeo.meteogalicia.es/thredds/catalogos/DATOS/ARCHIVE/WRF/WRF_hist.html" rel="noopener ugc nofollow" target="_blank">气象局WRF </a>档案馆得到一个历史模型。</p><p id="47f8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">实际气象数据是从维哥机场气象站获得的。爱荷华州立大学提供了气象机场报告的数据库，查看这个<a class="ae kg" href="https://mesonet.agron.iastate.edu/request/download.phtml?network=ES__ASOS" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="77de" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以从我在Github的存储库中获得数据帧。代码应该是:</p><pre class="ju jv jw jx fd kh ki kj kk aw kl bi"><span id="862a" class="km kn hi ki b fi ko kp l kq kr">import pandas as pd<br/>#from Github link <br/>url=<a class="ae kg" href="https://raw.githubusercontent.com/granantuin/LEVX_class/master/maestro.csv" rel="noopener ugc nofollow" target="_blank">"https://raw.githubusercontent.com/granantuin/LEVX_class/master/maestro.csv</a>"<br/>master=pd.read_csv(url,index_col=”datetime”,parse_dates=True)</span></pre><p id="44a7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以通过以下方式可视化数据框:</p><pre class="ju jv jw jx fd kh ki kj kk aw kl bi"><span id="e2f4" class="km kn hi ki b fi ko kp l kq kr">import pandas_profiling</span><span id="1cfe" class="km kn hi ki b fi ks kp l kq kr">pandas_profiling.ProfileReport(master)</span></pre><p id="e11b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">数据框有33个要素(列)和61256个观测值(行次)</p><p id="51b9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这些列被命名为:</p><pre class="ju jv jw jx fd kh ki kj kk aw kl bi"><span id="1f65" class="km kn hi ki b fi ko kp l kq kr">[‘dir_o’, ‘wind_gust_o’, ‘skyc1_o’, ‘skyc2_o’, ‘skyc3_o’, ‘skyc4_o’, ‘wxcodes_o’, ‘metar_o’, ‘dir_p’, ‘lhflx_p’, ‘mod_p’, ‘prec_p’, ‘rh_p’, ‘visibility_p’, ‘wind_gust_p’, ‘mslp_p’, ‘temp_p’, ‘cape_p’, ‘cfl_p’, ‘cfm_p’, ‘cin_p’, ‘conv_prec_p’, ‘mslp_o’, ‘temp_o’, ‘dwp_o’, ‘rh_o’, ‘visibility_o’, ‘mod_o’, ‘skyl1_o’, ‘skyl2_o’, ‘skyl3_o’, ‘skyl4_o’]</span></pre><p id="2939" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">带“_o”的栏为气象站观测数据。带“_p”的列是当时模型预测的变量。我使用的模型预测从0到72小时。数据框中的日期是24到48小时的预报。</p><p id="8748" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以用以下公式得到指数:</p><pre class="ju jv jw jx fd kh ki kj kk aw kl bi"><span id="6790" class="km kn hi ki b fi ko kp l kq kr">master.index</span></pre><p id="1274" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们得到了:</p><pre class="ju jv jw jx fd kh ki kj kk aw kl bi"><span id="234a" class="km kn hi ki b fi ko kp l kq kr">DatetimeIndex([‘2011–08–22 20:00:00’, ‘2011–08–22 21:00:00’, ‘2011–08–22 22:00:00’, ‘2011–08–22 23:00:00’, ‘2011–08–23 00:00:00’, ‘2011–08–23 01:00:00’, ‘2011–08–23 02:00:00’, ‘2011–08–23 03:00:00’, ‘2011–08–23 04:00:00’, ‘2011–08–23 05:00:00’, … ‘2019–05–29 14:00:00’, ‘2019–05–29 15:00:00’, ‘2019–05–29 16:00:00’, ‘2019–05–29 17:00:00’, ‘2019–05–29 18:00:00’, ‘2019–05–29 19:00:00’, ‘2019–05–29 20:00:00’, ‘2019–05–29 21:00:00’, ‘2019–05–29 22:00:00’, ‘2019–05–29 23:00:00’]</span></pre><p id="6365" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">行是日期时间类型。时间以UTC为单位。例如，第一行(索引)2011–08–22 20:00:00表示模型预测的2011–08–22 20:00:00的变量来自时间分析2011–08–21 00:00:00发布的模型。这意味着我们看到了H+45的预报。数据框仅包含从24小时到48小时的间隔预测。时间为00:00:00的行是H+24预测，时间为23:00:00的行是H+48预测。我从上图中选择空间点3。距离机场气象站约5公里。</p><p id="1e55" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们解释每个变量的含义和单位。让我们从观察到的变量开始(扩展名为“_o”)。</p><p id="c10c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">metar _ o</strong>:Vigo站每30分钟发布的原始气象报告。我们不使用半小时，因为模型不报告半小时。你可以在这里看到更多关于METAR报告<a class="ae kg" href="https://en.wikipedia.org/wiki/METAR" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><p id="d53d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> dir_o </strong>:观察到的风向。从北方顺时针方向。单位是度。-1表示可变方向。</p><p id="f044" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> mod_o </strong>:风力强度。单位是米每秒。所有的风速测量都是在10米高的地方进行的</p><p id="06c0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">风_阵风_o </strong>:阵风。单位是米每秒。-1表示没有报告阵风。</p><p id="fc9d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">能见度_o </strong>:以米为单位的能见度。最低能见度报告为48.280319米。最大能见度报告为9994.026301(全能见度)。抱歉小数点。这是一个多次改变单位的问题。</p><p id="1f8f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> wxcodes_o </strong>:当前天气代码(空格分隔)。查看关于气象报告的链接以获取当前的天气代码</p><p id="e453" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> skyc1_o，skyc2_o，skyc3_o，skyc4_o </strong>:是几个级别的天空级别覆盖。粗略地说，云量。分类数据。m表示没有云覆盖。</p><p id="c33f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">Sky 1 _ o，skyl2 _ o，skyl3 _ o，Sky 4 _ o</strong>:云层在几个层次上的天空高度，单位为米。-一表示没有云层覆盖</p><p id="3a50" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">temp _ o</strong>:2米处的空气温度，单位为开尔文</p><p id="aba8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在2米处的露点温度，单位为开尔文单位</p><p id="e91a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">rho</strong>:相对湿度</p><p id="a65e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">mslp_o :海平面压力，单位为帕斯卡</p><p id="f583" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">扩展名为“_p”的列是模型预测的变量。你可以在这里获得更多关于WRF模型<a class="ae kg" href="http://mandeo.meteogalicia.es/thredds/dodsC/modelos/WRF_HIST/d02/2015/08/wrf_arw_det_history_d02_20150829_0000.nc4.html" rel="noopener ugc nofollow" target="_blank">预测变量的信息。让我们描述一下出现在数据框中的每一项:</a></p><p id="2e75" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> lhflx_p: S </strong>地表向下潜热通量。单位，瓦特每平方米</p><p id="d1d0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> dir_p </strong>:预测风向。从北方顺时针方向。单位是度。与dir_o不同，没有预测可变风(第1个值)</p><p id="0557" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> mod_p: </strong>风力强度预报。单位是米每秒</p><p id="c77a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> prec_p: </strong>各模式输出之间的累计总降雨量。在我们的情况下，每小时。单位千克每平方米。</p><p id="1c7a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">相对湿度:相对湿度</strong></p><p id="c503" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">能见度_p: </strong>空气中的能见度。单位米。最小能见度26.028316米。最大能见度24235.000000</p><p id="dfd6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">风_阵风_p: </strong>阵风。单位是米每秒。不像wind_gust_o总是预测(1号值)</p><p id="ee1e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> mslp_p: </strong>海平面压力(帕斯卡)</p><p id="600f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">temp _ p:</strong>2米处的空气温度，单位为开尔文</p><p id="8864" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> cape_p: </strong>对流有效位能。单位:每千克朱尔斯。更多信息请查看此<a class="ae kg" href="https://en.wikipedia.org/wiki/Convective_available_potential_energy" rel="noopener ugc nofollow" target="_blank">链接</a></p><p id="1fa9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> cin_p: </strong>对流抑制。点击<a class="ae kg" href="https://en.wikipedia.org/wiki/Convective_inhibition" rel="noopener ugc nofollow" target="_blank">此处</a>了解更多信息。单位朱尔斯每千克</p><p id="c492" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">低层大气云面积分数。我找到了1251个值大于1的样本。或许，我们不会那么信任这个功能。</p><p id="f163" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">中层大气层云面积分数。另外，我发现37个样本的值大于1。</p><p id="90d9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> conv_prec_p: </strong>各模式输出之间的累计对流降雨总量。对我们来说是每小时。</p><p id="c90c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用此数据框架，我们将构建分类和回归问题，其中独立变量是扩展名为“_p”的变量，这些变量是气象模型的输出。因变量或目标变量将是带有“_o”扩展名的变量，即该站的观察变量。</p><p id="612c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将评估气象模型。我们将应用我们用来评估机器学习模型的相同指标。有时要打败气象模型是很有挑战性的。例如，观察到的和预测的变量压力之间的相关性大于0.9。</p><h2 id="73e2" class="km kn hi bd kt ku kv kw kx ky kz la lb jg lc ld le jk lf lg lh jo li lj lk ll bi translated">结论和展望</h2><p id="f2ba" class="pw-post-body-paragraph ix iy hi iz b ja lm ij jc jd ln im jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">该数据库是评估气象模型并创建机器学习模型以提高其准确性的起点。下一篇文章，我将从可变可见度开始。希望能有很多人对这个科学领域感兴趣。请随意提交您的意见。感谢您阅读帖子！</p></div></div>    
</body>
</html>