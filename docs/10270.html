<html>
<head>
<title>House price prediction using PyCaret</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于 PyCaret 的房价预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/house-price-prediction-using-pycaret-1c7d11d76570?source=collection_archive---------14-----------------------#2020-10-11">https://medium.com/analytics-vidhya/house-price-prediction-using-pycaret-1c7d11d76570?source=collection_archive---------14-----------------------#2020-10-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/abf1d147223f6f2dbe348110c9d78a83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2rAjMWCYMmB00-s9"/></div></div></figure><h1 id="454a" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">👉🏻PyCaret 是什么？</h1><p id="7001" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">Pycaret 是 python 中的一个开源机器学习库，用于在低代码环境中训练和部署有监督和无监督的机器学习模型。</p><p id="a583" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">在数据科学中，您的代码在工作流中呈指数级增长，但是使用 PyCaret，您可以在低代码环境中构建强大的解决方案。您可以使用 PyCaret 在几秒钟内构建和部署 ML 模型。</p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="a2c0" class="iq ir hi bd is it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn bi translated">💻装置</h1><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="84f5" class="lm ir hi li b fi ln lo l lp lq">!pip install pycaret</span><span id="2372" class="lm ir hi li b fi lr lo l lp lq"># for data analysis<br/>!pip install pandas_profiling</span></pre><p id="b601" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj">导入库:</strong></p><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="0efe" class="lm ir hi li b fi ln lo l lp lq">import pandas as pd <br/>import pandas_profiling as pp</span></pre><p id="c1f1" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">在这里，我们使用这个房价预测<a class="ae ls" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data?select=train.csv" rel="noopener ugc nofollow" target="_blank">数据集</a>来探索 PyCaret</p><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="a13e" class="lm ir hi li b fi ln lo l lp lq">train_house=pd.read_csv('../input/house-prices-advanced-regression-techniques/train.csv')</span><span id="fa9f" class="lm ir hi li b fi lr lo l lp lq">test_house=pd.read_csv('../input/house-prices-advanced-regression-techniques/test.csv')</span></pre><h1 id="6978" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">📊EDA 使用 Pandas 分析报告</h1><p id="e69e" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">Python 中的 pandas_profiling 库包括一个名为 ProfileReport()的方法，该方法生成关于输入数据帧的基本报告。</p><p id="e37b" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">该报告包括以下内容:</p><ul class=""><li id="834c" class="lt lu hi jq b jr km jv kn jz lv kd lw kh lx kl ly lz ma mb bi translated">数据帧概述，</li><li id="5861" class="lt lu hi jq b jr mc jv md jz me kd mf kh mg kl ly lz ma mb bi translated">定义数据帧的每个属性，</li><li id="0060" class="lt lu hi jq b jr mc jv md jz me kd mf kh mg kl ly lz ma mb bi translated">属性之间的相关性(皮尔逊相关性和斯皮尔曼相关性)，以及</li><li id="b577" class="lt lu hi jq b jr mc jv md jz me kd mf kh mg kl ly lz ma mb bi translated">数据帧的样本。</li></ul><p id="a151" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">这一行代码将为您提供数据集的详细报告</p><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="02ff" class="lm ir hi li b fi ln lo l lp lq">pp.ProfileReport(train_house)</span></pre><figure class="ld le lf lg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/91a606560f2d68cefa6afd6632b5dd58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s1aDoblARl04QxMl3eCIAw.png"/></div></div></figure><div class="ld le lf lg fd ab cb"><figure class="mi ij mj mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/e06b8a7bd4f21ad14cf2cca1396bfc91.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*erY2i13wdPwHqjFpfEjSDQ.png"/></div></figure><figure class="mi ij mo mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/03d65adb12178b0de8d85b1047140901.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*UxfSTmOqGPTJRn4AowGf9w.png"/></div></figure></div></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="7603" class="iq ir hi bd is it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn bi translated">📉使用 PyCaret 回归</h1><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="652d" class="lm ir hi li b fi ln lo l lp lq">from pycaret.regression import *</span></pre><p id="0df6" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">在 pycaret 中执行任何其他函数之前，必须调用 setup()。它有两个强制参数:dataframe {类似数组的稀疏矩阵}和目标列的名称。所有其他参数都是可选的。</p><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="9162" class="lm ir hi li b fi ln lo l lp lq">regression_setup= setup<strong class="li hj">(</strong>data = train_house, target = ‘SalePrice’, html = <strong class="li hj">False)</strong></span></pre><figure class="ld le lf lg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/13959f51db75634731fef650acfbab12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sTlZ1fFZGZgdUx_wKMhxHw.png"/></div></div></figure><h1 id="8052" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">👉编写一行代码来比较模型</h1><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="cdaa" class="lm ir hi li b fi ln lo l lp lq">compare_models()</span></pre><p id="5c3b" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">该函数训练模型库中所有可用的模型，并使用 Kfold 交叉验证对它们进行评分。输出打印一个评分网格，包括 MAE、MSE RMSE、R2、RMSLE 和 MAPE(跨折叠平均)，由折叠参数确定。该函数根据 sort 参数中定义的度量返回最佳模型。</p><ul class=""><li id="1874" class="lt lu hi jq b jr km jv kn jz lv kd lw kh lx kl ly lz ma mb bi translated"><strong class="jq hj">用于分类:</strong>准确率、AUC、召回率、精度、F1、Kappa、MCC</li><li id="1363" class="lt lu hi jq b jr mc jv md jz me kd mf kh mg kl ly lz ma mb bi translated"><strong class="jq hj">用于回归:</strong> MAE，MSE，RMSE，R2，RMSLE，MAPE</li></ul><figure class="ld le lf lg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/0a42c3d9dcc69f7d55acc3e86b0fde68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z9GbMAyK7b2Vg_pUQLHB5A.png"/></div></div></figure><h1 id="7a44" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">模特✏️Create</h1><p id="f7b2" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在观察了 MAE、MSE RMSE、R2、RMSLE 和 MAPE 的所有模型后，下一步是为我们的数据集创建最佳模型。</p><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="781d" class="lm ir hi li b fi ln lo l lp lq">lgbm = create_model(<br/>    estimator='lightgbm',<br/>    fold=5<br/>)</span></pre><p id="875a" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">该函数创建一个模型，并使用 K-fold 交叉验证对其进行评分。(默认值= 10 折)。输出打印一个得分网格，显示 MAE、MSE、RMSE、RMSLE、R2 和 MAPE。这个函数返回一个训练好的模型对象。</p><figure class="ld le lf lg fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/fb577e5c440bc3f357ff0e2c004de420.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*KPH2YZigcejxyGqEJUTUIQ.png"/></div></figure><h1 id="11d3" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">📝预言；预测；预告</h1><p id="0f78" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">该函数用于使用经过训练的估计器来预测新数据。</p><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="8705" class="lm ir hi li b fi ln lo l lp lq">house_prediction =  predict_model(lgbm, data=test_house)<br/>house_prediction.head()</span></pre><figure class="ld le lf lg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/1d96f383de99cfb815877588bae79dd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CN3LA6DSlUA5XMPPzwExDA.png"/></div></div></figure></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="c997" class="iq ir hi bd is it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn bi translated">📋为 Kaggle 提交生成 CSV</h1><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="1fcb" class="lm ir hi li b fi ln lo l lp lq">house_prediction.rename(columns={'Label':'SalePrice'}, inplace=True)<br/>house_prediction[['Id','SalePrice']].to_csv('submission_house.csv', index=False)</span></pre></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><p id="402c" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">模型调整，整体，堆叠，AutoML 功能也是可用的。</p><p id="d8c4" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">下面是<a class="ae ls" href="https://www.kaggle.com/hrbathia260698/house-prices-advanced-regression-techniques" rel="noopener ugc nofollow" target="_blank"> Kaggle 代码链接</a></p><p id="3ddb" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">点击查看更多关于 PyCaret <a class="ae ls" href="https://pycaret.org/regression/#automl" rel="noopener ugc nofollow" target="_blank">的特性</a></p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h2 id="1011" class="lm ir hi bd is mt mu mv iw mw mx my ja jz mz na je kd nb nc ji kh nd ne jm nf bi translated">想分享点什么吗？我很想收到你的来信！Linkedin。</h2></div></div>    
</body>
</html>