<html>
<head>
<title>Understanding the Mel Spectrogram</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解Mel光谱图</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/understanding-the-mel-spectrogram-fca2afa2ce53?source=collection_archive---------0-----------------------#2020-03-06">https://medium.com/analytics-vidhya/understanding-the-mel-spectrogram-fca2afa2ce53?source=collection_archive---------0-----------------------#2020-03-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/200d2e38165c47d3ce34ca266b1dfdce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*07y_X8HAgRF9l_5_7Rj1JQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来自<a class="ae iu" href="https://gradiom.ch/project/signal-processing/" rel="noopener ugc nofollow" target="_blank"> Gradiom </a></figcaption></figure><p id="3186" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你和我一样，试图理解mel光谱图并不是一件容易的事情。你读一篇文章只是为了引向另一篇…另一篇…另一篇…继续下去。我希望这个简短的帖子能够澄清一些困惑，并从头开始解释mel光谱图。</p><h1 id="666b" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">信号</h1><p id="39c6" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">一个<strong class="ix hj">信号</strong>是一个特定量随时间的变化。对于音频，变化的量是空气压力。我们如何以数字方式获取这些信息？我们可以采集一段时间内的气压样本。我们采样数据的速率可以变化，但最常见的是44.1kHz，即每秒44，100个样本。我们捕捉到的是信号的<strong class="ix hj">波形</strong>，这可以用计算机软件进行解释、修改和分析。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="d7ba" class="lf ju hi lb b fi lg lh l li lj">import librosa<br/>import librosa.display<br/>import matplotlib.pyplot as plt</span><span id="d7c2" class="lf ju hi lb b fi lk lh l li lj">y, sr = librosa.load('./example_data/blues.00000.wav')</span><span id="f937" class="lf ju hi lb b fi lk lh l li lj">plt.plot(y);<br/>plt.title('Signal');<br/>plt.xlabel('Time (samples)');<br/>plt.ylabel('Amplitude');</span></pre><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/54d0493a5221b475b050ce7fc07d7e34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4nhf3gx4BTBDP_QEeyIeIg.png"/></div></div></figure><p id="72a0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这太棒了！我们有一个音频信号的数字表示，我们可以使用它。欢迎来到信号处理领域！你可能想知道，我们如何从中提取有用的信息？它看起来像一团乱麻。这就是我们的朋友傅立叶的作用。</p><h1 id="a91b" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">傅立叶变换</h1><p id="db69" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">音频信号由几个单频声波组成。当随着时间的推移对信号进行采样时，我们只捕获结果幅度。<strong class="ix hj">傅立叶变换</strong>是一个数学公式，它允许我们将信号分解成其单独的频率和频率的振幅。换句话说，它将信号从时域转换到频域。结果被称为<strong class="ix hj">光谱</strong>。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/b458faa055f4c65148099ec8bfdcad1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xTYCtcx_7otHVu-uToI9dA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来自<a class="ae iu" href="https://aavos.eu/glossary/fourier-transform/" rel="noopener ugc nofollow" target="_blank">阿沃斯国际</a></figcaption></figure><p id="7518" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是可能的，因为每一个信号都可以分解成一组正弦和余弦波，叠加起来就是原始信号。这是一个著名的定理，被称为<strong class="ix hj">傅立叶定理。</strong>点击<a class="ae iu" href="https://youtu.be/UKHBWzoOKsY" rel="noopener ugc nofollow" target="_blank">这里</a>如果你想要一个很好的直觉，为什么这个定理是正确的。如果你想在这里了解更多<a class="ae iu" href="https://youtu.be/spUNpyF58BY" rel="noopener ugc nofollow" target="_blank"/>，还有一个由3Blue1Brown制作的关于傅立叶变换的视频。</p><p id="61ca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">快速傅立叶变换(FFT) </strong>是一种可以高效计算傅立叶变换的算法。它广泛应用于信号处理。我将在示例音频的加窗片段上使用该算法。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="b3e0" class="lf ju hi lb b fi lg lh l li lj">import numpy as np</span><span id="328c" class="lf ju hi lb b fi lk lh l li lj">n_fft = 2048<br/>ft = np.abs(librosa.stft(y[:n_fft], hop_length = n_fft+1))</span><span id="2788" class="lf ju hi lb b fi lk lh l li lj">plt.plot(ft);<br/>plt.title('Spectrum');<br/>plt.xlabel('Frequency Bin');<br/>plt.ylabel('Amplitude');</span></pre><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/c4c00ceab57d652dcfcee24a7d5dbc23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m_PhwYnKwjAUTFTjpXJ5XQ.png"/></div></div></figure><h1 id="ceb4" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">声谱图</h1><p id="8469" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">快速傅立叶变换是一种强大的工具，可以让我们分析信号的频率成分，但如果信号的频率成分随时间而变化呢？诸如音乐和语音的大多数音频信号就是这种情况。这些信号被称为<strong class="ix hj">非周期性</strong>信号。我们需要一种方法来表示这些信号随时间变化的频谱。你可能会想，“嘿，我们不能通过对信号的几个加窗段执行FFT来计算几个频谱吗？”是啊！这正是我们所做的，它被称为<strong class="ix hj">短时傅立叶变换。</strong>FFT是在信号的重叠窗口段上计算的，我们得到了所谓的<strong class="ix hj">频谱图。</strong>哇！有太多要理解的了。这里发生了很多事。一个好的视觉是有序的。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/035c0cc740ae136ce4f8aca6229c9875.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tIBRdtG3EfjmSIlraWVIxw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来自<a class="ae iu" href="https://www.mathworks.com/help/dsp/ref/dsp.stft.html" rel="noopener ugc nofollow" target="_blank"> MathWorks </a></figcaption></figure><p id="d963" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以把频谱图想象成一堆叠在一起的FFT。这是一种直观表示信号响度或幅度的方式，因为信号以不同频率随时间变化。在计算声谱图时，还有一些额外的细节在幕后进行。y轴转换成对数刻度，颜色维度转换成分贝(你可以把这个当成振幅的对数刻度)。这是因为人类只能感知非常小且集中的频率和振幅范围。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="221f" class="lf ju hi lb b fi lg lh l li lj">spec = np.abs(librosa.stft(y, hop_length=512))<br/>spec = librosa.amplitude_to_db(spec, ref=np.max)</span><span id="56ef" class="lf ju hi lb b fi lk lh l li lj">librosa.display.specshow(spec, sr=sr, x_axis='time', y_axis='log');<br/>plt.colorbar(format='%+2.0f dB');<br/>plt.title('Spectrogram');</span></pre><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/ac114fff1b6e29b2f1c4cfd2583cec30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dbc9s0KfznzFYO0Q7OOOWg.png"/></div></div></figure><p id="3e9e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">瞧啊。只用几行代码，我们就创建了一个声谱图。好的。我们快到了！我们已经牢牢掌握了“声谱图”部分，但“梅尔”呢他是谁？</p><h1 id="68e0" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">熔融标度</h1><p id="00a3" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">研究表明，人类不会在线性尺度上感知频率。与高频相比，我们更擅长检测低频中的差异。例如，我们可以轻松分辨500 Hz和1000 Hz之间的差异，但我们几乎无法分辨10，000 Hz和10，500Hz之间的差异，即使两对之间的距离相同。</p><p id="3521" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">1937年，史蒂文斯、沃尔克曼和纽曼提出了一种音高单位，使得音高的相等距离对听者来说听起来是相等的距离。这被称为<strong class="ix hj">梅尔标度。</strong>我们对频率进行数学运算，将其转换为mel标度。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/15148ea53bf59e49e9d0a857ede334a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/1*erUKb2-Z-Wi_u8JWel6cDQ.gif"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来自<a class="ae iu" href="https://www.sfu.ca/sonic-studio-webdav/handbook/Mel.html" rel="noopener ugc nofollow" target="_blank">西蒙弗雷泽大学</a></figcaption></figure><h1 id="0587" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">梅尔光谱图</h1><p id="aa23" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated"><strong class="ix hj">梅尔频谱图</strong>是一个频谱图，其中频率被转换为梅尔标度。我知道，对吧？谁会想到呢？令人惊讶的是，在经历了所有这些精神体操来试图理解mel谱图之后，它只需要几行代码就可以实现。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="ec04" class="lf ju hi lb b fi lg lh l li lj">mel_spect = librosa.feature.melspectrogram(y=y, sr=sr, n_fft=2048, hop_length=1024)<br/>mel_spect = librosa.power_to_db(spect, ref=np.max)</span><span id="1eb7" class="lf ju hi lb b fi lk lh l li lj">librosa.display.specshow(mel_spect, y_axis='mel', fmax=8000, x_axis='time');<br/>plt.title('Mel Spectrogram');<br/>plt.colorbar(format='%+2.0f dB');</span></pre><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/e3fe0dc6e32a68f43aed8be4aa204a3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zX-rizZKXXg7Ju-entot9g.png"/></div></div></figure></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><h1 id="8c95" class="jt ju hi bd jv jw lz jy jz ka ma kc kd ke mb kg kh ki mc kk kl km md ko kp kq bi translated">概括起来</h1><p id="b3bd" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">这需要吸收大量信息，尤其是像我这样的信号处理新手。然而，如果你继续回顾这篇文章中阐述的概念(并花足够的时间盯着墙角思考它们)，它将开始变得有意义！让我们简单回顾一下我们都做了些什么。</p><ol class=""><li id="57b6" class="me mf hi ix b iy iz jc jd jg mg jk mh jo mi js mj mk ml mm bi translated">我们采集了一段时间内的气压样本，以数字方式表示音频信号</li><li id="fbd9" class="me mf hi ix b iy mn jc mo jg mp jk mq jo mr js mj mk ml mm bi translated">我们使用<strong class="ix hj">快速傅立叶变换</strong>将音频信号从时域映射到频域，并对音频信号的重叠窗口段执行此操作。</li><li id="8558" class="me mf hi ix b iy mn jc mo jg mp jk mq jo mr js mj mk ml mm bi translated">我们将y轴(频率)转换为对数标度，将颜色维度(振幅)转换为分贝，形成了<strong class="ix hj">声谱图</strong>。</li><li id="58cb" class="me mf hi ix b iy mn jc mo jg mp jk mq jo mr js mj mk ml mm bi translated">我们将y轴(频率)映射到<strong class="ix hj">梅尔标度</strong>上，形成<strong class="ix hj">梅尔谱图</strong>。</li></ol><p id="890d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">就是这样！听起来很简单，对吧？嗯，不完全是，但我希望这篇文章能让梅尔光谱图不那么吓人。我花了很长时间才理解它。不过，在那天结束时，我发现梅尔并不是那么冷漠。</p></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><blockquote class="ms mt mu"><p id="4e07" class="iv iw mv ix b iy iz ja jb jc jd je jf mw jh ji jj mx jl jm jn my jp jq jr js hb bi translated">如果你想看看这个主题的一个很酷的应用，可以看看我关于音乐流派分类的帖子，在那里我使用mel spectrograms来训练一个卷积神经网络来预测歌曲的流派。它做得怎么样？在这里了解<a class="ae iu" rel="noopener" href="/@lelandroberts97/musical-genre-classification-with-convolutional-neural-networks-ff04f9601a74"/>！</p></blockquote></div></div>    
</body>
</html>