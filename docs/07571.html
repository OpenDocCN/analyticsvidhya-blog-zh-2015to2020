<html>
<head>
<title>Create and visualize Choropleth map with Folium</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建和可视化Choropleth地图与叶</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/create-and-visualize-choropleth-map-with-folium-269d3fd12fa0?source=collection_archive---------0-----------------------#2020-06-30">https://medium.com/analytics-vidhya/create-and-visualize-choropleth-map-with-folium-269d3fd12fa0?source=collection_archive---------0-----------------------#2020-06-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/80e526d1b4af25461ad10bb379599979.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vTLaGN1x8gQJTcQ1CAEkpA.jpeg"/></div></div></figure><p id="619b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">/ˌviZH(o͞o)ələˈzāSH(ə)n/ </p><blockquote class="jp"><p id="1485" class="jq jr hi bd js jt ju jv jw jx jy jn dx translated">以图表或其他图像的形式表示一个对象、一种情况或一组信息</p></blockquote><h1 id="8999" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">为什么可视化如此重要？</h1><p id="7af0" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">数据可视化的目标是简化数据值，加深对数据值的理解，并向受众传达重要的概念。我们的大脑天生具有快速视觉处理能力。同样，<strong class="is hj">麻省理工</strong>声明:</p><ol class=""><li id="4e3e" class="lc ld hi is b it iu ix iy jb le jf lf jj lg jn lh li lj lk bi translated">人脑可以在短短的13毫秒内处理一幅图像</li><li id="ad90" class="lc ld hi is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk bi translated"><strong class="is hj"/>传输到大脑的信息90%是视觉的</li></ol><blockquote class="lq lr ls"><p id="8a1e" class="iq ir jo is b it iu iv iw ix iy iz ja lt jc jd je lu jg jh ji lv jk jl jm jn hb bi translated">“的确，视觉效果非常引人注目！!"</p></blockquote><h1 id="851c" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk lw km kn ko lx kq kr ks ly ku kv kw bi translated">让我们了解一下叶图书馆和Choropleth地图</h1><p id="7c26" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi lz translated"><span class="l ma mb mc bm md me mf mg mh di"> C </span>它允许我们研究变量是如何随着领域发展的。它是一种功能强大且广泛使用的数据可视化技术。</p><p id="fc7b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi lz translated"><span class="l ma mb mc bm md me mf mg mh di"> F </span>它建立在Python生态系统的数据争论优势和<a class="ae mi" href="https://leafletjs.com/" rel="noopener ugc nofollow" target="_blank"> leaflet.js </a>库的映射优势之上。</p><p id="bf00" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该库内置了来自<strong class="is hj"> OpenStreetMap </strong>、<strong class="is hj"> Mapbox </strong>和<strong class="is hj"> Stamen </strong>的多个tileset，并支持带有<strong class="is hj"> Mapbox </strong>或<strong class="is hj"> Cloudmade API </strong>键的自定义tileset。</p><p id="dbf0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们一步一步来</p><h1 id="b2d6" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk lw km kn ko lx kq kr ks ly ku kv kw bi translated">1.叶子的安装</h1><h2 id="c288" class="mj ka hi bd kb mk ml mm kf mn mo mp kj jb mq mr kn jf ms mt kr jj mu mv kv mw bi translated">在安装have之前，建议安装<a class="ae mi" href="https://pypi.org/project/branca/" rel="noopener ugc nofollow" target="_blank"> branca </a>、<a class="ae mi" href="https://pypi.org/project/Jinja2/" rel="noopener ugc nofollow" target="_blank"> jinja2 </a>和<a class="ae mi" href="https://pypi.org/project/requests/2.7.0/" rel="noopener ugc nofollow" target="_blank"> requests </a>。</h2><p id="898d" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">有些功能需要<a class="ae mi" href="https://pypi.org/project/geopandas/" rel="noopener ugc nofollow" target="_blank"> geopandas </a>和<a class="ae mi" href="https://pypi.org/project/altair/" rel="noopener ugc nofollow" target="_blank"> altair </a></p><pre class="mx my mz na fd nb nc nd ne aw nf bi"><span id="bdbc" class="mj ka hi nc b fi ng nh l ni nj">$ pip install folium</span></pre><p id="c635" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">或者</p><pre class="mx my mz na fd nb nc nd ne aw nf bi"><span id="6b62" class="mj ka hi nc b fi ng nh l ni nj">$ conda install folium -c conda-forge</span></pre><h1 id="ad76" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk lw km kn ko lx kq kr ks ly ku kv kw bi translated">2.使用切片和标记创建底图</h1><p id="13a0" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">要创建底图，只需将位置坐标传递给map()。</p><pre class="mx my mz na fd nb nc nd ne aw nf bi"><span id="cd3f" class="mj ka hi nc b fi ng nh l ni nj"><strong class="nc hj">import</strong> <strong class="nc hj">folium</strong></span><span id="2ab8" class="mj ka hi nc b fi nk nh l ni nj">new_york = folium.Map(location=[40.7128,-73.9352])<br/>new_york</span></pre><figure class="mx my mz na fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nl"><img src="../Images/6b0bc2a0f3ddd05f2f9cfb8917cc5f97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NGO_rfYcdJwkwLem1FKeVQ.jpeg"/></div></div><figcaption class="nm nn et er es no np bd b be z dx translated">上述代码的输出，这是一个OpenStreetMap</figcaption></figure><p id="8316" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">列表包含<strong class="is hj">【纬度，经度】，</strong>，这些值必须以十进制度数表示。你可以通过这个<a class="ae mi" href="https://www.gps-coordinates.net/" rel="noopener ugc nofollow" target="_blank"> <em class="jo">网站</em> </a>获取地点的经纬度。</p><p id="a50b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要将其存储为“下载”文件夹中的HTML文档:</p><pre class="mx my mz na fd nb nc nd ne aw nf bi"><span id="4c5d" class="mj ka hi nc b fi ng nh l ni nj">new_york.save(‘index.html’)</span></pre><p id="567b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意:默认磁贴被设置为OpenStreetMap，但也可以使用许多其他磁贴，如<a class="ae mi" href="http://maps.stamen.com/#terrain" rel="noopener ugc nofollow" target="_blank">雄蕊地形</a>、<a class="ae mi" href="http://maps.stamen.com/#toner" rel="noopener ugc nofollow" target="_blank">雄蕊调色剂</a>、<a class="ae mi" href="https://api.mapbox.com/styles/v1/mapbox/bright-v9.html?title=true&amp;access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4M29iazA2Z2gycXA4N2pmbDZmangifQ.-g_vE53SD2WrJ6tFX7QHmA#15/34.0442/-118.2518" rel="noopener ugc nofollow" target="_blank">地图框明亮</a>。</p><pre class="mx my mz na fd nb nc nd ne aw nf bi"><span id="693b" class="mj ka hi nc b fi ng nh l ni nj">folium.Map(<br/>    location=[40.7128,-73.9352],<br/>    tiles='Stamen Toner',<br/>    zoom_start=13<br/>)</span></pre><figure class="mx my mz na fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nq"><img src="../Images/662d25100e9b39fb20a3fa62b735c672.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bq3ejEE6CmAs0FwY6HO5PA.jpeg"/></div></div><figcaption class="nm nn et er es no np bd b be z dx translated">输出为上面的代码，一个带有雄蕊调色剂的贴图</figcaption></figure><blockquote class="lq lr ls"><p id="e8ef" class="iq ir jo is b it iu iv iw ix iy iz ja lt jc jd je lu jg jh ji lv jk jl jm jn hb bi translated">要了解有关地图功能的更多信息，只需将以下内容粘贴到编辑器中</p></blockquote><pre class="mx my mz na fd nb nc nd ne aw nf bi"><span id="496e" class="mj ka hi nc b fi ng nh l ni nj"><strong class="nc hj">folium.Map?</strong></span></pre><p id="cd6e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了在地图上精确定位一个位置，使用了一个标记<strong class="is hj">和</strong>。</p><pre class="mx my mz na fd nb nc nd ne aw nf bi"><span id="5bcf" class="mj ka hi nc b fi ng nh l ni nj"><strong class="nc hj">new_york </strong>= folium.Map(<br/>    location=[40.7128,-73.9352],<br/>    zoom_start=12,<br/>    <br/>)</span><span id="ce5e" class="mj ka hi nc b fi nk nh l ni nj">folium.<strong class="nc hj">Marker</strong>([40.74843597, -73.98580932], popup='&lt;i&gt;Empire State Bldg&lt;/i&gt;', tooltip="Empire State Bldg").add_to(new_york)</span><span id="ff66" class="mj ka hi nc b fi nk nh l ni nj">folium.<strong class="nc hj">Marker</strong>([40.767459869,-73.970710754], popup='&lt;b&gt;Central Park&lt;/b&gt;').add_to(new_york)</span><span id="e05e" class="mj ka hi nc b fi nk nh l ni nj">folium.<strong class="nc hj">Marker</strong>([40.75271606,-73.97721862],popup='Grand Central Terminal',icon=folium.Icon(color='red',icon='bus',prefix='fa'))<br/>.add_to(new_york)</span><span id="b390" class="mj ka hi nc b fi nk nh l ni nj">folium.<strong class="nc hj">Marker</strong>([40.713409424, -74.013343811],popup='One World Trade Center',icon=folium.Icon(color='green'))<br/>.add_to(new_york)</span><span id="a4a3" class="mj ka hi nc b fi nk nh l ni nj"><strong class="nc hj">new_york</strong></span></pre><figure class="mx my mz na fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nr"><img src="../Images/f12fd8f09a6a4efec4479eb2ee6098ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lQGY-5JRRJg6kvw1qgSeCA.jpeg"/></div></div></figure><figure class="mx my mz na fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ns"><img src="../Images/03a88b69e17a96d678505e67cc483d6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4kiRnqZ2hkPIn_n375zvsw.jpeg"/></div></div><figcaption class="nm nn et er es no np bd b be z dx translated">我的一个小向导</figcaption></figure><p id="599f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你想要更多不同类型的图标，那么访问<a class="ae mi" href="https://fontawesome.com/v4.7.0/icons/" rel="noopener ugc nofollow" target="_blank"> Font Awesome的网站。要使用这些图标，在<strong class="is hj">叶中使用<strong class="is hj">前缀=‘fa’</strong>。图标()。</strong></a></p><h1 id="9a9b" class="jz ka hi bd kb kc kd ke kf kg kh ki kj kk lw km kn ko lx kq kr ks ly ku kv kw bi translated">3.最后，创建一个Choropleth地图！</h1><p id="0ef6" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">我选择了一个美国州的数据集来工作。您也可以选择具有不同位置的数据集。首先，让我们加载我们选择的CSV文件来可视化Choropleth图。GeoJSON和TopoJSON图层可以作为叠加图传递到地图，并且可以在同一地图上显示多个图层。</p><pre class="mx my mz na fd nb nc nd ne aw nf bi"><span id="93fc" class="mj ka hi nc b fi ng nh l ni nj"><strong class="nc hj">import folium <br/>import json<br/>import requests<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import branca <br/>import seaborn as sns<br/>import numpy as np</strong></span><span id="eb8f" class="mj ka hi nc b fi nk nh l ni nj"><strong class="nc hj">state_unemp</strong> = pd.read_csv("state_unemployment.csv")</span><span id="b95a" class="mj ka hi nc b fi nk nh l ni nj"><strong class="nc hj">url</strong> = '<a class="ae mi" href="https://raw.githubusercontent.com/python-visualization/folium/master/examples/data'" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/python-visualization/folium/master/examples/data'</a></span><span id="13fe" class="mj ka hi nc b fi nk nh l ni nj"><strong class="nc hj">state_geo</strong> = f'{url}/us-states.json'        #for state level data</span></pre><p id="045a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在创建一个简单的地图:</p><pre class="mx my mz na fd nb nc nd ne aw nf bi"><span id="5fb1" class="mj ka hi nc b fi ng nh l ni nj"><strong class="nc hj">usa_state = folium.Map(location=[48, -102], zoom_start=3)</strong></span><span id="ef47" class="mj ka hi nc b fi nk nh l ni nj"><strong class="nc hj">folium.Choropleth(<br/>    geo_data = state_geo,                  </strong>#json<strong class="nc hj"><br/>    name ='choropleth',                  <br/>    data = state_unemp,                     <br/>    columns = ['State', 'Unemployment'], </strong>#columns to work on<strong class="nc hj"><br/>    key_on ='feature.id',<br/>    fill_color ='YlGnBu',     </strong>#I passed colors Yellow,Green,Blue<strong class="nc hj"><br/>    fill_opacity = 0.7,<br/>    line_opacity = 0.2<br/>   legend_name = "Unemployment scale</strong>"<strong class="nc hj"><br/>).add_to(usa_state)</strong></span><span id="0342" class="mj ka hi nc b fi nk nh l ni nj"><strong class="nc hj">usa_state</strong></span><span id="9e77" class="mj ka hi nc b fi nk nh l ni nj">#more info about the function can be found using <strong class="nc hj">folium.Choropleth?</strong></span></pre><figure class="mx my mz na fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nt"><img src="../Images/db0a111231775ecb2a16929f2f74cd60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WZ8euWrxbqAZknvLvVmsYQ.jpeg"/></div></div><figcaption class="nm nn et er es no np bd b be z dx translated">显示州一级失业情况的地图</figcaption></figure><h2 id="49ef" class="mj ka hi bd kb mk ml mm kf mn mo mp kj jb mq mr kn jf ms mt kr jj mu mv kv mw bi translated">3.1使用StepColormap</h2><p id="0eb5" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">StepColormap是<em class="jo">嵌入</em>在folium.colormap中</p><pre class="mx my mz na fd nb nc nd ne aw nf bi"><span id="4c08" class="mj ka hi nc b fi ng nh l ni nj"><strong class="nc hj">import</strong> <strong class="nc hj">branca.colormap</strong> <strong class="nc hj">as</strong> <strong class="nc hj">cmp</strong></span><span id="864f" class="mj ka hi nc b fi nk nh l ni nj"><strong class="nc hj">step</strong> = cmp.StepColormap(<br/> ['yellow', 'green', 'purple'],<br/> vmin=3, vmax=10,<br/> index=[3, 6, 8, 10],  #for change in the colors, not used fr linear<br/> caption='Color Scale for Map'    #Caption for Color scale or Legend<br/>)</span><span id="983c" class="mj ka hi nc b fi nk nh l ni nj"><strong class="nc hj">step</strong></span></pre><figure class="mx my mz na fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nu"><img src="../Images/5898f4e50ef2472fa46f7d432e6d6735.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gBpfslaS2oZwGbKZVnEKtA.jpeg"/></div></div></figure><p id="eec2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用上面在图中定义的步长变量:</p><pre class="mx my mz na fd nb nc nd ne aw nf bi"><span id="74af" class="mj ka hi nc b fi ng nh l ni nj"><strong class="nc hj">unemployment_dict</strong> = state_unemp.set_index('State')['Unemployment']<br/><strong class="nc hj">geo_json_data </strong>= json.loads(requests.get(<strong class="nc hj">state_geo</strong>).text)</span><span id="17ad" class="mj ka hi nc b fi nk nh l ni nj">usa_step = folium.Map([48, -102], tiles='cartodbpositron', zoom_start=3)</span><span id="91bf" class="mj ka hi nc b fi nk nh l ni nj">folium.GeoJson(<br/>    <strong class="nc hj">geo_json_data</strong>,<br/>    style_function=lambda feature: {<br/>        'fillColor': <strong class="nc hj">step</strong>(<strong class="nc hj">unemployment_dict</strong>[feature['id']]),<br/>        'color': 'black',       #border color for the color fills<br/>        'weight': 1,            #how thick the border has to be<br/>        'dashArray': '5, 3'  #dashed lines length,space between them<br/>    }<br/>).add_to(usa_step)<br/><strong class="nc hj">step</strong>.add_to(usa_step)     #adds colorscale or legend</span><span id="bcfc" class="mj ka hi nc b fi nk nh l ni nj">usa_step</span></pre><figure class="mx my mz na fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nv"><img src="../Images/136ea842aac95e025af2181ed861f0fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qGCiKfP0ByqTCYmWWt7LTw.jpeg"/></div></div></figure><h2 id="1c60" class="mj ka hi bd kb mk ml mm kf mn mo mp kj jb mq mr kn jf ms mt kr jj mu mv kv mw bi translated">3.2使用LinearColormap</h2><p id="121a" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">有一组连续的颜色。</p><pre class="mx my mz na fd nb nc nd ne aw nf bi"><span id="f610" class="mj ka hi nc b fi ng nh l ni nj"><strong class="nc hj">import</strong> <strong class="nc hj">branca.colormap</strong> <strong class="nc hj">as</strong> <strong class="nc hj">cmp</strong></span><span id="2029" class="mj ka hi nc b fi nk nh l ni nj"><strong class="nc hj">linear</strong> = cmp.LinearColormap(<br/>    ['yellow', 'green', 'purple'],<br/>    vmin=3, vmax=10,<br/>    caption='Color Scale for Map' #Caption for Color scale or Legend<br/>)</span><span id="973c" class="mj ka hi nc b fi nk nh l ni nj"><strong class="nc hj">linear</strong></span></pre><figure class="mx my mz na fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nw"><img src="../Images/1632daf82d40de455d80ebfdd38db1d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GaZAvmequprZQpzlyzufeQ.jpeg"/></div></div></figure><p id="e33e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用上面在图中定义的线性变量:</p><pre class="mx my mz na fd nb nc nd ne aw nf bi"><span id="a39a" class="mj ka hi nc b fi ng nh l ni nj"><strong class="nc hj">unemployment_dict</strong> = state_unemp.set_index('State')['Unemployment']<br/><strong class="nc hj">geo_json_data </strong>= json.loads(requests.get(<strong class="nc hj">state_geo</strong>).text)</span><span id="bd3f" class="mj ka hi nc b fi nk nh l ni nj">usa_linear = folium.Map([48,-102], tiles='cartodbpositron', zoom_start=3)</span><span id="f39b" class="mj ka hi nc b fi nk nh l ni nj">folium.GeoJson(<br/>    <strong class="nc hj">geo_json_data</strong>,<br/>    style_function=lambda feature: {<br/>        'fillColor': <strong class="nc hj">linear</strong>(<strong class="nc hj">unemployment_dict</strong>[feature['id']]),<br/>        'color': 'black',     #border color for the color fills<br/>        'weight': 1,          #how thick the border has to be<br/>        'dashArray': '5, 3'  #dashed lines length,space between them<br/>    }<br/>).add_to(usa_linear)<br/><strong class="nc hj">linear</strong>.add_to(usa_linear)   #adds colorscale or legend</span><span id="f77a" class="mj ka hi nc b fi nk nh l ni nj">usa_linear</span></pre><figure class="mx my mz na fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nx"><img src="../Images/2ea0b1878a4360b4fd7c3027c486b4b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aUwHGeVVVq9JqULi1kc6ow.jpeg"/></div></div></figure><blockquote class="lq lr ls"><p id="788f" class="iq ir jo is b it iu iv iw ix iy iz ja lt jc jd je lu jg jh ji lv jk jl jm jn hb bi translated">“要找到更多这样的配色方案，只需将它粘贴到编辑器中”</p></blockquote><pre class="mx my mz na fd nb nc nd ne aw nf bi"><span id="1c73" class="mj ka hi nc b fi ng nh l ni nj"><strong class="nc hj">cmp.linear   <br/>#or<br/>branca.colormap.linear</strong></span></pre><h2 id="bfc7" class="mj ka hi bd kb mk ml mm kf mn mo mp kj jb mq mr kn jf ms mt kr jj mu mv kv mw bi translated">转换策略</h2><p id="f0d6" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">如果您想将线性配色方案转换为step:</p><pre class="mx my mz na fd nb nc nd ne aw nf bi"><span id="e295" class="mj ka hi nc b fi ng nh l ni nj"><strong class="nc hj">linear.to_step(6)</strong></span><span id="226d" class="mj ka hi nc b fi nk nh l ni nj">#Note: The color schemes appeared in <strong class="nc hj">linear</strong> have been changed to #step. Also, give a step size in the parenthesis.</span></pre><figure class="mx my mz na fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ny"><img src="../Images/fb9d3a9309df1a11d9e5255f5041b350.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NuOZuYxRL6FzmfAo5qfFzA.jpeg"/></div></div></figure><p id="b2e2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以及，将步骤颜色方案转换为线性:</p><pre class="mx my mz na fd nb nc nd ne aw nf bi"><span id="6d53" class="mj ka hi nc b fi ng nh l ni nj"><strong class="nc hj">step.to_linear()</strong></span><span id="6a17" class="mj ka hi nc b fi nk nh l ni nj">#Note: The color schemes appeared in <strong class="nc hj">step</strong> have been changed to #linear</span></pre><figure class="mx my mz na fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nw"><img src="../Images/1632daf82d40de455d80ebfdd38db1d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GaZAvmequprZQpzlyzufeQ.jpeg"/></div></div></figure><h2 id="cb2a" class="mj ka hi bd kb mk ml mm kf mn mo mp kj jb mq mr kn jf ms mt kr jj mu mv kv mw bi translated">3.3将阶跃转换为线性的Choropleth图，反之亦然</h2><p id="0daf" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">使用新的美国县数据集。按照步骤3加载CSV文件并导入必要的库。</p><pre class="mx my mz na fd nb nc nd ne aw nf bi"><span id="d2e9" class="mj ka hi nc b fi ng nh l ni nj"><strong class="nc hj">us_data</strong> = pd.read_csv('unemployment_county_data.csv')</span><span id="aeb1" class="mj ka hi nc b fi nk nh l ni nj"><strong class="nc hj">url</strong> = '<a class="ae mi" href="https://raw.githubusercontent.com/python-visualization/folium/master/examples/data'" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/python-visualization/folium/master/examples/data'</a></span><span id="adb3" class="mj ka hi nc b fi nk nh l ni nj"><strong class="nc hj">county_geo</strong> =f'{url}/us_counties_20m_topo.json'#for county level data</span><span id="951e" class="mj ka hi nc b fi nk nh l ni nj"><strong class="nc hj">employed_series</strong> = us_data.set_index('FIPS')['Unemployment_rate_2011']</span></pre><p id="1f59" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">利用。Choropleth映射中的to _ step():</strong></p><pre class="mx my mz na fd nb nc nd ne aw nf bi"><span id="0619" class="mj ka hi nc b fi ng nh l ni nj">#linear to step using .to_step()</span><span id="2fdc" class="mj ka hi nc b fi nk nh l ni nj">colorscale = branca.colormap.linear.RdYlBu_11.<strong class="nc hj">to_step(6)</strong>.scale(0, 30)                       <br/>colorscale.caption = 'Color Scale'     #Caption for legend</span><span id="102b" class="mj ka hi nc b fi nk nh l ni nj">def style_function(feature):<br/>    employed = <strong class="nc hj">employed_series</strong>.get(int(feature['id'][-5:]), None)<br/>    return {<br/>        'fillOpacity': 0.5,<br/>        'weight': 0,<br/>        'caption': "Color Scale",<br/>        'fillColor': '#black' if employed is None else colorscale(employed)<br/>    }</span><span id="d2a6" class="mj ka hi nc b fi nk nh l ni nj">us_county_stp = folium.Map(<br/>    location=[42, -100],<br/>    tiles='cartodbpositron',<br/>    zoom_start=4<br/>)</span><span id="0199" class="mj ka hi nc b fi nk nh l ni nj">folium.TopoJson(<br/>    json.loads(requests.get(<strong class="nc hj">county_geo</strong>).text),  #data<br/>    'objects.us_counties_20m',       #object_path<br/>    style_function=style_function<br/>).add_to(us_county_stp)</span><span id="0f6a" class="mj ka hi nc b fi nk nh l ni nj">colorscale.add_to(us_county_stp)</span><span id="41aa" class="mj ka hi nc b fi nk nh l ni nj">us_county_stp</span></pre><figure class="mx my mz na fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nz"><img src="../Images/007f9b525491d182b61898a708066771.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*letDc6mfWqRMtuOnjnRLbw.jpeg"/></div></div><figcaption class="nm nn et er es no np bd b be z dx translated">使用阶跃函数的美国县明智失业</figcaption></figure><p id="0806" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">利用。Choropleth映射中的to _ linear():</strong></p><pre class="mx my mz na fd nb nc nd ne aw nf bi"><span id="4972" class="mj ka hi nc b fi ng nh l ni nj">#step to linear using .to_linear()<br/>colorscale = branca.colormap.step.RdYlBu_11.<strong class="nc hj">to_linear()</strong>.scale(0, 30)<br/>colorscale.caption = 'Color Scale'</span><span id="3937" class="mj ka hi nc b fi nk nh l ni nj">def style_function(feature):<br/>    employed = <strong class="nc hj">employed_series</strong>.get(int(feature['id'][-5:]), None)<br/>    return {<br/>        'fillOpacity': 0.5,<br/>        'weight': 0,<br/>        'fillColor': '#black' if employed is None else colorscale(employed)<br/>    }</span><span id="59d6" class="mj ka hi nc b fi nk nh l ni nj">us_county_lin = folium.Map(<br/>    location=[42, -100],<br/>    tiles='cartodbpositron',<br/>    zoom_start=4<br/>)</span><span id="a8d3" class="mj ka hi nc b fi nk nh l ni nj">folium.TopoJson(<br/>    json.loads(requests.get(<strong class="nc hj">county_geo</strong>).text),<br/>    'objects.us_counties_20m',<br/>    style_function=style_function<br/>).add_to(us_county_lin)</span><span id="fd93" class="mj ka hi nc b fi nk nh l ni nj">colorscale.add_to(us_county_lin)</span><span id="47b0" class="mj ka hi nc b fi nk nh l ni nj">us_county_lin</span></pre><figure class="mx my mz na fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es oa"><img src="../Images/af3990c4bc807577fa688a4fa3f8092c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_N0OIYWVCI3OAP8H_qZZtA.jpeg"/></div></div><figcaption class="nm nn et er es no np bd b be z dx translated">使用线性函数的美国县级失业率</figcaption></figure><p id="05fd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，创建一个Choropleth地图并不是一项任务😄。我希望我的帖子对大多数从事可视化数据工作的人有所帮助。</p><p id="f1d3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="jo">请给我</em> </strong>👏<strong class="is hj"> <em class="jo">如果你喜欢我的帖子！🎉</em> </strong></p></div></div>    
</body>
</html>