<html>
<head>
<title>Setup any Tensorflow-gpu &amp; Jupyter in minutes [Ubuntu 18.04]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在几分钟内设置任何Tensorflow-gpu和Jupyter[Ubuntu 18.04]</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/setup-any-tensorflow-gpu-31ef64337a66?source=collection_archive---------7-----------------------#2019-12-14">https://medium.com/analytics-vidhya/setup-any-tensorflow-gpu-31ef64337a66?source=collection_archive---------7-----------------------#2019-12-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e4e73e781c2bc96810ec36ad1958edab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BRPkWX5PZbaAO8BzMTMKGA@2x.jpeg"/></div></div></figure><p id="9e6a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我制作这个教程是因为我第一次设置它花了太多时间。在Ubuntu的一次更新后，一切都丢失了，我需要重新设置一切。因为我没有记录，我担心我至少要花几个小时来重新设置一切。现在它被记录下来，我可以在10分钟左右完成！想和大家分享一下我的经验:)</p><p id="c1bb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用Tensorflow/docker(和其他框架)的主要优点是可以自由设置您想要使用的版本。不再强调安装哪个Cuda或Cudnn版本。您将不再需要设置它们！</p><p id="7e26" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">基本要求:</p><ul class=""><li id="4976" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">Ubuntu 18.04 lts:已测试</li><li id="85be" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">对机器的超级用户访问权限</li><li id="77c5" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">至少1个支持Cuda的Nvidia GPU:我有1个1080Ti</li></ul><h1 id="74c2" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">Readyy…开始！</h1><h1 id="edc9" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak"> 0.1。清除Nvidia(可选)~2分钟</strong></h1><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="bf03" class="lj kd hi lf b fi lk ll l lm ln">sudo apt-get purge nvidia*</span></pre><h2 id="9386" class="lj kd hi bd ke lo lp lq ki lr ls lt km jb lu lv kq jf lw lx ku jj ly lz ky ma bi translated"><strong class="ak">安装nvidia驱动</strong></h2><ul class=""><li id="f6cb" class="jo jp hi is b it mb ix mc jb md jf me jj mf jn jt ju jv jw bi translated">搜索更新管理器</li><li id="4eb7" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">单击设置</li><li id="55be" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">单击其他驱动因素</li><li id="8555" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">选择<strong class="is hj"> <em class="mg"> nvidia-driver-*(专有，已测试)</em> </strong></li><li id="e389" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">单击应用更改</li></ul><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="021c" class="lj kd hi lf b fi lk ll l lm ln">sudo apt-get install nvidia-container-toolkit<br/>sudo reboot</span></pre><h1 id="6279" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak"> 0.2。吹扫对接器(可选)~30秒</strong></h1><ul class=""><li id="3599" class="jo jp hi is b it mb ix mc jb md jf me jj mf jn jt ju jv jw bi translated">检查这个有用的链接来做好它:<a class="ae mh" href="https://askubuntu.com/a/1021506" rel="noopener ugc nofollow" target="_blank">https://askubuntu.com/a/1021506</a></li></ul><h1 id="c344" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak"> 1。安装Docker(版本19.03+) ~1分钟</strong>，支持链接:https://docs.docker.com/install/linux/docker-ce/ubuntu/</h1><ul class=""><li id="224c" class="jo jp hi is b it mb ix mc jb md jf me jj mf jn jt ju jv jw bi translated">标准安装:</li></ul><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="246d" class="lj kd hi lf b fi lk ll l lm ln">sudo apt-get remove docker docker-engine docker.io containerd runc</span><span id="d84a" class="lj kd hi lf b fi mi ll l lm ln">sudo apt-get update</span><span id="e408" class="lj kd hi lf b fi mi ll l lm ln">sudo apt-get install \<br/>    apt-transport-https \<br/>    ca-certificates \<br/>    curl \<br/>    gnupg-agent \<br/>    software-properties-common</span><span id="f576" class="lj kd hi lf b fi mi ll l lm ln">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span><span id="69c7" class="lj kd hi lf b fi mi ll l lm ln">sudo apt-key fingerprint 0EBFCD88</span><span id="1583" class="lj kd hi lf b fi mi ll l lm ln">sudo add-apt-repository \<br/>   "deb [arch=amd64] https://download.docker.com/linux/ubuntu \<br/>   $(lsb_release -cs) \<br/>   stable"</span><span id="22d3" class="lj kd hi lf b fi mi ll l lm ln">sudo apt-get update</span><span id="6dbf" class="lj kd hi lf b fi mi ll l lm ln">sudo apt-get install docker-ce docker-ce-cli containerd.io</span></pre><ul class=""><li id="a660" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">奖金:执行docker没有sudo:</li></ul><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="cf55" class="lj kd hi lf b fi lk ll l lm ln">sudo usermod -aG docker ${USER}<br/>sudo su - ${USER}<br/>sudo reboot</span></pre><h1 id="8de7" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak"> 2。设置nvidia docker ~30 s </strong>，支持链接https://github.com/NVIDIA/nvidia-docker</h1><p id="e603" class="pw-post-body-paragraph iq ir hi is b it mb iv iw ix mc iz ja jb mj jd je jf mk jh ji jj ml jl jm jn hb bi translated">对于Ubuntu用户，请键入以下命令:</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="48ce" class="lj kd hi lf b fi lk ll l lm ln">distribution=$(. /etc/os-release;echo $ID$VERSION_ID)<br/>curl -s -L <a class="ae mh" href="https://nvidia.github.io/nvidia-docker/gpgkey" rel="noopener ugc nofollow" target="_blank">https://nvidia.github.io/nvidia-docker/gpgkey</a> | sudo apt-key add -<br/>curl -s -L <a class="ae mh" href="https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list" rel="noopener ugc nofollow" target="_blank">https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list</a> | sudo tee /etc/apt/sources.list.d/nvidia-docker.list<br/>sudo apt-get update &amp;&amp; sudo apt-get install -y nvidia-container-toolkit<br/>sudo systemctl restart docker</span></pre><h1 id="8006" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">3.<strong class="ak">测试设置(可选)~30秒+ </strong>(取决于您的网速)</h1><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="8079" class="lj kd hi lf b fi lk ll l lm ln">docker run --gpus all nvidia/cuda:9.0-base nvidia-smi</span></pre><p id="885c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">(docker不退出会自动拉nvidia/cuda:9.0-base镜像)</p><p id="24e4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">结果屏幕应该如下所示</p><figure class="la lb lc ld fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/5577d31bd0c9bd3b64b2878df1c430de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jhi8QSDySAxVVO1RBpYfiA.png"/></div></div><figcaption class="mn mo et er es mp mq bd b be z dx translated"><code class="du mr ms mt lf b">docker run --gpus all nvidia/cuda:9.0-base nvidia-smi</code></figcaption></figure><h1 id="b4b4" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak"> 4。设置Jupyter笔记本的访问权限约1分钟</strong></h1><p id="1e3d" class="pw-post-body-paragraph iq ir hi is b it mb iv iw ix mc iz ja jb mj jd je jf mk jh ji jj ml jl jm jn hb bi translated">注意:Tensorflow在Docker中有很多支持，你可以找到所有类型的tensorflow版本，无论是在python 2还是python3中，有/无GPU支持。你只需要拉你需要的图像。Tensorflow/Docker图片每日更新！查看此链接了解更多信息。【https://hub.docker.com/r/tensorflow/tensorflow/tags?page=9】</p><p id="eccb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于这个例子，我们将使用这个图像:latest-gpu-py3-jupyter。它使用了最新的Tensorflow (2.0.0)并有Gpu支持和python3环境。</p><p id="b353" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于这些步骤，您将只需要在终端中对C/P执行两个命令:</p><ul class=""><li id="746e" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">第一个将让您通过桌面内的端口8889访问jupyter笔记本(到jupyter的链接将显示在终端中)。如果需要，您可以更改本地路径或端口</li><li id="5500" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">如果你想保存新安装的包(Pytorch，Opencv…)，第二个会让你提交对docker镜像的修改。确保名称标签在两个命令中匹配</li></ul><p id="c01d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了方便使用，我在~/.bashrc中添加了这两个命令作为别名。我建议你也这样做。</p><p id="6076" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是怎么做的:<strong class="is hj"> Readyy… GO！</strong></p><ul class=""><li id="074c" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated"><strong class="is hj">型<em class="mg">须藤vi ~/。bashrc </em> </strong> <em class="mg">(轻松编辑:</em> <strong class="is hj"> <em class="mg">须藤纳米~/。巴沙尔</em> </strong> <em class="mg"> ) </em></li><li id="3569" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">选择C/P该块的一条线(如果设置，您可以删除符合的sudo):</li></ul><figure class="la lb lc ld fd ij"><div class="bz dy l di"><div class="mu mv l"/></div></figure><ul class=""><li id="eda2" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">键入<strong class="is hj"> <em class="mg"> Esc </em> </strong></li><li id="9d55" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">键入<strong class="is hj"> <em class="mg"> :wq </em> </strong>(保存并退出)</li></ul><h1 id="efef" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak"> 5。最终测试~5分钟+ </strong>(取决于你的网速)</h1><ul class=""><li id="6283" class="jo jp hi is b it mb ix mc jb md jf me jj mf jn jt ju jv jw bi translated">打开一个新终端并键入别名</li></ul><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="93d3" class="lj kd hi lf b fi lk ll l lm ln"><em class="mg">tensorflow-docker-gpu</em> </span></pre><p id="991d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">(如果图像不存在，将下载该图像)</p><ul class=""><li id="f99b" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">打开笔记本(单击将显示的链接)</li><li id="4104" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">创建新笔记本</li><li id="e122" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">C/P并在笔记本中执行以下脚本:</li></ul><figure class="la lb lc ld fd ij"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="b5ed" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">输出结果应该是这样的(枕头已经安装在我的案例中):</p><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="2a68" class="lj kd hi lf b fi lk ll l lm ln">tensorflow version 2.0.0<br/>Num GPUs Available:  1<br/>True<br/>True<br/>Pillow already installed<br/>Pillow installed</span></pre><p id="78eb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要在退出前保存对docker图像的更改:</p><ul class=""><li id="93d8" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">打开另一个终端</li><li id="9631" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">键入别名:</li></ul><pre class="la lb lc ld fd le lf lg lh aw li bi"><span id="f3ac" class="lj kd hi lf b fi lk ll l lm ln"> docker-commit-tf</span></pre><ul class=""><li id="dcce" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">您新安装的软件包现在已保存。可以退出:)</li></ul><p id="9567" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，您已经准备好使用Jupyter上的本地GPU运行您的模型进行训练了</p><p id="3c5d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你觉得这个教程有用，请告诉我</p><p id="b332" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">谢谢</p></div></div>    
</body>
</html>