<html>
<head>
<title>Finding Latitude and Longitude of places</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">查找地点的纬度和经度</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/finding-latitude-and-longitude-of-places-b6d94fdd8b4e?source=collection_archive---------23-----------------------#2020-07-27">https://medium.com/analytics-vidhya/finding-latitude-and-longitude-of-places-b6d94fdd8b4e?source=collection_archive---------23-----------------------#2020-07-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/803fdf98cf8e1110a676e7681e21d453.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*J1VqTDALb4KXJ9BTuT90Pg.png"/></div></figure><p id="71e9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我想在地图上显示特定地区的统计数据。第一步是找到该地区的纬度和经度，这样就可以在地图上显示图钉。基于大头针，我想显示与该地区相关的各种数据。</p><p id="7508" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在本文中，我将讨论使用Google的地理编码API获取纬度和经度的步骤。</p><h1 id="1b6e" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">获取API密钥</h1><p id="951f" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">在我们编写获取地区纬度和经度的脚本之前，我们必须为Google地理编码API获取一个API键。要获得API密钥，首先用你的电子邮件id和密码登录谷歌开发者账户<a class="ae kn" href="https://console.developers.google.com" rel="noopener ugc nofollow" target="_blank">https://console.developers.google.com</a>。</p><p id="8d5c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下一步是为Google创建计费帐户，以收取API的使用费。别担心，谷歌有很多灵活的计费方案。要创建计费账户，请转到<em class="ko">计费</em>部分和<em class="ko">创建账户</em>。</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es kp"><img src="../Images/ef78a4ed8fcdebb0567e3a19bc50481a.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*hub138G0kpZtpbEXf7phjQ.png"/></div></figure><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es ku"><img src="../Images/c330a6386df1efbaa83001fd1e12e029.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*GsaI0UjFgw5ei62J-BrzQA.png"/></div></figure><p id="cbb3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在下一个屏幕中，提供计费详细信息并启用计费。</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es kv"><img src="../Images/a4ad2caeaad5188576731743658d8f96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*LigPdCEPs8LkapjOkcsVHA.png"/></div></figure><p id="99fb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">付费账户可以为谷歌云平台或谷歌地图平台付费，但不能同时为两者付费。对于谷歌云平台，所有使用都将计入该计费账户。对于谷歌地图平台，超过<strong class="io hj"> $200每月免费等级</strong>限额的使用将被记入该账户。</p><p id="f81f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">地理编码API计费信息可以在<a class="ae kn" href="https://developers.google.com/maps/documentation/geocoding/usage-and-billing" rel="noopener ugc nofollow" target="_blank">这里</a>找到。有关谷歌地图平台所有产品的信息，请参考此处的<a class="ae kn" href="https://developers.google.com/maps/billing/gmp-billing" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="65a3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">对于使用地理编码API，选择谷歌地图平台作为计费账户。</strong>创建计费账户后，我们将创建项目，API将在该项目下注册。从项目顶部创建一个新项目。</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es kw"><img src="../Images/e3caf429afc508aaa1d8e23a97c0ea65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*Ao7RSxBtPQdSqfllZHXDqA.png"/></div></figure><p id="0821" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在新屏幕中提供项目详细信息并创建一个项目。</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es kx"><img src="../Images/86266dcee363884ac99615e5e36e27ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*doGYv9HTnrOvyQTHbpTB1A.png"/></div></figure><p id="890e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我已经用我的地图付费帐户标记了该项目。由于这是一个个人项目，我没有创建一个组织。</p><p id="7ab8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">创建计费帐户和项目后，下一步是为项目启用API。点击<em class="ko">启用API和服务</em>以启用地理编码API。</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es kw"><img src="../Images/9254779dff089e7cc4eb9e61035dfff6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*fQ1uxHHJnS0BE-eySqpqBg.png"/></div></figure><p id="00d7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在下一个屏幕中搜索地理编码，并通过单击<em class="ko">启用</em>按钮启用API。启用后，您应该会看到下面的屏幕。</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es ky"><img src="../Images/5c4f9a2ea54a15dd8717598350d82fad.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*MQsaoHxH8aALuOr57E319g.png"/></div></figure><p id="d221" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">请参考地理编码API定价计划的定价标签。截至2020年7月，谷歌每月为地图、路线和地点提供200美元的免费使用权。</p><p id="8952" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">到目前为止，我们已经创建了一个新的计费帐户，创建了一个新的项目并将计费帐户附加到项目，并为项目启用了地理编码API。启用API后，我们现在需要一个可以用来从python脚本调用API的键。最后一步是创建API密钥。</p><p id="45d4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">要创建API密钥，请转到<em class="ko">凭证</em>选项卡并点击<em class="ko">创建凭证。</em></p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es kz"><img src="../Images/743d1597c4f30b10146cd2d94dc2ab34.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/1*_i3vqC89NcomIJSVb3_bPA.png"/></div></figure><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es la"><img src="../Images/ef2cb388d821f0fa3b8083cf11e67a9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*CXs7mIOU8_VMd6Qk6aGyhg.png"/></div></figure><p id="a887" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">单击API密钥创建新密钥。</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es lb"><img src="../Images/f8ee8f4f8e4a570c2d708255a34abf9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*O8TvyB4bHzaeIZtRN-bDNg.png"/></div></figure><p id="fd08" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">请注意API键。这将在python脚本中使用。</p><p id="63d1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这一步完成了获取API密钥的设置过程。现在，我们将在python脚本中使用这个新生成的键来获取地区的经度和纬度。</p><p id="977e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我从维基百科搜集数据，创建了一个地区和州的列表。(参见<a class="ae kn" rel="noopener" href="/@divij.sharma/web-scraping-dealing-with-ftp-servers-and-other-things-all-in-one-a07b61421d14">本文</a>了解网页抓取详情。)区文件上传<a class="ae kn" href="https://github.com/divijsharma/Blog/blob/master/district_lat_lng.csv" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><h1 id="cd16" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">获取纬度和经度</h1><p id="d42f" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">首先，我们将导入库。我们将使用3个库。<code class="du lc ld le lf b">pandas</code>读取存放区的csv文件，<code class="du lc ld le lf b">requests</code>进行API调用，<code class="du lc ld le lf b">json</code>将响应从API转换为JSON格式</p><figure class="kq kr ks kt fd ij"><div class="bz dy l di"><div class="lg lh l"/></div></figure><p id="de5c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为API创建URL。我们将使用上一步中生成的API密钥。</p><figure class="kq kr ks kt fd ij"><div class="bz dy l di"><div class="lg lh l"/></div></figure><p id="8a60" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">读取地区数据并创建新列。在此上传地区数据<a class="ae kn" href="https://github.com/divijsharma/Blog/blob/master/district_lat_lng.csv" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="kq kr ks kt fd ij"><div class="bz dy l di"><div class="lg lh l"/></div></figure><p id="eb52" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">循环读取文件，获取经纬度信息。在调用API之前，我们必须进行URL百分比编码。它用于在通常不允许的URL中放置字符。编码是百分号后跟一个ASCII值(十六进制)。(详情请参考<a class="ae kn" href="https://en.wikipedia.org/wiki/Percent-encoding" rel="noopener ugc nofollow" target="_blank">百分比编码</a>。)所以数据中的空格被替换为%20。纬度和经度信息存在于JSON中，因此我们必须导航到正确的标签来捕获数据。</p><figure class="kq kr ks kt fd ij"><div class="bz dy l di"><div class="lg lh l"/></div></figure><p id="fc6f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">最后一步是保存带有经纬度的文件。</p><figure class="kq kr ks kt fd ij"><div class="bz dy l di"><div class="lg lh l"/></div></figure></div></div>    
</body>
</html>