# 多元线性回归

> 原文：<https://medium.com/analytics-vidhya/multiple-linear-regression-47e4b7a0fb1e?source=collection_archive---------8----------------------->

![](img/a854aaece0c2b60c6adfb4c72ce997ce.png)

格伦·卡斯滕斯-彼得斯在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

在这篇博客文章中，我们将涉及以下主题

1.  什么是多元线性回归？
2.  多元线性回归的假设。
3.  多元线性回归的实际应用。

**1。什么是多元线性回归？**

多元线性回归或多重回归用于建模因变量和一组自变量之间的线性关系。当一个被称为因变量的变量的输出依赖于许多被称为自变量的其他变量时，就会用到它。在多元线性回归中，y 的值是离散的或数字的。

**例 1**

手机的价格取决于品牌、存储、相机和年龄。价格是因变量，品牌名称、存储、相机和年龄是自变量。

**例 2**

医疗保险的保费金额取决于年龄、工作性质、既往病史和保险期限。保费金额是因变量，年龄、工作性质、病史和保单期限是自变量。

**多元线性回归模型的方程式是–**

Y=B0+B1X1+B2X2+…+BnXn

其中 Y 是因变量，

X1，X2…Xn 是独立变量，

而 B0，B1，B2，…，Bn 是回归系数。

**2。假设**

多元线性回归基于以下假设

1.因变量和自变量高度相关，且因变量和自变量之间存在线性关系。

2.独立变量彼此不相关。

3.残差应该是正态分布的，这意味着误差不包含重要信息。

4.残差不应包含任何模式。

决定系数(R)表明回归模型有多好。R 的值范围从 0 到 1。R 的值越接近 1，回归模型就越好。

**3。多元线性回归在 R 中的实际实现**

为了进行实验，我从 kaggle 下载了一个数据集“insurance . CSV”(https://www . ka ggle . com/noordeen/insurance-premium-prediction)。该数据集包含以下特征-年龄、bmi、儿童、性别、吸烟者、地区和费用。本实验的目的是绘制一个多元线性回归模型，该模型基于几个特征，如年龄、bmi、儿童、性别、吸烟者和地区与他们现有医疗费用的关系，用于预测个人未来的医疗费用。

**安装并加载所需的软件包**

首先，打开 R Studio，然后将所需的包安装并加载到 R Studio 中。

![](img/62bedd83ffedda6c5a0d8ed49fa05043.png)

**加载数据**

将“insurance.csv”文件加载到 R Studio 中。

![](img/ea5f2acf8fe3ac32fb3517935b0aabd8.png)

执行上述代码后，我们得到以下输出-

![](img/3afdf34855881608ff1ab8e08eb18dba.png)

**将分类列转换成数字形式**

要应用多元线性回归，需要将分类变量转换为数字形式。这里，我们通过使用 revalue 函数将分类变量的值更改为数字形式。

![](img/ad04f6ae54810d4f3b9d8e59a48e3e1b.png)

执行上述代码后，我们得到以下输出-

![](img/2928669f54d9ec4cae355c44ee5e3ab3.png)

**一、探索性数据分析**

多元线性回归的第一步是探索性数据分析。在这一步中，我们检查散点图和相关矩阵，找出变量之间的关系。

**散点图**

我们希望看到变量的成对散点图，这样我们就可以确定是否有任何成对的预测因子高度相关。

![](img/fcc196d48f91b4d8ad165369294f50de.png)

执行上述代码后，我们得到以下输出-

![](img/9e68c76b4f96e109bbd3f3db657f279a.png)

**打印相关矩阵**

绘制变量的相关矩阵以检查变量之间的相关性。

![](img/a1f419fff24772ea02194ee84dce05c6.png)

执行上述代码后，我们得到以下输出-

![](img/15892a633eb367bf97e562fe2059b09d.png)

**二。模型构建**

多元线性回归的第二步是建模。

![](img/5cb53efed4621920c252ce8e83aa0cf2.png)

执行上述代码后，我们得到以下输出-

![](img/591a1d68f16004f6c782e0917add12ea.png)

总结表明，年龄、体重指数、儿童和吸烟者是重要的变量，而性别和地区是无关紧要的变量。R 的值是 0.7498。

**三。检查多重共线性问题**

多元线性回归的第三步是检查多重共线性问题。如果存在多重共线性问题，则从数据中删除重复变量。我们将使用方差膨胀因子(VIF)来检查多重共线性问题。

![](img/21764c90d221d5917c8349db0ccb46fb.png)

执行上述代码后，我们得到以下输出-

![](img/2d4e5287800d20506a233d3deee844ad.png)

由于所有变量的 VIF 值都小于 20，因此不存在多重共线性问题。

**四。模型验证**

![](img/350dca2926541c7d7a0eb6dbdd910142.png)

执行上述代码后，我们得到以下输出-

![](img/a818871d0387191f7f15891ef2e1b03c.png)![](img/7b56c80627a33815ea811da70994bb61.png)![](img/0e74ad9891ad354bc57cbeebfd6eaa1a.png)![](img/0492befd7a3acfb74dd2f74049ef1636.png)

第一个图是剩余图。这表明残差与拟合图中存在一种模式，这意味着误差包含重要信息。

接下来的剧情是 QQ-plot。因为 QQ 图中的大多数点没有落在这条线上，这表明残差不遵循正态分布。

创建的第三个图是比例-位置图。该图类似于残差图，但使用标准化残差的平方根，而不是残差本身。这使得残差的趋势更加明显，从这个图中，我们可以看到残差中有一些模式。

第四个情节是杠杆情节。该图显示了标准化残差与其杠杆率的关系。也包括库克的距离界限。这些边界之外的任何点都将是 x 方向上的异常值。从图中，我们可以看到数据中存在异常值。

**残差与回归量图**

![](img/c3b3d5bb02f7b986d2d01ebd3acb8283.png)

执行上述代码后，我们得到以下输出-

![](img/088cec8bc01ed8440cf2cc516f0f7a2d.png)![](img/90432ac36c27130dd241a90b3cab8c6d.png)

这里，独立变量相对于它们的误差被标绘。从图中，我们可以看到年龄和体重指数呈现出一种模式，或者年龄和体重指数不存在线性关系。因此，应用变换来使关系线性。各种变换可以应用于数据，如二次、多项式、对数和指数等。

**V .模型删除诊断**

可以使用 Cook 距离、Hat 值和 Bonferroni 校正从数据中识别异常值或影响因素。

![](img/1f0bfafd2dadbcecf5e5a3ad7448543b.png)

执行上述代码后，我们得到以下输出-

![](img/7b79230b49e94fe23643cf2015ae3508.png)

现在，我们将移除异常值，并对模型进行转换，以获得更好的 R 值。

# # # #迭代 1

**#二次模型**

![](img/6fff3c47887eef2a405059fda56dea0f.png)

执行上述代码后，我们得到以下输出-

![](img/c355187ddcbc7b2e3061248c0521287b.png)

**#聚模式**

![](img/e94768a1949b2cf37309cd3037ec41e3.png)

执行上述代码后，我们得到以下输出-

![](img/015a21d5e39c06d110f0d7942a56308e.png)![](img/69a1258c8feca0939171c7aa2101194c.png)

**#互反模式**

![](img/b0c52da47163c272f7e91218d35101a6.png)

执行上述代码后，我们得到以下输出-

![](img/eb25a95ad0f0f8874114a198730ba2d0.png)

**#指数模型**

![](img/a45ac384ba983ac62cc159c548c2e27b.png)

执行上述代码后，我们得到以下输出-

![](img/86cc00f3cf6969d18bdc9ae5ebbf0782.png)

我们对模型进行了各种变换，可以看到指数模型给出了更好的 R 值，即 0.7616。

**#检查模型中有影响的观察值**

![](img/c3706ec3e63b85cb84cdc656f5b0909c.png)

执行上述代码后，我们得到以下输出-

![](img/b2b608f48a30192b1e1e50b06204104b.png)![](img/44f0efd58176b9df91124d65bf258371.png)

执行上述代码后，我们得到以下输出-

![](img/6c5ed80d4d8d005dc8102dc6bcf88fcc.png)

**#检查模型中有影响的观察值**

![](img/b05a173056732c00a4ec81a715e357cb.png)

执行上述代码后，我们得到以下输出-

![](img/ec518f125b0e62a48d69e5a752b2f44e.png)![](img/cf266eadbd8fc4a097b3d71043e2429a.png)

执行上述代码后，我们得到以下输出-

![](img/5880b43ffa8980c93a34eed4a492e505.png)

通过剔除有影响的观测值，指数模型的精度从 0.7616 提高到 0.7821。这样，通过从数据中移除异常值，可以提高模型的准确性。