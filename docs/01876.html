<html>
<head>
<title>Pandas Tutorial-Indexing, Slicing, Date &amp; Times</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫教程-索引，切片，日期和时间</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/pandas-tutorial-indexing-slicing-date-times-e02d230ff485?source=collection_archive---------3-----------------------#2019-11-19">https://medium.com/analytics-vidhya/pandas-tutorial-indexing-slicing-date-times-e02d230ff485?source=collection_archive---------3-----------------------#2019-11-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/918ee116a24bf7b310adcdda9dd6b500.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*idnI2pwiEFizm-rik8bo5Q.png"/></div></div></figure><div class=""/><p id="eca5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们现在正试图用Python的Pandas库来进行数据分析。</p><p id="bcd3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Pandas是一个数据分析库。Pandas依赖于并使用<code class="du jo jp jq jr b">NumPy</code>——Python库进行快速数值数组计算。例如，您可以使用DataFrame属性<code class="du jo jp jq jr b">.values</code>将DataFrame <code class="du jo jp jq jr b">df</code>表示为NumPy数组。您还可以将Pandas数据结构传递给NumPy方法。</p></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><h1 id="2dd3" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">索引</h1><p id="0fd2" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">熊猫数据帧是带有标记行和列的表格数据结构。数据帧的行由索引标记。数据帧的列本身是称为<code class="du jo jp jq jr b">Series</code>的特殊数据结构。Pandas系列是一维带标签的numpy数组，dataframe是列为系列的二维numpy数组。</p><p id="28db" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，数据帧可以像numpy数组或Python列表一样进行切片。我们使用冒号来指定切片的<code class="du jo jp jq jr b">Start</code>、<code class="du jo jp jq jr b">End</code>和<code class="du jo jp jq jr b">Stride</code>。Pandas数据框架提供了几种灵活的方法来索引您将要处理的数据子集。</p><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="5b03" class="lk ka ht jr b fi ll lm l ln lo">In [1]: import pandas as pd<br/>In [2]: df = pd.read_csv('sales.csv', index_col='month')<br/>In [3]: df<br/>Out[3]:      eggs    salt     fish<br/> month<br/> Jan         47       12.0    17<br/> Feb         110      50.0    31<br/> Mar         221      89.0    72<br/> Apr         77       87.0    20<br/> May         132      NaN     52<br/> Jun         205      60.0    55</span></pre><h2 id="47f7" class="lk ka ht bd kb lp lq lr kf ls lt lu kj jb lv lw kn jf lx ly kr jj lz ma kv mb bi translated">方括号</h2><p id="24cf" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">我们可以用方括号选择数据的某些部分。本例中的第一个括号选择列标签，第二个括号选择行标签。</p><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="9305" class="lk ka ht jr b fi ll lm l ln lo">In [4]: df['eggs']['Feb']<br/>Out[4]: 110</span></pre><p id="054f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面的代码选择了二月份销售的鸡蛋，即110。这是一种非常方便的方式来截取您可能正在寻找的特定结果。一点也不复杂，但它可能是你工作中的宝贵资源。</p><h2 id="fe34" class="lk ka ht bd kb lp lq lr kf ls lt lu kj jb lv lw kn jf lx ly kr jj lz ma kv mb bi translated">使用列属性和行标签</h2><p id="6afa" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">Pandas还允许您将列链接到数据帧，然后使用方括号分割所需的行标签。值得注意的是，这只适用于单个单词或多个单词用下划线连在一起的列。</p><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="0982" class="lk ka ht jr b fi ll lm l ln lo">In [5]: df.fish['Mar']<br/>Out[5]: 72</span></pre><p id="2ba1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面的代码分割了三月份销售的鱼的数量，即72条。</p><h2 id="86dd" class="lk ka ht bd kb lp lq lr kf ls lt lu kj jb lv lw kn jf lx ly kr jj lz ma kv mb bi translated">使用<code class="du jo jp jq jr b">.loc </code>或<code class="du jo jp jq jr b">.iloc A</code>辅助</h2><p id="4f7c" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">从Pandas的数据帧中分割数据的另一种方法是使用“访问器”。这些访问器告诉panda slice将焦点转向何处，以及在要切片的数据中要寻找什么。<code class="du jo jp jq jr b">.loc</code>访问器使用给定的<code class="du jo jp jq jr b">labels</code>分割数据，而<code class="du jo jp jq jr b">.iloc</code>使用<code class="du jo jp jq jr b">Index positions</code>分割数据。</p><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="657f" class="lk ka ht jr b fi ll lm l ln lo">In [6]: df.loc['May','fish']<br/>Out[6]: 52</span><span id="c26b" class="lk ka ht jr b fi mc lm l ln lo">In [7]: df.iloc[4,2]<br/>Out[7]: 52</span></pre><p id="0a8b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第一段代码使用<code class="du jo jp jq jr b">.loc</code>访问器分割了5月份销售的鱼的数量。在<code class="du jo jp jq jr b">.loc</code>之后，我们传递一个字符串列表，首先指定我们想要切片的行，然后指定我们感兴趣的行中的列。</p><p id="991c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第二位类似地使用<code class="du jo jp jq jr b">.iloc</code>访问器分割了5月份销售的鱼的数量。使用<code class="du jo jp jq jr b">.iloc</code>，我们传递一个整数列表。第一个整数指定我们感兴趣的行的索引，第二个整数指定列的索引。行和列的索引从0开始，所以<code class="du jo jp jq jr b">May</code>假设索引为<code class="du jo jp jq jr b">4</code>，而<code class="du jo jp jq jr b">fish</code>的索引为2。</p><h2 id="9f48" class="lk ka ht bd kb lp lq lr kf ls lt lu kj jb lv lw kn jf lx ly kr jj lz ma kv mb bi translated">仅选择一些列</h2><p id="5872" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">在某些情况下，我们只想分割一些列，我们使用带方括号的嵌套列表来实现这一点。</p><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="0629" class="lk ka ht jr b fi ll lm l ln lo">In [8]: df_new = df[['eggs','salt']]<br/>In [9]:df_new<br/>Out[9]:          eggs       salt<br/>      month<br/>      Jan         47        12.0<br/>      Feb        110        50.0<br/>      Mar        221        89.0<br/>      Apr         77        87.0<br/>      May        132         NaN<br/>      Jun        205        60.0</span></pre></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><h1 id="89fb" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">切片数据帧</h1><p id="ec70" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">切片可以使用或不使用访问器来完成。我们将看几个例子，说明如何使用和不使用访问器来分割数据帧的各个部分。</p><p id="e29d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们仍将使用之前加载的销售数据框架。</p><h2 id="b6ba" class="lk ka ht bd kb lp lq lr kf ls lt lu kj jb lv lw kn jf lx ly kr jj lz ma kv mb bi translated">切割柱的部分</h2><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="0611" class="lk ka ht jr b fi ll lm l ln lo">In [1]: df['eggs'][1:4]<br/>Out[1]: month<br/>        Feb     110<br/>        Mar     221<br/>        Apr      77</span></pre><p id="afd2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这段代码选择了eggs列，并对从2月到4月售出的鸡蛋数量进行切片。第一个括号选择列，下一个括号选择所需的行。</p><h1 id="8356" class="jz ka ht bd kb kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw bi translated">1.使用。loc[ ]访问器</h1><h2 id="2aad" class="lk ka ht bd kb lp lq lr kf ls lt lu kj jb lv lw kn jf lx ly kr jj lz ma kv mb bi translated">分割所有行和一些列</h2><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="2059" class="lk ka ht jr b fi ll lm l ln lo">In [2]: df.loc[:,'eggs':'salt']<br/>Out[2]:          eggs      salt<br/>        month         <br/>        Jan       47       12.0<br/>        Feb      110       50.0<br/>        Mar      221       89.0<br/>        Apr       77       87.0<br/>        May      132        NaN<br/>        Jun      205       60.0</span></pre><p id="d73f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如我们已经看到的<code class="du jo jp jq jr b">.loc[]</code>访问器，传递的第一个字符串指定选择的行，在逗号后面传递的第二个字符串指定要切片的列。</p><p id="817c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这种情况下，我们希望选择数据帧的所有行和其中的一些列，我们使用冒号<code class="du jo jp jq jr b">:</code>来表示选择所有行。仅使用冒号，而不指定任何范围，会选择一行或一列的全部。但是，如果将冒号放在两个字符串或两个整数之间，它会选择所指示的两点之间的所有数据。</p><p id="5454" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du jo jp jq jr b">df.loc[:,'eggs':'salt']</code>选择几个月的鸡蛋和鱼的销售额。<code class="du jo jp jq jr b">'eggs':'salt'</code>仅选择鸡蛋和盐，因为鸡蛋和盐列之间没有项目。如果两列之间有列，它们也会被选中。</p><h2 id="af46" class="lk ka ht bd kb lp lq lr kf ls lt lu kj jb lv lw kn jf lx ly kr jj lz ma kv mb bi translated">分割一些行和所有列</h2><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="ff35" class="lk ka ht jr b fi ll lm l ln lo">In [3]: df.loc['Jan':'Apr',:]<br/>Out[3]:       eggs     salt    fish<br/>      month<br/>      Jan     47       12.0     17<br/>      Feb     110      50.0     31<br/>      Mar     221      89.0     72<br/>      Apr     77       87.0     20</span></pre><p id="27cb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这段代码对dataframe的行<code class="du jo jp jq jr b">'Jan'</code>到<code class="du jo jp jq jr b">'April'</code>以及所有列(鸡蛋、盐和鱼的销售额)进行切片。注意，我们使用了一个单独的冒号<code class="du jo jp jq jr b">:</code>来选择所有列。我本可以使用<code class="du jo jp jq jr b">'eggs':'fish'</code>，那也是准确的。</p><h2 id="09cb" class="lk ka ht bd kb lp lq lr kf ls lt lu kj jb lv lw kn jf lx ly kr jj lz ma kv mb bi translated">分割一些行和一些列</h2><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="45c9" class="lk ka ht jr b fi ll lm l ln lo">In [4]:df.loc['Mar':'May','salt':'fish']<br/>Out[4]:        salt     fish<br/>       month       <br/>       Mar     89.0       72<br/>       Apr     87.0       20<br/>       May      NaN       52</span></pre><p id="79e2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这段代码将3月到4月的盐和鱼的销售记录分割开来。语法类似于早期的语法。<code class="du jo jp jq jr b">'Mar':'May'</code>选择3月到4月的行，而<code class="du jo jp jq jr b">'salt':'fish'</code>为我们提供这几个月的盐和鱼的销售情况。</p><h1 id="a0b3" class="jz ka ht bd kb kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw bi translated">2.使用。iloc[ ]访问器</h1><h2 id="02ac" class="lk ka ht bd kb lp lq lr kf ls lt lu kj jb lv lw kn jf lx ly kr jj lz ma kv mb bi translated">分割所有行和一些列</h2><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="5cea" class="lk ka ht jr b fi ll lm l ln lo">In [5]: df.iloc[:,0:1]<br/>Out[5]:          eggs      salt<br/>        month         <br/>        Jan       47       12.0<br/>        Feb      110       50.0<br/>        Mar      221       89.0<br/>        Apr       77       87.0<br/>        May      132        NaN<br/>        Jun      205       60.0</span></pre><p id="624e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这类似于使用<code class="du jo jp jq jr b">.loc[]</code>访问器。冒号<code class="du jo jp jq jr b">:</code>分割整行，<code class="du jo jp jq jr b">0:1</code>是第一列和第二列的索引。对一些行和所有列进行切片也是如此。</p><h2 id="ac8f" class="lk ka ht bd kb lp lq lr kf ls lt lu kj jb lv lw kn jf lx ly kr jj lz ma kv mb bi translated">分割一些行和一些列</h2><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="d234" class="lk ka ht jr b fi ll lm l ln lo">In [6]:df.iloc[2:5,1:]<br/>Out[4]:        salt     fish<br/>       month       <br/>       Mar     89.0       72<br/>       Apr     87.0       20<br/>       May      NaN       52</span></pre><p id="fbb5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个代码相当于<code class="du jo jp jq jr b">df.loc[‘Mar’:’May’,’salt’:’fish’]</code>的<code class="du jo jp jq jr b">iloc[]</code>。它削减了3月至5月的盐和鱼销售额。</p><h2 id="7175" class="lk ka ht bd kb lp lq lr kf ls lt lu kj jb lv lw kn jf lx ly kr jj lz ma kv mb bi translated">特殊切片</h2><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="06d8" class="lk ka ht jr b fi ll lm l ln lo">In [1]: df.iloc[:5,:]</span></pre><p id="3f24" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从开始到第5行切片。第5行不包含，并选择所有相应的列条目。</p><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="bd5c" class="lk ka ht jr b fi ll lm l ln lo">In [2]: df.iloc[-5:,:]</span></pre><p id="9343" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从底部到倒数第五行的切片…当然，还有所有相应的列条目。</p><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="ee56" class="lk ka ht jr b fi ll lm l ln lo">In [3]: df.iloc[::3,-1]</span></pre><p id="f6fd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将从最后一列的0开始每隔3行进行切片。</p><h2 id="ec94" class="lk ka ht bd kb lp lq lr kf ls lt lu kj jb lv lw kn jf lx ly kr jj lz ma kv mb bi translated">使用列表而不是切片</h2><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="e055" class="lk ka ht jr b fi ll lm l ln lo">In [4]: df.loc['Jan':'May',['eggs','fish']]<br/>Out[4]:        eggs    fish<br/>      month    <br/>      Jan       47      17<br/>      Feb      110      31<br/>      Mar      221      72<br/>      Apr       77      20<br/>      May      132      52</span></pre><p id="1960" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面的代码对行<code class="du jo jp jq jr b">January</code>到<code class="du jo jp jq jr b">'May'</code>进行切片，并选择嵌套列表中传递的列。在这个例子中，返回了从1月到5月的鸡蛋和鱼的销售额。</p><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="82d6" class="lk ka ht jr b fi ll lm l ln lo">In [5]:df.iloc[[0,4,5],0:2]<br/>Out[5]:          eggs      salt<br/>        month         <br/>        Jan       47       12.0<br/>        May      132        NaN<br/>        Jun      205       60.0</span></pre><p id="e304" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">就像<code class="du jo jp jq jr b">.loc[]</code>一样，我们传递我们感兴趣的列或行的列表，而不是分割它们。在上面的例子中，我们选择了月份<code class="du jo jp jq jr b">January</code>、<code class="du jo jp jq jr b">May</code>和<code class="du jo jp jq jr b">June</code>，然后对第一列和第二列进行切片。该代码返回一月、五月和六月鸡蛋和盐的所有销售额。</p></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><h1 id="868d" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">日期和时间</h1><p id="1e27" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">在使用Pandas读取日期时间对象时，我们需要在使用<code class="du jo jp jq jr b">pd.read_csv()</code>函数将数据加载到dataframe时指定<code class="du jo jp jq jr b">'parse_dates=True'</code>。</p><p id="b583" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du jo jp jq jr b">'parse_dates=True'</code>关键字参数(Kwarg)帮助将<code class="du jo jp jq jr b">ISO 8601</code>格式的日期和时间从指定的列转换成日期时间对象。</p><p id="2528" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du jo jp jq jr b">ISO 8601</code>格式看起来像这样<code class="du jo jp jq jr b">yyyy-mm-dd hh:mm:ss</code></p><p id="a9d7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们来看一家公司的产品销售数据:(Sale-feb-2015.csv)</p><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="f6a1" class="lk ka ht jr b fi ll lm l ln lo">     Date                 Company          product      Unit<br/>0  2015-02-02 08:30:00   Hooli             Software       3<br/>1  2015-02-02 21:00:00   Mediacare         Hardware       9<br/>2  2015-02-03 14:00:00   Initech           Software      13<br/>3  2015-02-04 15:30:00   Streeplex         Software      13<br/>4  2015-02=04 22:00:00   Acme Corporation  Hardware      14<br/></span></pre><p id="0a1d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以看到这个文件包含至少一列日期时间。我们必须告诉<code class="du jo jp jq jr b">read_csv()</code>用<code class="du jo jp jq jr b">'parse_dates=True'</code>将所有兼容的列解析为datetime对象。此外，我们希望使用<code class="du jo jp jq jr b">index_cols='Date'</code>将日期列作为索引</p><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="1479" class="lk ka ht jr b fi ll lm l ln lo">In [1]: import pandas as pd<br/>In [2]: sales=pd.read_csv('Sales-feb-2015.csv',                    parse_dates=True,index_cols='Date')<br/>In [3]: sales<br/>Out[3]:                Company          product      Unit <br/>    Date<br/> 2015-02-02 08:30:00   Hooli             Software       3<br/> 2015-02-02 21:00:00   Mediacare         Hardware       9<br/> 2015-02-03 14:00:00   Initech           Software      13<br/> 2015-02-04 15:30:00   Streeplex         Software      13<br/> 2015-02=04 22:00:00   Acme Corporation  Hardware      14</span></pre><h2 id="2bf5" class="lk ka ht bd kb lp lq lr kf ls lt lu kj jb lv lw kn jf lx ly kr jj lz ma kv mb bi translated">选择单一日期时间</h2><p id="fff8" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">记住<code class="du jo jp jq jr b">.loc</code>可用于按行和按列分割数据。</p><p id="1727" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以对日期时间做同样的事情。例如，我们可以选择在2月19日晚上11点购买的公司。</p><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="0e63" class="lk ka ht jr b fi ll lm l ln lo">In [4]: Sales.loc['2015-02-19 23:00:00','Company']<br/>Out[4]: 'Mediacare'</span></pre><h2 id="3e55" class="lk ka ht bd kb lp lq lr kf ls lt lu kj jb lv lw kn jf lx ly kr jj lz ma kv mb bi translated">选择全天</h2><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="6244" class="lk ka ht jr b fi ll lm l ln lo">In [5]:Sales.loc['2015-2-4']<br/>Out[5]:               Company           Product   Unit<br/>Date<br/>2015-02-04 15:30:00  Streeplex          Software   13<br/>2015-02-04 22:00:00  Acme Corporation   Hardware   14</span></pre><p id="88ea" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意，我们没有指定列名，所以所有的列都被返回。</p><p id="befd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">部分日期时间字符串的替代格式</p><ul class=""><li id="2860" class="mi mj ht is b it iu ix iy jb mk jf ml jj mm jn mn mo mp mq bi translated"><code class="du jo jp jq jr b">Sales.loc['February 5, 2015']</code></li><li id="a6b6" class="mi mj ht is b it mr ix ms jb mt jf mu jj mv jn mn mo mp mq bi translated"><code class="du jo jp jq jr b">Sales.loc['2015-Feb-5']</code></li></ul><p id="c709" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Pandas还允许对整月、整年等进行部分选择。</p><ul class=""><li id="2a54" class="mi mj ht is b it iu ix iy jb mk jf ml jj mm jn mn mo mp mq bi translated">整整几个月:<code class="du jo jp jq jr b">Sales.loc['2015-2']</code></li><li id="82d9" class="mi mj ht is b it mr ix ms jb mt jf mu jj mv jn mn mo mp mq bi translated">全年:<code class="du jo jp jq jr b">Sales.loc['2015']</code></li></ul><h2 id="28f5" class="lk ka ht bd kb lp lq lr kf ls lt lu kj jb lv lw kn jf lx ly kr jj lz ma kv mb bi translated">切片日期和时间</h2><p id="43bb" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">我们可以通过提供由冒号<code class="du jo jp jq jr b">:</code>分隔的<code class="du jo jp jq jr b">Start</code>和<code class="du jo jp jq jr b">Stop</code>字符串来分割部分日期时间字符串。</p><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="a86d" class="lk ka ht jr b fi ll lm l ln lo">In [6]: Sales.loc['2015-2-16':'2015-2-20']</span></pre><p id="3a4c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将分割从2月16日到2月20日的所有销售记录。</p><h2 id="13e3" class="lk ka ht bd kb lp lq lr kf ls lt lu kj jb lv lw kn jf lx ly kr jj lz ma kv mb bi translated">将字符串转换为日期时间</h2><p id="ffbe" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">Pandas <code class="du jo jp jq jr b">.to_datetime()</code>方法用于将<code class="du jo jp jq jr b">ISO 8601</code>格式的字符串转换成pandas datetime对象。</p><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="7dcd" class="lk ka ht jr b fi ll lm l ln lo">In [7]: night_sales=pd.datetime(['2015-2-11 20:00','2015-2-11 21:00'<br/>    ..: '2015-2-11 22:00','2015-2-11 23:00'])<br/>In [8]:night_sales<br/>Out[8]:<br/>       DatetimeIndex(['2015-02-11 20:00:00','2015-02-11 21:00:00',<br/>       '2015-02-11 22:00:00','2015-02-11 23:00:00'],<br/>        dtype='datetime64[ns]',freq=None)</span></pre><h2 id="eb70" class="lk ka ht bd kb lp lq lr kf ls lt lu kj jb lv lw kn jf lx ly kr jj lz ma kv mb bi translated">重新索引数据帧</h2><pre class="lc ld le lf fd lg jr lh li aw lj bi"><span id="492f" class="lk ka ht jr b fi ll lm l ln lo">In [9]: Sales.reindex(night_sales)<br/>Out[9]:                Company       Product      Units<br/>2015-02-11 20:00:00    Initech        Software       7.0<br/>2015-02-11 21:00:00     NaN            NaN           NaN<br/>2015-02-11 22:00:00     NaN            NaN           NaN<br/>2015-02-11 23:00:00    Hooli          Software       4.0</span></pre><p id="2ea5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">重建索引包括提供新的索引并根据需要匹配数据。如上所示，reindex返回了一个新的dataframe，其中有4行对应于<code class="du jo jp jq jr b">night_sales</code>中的时间。</p><p id="2769" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当使用带有缺失条目的reindex时，我们可以使用参数<code class="du jo jp jq jr b">'Method=ffill'</code>覆盖默认的用<code class="du jo jp jq jr b">NaN</code>归档。(正向填充)。还有一个<code class="du jo jp jq jr b">'Method=bfill'</code>(回填)。它用最近的前一个条目或最近的后一个条目填充列。</p><p id="ce8b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我将在后续教程中详细讨论这些问题。</p><p id="62c2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在应该就这些了。我希望你能从这篇教程帖子中得到乐趣。</p><p id="864d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下次见，编码快乐！</p></div></div>    
</body>
</html>