<html>
<head>
<title>Data Augmentation Techniques using OpenCV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用OpenCV的数据扩充技术</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-augmentation-techniques-using-opencv-657bcb9cc30b?source=collection_archive---------6-----------------------#2020-07-24">https://medium.com/analytics-vidhya/data-augmentation-techniques-using-opencv-657bcb9cc30b?source=collection_archive---------6-----------------------#2020-07-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c648997a93afba158473b0c7d04a06da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zhsa4n7TsgphkYm10GEEAw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片由AltPhoto提供</figcaption></figure><p id="bc56" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">数据扩充</strong>是一种策略，使从业者能够显著增加可用于训练模型的<strong class="iw hj">数据</strong>的多样性，而无需实际收集新的<strong class="iw hj">数据</strong>。<strong class="iw hj">数据扩充</strong>裁剪、填充和水平翻转等技术通常用于训练大型神经网络。</p><p id="bf3d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">数据增强</strong>可用于增加模型的准确性和学习，因为通过使用数据增强，我们可以从不同的角度创建同一图像的多幅图像，如翻转、旋转、锐化等，因此同一图像可以多种方式训练，模型可以通过大量学习轻松预测图像。</p><h1 id="32f6" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">数据增强技术:</strong></h1><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kq"><img src="../Images/e753cfadaa3e19f9e8dcf1bb4deb09d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eepf79k7yQs-IQHYQd-xxA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来自StackOverflow</figcaption></figure><ul class=""><li id="1f5e" class="kv kw hi iw b ix iy jb jc jf kx jj ky jn kz jr la lb lc ld bi translated">翻转:垂直或水平翻转图像。</li><li id="1d69" class="kv kw hi iw b ix le jb lf jf lg jj lh jn li jr la lb lc ld bi translated">旋转:将图像旋转指定的角度。</li><li id="67c9" class="kv kw hi iw b ix le jb lf jf lg jj lh jn li jr la lb lc ld bi translated">剪切:像平行四边形一样移动图像的一部分。</li><li id="449b" class="kv kw hi iw b ix le jb lf jf lg jj lh jn li jr la lb lc ld bi translated">裁剪:对象以不同的比例出现在图像的不同位置</li></ul><p id="3d99" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">通过使用各种库有更多的技术来进行数据扩充，我们可以通过使用像<strong class="iw hj"> ImageDataGenerator </strong>这样的简单方法来实现扩充，但我使用的是<strong class="iw hj"> Opencv </strong>并重新生成不同的图像。</p><p id="06ca" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我将实现旋转，增加亮度，降低亮度，翻转和锐化。</p><blockquote class="lj lk ll"><p id="ccbf" class="iu iv lm iw b ix iy iz ja jb jc jd je ln jg jh ji lo jk jl jm lp jo jp jq jr hb bi translated"><strong class="iw hj">你可以从这个</strong> <a class="ae lq" href="https://github.com/MayankkYogi/OpenCV" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hj">链接</strong> </a>下载代码</p></blockquote><h2 id="ee9f" class="lr jt hi bd ju ls lt lu jy lv lw lx kc jf ly lz kg jj ma mb kk jn mc md ko me bi translated">使用的库:</h2><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/51b160543dc179af09aacb537e08e3b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*xZSdeLMncoRAqla5X7FPag.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">作者图片</figcaption></figure><p id="895e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我正在使用开放的CV库，即cv2。</p><p id="9aae" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> Glob </strong> = Unix风格路径名模式扩展。<strong class="iw hj"> glob </strong>模块根据Unix shell使用的规则查找与指定模式匹配的所有路径名，尽管结果以任意顺序返回。… fnmatch()，<strong class="iw hj"> glob </strong>处理以点( .)作为特例。</p><h1 id="eb5e" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">旋转:</strong></h1><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/63c7ed081da8a1d84f382220f998bd36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PQ3qh4z0_EhXQ9NgYW2yPw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">作者图片</figcaption></figure><p id="07d6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这里，我从输入文件夹，我用来增加技术的图像。</p><p id="3298" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在我正在创建一个新的文件夹，我可以用“操作系统”库来保存我所有旋转过的图片</p><p id="6b49" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在在for循环中，我基本上是一个接一个地获取扩展名为“jpeg”的输入文件夹中的所有图像，并使用openCV读取图像。</p><p id="b517" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在函数“cv2.getRotationMatrix2D”中，第一个参数是<strong class="iw hj">中心</strong>，用于根据图像的中心旋转图像，第二个参数是<strong class="iw hj">角度</strong>，我们要旋转图像的角度，最后一个参数是<strong class="iw hj">比例</strong></p><p id="0500" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在在“imwrite”中，我只是将旋转后的图像保存在新创建的文件夹中，可以通过下面的“imshow”看到旋转后的图像</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/6c2bfa829d2a9007222ac17964041b2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*fpWqjVz0D5Qy6fovW2bfQQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">旋转图像</figcaption></figure><h1 id="09c5" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">增加亮度:</h1><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/521901500d4cecb897316c9fbabbb285.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*00o8lQru8rnuJ1V-r-Hrvw.png"/></div></div></figure><p id="7e66" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这里我使用numpy来增加图像的亮度，我将原始的3*3数组图像添加到明亮的图像数组中。</p><p id="f31f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">将1的图像形状乘以70形成明亮的图像阵列，并保存到文件夹中</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/f00fb1fd5f1ec3901589d735374a2d85.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*p9NcqLH7A6wl87Nd1OptUQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">增加亮度</figcaption></figure><h1 id="dd7f" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">降低亮度:</h1><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/30fc062722c103bb44c0f120d3b6da8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SQBoyNgGSovGkvfb-FWXLQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">作者图片</figcaption></figure><p id="29a3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这里所有的代码都是一样的，增加亮度，而不是加法，这里我用减法</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/42ff04631f5427c3ca3a38ba2a44d53f.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*qimP4vbvkbdHoUrdI9NiuQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">降低亮度</figcaption></figure><h1 id="53f5" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">翻转:</h1><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/a4a728afd149d10fa7cf327f24cd95d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MW_ZqkMoOtWmNqwqsO4e5g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">作者图片</figcaption></figure><p id="d5ed" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在翻转中，我们必须传递图像源和翻转代码，这意味着我们必须在哪个轴上翻转图像。这里我使用翻转代码&gt; 0，所以它在垂直轴上翻转。</p><p id="b9ba" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们可以指定不同的翻转代码值，如下所示:</p><pre class="kr ks kt ku fd mn mo mp mq aw mr bi"><span id="486e" class="lr jt hi mo b fi ms mt l mu mv">The example scenarios of using the function are the following:<br/>.   *   Vertical flipping of the image (flipCode == 0) to switch between<br/>.       top-left and bottom-left image origin. This is a typical operation<br/>.       in video processing on Microsoft Windows\* OS.<br/>.   *   Horizontal flipping of the image with the subsequent horizontal<br/>.       shift and absolute difference calculation to check for a<br/>.       vertical-axis symmetry (flipCode \&gt; 0).<br/>.   *   Simultaneous horizontal and vertical flipping of the image with<br/>.       the subsequent shift and absolute difference calculation to check<br/>.       for a central symmetry (flipCode \&lt; 0).<br/>.   *   Reversing the order of point arrays (flipCode \&gt; 0 or<br/>.       flipCode == 0).<br/>.   @param src input array.<br/>.   @param dst output array of the same size and type as src.<br/>.   @param flipCode a flag to specify how to flip the array; 0 means<br/>.   flipping around the x-axis and positive value (for example, 1) means<br/>.   flipping around y-axis. Negative value (for example, -1) means flipping<br/>.   around both axes.</span></pre><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/a03d5ef824544a31668c34a9778131e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*Ha-ss8cNWAzoGQ3juf9I_w.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">翻转图像</figcaption></figure><h1 id="44f1" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">锐化:</h1><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/443e90c78b30be110de90d13f7dfdd89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OVGnVesFadmUb6A90VUG3Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">作者图片</figcaption></figure><p id="16e6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这种情况下，有各种参数用于锐化图像，定义如下:</p><pre class="kr ks kt ku fd mn mo mp mq aw mr bi"><span id="534a" class="lr jt hi mo b fi ms mt l mu mv">.   @param src input image.<br/>.   @param dst output image of the same size and the same number of channels as src.<br/>.   @param ddepth desired depth of the destination image, see @ref filter_depths "combinations"<br/>.   @param kernel convolution kernel (or rather a correlation kernel), a single-channel floating point matrix</span></pre><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es mx"><img src="../Images/8254541fb611b48fe69451cb3502263a.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*JU0Yp0YCCHBKgkAD8vEH1Q.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">清晰图像</figcaption></figure><p id="825a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">所以，上面我使用了numpy、openCV和glob库，并实现了数据扩充技术</p><blockquote class="lj lk ll"><p id="5499" class="iu iv lm iw b ix iy iz ja jb jc jd je ln jg jh ji lo jk jl jm lp jo jp jq jr hb bi translated"><strong class="iw hj">如有任何疑问，可通过</strong> <a class="ae lq" href="https://www.linkedin.com/in/mayank-yogi-806ba9156/" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hj">联系我</strong>中的 </a> <strong class="iw hj"/></p></blockquote></div></div>    
</body>
</html>