<html>
<head>
<title>Black-(Blind Or Not)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">黑色-(失明与否)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/black-blind-or-not-8897e6c1ad4c?source=collection_archive---------13-----------------------#2020-09-25">https://medium.com/analytics-vidhya/black-blind-or-not-8897e6c1ad4c?source=collection_archive---------13-----------------------#2020-09-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/944d3de41ea47056353b3080e473f442.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mDzOnfEnp56fVwBl6CBnXw.jpeg"/></div></div></figure><blockquote class="iq ir is"><p id="8fde" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">概述<em class="hi"> : </em> </strong> <em class="hi">这篇博客是关于检测</em> <a class="ae js" href="https://nei.nih.gov/health/diabetic/retinopathy" rel="noopener ugc nofollow" target="_blank">糖尿病视网膜病变</a> <em class="hi">的，糖尿病视网膜病变是居住在难以进行医学筛查的农村地区的工作老年人失明的主要原因</em>。<em class="hi">这个想法是在早期阶段检测到这个问题，以便在机器学习的帮助下预防失明。使用机器学习的要点是，整个过程可以加速，并且可以在没有医生的地方远程访问。</em></p></blockquote><p id="77b4" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">完整的代码可以在我的 Github <a class="ae js" href="https://github.com/Anwoy-p/case_study_2" rel="noopener ugc nofollow" target="_blank">档案</a>中找到</p><blockquote class="iq ir is"><p id="5779" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">目录</strong>:</p></blockquote><p id="902c" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— —关于这个问题</p><p id="bc45" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— —关于数据集</p><p id="7aa4" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— —指标</p><p id="b9cd" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— —加载数据集</p><p id="8baf" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— —探索数据</p><p id="d1b5" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— —数据增强</p><p id="e797" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— —数据预处理</p><p id="d7ac" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— —准备图像数据生成器</p><p id="bba6" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— —建模</p><p id="bf12" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— —对照表</p><p id="9f9f" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— —卡格尔分数</p><p id="52e3" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— —未来的工作</p><p id="e367" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— —参考</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div class="er es jw"><img src="../Images/beb92c8caffaf702458c7ef6afd8bc5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/1*TL-3Vfh0q-dcNeC9YXPyDg.jpeg"/></div></figure><blockquote class="iq ir is"><p id="83e4" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">关于问题:</strong></p></blockquote><figure class="jx jy jz ka fd ij er es paragraph-image"><div class="er es kb"><img src="../Images/e1f7855ff8b44ffd4507bb66ff9d8a46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*Iv3n0qdTDHd4rEwXANQxFg.png"/></div></figure><p id="73d3" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">如上图所示，这是不健康眼睛的五种不规则性，即这些不规则性倾向于<a class="ae js" href="https://nei.nih.gov/health/diabetic/retinopathy" rel="noopener ugc nofollow" target="_blank">糖尿病视网膜病变</a>。所以我们必须处理图像来发现问题有多严重。</p><blockquote class="iq ir is"><p id="5c9e" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">关于数据集:</strong></p></blockquote><p id="c087" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">这是一个 Kaggle 问题，其中数据集由 5 个不同类别的图像组成，但所提供的图像包含噪声，因为所有真实世界的数据都是如此，并且它是一个高度不平衡的数据集，具有超过 1700 个 0 类点和少于 250 个 4 类图像。训练集由 3662 幅图像组成，测试集包含 1928 幅图像。</p><blockquote class="iq ir is"><p id="6eb4" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">指标:</strong></p></blockquote><p id="de86" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">用于评估预测的度量是 kappa 度量。Kappa score 测量两个评价人之间的一致程度，这两个评价人分别将 N 个项目分成<em class="iv"> C </em>互斥的类别。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div class="er es kc"><img src="../Images/e97ceec097ff4e0bc0419170fed342a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:482/format:webp/1*U5EYpBLPQtX-eRpbwLHyuw.png"/></div><figcaption class="kd ke et er es kf kg bd b be z dx translated"><em class="kh"> po </em>是相对观察一致，<em class="kh"> pe </em>是偶然一致的概率</figcaption></figure><p id="ae6b" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">如果评定者完全同意，那么 k =1。如果评定者之间没有一致意见，则的值为 0，即 k=0。</p><blockquote class="iq ir is"><p id="2cdc" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="hi">加载数据集:</em> </strong></p></blockquote><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="d2d7" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">现在将列车图像的路径保存在列车数据框中</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><blockquote class="iq ir is"><p id="6a76" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">探索数据:</strong></p></blockquote><p id="ebd8" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— — — <em class="iv">绘制图像标签的直方图:</em></p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><figure class="jx jy jz ka fd ij er es paragraph-image"><div class="er es kk"><img src="../Images/76abe20f1215784edc07812528bf959f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*wkHlaspiUU8Qoyuo6BYmwA.png"/></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">从剧情来看，很明显有很多数据不平衡。</figcaption></figure><p id="fcf9" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— — — <em class="iv">绘制一些不同类别的图像:</em></p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><figure class="jx jy jz ka fd ij er es paragraph-image"><div class="er es kl"><img src="../Images/4e63518d4e0523c9b1fe5b62906e45aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*V2xzSHaz6ZEScrxxcd6pFw.png"/></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">从图中，我们可以看到图像在大小和强度上有很大差异。</figcaption></figure><blockquote class="iq ir is"><p id="f8d5" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">数据扩充:</strong></p></blockquote><p id="f104" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">正如我们所知，所提供的数据是高度不平衡的，我们可以使用一种技术来处理它是上采样。上采样基本上是通过使用不同的增强技术从现有数据中创建数据点。在这篇博客中，我们将对 1、4 和 3 级使用水平和垂直翻转增强，因为它们的比例比 0 和 2 级小，并保存这些图像，以便我们可以在训练时使用它们。</p><p id="5e56" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">创建具有 1、4 和 3 类标签的数据帧</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="506e" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">下面的函数返回给定图像的两幅图像，一幅垂直翻转，另一幅水平翻转。</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="49ae" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">现在我们需要保存这些图像，以便以后使用。在此之前，我们需要将图像转换成 RGB 格式，因为 cv2 可以读取 BGR 格式的图像。</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="31e5" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">增强后的数据集是这样的，我们总共有 5062 个数据点。</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><figure class="jx jy jz ka fd ij er es paragraph-image"><div class="er es km"><img src="../Images/88d7e999a96fd40c255603044604155f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*B9Ka1a5bC6kGcxrxAQYB7Q.png"/></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">从图中可以明显看出，我们已经设法在一定程度上减少了阶级的不平衡</figcaption></figure><blockquote class="iq ir is"><p id="6c34" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">数据预处理:</strong></p></blockquote><p id="0c79" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">对于预处理部分，我们将裁剪所有图像，将使用 Ben(前一场比赛的获胜者)使用的图像增亮技术，最后使用阈值处理以获得更好的结果。</p><p id="48f4" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">所以让我们从修剪所有的法师开始。在这一步，我们将裁剪掉所有的暗像素，这样我们就有了一个清晰的图像。但是，如果图像是完全黑暗的，那么我们将裁剪一切，因此，如果裁剪后的形状为 0，我们需要返回原始图像。</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="ab20" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">现在来看本使用的图像增亮技术。在这个函数中，我们首先将图像从 RGB 转换到 BGR，因为 ImageDataGenerator 以 RGB 模式读取图像，而 cv2 以 BGR 模式读取。之后，我们将调整图像的大小，并给它们添加权重。</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="397d" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">之后，我们将应用阈值技术，使不规则很容易看到。</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="39b2" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">在图像变亮后，我也尝试使用 canny 边缘检测技术，但它无法检测出图像中存在的所有不规则之处</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="be18" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">让我们想象一下到目前为止所有预处理的输出。</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><figure class="jx jy jz ka fd ij er es paragraph-image"><div class="er es kn"><img src="../Images/426f3c1a28b07b32fec1607761a2b4ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*8wuDRCHGcDePMWrNSXJ9tA.png"/></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">从图像来看，很明显 canny 边缘检测没有正常工作，所以我们将使用阈值处理</figcaption></figure><blockquote class="iq ir is"><p id="2f3e" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">准备图像数据生成器:</strong></p></blockquote><p id="e2f3" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">现在，我们需要加载所有图像，并将它们分为训练和验证两部分。</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="b811" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">将数据分为训练集和验证集。在分割时，我做了 80-20 分割，并使用分层，因为数据是不平衡的。分割后，我们有 4049 个训练数据和 1013 个验证数据。</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="00d1" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">现在让我们看看训练和验证数据集的分布。</p><p id="2460" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">列车组分布</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ko"><img src="../Images/c92c02f90a65cb2f852029bcceb4b638.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*otFbpO9gx9RlzCUsfYFq5Q.png"/></div></div></figure><p id="63b5" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">有效集分布</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div class="er es kp"><img src="../Images/64db759d3d72e911d20fc66ee374d258.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*vDHbrCiSEMWqhJSbQP7zVA.png"/></div></figure><p id="0daf" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">很明显，训练集和验证集具有相同的分布。</p><p id="f15b" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">我们准备好训练模型了。</p><blockquote class="iq ir is"><p id="bc4e" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">造型:</strong></p></blockquote><p id="7380" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— — <strong class="iw hj"> <em class="iv">基础型号</em> </strong>:</p><p id="e791" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">对于基本模型，我没有训练任何模型，我只是使用了预训练的<a class="ae js" href="https://keras.io/api/applications/vgg/" rel="noopener ugc nofollow" target="_blank"> Vgg16 </a>，在此基础上，我使用了具有 5 个参数和 softmax 激活功能的密集层。结果不是很好，因为它错误地分类了许多 2 类和 3 类数据点。</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="4f61" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">基本模型的训练</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="dd42" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">基本模型的混淆矩阵如下所示。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div class="er es kq"><img src="../Images/689f4eee2da11df36a7db1e25f11101b.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*YMgAA9pv0biIBpnME9HxZA.png"/></div></figure><blockquote class="iq ir is"><p id="d530" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">———<strong class="iw hj">CNN 基本模式:</strong></p></blockquote><p id="a428" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">出于同情，我尝试实现一个 CNN 模型，这是一个基本的模型。该模型似乎是一个哑模型，它将所有的数据点归类到类标签 1。</p><p id="66d7" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">模型架构</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="e29a" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">CNN 模型的训练</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="3817" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">混乱矩阵看起来像这样</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div class="er es kr"><img src="../Images/66ad13d455f44febd8caab8cc88c4295.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*VpOXeQGp1LxhTW3kD9Gc_w.png"/></div></figure><p id="13e8" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">显然，这是一个什么也没学到的愚蠢模型。</p><p id="236b" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— — — <strong class="iw hj"> <em class="iv">转移学习:</em> </strong></p><p id="42ec" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">对于迁移学习，我使用的是<a class="ae js" href="https://keras.io/api/applications/efficientnet/" rel="noopener ugc nofollow" target="_blank"> EfficientNetB3 </a>，图像大小为 300*300，批量大小为 16。我使用分类交叉熵作为损失函数，使用自定义 AUC 作为度量。</p><p id="e82e" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">首先，让我们使用预先训练的 ImageNet 权重初始化模型，并在此基础上使用密集层将问题视为分类。</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="f3e6" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">现在是训练部分，在训练模型时，我使用了 ReduceLROnPlateau 作为回调。其功能是在模型不收敛时降低学习速率。很多时候，训练时发生的情况是，模型没有收敛，这意味着它已经优化，但性能不是很好。这是因为学习率，可能是超过了最小值，所以如果我们减少学习与历元，收敛变得更容易，并提供更好的性能。</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="57b5" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">效率网的结果是令人满意的。它的混淆矩阵是这样的。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div class="er es ks"><img src="../Images/c602939aee3c7c9892b1e73308c49198.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*dPmy6T489ImJLvER28EkYA.png"/></div></figure><p id="cd52" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">我们可以看到，它对 3 类数据点进行了错误分类，但结果仍然足够好。</p><p id="42a8" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— — — <strong class="iw hj"> <em class="iv">集合模型:</em> </strong></p><p id="82bd" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">为了减少有效网络的错误分类点，我尝试通过结合有效网络、vgg16 和 rest 网络实现一个集成模型，但结果并没有太大不同。我用三票多数来预测最终的标签。</p><p id="3ec6" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">架构</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="f4f8" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated"><a class="ae js" href="https://keras.io/api/applications/vgg/" rel="noopener ugc nofollow" target="_blank"> Vgg16 </a>架构</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="5f7f" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated"><a class="ae js" href="https://keras.io/api/applications/efficientnet/" rel="noopener ugc nofollow" target="_blank">高效网络 B3 </a>架构</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="a08c" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">然后是使用这三个模型的预测，我使用了多数票。</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="0f17" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">集合模型的混淆度量看起来像这样。</p><figure class="jx jy jz ka fd ij er es paragraph-image"><div class="er es kt"><img src="../Images/49a1a130d27db7c80dad0b6d4f0df9ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*VxOExPEJVlUA_yuzPeGGAA.png"/></div></figure><p id="66a4" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">显然，有效的网络模型和集合模型之间没有太大的区别。</p><blockquote class="iq ir is"><p id="69ae" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">对比表:</strong></p></blockquote><figure class="jx jy jz ka fd ij er es paragraph-image"><div class="er es ku"><img src="../Images/9240f11dd4bb171a0de7460f296b6af9.png" data-original-src="https://miro.medium.com/v2/resize:fit:604/format:webp/1*3TcZNzNlM5TKEL8oWMEU1w.png"/></div></figure><blockquote class="iq ir is"><p id="f058" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> Kaggle 评分:</strong></p></blockquote><p id="1d6b" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">我的分数:</p><p id="20ad" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— — —私人得分:0.9152</p><p id="5129" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— — —公众评分:0.763837</p><p id="3add" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">最高领导者委员会分数:</p><p id="88e8" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— — —私人得分:0.936129</p><p id="2860" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">— — —公众得分:0.856139</p><blockquote class="iq ir is"><p id="5a34" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">未来工作:</strong></p></blockquote><p id="020f" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">通过在组合时使用更多的模型，或者通过改变阈值，或者通过使用从图像中提取信息的其他技术，可以进一步提高结果。</p><blockquote class="iq ir is"><p id="0cfc" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">参考:</strong></p></blockquote><div class="kv kw ez fb kx ky"><a href="https://www.appliedaicourse.com/" rel="noopener  ugc nofollow" target="_blank"><div class="kz ab dw"><div class="la ab lb cl cj lc"><h2 class="bd hj fi z dy ld ea eb le ed ef hh bi translated">应用课程</h2><div class="lf l"><h3 class="bd b fi z dy ld ea eb le ed ef dx translated">我们知道转行是多么具有挑战性。我们的应用人工智能/机器学习课程被设计为整体学习…</h3></div><div class="lg l"><p class="bd b fp z dy ld ea eb le ed ef dx translated">www.appliedaicourse.com</p></div></div><div class="lh l"><div class="li l lj lk ll lh lm io ky"/></div></div></a></div><div class="kv kw ez fb kx ky"><a href="https://www.kaggle.com/ratthachat/aptos-eye-preprocessing-in-diabetic-retinopathy" rel="noopener  ugc nofollow" target="_blank"><div class="kz ab dw"><div class="la ab lb cl cj lc"><h2 class="bd hj fi z dy ld ea eb le ed ef hh bi translated">APTOS:糖尿病视网膜病变中的眼睛预处理</h2><div class="lf l"><h3 class="bd b fi z dy ld ea eb le ed ef dx translated">使用 Kaggle 笔记本探索和运行机器学习代码|使用来自多个数据源的数据</h3></div><div class="lg l"><p class="bd b fp z dy ld ea eb le ed ef dx translated">www.kaggle.com</p></div></div><div class="lh l"><div class="ln l lj lk ll lh lm io ky"/></div></div></a></div><div class="kv kw ez fb kx ky"><a href="https://www.kaggle.com/carlolepelaars/efficientnetb5-with-keras-aptos-2019" rel="noopener  ugc nofollow" target="_blank"><div class="kz ab dw"><div class="la ab lb cl cj lc"><h2 class="bd hj fi z dy ld ea eb le ed ef hh bi translated">带 Keras 的 efficient net b5(APTOS 2019)</h2><div class="lf l"><h3 class="bd b fi z dy ld ea eb le ed ef dx translated">使用 Kaggle 笔记本探索和运行机器学习代码|使用来自多个数据源的数据</h3></div><div class="lg l"><p class="bd b fp z dy ld ea eb le ed ef dx translated">www.kaggle.com</p></div></div><div class="lh l"><div class="lo l lj lk ll lh lm io ky"/></div></div></a></div><figure class="jx jy jz ka fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/f435b3611bd4929f80a21a3395fb981a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*flqQlq0EvWHDWqgq0yW56A.png"/></div></figure><p id="6117" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">我的 LinkedIn <a class="ae js" href="https://www.linkedin.com/in/anwoy-panigrahi-415754169/" rel="noopener ugc nofollow" target="_blank">个人资料</a></p></div></div>    
</body>
</html>