<html>
<head>
<title>Introduction to ThunderSVM: A Fast SVM Library on GPUs and CPUs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ThunderSVM 简介:基于 GPU 和 CPU 的快速 SVM 库</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-install-and-run-thundersvm-in-google-colab-de1fe49eef85?source=collection_archive---------6-----------------------#2020-08-23">https://medium.com/analytics-vidhya/how-to-install-and-run-thundersvm-in-google-colab-de1fe49eef85?source=collection_archive---------6-----------------------#2020-08-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b413" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以及如何在 Google Colab 上运行它…</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/3761bdc7bcb0fc0c7adcb72267be54a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ybu9fEJ8EG4SY9JGpycwmA.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">在<a class="ae jt" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的<a class="ae jt" href="https://unsplash.com/@thisisengineering?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> ThisisEngineering RAEng </a></figcaption></figure><p id="2cd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">支持向量机(SVM)是一种用于分类和回归的机器学习算法。它是最基本的 ML 算法之一，可用于对高维空间中的点进行分类，并从一组给定的特征中预测实数。如果你想更深入地了解 SVM，请随意阅读以下内容:</p><h2 id="3ab6" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">分类中的 SVM</h2><ul class=""><li id="8887" class="kp kq hi ih b ii kr im ks iq kt iu ku iy kv jc kw kx ky kz bi translated"><a class="ae jt" rel="noopener" href="/machine-learning-101/chapter-2-svm-support-vector-machine-theory-f0812effc72">第二章:SVM(支持向量机)——理论</a></li><li id="ef3f" class="kp kq hi ih b ii la im lb iq lc iu ld iy le jc kw kx ky kz bi translated"><a class="ae jt" href="https://towardsdatascience.com/https-medium-com-pupalerushikesh-svm-f4b42800e989" rel="noopener" target="_blank">支持向量机(SVM)——概述</a></li><li id="00e1" class="kp kq hi ih b ii la im lb iq lc iu ld iy le jc kw kx ky kz bi translated"><a class="ae jt" href="https://towardsdatascience.com/support-vector-machine-simply-explained-fee28eba5496" rel="noopener" target="_blank">支持向量机——简单解释</a></li></ul><h2 id="e96c" class="ju jv hi bd jw jx jy jz ka kb kc kd ke iq kf kg kh iu ki kj kk iy kl km kn ko bi translated">回归的 SVM</h2><ul class=""><li id="4ad1" class="kp kq hi ih b ii kr im ks iq kt iu ku iy kv jc kw kx ky kz bi translated"><a class="ae jt" href="https://towardsdatascience.com/an-introduction-to-support-vector-regression-svr-a3ebc1672c2" rel="noopener" target="_blank">支持向量回归(SVR)简介</a></li><li id="cdaf" class="kp kq hi ih b ii la im lb iq lc iu ld iy le jc kw kx ky kz bi translated"><a class="ae jt" href="https://www.analyticsvidhya.com/blog/2020/03/support-vector-regression-tutorial-for-machine-learning/" rel="noopener ugc nofollow" target="_blank">机器学习的支持向量回归教程</a></li></ul><p id="a0f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将了解如何在 Google Colab 中安装和运行 ThunderSVM。先来看看 thundersvm 是什么…</p><h1 id="09c0" class="lf jv hi bd jw lg lh li ka lj lk ll ke lm ln lo kh lp lq lr kk ls lt lu kn lv bi translated">ThunderSVM</h1><p id="ff0f" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq lw is it iu lx iw ix iy ly ja jb jc hb bi translated"><a class="ae jt" href="https://github.com/Xtra-Computing/thundersvm" rel="noopener ugc nofollow" target="_blank"> ThunderSVM </a>是一个开源库，它利用 GPU 和多核 CPU 应用 SVM 以更快、更高效的方式解决问题。使用<em class="lz"> thundersvm </em>相比<em class="lz"> scikit-learn svm </em>在分类<em class="lz"> </em>中的加速提高随着数据量成比例增加。只需更改一行代码，您就可以将算法速度提高大约 70 倍！</p><p id="4e5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在使用 thundersvm 时，首先您必须按照以下步骤安装它。</p><h1 id="0239" class="lf jv hi bd jw lg lh li ka lj lk ll ke lm ln lo kh lp lq lr kk ls lt lu kn lv bi translated">装置</h1><p id="d06a" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq lw is it iu lx iw ix iy ly ja jb jc hb bi translated">为了充分利用 cpu 和 gpu，请使用 google colab 中的 gpu 运行时。首先打开<a class="ae jt" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank"> colab </a>，从菜单栏<em class="lz">点击<em class="lz">运行时</em> &gt; &gt; <em class="lz">改变运行时类型</em>。</em>接下来，在<em class="lz">硬件加速器</em>下拉菜单中点击<em class="lz"> GPU </em>。这将为您的 google colab 脚本激活一个 gpu 后端。</p><p id="74a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行 thundersvm 需要 CUDA Toolkit 9.0。我们先安装这个。</p><p id="36ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，按如下所示的顺序依次执行以下代码行:</p><pre class="je jf jg jh fd ma mb mc md aw me bi"><span id="c8cb" class="ju jv hi mb b fi mf mg l mh mi">1. !wget <a class="ae jt" href="https://developer.nvidia.com/compute/cuda/9.0/Prod/local_installers/cuda-repo-ubuntu1704-9-0-local_9.0.176-1_amd64-deb" rel="noopener ugc nofollow" target="_blank">https://developer.nvidia.com/compute/cuda/9.0/Prod/local_installers/cuda-repo-ubuntu1704-9-0-local_9.0.176-1_amd64-deb</a></span><span id="adc9" class="ju jv hi mb b fi mj mg l mh mi">2. !ls  # Check if required cuda 9.0 amd64-deb file is downloaded</span><span id="7ee9" class="ju jv hi mb b fi mj mg l mh mi">3. !dpkg -i cuda-repo-ubuntu1704-9-0-local_9.0.176-1_amd64-deb</span><span id="3a0d" class="ju jv hi mb b fi mj mg l mh mi">4. !ls /var/cuda-repo-9-0-local | grep .pub</span><span id="3225" class="ju jv hi mb b fi mj mg l mh mi">5. !apt-key add /var/cuda-repo-9-0-local/7fa2af80.pub</span><span id="4f37" class="ju jv hi mb b fi mj mg l mh mi">6. !apt-get update</span><span id="bb97" class="ju jv hi mb b fi mj mg l mh mi">7. !sudo apt-get install cuda-9.0</span></pre><p id="060b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，运行以下命令检查 CUDA 9.0 是否安装成功:</p><pre class="je jf jg jh fd ma mb mc md aw me bi"><span id="6b2c" class="ju jv hi mb b fi mf mg l mh mi">!nvcc --version</span></pre><p id="4fa1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行后，如果您看到<em class="lz"> Cuda 编译工具，发布 9.0 </em>，在输出的最后一行是具体的版本号，那么安装就完成了。如果您想将它安装在您的本地电脑上，只需在终端中去掉“！”即可按顺序运行上述命令对他们每个人来说。如果您想检查输出结果，安装代码可从<a class="ae jt" href="https://github.com/SifatMd/thundersvm-tutorial/blob/master/Installation_Steps.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>获得。</p><p id="5de4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们将安装 thundersvm。</p><h1 id="dd49" class="lf jv hi bd jw lg lh li ka lj lk ll ke lm ln lo kh lp lq lr kk ls lt lu kn lv bi translated">安装 ThunderSVM</h1><p id="8e36" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq lw is it iu lx iw ix iy ly ja jb jc hb bi translated">运行以下命令将其安装在 google colab 中。</p><pre class="je jf jg jh fd ma mb mc md aw me bi"><span id="91e5" class="ju jv hi mb b fi mf mg l mh mi">!pip install thundersvm</span></pre><p id="2161" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您只想使用 cpu 而不使用 gpu 来执行 thundersvm，请在 colab 中执行以下命令:</p><pre class="je jf jg jh fd ma mb mc md aw me bi"><span id="18e2" class="ju jv hi mb b fi mf mg l mh mi">!pip install thundersvm-cpu</span></pre><p id="df54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您也可以在计算机的终端中运行上述命令，删除“！”安装到您的电脑中。</p><p id="826e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于纯 cpu 版本，不需要安装 CUDA 9.0。在这两种情况下，Thundersvm 将使用 cpu 的所有核心。以下步骤对于 cpu 和 gpu 版本是相同的。</p><h1 id="1bf8" class="lf jv hi bd jw lg lh li ka lj lk ll ke lm ln lo kh lp lq lr kk ls lt lu kn lv bi translated">执行</h1><p id="3ff8" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq lw is it iu lx iw ix iy ly ja jb jc hb bi translated">让我们以如下方式用 thundersvm 运行支持向量分类:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="0bd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，除了修改 import 语句，其他都类似于运行<a class="ae jt" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html" rel="noopener ugc nofollow" target="_blank"><em class="lz">scikit-learn SVM</em></a>。</p><h1 id="9972" class="lf jv hi bd jw lg lh li ka lj lk ll ke lm ln lo kh lp lq lr kk ls lt lu kn lv bi translated">加速评估</h1><p id="03bb" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq lw is it iu lx iw ix iy ly ja jb jc hb bi translated">要查看<em class="lz"> scikit-learn svm </em>和<em class="lz"> thundersvm </em>的速度提升对比，让我们看看下面的代码。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="226b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经可以看到拟合训练数据的速度提高了 50 多倍。预测和评分功能的速度也提高了 17 倍以上。如果我们继续增加数据量，以上三个函数的加速都会成比例增加。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mm"><img src="../Images/faff4e6e487d270be8c074929d8a2d70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O5AWlQGNxYvdK7JR-yCoUA.png"/></div></div></figure><p id="c049" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将数据量从 50，000 增加到 100，000，将<em class="lz"> Fit </em>函数的加速从 20 倍提高到 70 倍。当我们跨越 200，000 个样本时，<em class="lz"> thundersvm </em>在训练速度上实现了超过 120 倍的加速！<em class="lz">得分</em>和<em class="lz">预测</em>功能也导致执行时间加速超过 20 倍。我在 google colab 使用期间，用的是特斯拉-P100 gpu。根据 gpu 类型的不同，加速比的个别增加率可能会有所不同。</p><p id="b239" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">加速和可视化的比较代码可以在<a class="ae jt" href="https://github.com/SifatMd/thundersvm-tutorial/blob/master/compare_and_visualize.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="b929" class="lf jv hi bd jw lg lh li ka lj lk ll ke lm ln lo kh lp lq lr kk ls lt lu kn lv bi translated">结论</h1><p id="a742" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq lw is it iu lx iw ix iy ly ja jb jc hb bi translated">SVM 在处理大量数据时会非常慢。但是，通过使用 thundersvm，您可以轻松地加速代码的各个方面。可以在 Linux，Windows，MacOS 中使用。Thundersvm 还支持 LibSVM 的所有功能，包括支持向量回归(SVR)、单类支持向量机和概率支持向量机。你可以点击<a class="ae jt" href="https://thundersvm.readthedocs.io/en/latest/get-started.html" rel="noopener ugc nofollow" target="_blank">了解更多信息。</a></p><p id="e1a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望这对您的编码之旅有所帮助。万事如意！😀</p></div><div class="ab cl mn mo gp mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="hb hc hd he hf"><p id="5491" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读！如果你喜欢这个帖子或者有任何问题/评论，请在下面留下评论！</p><p id="9cb0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇文章的代码可以在我的 GitHub 页面上找到。</p></div></div>    
</body>
</html>