<html>
<head>
<title>Azure Synapse SQL Server less Create facts and dimensions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Azure Synapse SQL Server less创建事实和维度</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/azure-synapse-sql-server-less-create-facts-and-dimensions-e9ea35cd025b?source=collection_archive---------16-----------------------#2020-12-01">https://medium.com/analytics-vidhya/azure-synapse-sql-server-less-create-facts-and-dimensions-e9ea35cd025b?source=collection_archive---------16-----------------------#2020-12-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="7e99" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">复制公共数据集并创建事实和维度</h1><h1 id="60f6" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">用例</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/284c980e9389c84d5e5d8adab8e6f811.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/0*QkUbRuOvXcXyrDoU.jpg"/></div></figure><ul class=""><li id="00f7" class="jl jm hi jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">转到浏览图库并选择数据集</li><li id="2fdc" class="jl jm hi jn b jo kd jq ke js kf ju kg jw kh jy jz ka kb kc bi translated">按县选择美国人口</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es ki"><img src="../Images/b30eaca5b068142a3c8a179ef4e9f600.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9SQ3jj317La2-Cac.jpg"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es ki"><img src="../Images/ebad02a1d2ff1ea5c00f73d069776347.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BImZfbjfOzdvuT69.jpg"/></div></div></figure><ul class=""><li id="5fa8" class="jl jm hi jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">要查看开源数据</li><li id="0090" class="jl jm hi jn b jo kd jq ke js kf ju kg jw kh jy jz ka kb kc bi translated">在synapse工作区中打开查询</li></ul><pre class="je jf jg jh fd kn ko kp kq aw kr bi"><span id="3f20" class="ks ig hi ko b fi kt ku l kv kw">SELECT TOP 100 * FROM OPENROWSET( BULK     'https://azureopendatastorage.blob.core.windows.net/censusdatacontainer/release/us_population_county/year=*/*.parquet', FORMAT = 'parquet' ) AS [result];</span></pre><ul class=""><li id="7c5f" class="jl jm hi jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">现在是时候用拼花储物件创造事实和维度了</li><li id="f919" class="jl jm hi jn b jo kd jq ke js kf ju kg jw kh jy jz ka kb kc bi translated">确保你有万能钥匙。然后创建数据源。</li><li id="9dec" class="jl jm hi jn b jo kd jq ke js kf ju kg jw kh jy jz ka kb kc bi translated">我用nyctaxi作为数据库。如果需要，创建你自己的</li><li id="2496" class="jl jm hi jn b jo kd jq ke js kf ju kg jw kh jy jz ka kb kc bi translated">创建要写入的数据源</li><li id="b914" class="jl jm hi jn b jo kd jq ke js kf ju kg jw kh jy jz ka kb kc bi translated">我已经根据文档创建了sqlondemand/无服务器/内置凭据</li></ul><pre class="je jf jg jh fd kn ko kp kq aw kr bi"><span id="05d3" class="ks ig hi ko b fi kt ku l kv kw">DROP EXTERNAL DATA SOURCE uspopulation; <br/>use nyctaxi <br/>CREATE EXTERNAL DATA SOURCE myuspopulation WITH ( LOCATION = 'https://storagename.blob.core.windows.net/uspopulation', CREDENTIAL = sqlondemand ); <br/>GO</span></pre><ul class=""><li id="62e6" class="jl jm hi jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">让我们首先创建事实</li><li id="1518" class="jl jm hi jn b jo kd jq ke js kf ju kg jw kh jy jz ka kb kc bi translated">将创建一个名为fact/的文件夹</li></ul><pre class="je jf jg jh fd kn ko kp kq aw kr bi"><span id="e6e8" class="ks ig hi ko b fi kt ku l kv kw">use nyctaxi <br/>CREATE EXTERNAL TABLE [dbo].[factpopulation] WITH <br/>( <br/>LOCATION = 'fact/', <br/>DATA_SOURCE = [myuspopulation], <br/>FILE_FORMAT = [ParquetFF] ) AS <br/>SELECT     * FROM OPENROWSET( BULK     'https://azureopendatastorage.blob.core.windows.net/censusdatacontainer/release/us_population_county/year=*/*.parquet', FORMAT = 'parquet' ) AS [result];</span></pre><ul class=""><li id="6104" class="jl jm hi jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">现在是时候从事实中创建其他维度来模拟连接了</li><li id="7229" class="jl jm hi jn b jo kd jq ke js kf ju kg jw kh jy jz ka kb kc bi translated">创建dimstate</li></ul><pre class="je jf jg jh fd kn ko kp kq aw kr bi"><span id="6f53" class="ks ig hi ko b fi kt ku l kv kw">CREATE EXTERNAL TABLE [dbo].[dimstate] WITH ( LOCATION = 'dimstate/', DATA_SOURCE = [myuspopulation], FILE_FORMAT = [ParquetFF] ) AS Select distinct StateName from dbo.factpopulation</span><span id="6d8b" class="ks ig hi ko b fi kx ku l kv kw">CREATE EXTERNAL TABLE [dbo].[dimcountyname] WITH ( LOCATION = 'dimcountryname/', DATA_SOURCE = [myuspopulation], FILE_FORMAT = [ParquetFF] ) AS Select distinct CountyName from dbo.factpopulation</span><span id="2b2e" class="ks ig hi ko b fi kx ku l kv kw">CREATE EXTERNAL TABLE [dbo].[dimRace] WITH ( LOCATION = 'dimRace/', DATA_SOURCE = [myuspopulation], FILE_FORMAT = [ParquetFF] ) AS Select distinct Race from dbo.factpopulation</span><span id="14ae" class="ks ig hi ko b fi kx ku l kv kw">CREATE EXTERNAL TABLE [dbo].[dimSex] WITH ( LOCATION = 'dimsex/', DATA_SOURCE = [myuspopulation], FILE_FORMAT = [ParquetFF] ) AS Select distinct Sex from dbo.factpopulation</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es ky"><img src="../Images/8c624c209b476aa2585ae2fd20d7518c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*M-IgMs0WYgIEGH-T.jpg"/></div></div></figure></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><p id="a548" class="pw-post-body-paragraph lg lh hi jn b jo jp li lj jq jr lk ll js lm ln lo ju lp lq lr jw ls lt lu jy hb bi translated"><em class="lv">最初发表于</em><a class="ae lw" href="https://github.com/balakreshnan/Accenture/blob/master/cap/populationdataset.md" rel="noopener ugc nofollow" target="_blank"><em class="lv">【https://github.com】</em></a><em class="lv">。</em></p></div></div>    
</body>
</html>