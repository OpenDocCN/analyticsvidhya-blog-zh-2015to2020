<html>
<head>
<title>Introduction to SQL Using Python: Filtering Data with the WHERE Statement</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python的SQL简介:使用WHERE语句过滤数据</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/introduction-to-sql-using-python-filtering-data-with-the-where-statement-80d89688f39e?source=collection_archive---------0-----------------------#2019-10-27">https://medium.com/analytics-vidhya/introduction-to-sql-using-python-filtering-data-with-the-where-statement-80d89688f39e?source=collection_archive---------0-----------------------#2019-10-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="49a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结构化查询语言，通常称为SQL，是一种功能强大的关系数据库语言。这种语言允许您访问和操作存储在SQL数据库中的数据。本教程将向您展示如何使用Python获得SQL的强大功能，以及如何使用WHERE语句过滤数据。</p><p id="4eb5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一步是导入必要的库。您将需要导入sqlite3，这将允许您连接到SQL数据库并运行SQL查询。你还需要进口熊猫。Pandas将允许您以清晰易读的数据框格式查看查询结果。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/2c43d1a6727bd46f4d90a800aa84c247.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*rH7WKvVA3tMl-uaugAS6oQ.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">导入必要的库</figcaption></figure><p id="764b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于本教程，将使用足球德尔福数据库。你可以在这里下载数据库，<a class="ae jp" href="https://www.kaggle.com/laudanum/footballdelphi" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/laudanum/footballdelphi</a>。花些时间阅读描述，以了解更多关于我们将使用的数据库和表的信息。</p><p id="3702" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，您需要连接到数据库并创建一个游标对象。稍后我们将调用cursors execute方法来运行SQL查询。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jq"><img src="../Images/6af37f644b503eac4c529c51a9e87dfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*xqsB3Dfj4yX2FPojuZmN3w.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">连接到数据库并创建光标对象</figcaption></figure><p id="594b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你现在应该连接到足球德尔福数据库。这是一个关系数据库。关系数据库包括表。每个表都是存储信息的唯一数据集。每个表格由列和行组成。该数据库包括四个表:</p><ul class=""><li id="54c5" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">独特_团队</li><li id="d00d" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated">比赛</li><li id="2f84" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated">组</li><li id="1ed2" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated">比赛中的球队</li></ul><p id="6ffc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要运行SQL查询并以易于查看的数据框格式进行查看，我们将使用以下代码:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es kf"><img src="../Images/0fb8d18fb9d6423ca653e0ec720ff08b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z_8-_hcRY0ZYjtJs_TK0rg.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">Python格式的SQL查询</figcaption></figure><p id="d4fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于第一个查询，我们将预览表<strong class="ih hj"> Unique_Teams </strong>的内容。为此，我们可以运行以下查询:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es kk"><img src="../Images/24b96c07abc3a559a87381b28e51e48f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ttzHRlz7xtsC5Q2Df6itiw.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">唯一_团队表</figcaption></figure><p id="e17f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> SELECT </strong>语句告诉数据库我们试图从数据集中提取哪些列。星号(*)告诉数据库我们要选择表中所有可用的列。语句中的<strong class="ih hj">告诉数据库我们想要从表<strong class="ih hj"> Unique_Teams </strong>中选择数据。SQL查询以分号(；).这告诉数据库您已经结束了查询，就像句号结束一个句子一样。</strong></p><p id="a2e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以自己练习，尝试查询<strong class="ih hj"> Matches </strong>表的所有内容，并将您的查询与下面的答案进行比较。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es kl"><img src="../Images/5bfdaf4c9088e38ffe63dbd49c2b21ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G21cEvljNPKEct3M3iOnUA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">匹配表</figcaption></figure><p id="5f93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我们将在本教程的剩余部分使用的表。<strong class="ih hj">匹配</strong>表中有9列。下载该数据库的Kaggle页面对每一列的描述如下:</p><ul class=""><li id="ce49" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated"><strong class="ih hj"> Match_ID </strong> (int):每个匹配的唯一ID</li><li id="0f82" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated"><strong class="ih hj"> Div </strong> (str):标识比赛所在的级别(D1 =德甲，D2 =德甲2，E0 =英超)</li><li id="acb4" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated">赛季:比赛发生的赛季(通常指八月到第二年五月)</li><li id="6b9c" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated"><strong class="ih hj">日期</strong> (str):比赛日期</li><li id="2145" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated"><strong class="ih hj">主队</strong> (str):主队名称</li><li id="b696" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated"><strong class="ih hj">客场队</strong> (str):客场队的名称</li><li id="aac3" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated"><strong class="ih hj"> FTHG </strong> (int)(全职主场进球):主队的进球数</li><li id="41d0" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated"><strong class="ih hj"> FTAG </strong> (int)(全职客场进球):客场球队的进球数</li><li id="13fd" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated"><strong class="ih hj"> FTR </strong> (str)(全职成绩):比赛三方结果(H =主场胜，D =平局，A =客场胜)</li></ul><p id="0d52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">也许我们只想选择列<strong class="ih hj"> Match_ID </strong>。为此，我们只需在select语句中写入<strong class="ih hj"> Match_ID </strong>，而不是星号。下面的代码显示了这是如何实现的:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es km"><img src="../Images/9a06009c685dba147444df51efcd24dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aY0YcqRlv67hn0UkBVxcOw.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">查看匹配标识</figcaption></figure><p id="7e90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">尝试从<strong class="ih hj"> Matches </strong>表中只选择列<strong class="ih hj"> HomeTeam </strong>，并将您的代码与下面的查询进行比较:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es kn"><img src="../Images/6e42c565119b4c2e87ebba528a5fde6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7q93DlzK86WctdEJtDX04Q.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">从比赛中选择主队；</figcaption></figure><p id="a789" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过在select语句中键入每一列的名称并用逗号(，)分隔每一列的名称，可以选择多个列。您可以在下面的每场比赛中看到主队和客场队的名称:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ko"><img src="../Images/8c5a0a82b54dd9750ac1d29ad3f3ae54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OPuqVP0m1va7nVj8pnofZw.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">从比赛中选择主队、客场；</figcaption></figure><p id="25fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过从<strong class="ih hj"> Matches </strong>表中选择<strong class="ih hj"> Match_ID </strong>和<strong class="ih hj"> Date </strong>来练习选择多个列，并将您的查询与下面的代码进行比较:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es kp"><img src="../Images/cbf46295699d2a91ef5a01f0f9abde4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TS01RGt6i258kpfctbnfeg.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">SELECT Match_ID，Date FROM Matches。</figcaption></figure><h1 id="9420" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">WHERE语句</h1><p id="fa56" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">Matches表中有24，625行。这使得很难找到具体的信息。也许我们只想要2015赛季的信息。为此，我们可以在SQL查询中添加一个<strong class="ih hj"> WHERE </strong>语句。<strong class="ih hj"> WHERE </strong>语句允许我们选择满足特定条件的信息。要从<strong class="ih hj"> Matches </strong>表中查询仅与2015赛季相关的信息，我们可以使用以下查询:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lt"><img src="../Images/6492f33125db9f26a560dee4219ce5a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dKbofDBzOuJaP-Zc-QAL0w.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">SELECT * FROM Season = 2015的比赛；</figcaption></figure><p id="6f48" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们只有992行，每一行都来自2015赛季的比赛。这使我们能够查看2015赛季的数据，比以前滚动整个表格要容易得多。正如<strong class="ih hj"> SELECT </strong>语句允许我们从数据表中返回指定的列一样，<strong class="ih hj"> WHERE </strong>语句允许我们从数据集中返回满足特定条件的特定行，比如Season = 2015。要练习使用<strong class="ih hj"> WHERE </strong>语句，请编写一个查询，从<strong class="ih hj"> Matches </strong>表中选择全职家庭目标(<strong class="ih hj"> FTHG </strong>)等于5的所有列，并将您的查询与下面的查询进行比较:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lu"><img src="../Images/38e4de46946ea138d524f677c332f977.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PfDXiEdVVQUo_rpzm60itA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">SELECT * FROM FTHG = 5的匹配项；</figcaption></figure><p id="35b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">到目前为止，我们只在<strong class="ih hj"> WHERE </strong>语句中使用了数字数据。为了在<strong class="ih hj"> WHERE </strong>语句中使用字符串数据，我们需要用引号将我们用作条件的数据括起来。要查询阿森纳是主队的所有数据，我们可以使用下面的查询:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lv"><img src="../Images/63aa75dfc9674aa08480998b9df8b0ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7hzY5PLrLPKTrwciVkJTVA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">SELECT * FROM home team = '阿森纳'的比赛；</figcaption></figure><p id="788f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要练习在<strong class="ih hj"> WHERE </strong>语句中使用字符串数据作为条件，请选择D2分部中的所有列，并将您的查询与下面的查询进行比较:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lw"><img src="../Images/2088ad4718181d0b7bb060814132b4e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bRD1BmeZVTFALazXZMKLMQ.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">SELECT * FROM Matches WHERE Div = ' D2 '；</figcaption></figure><h1 id="714b" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">比较运算符</h1><p id="151c" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">到目前为止，我们只在<strong class="ih hj"> WHERE </strong>语句中使用了等号(=)作为运算符。除等号外，您还可以使用其他运算符，包括:</p><ul class=""><li id="4e24" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated"><strong class="ih hj"> &gt; </strong>(大于)</li><li id="314c" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated"><strong class="ih hj"> &lt; </strong>(小于)</li><li id="5231" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated"><strong class="ih hj"> &gt; = </strong>(大于或等于)</li><li id="b2cf" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated"><strong class="ih hj"> &lt; = </strong>(小于或等于)</li><li id="9226" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated"><strong class="ih hj">！= </strong>(不等于)</li></ul><p id="8603" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要查看来自<strong class="ih hj"> Matches </strong>表的所有数据，其中客队得分3次或更多，我们可以使用以下查询:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lv"><img src="../Images/b16e10bb7802d4d27c602a2f745252c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cAVKwOaGg9l8Si9gjOaVRA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">从FTAG ≥ 3的匹配项中选择*；</figcaption></figure><p id="966d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要练习在<strong class="ih hj"> WHERE </strong>语句中使用条件运算符，请查询<strong class="ih hj"> Matches </strong>表中的所有数据，其中主队没有获胜。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lx"><img src="../Images/b3b100bd4d5b0ddb8ff8fbef9762d37a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Iyy1Fq7gKITeZB5ZjXpF1A.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">SELECT * FROM Matches WHERE FTR！= ' H</figcaption></figure><h1 id="417d" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">AND &amp; OR:在WHERE语句中使用多个条件</h1><p id="b47e" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">到目前为止，我们只在<strong class="ih hj"> WHERE </strong>语句中放置了一个条件，但是也可以在<strong class="ih hj"> WHERE </strong>语句中放置多个条件。为此，您可以在SQL查询中添加一个<strong class="ih hj">和</strong>或<strong class="ih hj">或</strong>子句来进一步过滤您的结果。在<strong class="ih hj"> WHERE </strong>语句中使用<strong class="ih hj">和</strong>子句时，<strong class="ih hj">和</strong>子句两边的每个语句都必须为真，才能返回观察值。要了解这是如何工作的，下面的查询将显示来自<strong class="ih hj"> Matches </strong>表的所有观察结果，其中曼联是主队，比赛的最终结果是平局。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ly"><img src="../Images/c895991e5e4b27187a48e5e483d7f6e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e_zmYu1sc7SR1u_ozYHtsA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">SELECT *从主队= '曼联'和FTR = 'D '的比赛中选择；</figcaption></figure><p id="8b7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<strong class="ih hj"> WHERE </strong>语句中使用<strong class="ih hj">或</strong>子句时，只有当第一个条件为真或第二个条件为真时，才会在结果中包含行。如果一个观察的两个条件都为真，那么该观察也将被返回。要了解<strong class="ih hj">或</strong>子句的工作原理，请查看以下查询，该查询显示了来自<strong class="ih hj"> Matches </strong>表中2012赛季或2013赛季的所有行:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lz"><img src="../Images/227c26682a372727e95490ba9dbff691.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3_vsBBOw8cCfR5Mo0jhN8A.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">SELECT * FROM Season = 2012或Season = 2013的比赛；</figcaption></figure><p id="ece5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要练习使用<strong class="ih hj"> WHERE </strong>语句中的<strong class="ih hj">和</strong>子句，请从<strong class="ih hj"> Matches </strong>表中选择主队得分超过3分且客队赢得比赛的所有行，并与下面的查询进行比较:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ma"><img src="../Images/acc3d1d09f3d2ab08935640a37619ea1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LxaAd9fdMWy7MiRG3Y3NKA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">SELECT * FROM FTHG &gt; 3且FTR = 'A '的匹配项；</figcaption></figure><p id="ac49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了练习在<strong class="ih hj"> WHERE </strong>语句中使用<strong class="ih hj">或</strong>子句，从<strong class="ih hj"> Matches </strong>表中选择主队、客场队、FTHG、FTAG、FTR，其中主队进球超过7个或客场队进球超过7个，并与下面的查询进行比较:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es mb"><img src="../Images/9e8572969789bd44af9c63e666d49487.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HOJ-X9Ttp1QssDKgBlDThw.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">从FTHG &gt; 7或FTAG &gt; 7的比赛中选择主场队、客场队、FTHG、FTAG、FTR；</figcaption></figure><h1 id="6ef0" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">BETWEEN &amp; NOT BETWEEN:过滤落在某个范围内的行</h1><p id="edd1" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">现在，我们将介绍另外两个可以包含在<strong class="ih hj"> WHERE </strong>语句中的子句，<strong class="ih hj">BETWEEN</strong>and<strong class="ih hj">NOT BETWEEN</strong>。使用一个<strong class="ih hj"> BETWEEN </strong>子句，您可以根据被过滤的列中的值必须在两个值之间才能返回的条件来过滤结果。例如，如果我们想要选择2012赛季到2015赛季的所有比赛，我们将使用以下查询:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es mc"><img src="../Images/a1279ee38077322f57b343c2ad348fa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gm1FEJyPhXkBKL2a5C0RIQ.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">从EN 2012和2015赛季之间的比赛中选择*；</figcaption></figure><p id="8210" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> NOT BETWEEN </strong>子句以相反的方式工作。如果我们在上面的查询中用<strong class="ih hj">不在</strong>之间代替<strong class="ih hj">在</strong>之间，它将只显示不包括在2012-2015赛季范围内的比赛。因此，2012赛季之前的比赛将被包括在内，2015赛季之后的比赛将被包括在返回的结果中，但2012赛季和2015赛季之间的比赛都不会被包括在内。要查询Match_ID不在25和46，750之间的匹配，我们可以使用以下查询:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es md"><img src="../Images/2b964ff10a5ae325f9967c67a067d6a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cL7orgYniADSK9GOKkCPjQ.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">SELECT * FROM Matches不在EN 25和46750之间的匹配项；</figcaption></figure><p id="b4b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">自己练习的话，从所有主队进球数在7到9之间，客队进球数不在0到3之间的比赛中选择FTHG，FTAG，FTR。完成后，将您的查询与下面的查询进行比较:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es me"><img src="../Images/421d00970c254cf9b9803a535a3201dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Un5rPPJc0wa7v69uEgQ-Bg.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">从匹配的WHERE (FTHG介于EN 7和9之间)和(FTAG不介于EN 0和3之间)中选择FTHG、FTAG和FTR；</figcaption></figure><h1 id="6cf4" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">IN():从列表中选择值</h1><p id="79f5" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">有时您可能只想选择包含在某个列表中的数据。这就是操作符中的<strong class="ih hj">开始使用的时候。如果只想在条件包含在列表中时返回行，可以在<strong class="ih hj"> WHERE </strong>语句中使用</strong>中的<strong class="ih hj">运算符。例如，以下查询将返回切尔西、赫尔或沃特福德是主队的所有比赛:</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es mf"><img src="../Images/0e1889b8a08381c18038b4427a7fb55f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0No2CcVl1RHG0vHCc1XwEw.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">SELECT * FROM home team IN(' Chelsea '，' Hull '，' Watford ')；</figcaption></figure><p id="d8b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当客场球队是利物浦、曼城或斯旺西时，练习使用运算符中的<strong class="ih hj">从<strong class="ih hj"> Matches </strong>表中选择客场球队，并将您的查询与下面的查询进行比较:</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es mg"><img src="../Images/57b4a85cd371833fcd79fb487b18cfb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*acop2z5hUcUfK_djSjvtAA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">从客场队所在的比赛中选择客场队('利物浦'，'曼城'，'斯旺西')；</figcaption></figure><h1 id="b651" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">LIKE运算符:过滤字符串数据</h1><p id="048a" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">接下来，我们将介绍类似于运算符的<strong class="ih hj">。当您想要过滤字符串数据时，此运算符非常有用。要了解它是如何工作的，请看下面的查询。该查询将返回主队名称以“A”开头的所有匹配项。</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es mh"><img src="../Images/4462ed5d320575b68ede58ab4e354109.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xYM4eKa3rGzA-5KjXLC9GA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">从主队喜欢“A%”的比赛中选择*；</figcaption></figure><p id="ede6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<strong class="ih hj">之后，像</strong>一样的语句我们用引号括起来，A%。A告诉我们，语句必须以A开头。百分号就像通配符一样使用。A后面的任何内容都不必是任何特定的值。要了解其工作原理，请查看以下内容:</p><ul class=""><li id="56e5" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated"><strong class="ih hj">WHERE</strong>HomeTeam<strong class="ih hj">LIKE</strong>' Be % '(返回home team以“Be”开头的行)</li><li id="1970" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated"><strong class="ih hj">WHERE</strong>HomeTeam<strong class="ih hj">LIKE</strong>' % ty '(返回home team以“ty”结尾的行)</li><li id="a82e" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated"><strong class="ih hj">WHERE</strong>HomeTeam<strong class="ih hj">LIKE</strong>' % a % '(返回home team包含“a”的行)</li></ul><p id="47e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">练习使用<strong class="ih hj"> LIKE </strong>语句返回所有客场球队名称包含“City”的比赛，并与以下代码进行比较:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es mi"><img src="../Images/91975c400fcc82399d2856d426ec6fe9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xaQitLN1jWStGDpdZfu40g.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">SELECT * FROM Matches WHERE away team LIKE“% City %”；</figcaption></figure><p id="3121" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你也可以用不像的术语<strong class="ih hj">。如果您想要返回日期不是以2017开始的所有匹配项，您可以使用以下查询:</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es mj"><img src="../Images/4ab4096a20e21f5c4178c7d7e06382fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yvqms88Z_iy7mBDMr7dQlg.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">SELECT * FROM日期不同于“2017%”的匹配项；</figcaption></figure><p id="21e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要自己练习，从<strong class="ih hj"> Matches </strong>表中选择所有日期不以2016开始、HomeTeam名称以“y”结尾且AwayTeam名称不包含“e”的列。将您的查询与下面的查询进行比较:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es mk"><img src="../Images/a99fab044f1effab198c283d60926f32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qXENiuUI7W_S3QVECZE8Kg.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">SELECT * FROM Matches WHERE(Date NOT LIKE ' 2016% ')AND(home team LIKE ' % y ')AND(away team NOT LIKE ' % e % ')；</figcaption></figure><h1 id="3cd4" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">IS NULL &amp; IS NOT NULL:处理缺失值</h1><p id="4d01" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">有时，某些行中可能会缺少数据。这些值被称为空数据。您可以在<strong class="ih hj"> WHERE </strong>语句中使用子句<strong class="ih hj"> IS NULL </strong>来检查特定列是否缺少任何数据。要查看Matches表中是否缺少任何匹配的结果，我们可以使用以下查询:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ml"><img src="../Images/da3d91aebc925bbb1a3fbfeeafad9902.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RRvjkcepAymwe-9iOjXLqw.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">从FTR为空的匹配项中选择*；</figcaption></figure><p id="aa4d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们收到一个长度不匹配错误。这是因为现在有观察结果表明一场比赛的结果是未知的。那很好。练习使用<strong class="ih hj"> IS NULL </strong>子句检查<strong class="ih hj"> Matches </strong>表中的任何观察值是否缺少任何主队进球计数，并将您的查询与下面的查询进行比较:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es mh"><img src="../Images/6600b81ae5dcf6a04ff6806bfac641c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WwnwVGyT2_fT8FX3wTuMaA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">SELECT * FROM FTHG为空的匹配项；</figcaption></figure><p id="aeef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不应缺少任何值。语句<strong class="ih hj">不为空</strong>以相反的方式工作。这将返回某列没有空值<strong class="ih hj">的所有值。以下查询显示了来自<strong class="ih hj"> Matches </strong>表的所有观察结果，其中HomeTeam列中没有空值。</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es mm"><img src="../Images/dd9ea9bcb43fccd8dc44139c7eadaca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XiZie5uSofFuZO0apHFNOQ.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">SELECT * FROM home team不为空的匹配项；</figcaption></figure><p id="a5c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">练习使用<strong class="ih hj"> NOT NULL </strong>子句，方法是查询Matches表中日期不为空值的所有列，并与下面的查询进行比较:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es mn"><img src="../Images/22fdf3954e440643d1a20eae03a6d883.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QNiLmnKptFz2-7MNSIJGfA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">SELECT * FROM Date不为空的匹配项；</figcaption></figure><p id="48ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<strong class="ih hj">时需要注意的一件重要事情是NULL </strong>和<strong class="ih hj">不是NULL </strong>，零值不等同于NULL值。NULL是缺失值，0值不是缺失值。</p><p id="2a58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本教程到此结束。我们已经介绍了如何使用python连接和查询SQL数据库。我们还讨论了什么是<strong class="ih hj"> WHERE </strong>语句，以及以下可用于<strong class="ih hj"> WHERE </strong>语句的过滤技术:</p><ul class=""><li id="e824" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated">比较运算符</li><li id="1a6a" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated">与或</li><li id="db69" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated">介于两者之间&amp;而非两者之间</li><li id="17a8" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated">在…里</li><li id="d6bb" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated">喜欢&amp;不喜欢</li><li id="ad6c" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated">为空&amp;不为空</li></ul><p id="ee9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我鼓励您继续练习使用这些技术，以便更深入地理解如何使用<strong class="ih hj"> WHERE </strong>语句过滤SQL表。</p></div></div>    
</body>
</html>