<html>
<head>
<title>Predicting genes with CNN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用CNN预测基因</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predicting-genes-with-cnn-bdf278504e79?source=collection_archive---------7-----------------------#2020-09-30">https://medium.com/analytics-vidhya/predicting-genes-with-cnn-bdf278504e79?source=collection_archive---------7-----------------------#2020-09-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="fd67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">用于宏基因组学基因预测的卷积神经网络</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/dd465b7eeda5041aafd8783e2d2652c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e7hk9EQOAVirEJ6TPLlKQA.jpeg"/></div></div></figure><h1 id="9305" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">基因组学中的深度学习</h1><p id="0712" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">预测宏基因组片段中的基因是一项具有计算挑战性的任务，由于数据的短读取长度、不完整和碎片化性质，传统的机器学习技术提取大量特征，然后应用统计方法或监督分类方法来预测基因。</p><p id="1aa9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本研究使用卷积神经网络进行宏基因组学基因预测，克服了特征提取和选择步骤，该方法能够学习编码区和非编码区的特征，并直接从原始DNA序列中区分编码区和非编码区。</p><p id="ad0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">卷积神经网络(CNN)展示了基因组学中功能基序的最新预测。细胞神经网络在需要输入中的一些空间不变模式的设置中是有用的，例如图像或序列数据。CNN的输入通常是实值矩阵。在基因组学中，输入可以是DNA序列，其中核苷酸A、C、T和G被编码为[1，0，0，0]、[0，1，0，0]、[0，0，1，0]和[0，0，0，0，1]。直接读取数据输入的神经元被称为第一层，或输入层。第二层由读入第一层输出的神经元组成，对于更深的层也是如此，更深的层也被称为隐藏层。神经网络的输出是感兴趣的预测，例如，输入的DNA是否是增强子。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ks"><img src="../Images/5d0438b492b1680e49b4de32da189f5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I4IKkuTqIwPjnhotskCYBQ.png"/></div></div></figure><h1 id="41bf" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">加载训练数据</h1><p id="3d3e" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">我们使用这个<a class="ae kt" href="http://180.208.58.19/Meta-MFDL/" rel="noopener ugc nofollow" target="_blank">链接</a>下提供的traTest700.zip数据来训练和测试我们的方法</p><p id="2d90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们填充所有的基因组，然后从文件中提取所有的编码和非编码orf。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ku kv l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kw"><img src="../Images/9a237cec16b6f17156c05359a1058bda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*egaOfLiZ0t9QW4yT0i8UxQ.png"/></div></div></figure><p id="c9d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们提取所有的orf。非编码orf标记为0，编码标记为1，这一步我们提取了近4百万个orf</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ku kv l"/></div></figure><p id="02bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为训练400万个orf在计算上很昂贵，所以我只选择了85000个orf，并在这个<a class="ae kt" href="https://drive.google.com/drive/folders/1YcOCetzL8X4-YK-ShdWgih0YGWnBHLB2?usp=sharing" rel="noopener ugc nofollow" target="_blank">链接</a>下上传到google drive，以便在google colab中训练模型。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kx"><img src="../Images/a97a6b38e5641abf71b4a3952ca7a162.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZW2LTs9FDowEte9mTiLGZg.png"/></div></div></figure><h1 id="dc0a" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">从colab中读取数据</h1><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ku kv l"/></div></figure><p id="3bd8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在阅读完数据后，我们对orf应用一热编码，我在这篇<a class="ae kt" rel="noopener" href="/@elferachid/one-hot-encoding-dna-92a1c29ba15a">文章</a>中解释了这一点。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ku kv l"/></div></figure><p id="7eb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">orf总是有不同的长度，深度学习无法处理可变大小的输入，所以我们应用了我之前帖子中解释的帖子填充，你可以在这里找到<a class="ae kt" rel="noopener" href="/@elferachid/handling-variable-size-dna-input-c4bbb1df0458"/>。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ku kv l"/></div></figure><p id="3131" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们需要对标签进行一次热编码，并将编码的orf堆叠到numpy数组中。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ku kv l"/></div></figure><p id="6ab7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在创建模型之前，我们还有最后一步，你猜猜看！？。将数据分为训练和测试。我们使用20%的数据作为测试集。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ku kv l"/></div></figure><p id="5996" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，是时候创建我们的CNN模型了，超参数步骤已经完成。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ku kv l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ky"><img src="../Images/47e4b4b27b46b899e5606c4ca67a7797.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GaFLr1OjHO391sr7CLO8oQ.png"/></div></div></figure><p id="a85c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们训练我们的模型并观察它的性能，训练数据分为70%用于训练，30%用于验证。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ku kv l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kz"><img src="../Images/2a9dc6c79220a61302452603d88e8688.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*td1fB_4eBg9J9dripZUBKg.png"/></div></div></figure><p id="d795" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是时候使用混淆矩阵来评估我们的模型了。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ku kv l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es la"><img src="../Images/83ad5daefb4bd34b4435cd2d733c1798.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qhhCF3-ysI1y7zHJFfHbsw.png"/></div></div></figure><p id="acc3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的模型存档了85%的准确率，这并不坏，但如果我们用所有数据训练模型，我们可以将准确率提高到94%，因为深度学习获得的数据越多，它的表现就越好。</p><h1 id="2701" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">摘要</h1><p id="830a" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">在这一课中，我们学习了如何应用CNN进行基因预测，以及创建一个CNN的步骤，我的下一篇文章将是关于使用NLP进行基因预测的。</p><p id="5fa7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我的<a class="ae kt" href="https://www.linkedin.com/in/rachid-elfermi-75a84b8b/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae kt" href="https://github.com/rachidelfermi" rel="noopener ugc nofollow" target="_blank"> GitHub </a>关注我。</p></div></div>    
</body>
</html>