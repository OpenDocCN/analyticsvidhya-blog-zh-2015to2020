<html>
<head>
<title>Predict Who Survived the Titanic Disaster With Automated Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过自动机器学习预测谁在泰坦尼克号灾难中幸存</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predict-who-survived-the-titanic-disaster-with-automated-machine-learning-acec10715cd8?source=collection_archive---------21-----------------------#2020-05-01">https://medium.com/analytics-vidhya/predict-who-survived-the-titanic-disaster-with-automated-machine-learning-acec10715cd8?source=collection_archive---------21-----------------------#2020-05-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/047ff23920220bfdbf9516d628fc99e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VhUg2vnVCscT3dVEDsEOJg.jpeg"/></div></div></figure><p id="8ba0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">谷歌公司(Google Inc .)旗下的Kaggle 是一个面向数据科学和机器学习从业者的在线社区。换句话说，这是你的数据科学之家，在这里你可以找到数据集并参加比赛。然而；我努力完成我的第一份参赛作品，因为，我会说，<em class="jp">资源不当。我为这个比赛浏览了<a class="ae jo" href="https://www.kaggle.com/c/titanic/kernels" rel="noopener ugc nofollow" target="_blank">内核</a>(读作'<em class="jp">文章'</em>)，但是它们都不是为初学者设计的。我的意思是作为一个初学者，我不想看到我不能执行或解释的可视化，我只需要用简单的话来理解正在发生的事情。</em></p><p id="db99" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi jq translated">如果你是因为要开始使用Kaggle而来到这里，这篇文章将会帮助你使用自动化库。一个特殊的人觉得写复杂的代码很难，因为有些自动化库不需要不必要的代码或可视化就能完成工作。</p><p id="8bcb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">今天我将使用<strong class="is hj"> PYCARET </strong>机器学习库来解决这个问题，你会看到这个库是多么有效。对于那些不了解PYCARET的人，下面我提到了一个PYCARET的小介绍，请浏览一遍。</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div class="er es jz"><img src="../Images/7b248b47d9174a1293d2425cd620e978.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/0*D-HJUqU9xId9IGx9.png"/></div></figure><p id="7aa8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以从<a class="ae jo" href="https://pycaret.org/" rel="noopener ugc nofollow" target="_blank">https://pycaret.org</a>访问pycaret网站和文档</p><p id="300f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">PyCaret是Python中的一个开源、低代码机器学习库，允许您在几秒钟内从准备数据到在您选择的笔记本环境中部署模型。</p><p id="967f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">PyCaret是一个低代码库，让你更有生产力。随着花在编码上的时间减少，您和您的团队现在可以专注于业务问题。</p><p id="0360" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">PyCaret是一个简单易用的机器学习库，可以帮助你用更少的代码进行端到端的ML实验。</p><p id="3510" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">PyCaret是一个业务就绪的解决方案。它允许您从您选择的笔记本电脑环境中快速高效地进行原型制作。</p><h2 id="7902" class="ke kf hi bd kg kh ki kj kk kl km kn ko jb kp kq kr jf ks kt ku jj kv kw kx ky bi translated"><strong class="ak">步骤1—从Kaggle开始</strong></h2><p id="ddeb" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">所以我希望你们都有kaggle账号，并且都熟悉kaggle，或者如果你需要任何入门指南来做kaggle的事情，请访问这个<a class="ae jo" href="https://www.youtube.com/watch?v=Gp_qv317Gew" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">链接</strong> </a>来获得教程。之后通过前往<a class="ae jo" href="https://www.kaggle.com/c/titanic" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">这个链接</strong> </a>加入Kaggle泰坦尼克号比赛。完成了吗？太好了。我们都准备好了。让我们现在做一些真正的工作。</p><h2 id="345a" class="ke kf hi bd kg kh ki kj kk kl km kn ko jb kp kq kr jf ks kt ku jj kv kw kx ky bi translated">步骤2—安装Pycaret</h2><p id="dd75" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">您可以通过使用pip install命令简单地安装pycaret，如下所示</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es le"><img src="../Images/c05560904146e89a0a3946b1284463a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r9aAuLvsms49jD_7W90AmQ.png"/></div></div></figure><h2 id="9412" class="ke kf hi bd kg kh ki kj kk kl km kn ko jb kp kq kr jf ks kt ku jj kv kw kx ky bi translated">步骤3-加载数据</h2><p id="9ede" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">您可以简单地通过使用pycaret命令或使用pandas来加载数据，这里我使用pandas，如下所示。</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lf"><img src="../Images/9e4db8a0fae988350b0bdc0da237bcb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UFwkUFbSG1mLIW92nmVAlg.png"/></div></div></figure><h2 id="02dc" class="ke kf hi bd kg kh ki kj kk kl km kn ko jb kp kq kr jf ks kt ku jj kv kw kx ky bi translated">步骤4—导入模块</h2><p id="4f8c" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">根据您想要执行的实验类型，必须在python环境中导入当前支持的六个可用模块中的一个。导入模块为特定任务准备了一个环境。例如，如果您导入了分类模块，环境将相应地设置为仅执行分类任务。</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div class="er es lg"><img src="../Images/492984d6b2540f420491ee4d8d70f58f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*OGr5-FFA1U8zYxawQeVF_g.png"/></div></figure><p id="5b13" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们需要预测乘客能否幸存，所以这是一个分类问题。因此，我们将使用下面给出的命令导入分类模块。</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/065ed50f49c1de0a8383ec46db14d191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fzCCsQRwPPwobt-Mec4K3w.png"/></div></div></figure><h1 id="5cfd" class="li kf hi bd kg lj lk ll kk lm ln lo ko lp lq lr kr ls lt lu ku lv lw lx kx ly bi translated">正在初始化设置</h1><p id="bc19" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">现在，我们需要通过提供目标变量和一些其他信息来设置我们的数据，如下所示。</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/e4c48a0af495c463b6836e82c6eed1cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XToyOkU5WJOlMDuQwl7QOw.png"/></div></div></figure><h2 id="a0ac" class="ke kf hi bd kg kh ki kj kk kl km kn ko jb kp kq kr jf ks kt ku jj kv kw kx ky bi translated">步骤5 —比较模型</h2><p id="929c" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">这是我们在<em class="jp">任何</em>监督实验的工作流程中推荐的第一步。此函数使用k-fold交叉验证，为您导入的模块库中的所有可用模型训练和比较通用评估指标。使用的评估指标包括:</p><ul class=""><li id="9830" class="ma mb hi is b it iu ix iy jb mc jf md jj me jn mf mg mh mi bi translated"><strong class="is hj">分类:</strong>准确率、AUC、召回率、精度、F1、Kappa</li><li id="c1fe" class="ma mb hi is b it mj ix mk jb ml jf mm jj mn jn mf mg mh mi bi translated"><strong class="is hj">回归:</strong> MAE，MSE，RMSE，R2，RMSLE，MAPE</li></ul><p id="2a93" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该函数的输出是一个表格，显示了所有模型在褶皱上的平均得分。可以使用<strong class="is hj"> compare_models </strong>函数中的<strong class="is hj"> <em class="jp"> fold </em> </strong> <em class="jp"> </em>参数定义折叠的数量。默认情况下，<strong class="is hj"> <em class="jp">折叠</em> </strong>设置为<strong class="is hj"> 10 </strong>。表格根据选择的度量标准进行排序(从最高到最低)，并可使用<strong class="is hj"> <em class="jp">排序</em> </strong>参数<em class="jp">进行定义。</em>默认情况下，分类实验按照<strong class="is hj">精度</strong>排序，回归实验按照<strong class="is hj"> R2 </strong>排序。某些模型由于运行时间较长而无法进行比较。为了绕过这种预防，<strong class="is hj"> <em class="jp"> turbo </em> </strong>参数可以设置为<strong class="is hj"> False </strong>。</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/cedb3e4d2ce4d0096b27961daadc49dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oexCEvVtbSHJEtr5dzvhLg.png"/></div></div></figure><h1 id="7d4c" class="li kf hi bd kg lj lk ll kk lm ln lo ko lp lq lr kr ls lt lu ku lv lw lx kx ly bi translated"><strong class="ak">输出</strong></h1><figure class="ka kb kc kd fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/5a0130443ff47d36c44a670460739d9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1XMQL-esBGczsI4w7rVyQw.png"/></div></div></figure><p id="19cd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，通过观察结果，我们可以说<strong class="is hj">光梯度增强机</strong>模型具有最高的精度，因此我们可以使用该模型，但首先我们应该调整该模型一次以获得更好的结果，因为我们需要创建一个不同的模型，如下所示。</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div class="er es mq"><img src="../Images/86a1d8884fe6540044686d422df1add1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*BKumyH1jZwymqSr3xszZvw.png"/></div></figure><p id="ba79" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里你可以看到模型每次迭代的结果。现在我们可以使用下面给出的命令来调整模型</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/569467fa3b6963a6b699a239bfc565e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*IzkpW8SZTPBC0WsCU_xV4g.png"/></div></figure><h2 id="b72e" class="ke kf hi bd kg kh ki kj kk kl km kn ko jb kp kq kr jf ks kt ku jj kv kw kx ky bi translated">步骤6—通过可视化结果分析模型的性能</h2><p id="87e5" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">分析经过训练的机器学习模型的性能是任何机器学习工作流程中不可或缺的一步。在PyCaret中分析模型性能就像编写<strong class="is hj"> plot_model </strong>一样简单。该函数在<strong class="is hj"> plot_model </strong>函数内将训练好的模型对象和绘图类型作为字符串。</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div class="er es ms"><img src="../Images/8f74ce2259a1b05febade7e360e36622.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*O2Oz3cTpK0Jn5JzhfAbI1A.png"/></div></figure><div class="ka kb kc kd fd ab cb"><figure class="mt ij mu mv mw mx my paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/8b7ac1fc77fc7cdcfa56cad4ce0e0564.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*m7lPcGKbAoppuOhAA3Lnsg.png"/></div></figure><figure class="mt ij mz mv mw mx my paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/51d7df536182e38909bef3340f100b8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*Z0omgMKZiXMy_MU1yAnowA.png"/></div></figure></div><div class="ab cb"><figure class="mt ij na mv mw mx my paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/5c4f10a8aef1e5687ebf2b14f2e529d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*23Xppn7EkAlF33Ey3kBYFg.png"/></div></figure><figure class="mt ij nb mv mw mx my paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/e66a74680cf19a46a1e32064c8c89896.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*28ceTIkAKqaqWAQNBjznCg.png"/></div></figure></div><h2 id="c0bf" class="ke kf hi bd kg kh ki kj kk kl km kn ko jb kp kq kr jf ks kt ku jj kv kw kx ky bi translated">第七步——预测</h2><p id="c7b4" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">一旦使用<a class="ae jo" href="https://www.pycaret.org/deploy-model" rel="noopener ugc nofollow" target="_blank">deploy _ model</a><strong class="is hj"><em class="jp"/></strong>在云上成功部署了模型，或者使用<a class="ae jo" href="https://www.pycaret.org/save-model" rel="noopener ugc nofollow" target="_blank"> save_model </a> <strong class="is hj"> <em class="jp">，</em> </strong>在本地成功部署了模型，就可以使用<strong class="is hj"> predict_model </strong>函数对未知数据进行预测。此函数采用经过训练的模型对象和数据集进行预测。它将自动应用实验过程中创建的整个转换管道。对于分类，预测标签是基于50%的概率创建的，但是如果您选择使用不同的阈值，您可能已经使用<a class="ae jo" href="https://www.pycaret.org/optimize-threshold" rel="noopener ugc nofollow" target="_blank">优化_阈值</a>获得，您可以在<strong class="is hj">预测_模型</strong>内传递<strong class="is hj"> <em class="jp">概率_阈值</em> </strong>参数。该函数也可用于生成对保留/测试集的预测。</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/2a0fdf8a6c6d66d2ea6947c3fa9d0160.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7IoKhGQ_rY0OrbyFSav-uA.png"/></div></div></figure><p id="d59b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，让我们使用优化模型来执行预测</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nd"><img src="../Images/723d1783ee1b432bef791d8b25150a48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_1b5oJ7g_PoKYPy0k_DlZA.png"/></div></div></figure><h2 id="a1c1" class="ke kf hi bd kg kh ki kj kk kl km kn ko jb kp kq kr jf ks kt ku jj kv kw kx ky bi translated">第8步—最终提交</h2><p id="e7e5" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">提交我们的最终结果。我们的输出<code class="du ne nf ng nh b">.csv</code>文件应该只有两列——乘客Id和幸存者——正如竞争页面上提到的。创建并提交到竞争页面，我的提交得分为0.7751，这是非常好的，因为我们只写了几行代码。</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ni"><img src="../Images/435f5f95273ed258ae38b67499301274.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Rh8bpG0JvokfKHMNqgP4g.png"/></div></div></figure><p id="f5f9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">最后</strong></p><p id="5e30" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我发表这篇文章的主要问题是“一个人如何在不写长代码的情况下完成复杂的分析？”领域知识、良好的数据和学习新事物的意愿是你前进所需的一切。你不必一开始就是主人。这一切都来自于坚持。如果你正在读这篇文章，你有足够的精力去实现你的目标，无论如何都不要停下来。如果您对本文有任何疑问，请通过<a class="ae jo" href="http://rahulshuklawork@gmail.com" rel="noopener ugc nofollow" target="_blank">电子邮件</a>联系我。即使你没有任何疑问，我仍然希望在我的收件箱里看到你有价值的反馈或建议，如果有的话。</p><p id="21d1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">快乐学习。</p></div></div>    
</body>
</html>