# äº†è§£åˆ†ç±»çš„æ¨¡åž‹éªŒè¯

> åŽŸæ–‡ï¼š<https://medium.com/analytics-vidhya/model-validation-for-classification-5ff4a0373090?source=collection_archive---------2----------------------->

![](img/da00768acef38188e3bf45425aa9f364.png)

åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡ä¸åŒçš„æŠ€æœ¯æ¥éªŒè¯åˆ†ç±»æ¨¡åž‹çš„æ€§èƒ½ã€‚

**å®šä¹‰é—®é¢˜**:é¢„æµ‹æ˜Žå¤©ä¼šä¸ä¼šä¸‹é›¨ã€‚

åœ¨ä»¥å‰çš„åšå®¢ä¸­ï¼Œä½ å·²ç»çœ‹åˆ°äº†ä¸åŒçš„ç›‘ç£ç®—æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

è€ƒè™‘ä»»ä½•ç›‘ç£ç®—æ³•ï¼Œæ¯”å¦‚ç®€å•çš„é€»è¾‘å›žå½’ã€‚

**æ•°æ®é›†æè¿°**:é™é›¨æ•°æ®åŒ…å« 118 ä¸ªç‰¹å¾å’Œä¸€ä¸ªå› å˜é‡(y_test)æ˜¯å¦ä¼šä¸‹é›¨ã€‚

X_test æ ·æœ¬

![](img/e54528ba9ec9bf9cc6a0d4ca656c0c84.png)

```
***Features***
Index(['MinTemp', 'MaxTemp', 'Rainfall', 'Evaporation', 'Sunshine',
       'WindGustSpeed', 'WindSpeed9am', 'WindSpeed3pm', 'Humidity9am',
       'Humidity3pm',
       ...
       'NNW.2', 'NW.2', 'S.2', 'SE.2', 'SSE.2', 'SSW.2', 'SW.2', 'W.2',
       'WNW.2', 'WSW.2'],
      dtype='object', length=118)
```

y_test æ ·æœ¬

```
0     No
1     No
2     No
3     No
4     No
5     No
6    Yes
7    Yes
8     No
9     No
Name: RainFall, dtype: object
```

æœ€ä½³åšæ³•æ˜¯ä¿å­˜æ¨¡åž‹ï¼Œä»¥ä¾¿å°†æ¥ç›´æŽ¥ç”¨äºŽé¢„æµ‹ã€‚

ä¸‹é¢çš„ä»£ç ç‰‡æ®µå¯ä»¥ç”¨æ¥ä¿å­˜æ¨¡åž‹ã€‚

è®©æˆ‘ä»¬åŠ è½½æ¨¡åž‹ã€‚

é¢„æµ‹çš„æ—¶é—´åˆ°äº†

æˆ‘ä»¬æ‹¥æœ‰çƒ¹é¥ªå„ç§è¯„ä¼°èœè‚´æ‰€éœ€æ‰€æœ‰ææ–™ã€‚

**Metric** æ˜¯ä¸€ç§è¯„ä¼°æ¨¡åž‹æ€§èƒ½çš„æŠ€æœ¯ã€‚

æˆ‘ä»¬å°†åœ¨è¿™ä¸ªåšå®¢ä¸­è®¨è®ºçš„å„ç§åº¦é‡æ ‡å‡†çš„åˆ—è¡¨ã€‚

1.  *ç²¾åº¦*
2.  *é›¶ç²¾åº¦*
3.  *ç²¾åº¦*
4.  *å¬å›ž*
5.  *f1 å¾—åˆ†*
6.  *ROC â€” AUC*
7.  ***å‡†ç¡®åº¦*** : *è¿™æ˜¯åˆ†ç±»ä¸Šä¸‹æ–‡ä¸­æœ€å¹¼ç¨šã€æœ€å¸¸ç”¨çš„åº¦é‡ã€‚è¿™åªæ˜¯æ­£ç¡®é¢„æµ‹çš„å¹³å‡å€¼ã€‚*

æˆ‘ä»¬åˆšåˆšå®šä¹‰äº†ä¸€ä¸ªç®€å•çš„å‡½æ•°æ¥è®¡ç®—ç²¾åº¦ï¼Œå¹¶æ ¹æ®æˆ‘ä»¬çš„æµ‹è¯•æ•°æ®å¯¹å…¶è¿›è¡Œäº†è¯„ä¼°ã€‚

*ç²¾åº¦*= 0.8558658658656

é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ sklearn å†…ç½®çš„åˆ†æ•°å‡½æ•°æ¥è¯„ä¼°å‡†ç¡®æ€§ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ sklearn è¿›è¡Œè®¡ç®—ï¼Œå¹¶éªŒè¯æˆ‘ä»¬ä½¿ç”¨ä¸Šè¿°å‡½æ•°èŽ·å¾—çš„ç²¾åº¦ã€‚

æ‰€ä»¥ä¸¤ä¸ªç»“æžœéƒ½å»åˆã€‚

***2ã€‚ç©ºç²¾åº¦:*** *å®šä¹‰ä¸ºæ€»æ˜¯é¢„æµ‹æœ€é¢‘ç¹ç±»æ—¶èŽ·å¾—çš„ç²¾åº¦ã€‚*è¿™å¯¹äºŽæ£€æŸ¥æ¨¡åž‹å‡†ç¡®æ€§çš„ç»å¯¹æ€§éžå¸¸æœ‰ç”¨ã€‚

é›¶ç²¾åº¦æ˜¯ 0.7759414888005908ï¼Œä½ŽäºŽæ¨¡åž‹ç²¾åº¦ï¼Œæ‰€ä»¥æˆ‘ä»¬æ˜¯å¥½çš„ã€‚

ä¸€ä¸ªäººå¤´è„‘ä¸­ç«‹å³å‡ºçŽ°çš„é—®é¢˜æ˜¯å…³äºŽæ¨¡åž‹å–„è‰¯çš„å®Œæ•´ä¿¡æ¯ã€‚è¿™æ˜¯ç›¸å½“ä¸»è§‚çš„ï¼Œä¾‹å¦‚ï¼Œå¦‚æžœæˆ‘ä»¬æƒ³å‡å°‘å¯¹é™é›¨çš„é”™è¯¯é¢„æµ‹ã€‚

ä»»ä½•åˆ†ç±»æ¨¡åž‹éƒ½å°†é¢„æµ‹ç©ºé—´åˆ†æˆä¸åŒçš„å­ç©ºé—´ã€‚

æœ€å¥½çš„æ¦‚å¿µåŒ–æ–¹æ³•æ˜¯é€šè¿‡æ··æ·†çŸ©é˜µã€‚

è®©æˆ‘ä¸ºæˆ‘ä»¬çš„äºŒå…ƒåˆ†ç±»é—®é¢˜ç”»ä¸€ä¸ªæ··æ·†çŸ©é˜µã€‚

![](img/9b1d362317aaee8072441e745b087615.png)

20892 æ˜¯æˆ‘ä»¬é¢„æµ‹ä¼šä¸‹é›¨è€Œå®žé™…ä¸Šä¼šä¸‹é›¨çš„æ¬¡æ•°ã€‚è¿™å«çœŸæ­£ï¼Œå¿«é€Ÿå®šä¹‰å…¶ä»–å˜é‡

*   `True Positives`å®žé™…é™é›¨é‡å’Œé¢„æµ‹é™é›¨é‡
*   `True Negatives`å®žé™…æ— é›¨å’Œé¢„æµ‹æ— é›¨
*   `False Positives`å®žé™…æ— é›¨å’Œé¢„æµ‹æœ‰é›¨
*   `False Negatives`å®žé™…é™é›¨å’Œé¢„æµ‹æ— é›¨

åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹

*   TP = 20892
*   TN = 3286
*   FP = 1175
*   FN = 3086

å‡†ç¡®åº¦=(æ€»æ­£ç¡®é¢„æµ‹)/æ€»é¢„æµ‹

= (TP + TN)/( TP + TN + FP + FN)

è®©è¯»è€…æ¥éªŒè¯å‡†ç¡®æ€§æ˜¯å¦ä¸Žæˆ‘ä»¬è®¡ç®—çš„ç›¸ç¬¦ã€‚æˆ‘ä»¬è½¬å‘å…¶ä»–ä¸€äº›æŒ‡æ ‡ã€‚

***3ã€‚ç²¾åº¦:*** *å®šä¹‰ä¸ºæ‰€æœ‰é¢„æµ‹ä¸­æ­£ç¡®é¢„æµ‹çš„é˜³æ€§ç»“æžœçš„æ¯”ä¾‹ã€‚*æ¢å¥è¯è¯´ï¼Œåœ¨æ‰€æœ‰é¢„æµ‹çš„ç§¯æžç»“æžœä¸­ï¼Œæœ‰å¤šå°‘å®žé™…ä¸Šæ˜¯ç§¯æžçš„ã€‚

å› æ­¤ï¼Œ

ç²¾åº¦= TP /(TP + FP)

åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œprecision = 20892/(20892+1175)= 0.95678678671

è¿™åœ¨åŒ»ç–—åœºæ™¯ä¸­éžå¸¸é‡è¦ðŸ‘©â€âš•ï¸å¼€è¯ç»™æ­£å¸¸çš„ç—…äººæ²»ç—…ï¼Œè¿™å¯èƒ½å¯¼è‡´ä¸¥é‡çš„å¥åº·å±å®³ã€‚

ä¸ºäº†è¯¦ç»†è¯´æ˜Žè¿™ä¸€ç‚¹ï¼Œå½“æˆ‘ä»¬æƒ³è¦æœ€å°åŒ– FP æ—¶ï¼Œå¦‚æžœðŸ‘©â€âš•ï¸è®¡åˆ’ç”Ÿè‚²é”™è¯¯åœ°é¢„æµ‹äº†ç–¾ç—…ã€‚

***4ã€‚å›žå¿†:*** *å®šä¹‰ä¸ºæ‰€æœ‰å®žé™…é˜³æ€§ä¸­æ­£ç¡®é¢„æµ‹é˜³æ€§ç»“æžœçš„æ¯”ä¾‹ã€‚*æ¢å¥è¯è¯´ï¼Œåœ¨æ‰€æœ‰å®žé™…çš„ç§¯æžç»“æžœä¸­ï¼Œæˆ‘ä»¬èƒ½å¤Ÿé¢„æµ‹å¤šå°‘æ˜¯ç§¯æžçš„ã€‚

å¬å›ž= TP/(TP + FN)

åœ¨è¿™é‡Œï¼Œå›žå¿†= 20892/(20892+3086)= 0.87667676687

å½“ä½ æƒ³æœ€å°åŒ– FN çš„æƒ…å†µæ—¶ï¼Œå›žå¿†æ˜¯ç›¸å½“é‡è¦çš„ã€‚

è€ƒè™‘æ£€æµ‹å† çŠ¶ç—…æ¯’ðŸ¦ çš„è¯•éªŒï¼Œå½“ä¸ªä½“å‘ˆé˜³æ€§è€Œè¯•éªŒæœªèƒ½æ£€æµ‹æ—¶ï¼Œä¸è¦é”™è¿‡è¿™ç§æƒ…å†µæ˜¯éžå¸¸é‡è¦çš„ã€‚

å†è¯´ä¸€éï¼Œ

ç²¾åº¦= TP /(TP + FP)

å¬å›ž= TP/(TP + FN)

å¦‚æžœæ ·æœ¬å¤§å°æ˜¯å›ºå®šçš„ï¼Œæ¯”å¦‚è¯´(n)ï¼Œé‚£ä¹ˆ

TP + TN + FP + FN =n

ä¸ºäº†å…·æœ‰é«˜ç²¾åº¦å’Œå¬å›žçŽ‡ï¼ŒFP å’Œ FN è´Ÿå€¼åº”è¯¥å°½å¯èƒ½ä½Žã€‚è¿™æ˜¯æœ‰é™åˆ¶çš„ï¼Œå› ä¸ºé™ä½Žä¸¤è€…æ„å‘³ç€è¿™æ˜¯ä¸€ä¸ªç†æƒ³çš„åœºæ™¯ã€‚

æˆ‘ä»¬å¦‚ä½•å°†ä¸¤è€…ç»“åˆèµ·æ¥ï¼Ÿ

åœ¨æˆ‘ä»¬ç»§ç»­ä¹‹å‰ï¼Œ

> å›žå¿†ä¹Ÿç§°ä¸ºçœŸé˜³æ€§çŽ‡æˆ–çµæ•åº¦
> 
> ä½œä¸ºçœŸé˜´æ€§çŽ‡æˆ–ç‰¹å¼‚æ€§çš„ç²¾ç¡®åº¦

***4ã€‚f1 è¯„åˆ†:*** *æ˜¯ç²¾åº¦å’Œå¬å›žçŽ‡çš„è°ƒå’Œå¹³å‡å€¼ã€‚*æ˜¾è€Œæ˜“è§çš„é—®é¢˜æ˜¯ä¸ºä»€ä¹ˆè°ƒå’Œå¹³å‡å€¼(HM)è€Œä¸æ˜¯ç®—æœ¯æˆ–å‡ ä½•å¹³å‡å€¼æˆ–å…¶ä»–æŸç§å˜æ¢ã€‚æˆ‘å·²ç»å†™äº†ä¸€ä¸ªå•ç‹¬çš„åšå®¢æ¥è§£é‡Š HM æ¥ç»“åˆè¿™ä¸¤ä¸ªæŒ‡æ ‡ã€‚

*f1 = 2 *ç²¾åº¦*å¬å›ž/(ç²¾åº¦+å¬å›ž)*

è¿™é‡Œï¼Œ*f1*= 2 * 0.9467 * 0.8713/(0.9467+0.8713)= 0.9074

è¿™ç§æµ‹é‡æ¯”å‡†ç¡®æ€§æ›´æœ‰ä¸Šä¸‹æ–‡å…³ç³»ï¼Œåªæ˜¯å®ƒéœ€è¦æ­£ç¡®åœ°è§£é‡Šï¼Œä¸åƒå‡†ç¡®æ€§é‚£æ ·å®¹æ˜“è§£é‡Šã€‚

ä¸Šè¿°æŽªæ–½æ¦‚è¿°:

åœ¨ python ä¸­ï¼Œæˆ‘ä»¬åœ¨ sklearn ä¸­æœ‰ä¸€ä¸ªæ¨¡å—ï¼Œclassification_reportï¼Œå®ƒç”Ÿæˆæ‰€æœ‰çš„åº¦é‡ã€‚

![](img/5998f89d18ef5ad46e4c4322a1c9192a.png)

*æ”¯æŒåº¦æ˜¯æ¯ç±»ä¸­çš„è§‚å¯Ÿæ¬¡æ•°ã€‚*

***5ã€‚ROC :*** *æŽ¥æ”¶æœºå·¥ä½œç‰¹æ€§æ›²çº¿é’ˆå¯¹ä¸åŒçš„é˜ˆå€¼ç»˜åˆ¶ TPR å¯¹ FPRã€‚æ¢è¨€ä¹‹ï¼Œå®ƒæ˜¾ç¤ºäº†ä¸åŒé˜ˆå€¼æ°´å¹³ä¸‹çš„æ¨¡åž‹æ€§èƒ½ã€‚*

ä¸ºäº†ç†è§£è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£è®­ç»ƒåˆ†ç±»å™¨çš„è¾“å‡ºã€‚

```
Idx No_rain_prob Rain_prob
0      0.987328   0.012672
1      0.840071   0.159929
2      0.976743   0.023257
3      0.798552   0.201448
4      0.307343   0.692657
```

å› æ­¤ï¼Œé€»è¾‘å›žå½’æˆ–å¤§å¤šæ•°åˆ†ç±»å™¨çš„è¾“å‡ºæ˜¯ä»¥æ¦‚çŽ‡è¡¨ç¤ºçš„ã€‚

æœ‰ä¸€ä¸ªåä¸º C( *é˜ˆå€¼*)çš„é»˜è®¤è¶…å‚æ•°ï¼Œæ ¹æ®è¯¥è¶…å‚æ•°å°†è¯¥é—®é¢˜è½¬æ¢ä¸ºâ€œå¦â€æˆ–â€œæ˜¯â€ã€‚

1 æˆ–å¦:å¦ _ é›¨

0 æˆ–æ˜¯:ä¸‹é›¨

å¦‚æžœ C = 0.5

predict _ label =[ä¸ä¸ä¸ä¸æ˜¯] == [1ï¼Œ1ï¼Œ1ï¼Œ1ï¼Œ0]

å¦‚æžœ C = 0.8

predict _ label =[ä¸ä¸ä¸æ˜¯æ˜¯] == [1ï¼Œ1ï¼Œ1ï¼Œ0ï¼Œ0]

ROC æ›²çº¿é€šè¿‡ç»˜åˆ¶ TPR å¯¹ä¸åŒé˜ˆå€¼çš„ FPR è€Œäº§ç”Ÿã€‚

![](img/436c31c427d8fdcf29129de54b7cf007.png)

**ROC AUC** å³*å—è¯•è€…æ“ä½œç‰¹å¾â€”â€”æ›²çº¿ä¸‹é¢ç§¯ï¼Œæµ‹é‡æ›²çº¿ä¸‹é¢ç§¯ã€‚*

è¯¥å€¼è¶Šé«˜ï¼Œæ¨¡åž‹è¶Šå¥½ï¼Œæœ€ä½³å€¼ä¸º 1ã€‚

ROC _AUC å¾—åˆ†ä¸º 0.8729ã€‚

> *å¸Œæœ›è¿™å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œæ¬¢è¿Žè¯„è®ºã€‚*