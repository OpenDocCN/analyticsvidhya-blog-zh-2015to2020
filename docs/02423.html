<html>
<head>
<title>Classification of Images based on Fashion MNIST dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于时尚MNIST数据集的图像分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/classification-of-images-based-on-fashion-mnist-dataset-bb11e4bcdefb?source=collection_archive---------7-----------------------#2019-12-16">https://medium.com/analytics-vidhya/classification-of-images-based-on-fashion-mnist-dataset-bb11e4bcdefb?source=collection_archive---------7-----------------------#2019-12-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/6d69f990be0234a75d9805f76ef8672e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GNLB2jtcfb_xTqgQd9ntJA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">时尚大师</figcaption></figure><p id="0544" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">图像分类是深度学习中最受欢迎的任务之一，在深度学习中，我们给定一幅特定的图像，模型必须预测图像的类别。深度学习库，如Tensorflow和Pytorch，不要忘记Tensorflow上非常简单的Keras API，提供了直观而简单的方法来轻松执行图像分类。检测图像并对其进行分类是当今所有工业领域的主要应用，无论是在自动驾驶车辆分类、交通信号还是在医学成像中，这个列表永远不会结束。是不是很神奇！！</p><p id="2461" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在本文中，我们将使用非常流行的时尚MNIST数据集对服装、鞋类和其他相关商品进行分类。所以，让我们开始吧。</p><h1 id="1e2c" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">时尚MNIST到底是什么？</h1><p id="3716" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">时尚-MNIST是Zalando文章图像的数据集，由60，000个样本的训练集和10，000个样本的测试集组成。每个示例都是28×28灰度图像，与来自10个类别的标签相关联。时尚MNIST旨在作为原始MNIST数据集的直接替代，用于机器学习算法的基准测试。<br/>原始MNIST数据集是一组手写数字，从0到9，灰度为28 x 28像素大小。</p><p id="cf09" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这里，我们将利用Keras API和Tensorflow后端来完成我们的任务。</p><h1 id="63e7" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">使用Keras对图像进行分类</h1><p id="5046" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">对于这个任务，您将需要设置一个环境，最好是在Anaconda中，使用Tensorflow GPU和其他用于对象检测的依赖项。具有GPU的系统对于更快的训练是优选的，但是也可以用具有CPU的系统来完成。否则，你可以使用Google Colab，它提供了一个非常好的GPU运行时，如Tesla K80，来训练你的模型。</p><p id="d6e1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了设置tensorflow环境进行物体探测，我发现了一个非常有用的链接，你可以在下面找到它。</p><div class="kv kw ez fb kx ky"><a href="https://tensorflow-object-detection-api-tutorial.readthedocs.io/en/latest/install.html" rel="noopener  ugc nofollow" target="_blank"><div class="kz ab dw"><div class="la ab lb cl cj lc"><h2 class="bd hj fi z dy ld ea eb le ed ef hh bi translated">安装- TensorFlow对象检测API教程文档</h2><div class="lf l"><h3 class="bd b fi z dy ld ea eb le ed ef dx translated">有两种不同的TensorFlow版本，您可能希望安装，这取决于您是否愿意…</h3></div><div class="lg l"><p class="bd b fp z dy ld ea eb le ed ef dx translated">tensor flow-object-detection-API-tutorial . readthedocs . io</p></div></div></div></a></div><p id="45bc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">对于该任务，首先让我们导入keras和其他将在内部使用Tensorflow的库。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="cc43" class="lq jt hi lm b fi lr ls l lt lu">from keras.datasets import fashion_mnist<br/>from keras.models import Sequential<br/>from keras.layers import Dense,Conv2D,Dropout,MaxPooling2D,Flatten<br/>from keras.utils import np_utils</span></pre><p id="b89f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然后，将时尚MNIST数据集加载到训练集和测试集中。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="20e8" class="lq jt hi lm b fi lr ls l lt lu">(x_train, y_train), (x_test, y_test) = fashion_mnist.load_data()</span></pre><p id="98ef" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">对图像进行整形和标准化，以便可以输入到模型中。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="e339" class="lq jt hi lm b fi lr ls l lt lu">trainX = x_train.reshape((x_train.shape[0], 28, 28, 1))<br/>testX = x_test.reshape((x_test.shape[0], 28, 28, 1))<br/>trainX = trainX/255<br/>testX = testX/255</span></pre><p id="c237" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们用matplotlib查看特定的图像。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="ce72" class="lq jt hi lm b fi lr ls l lt lu">import matplotlib.pyplot as plt<br/>%matplotlib inline<br/>plt.imshow(x_test[2])</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/a4e456d1540675fbdf1854ae86a0210f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*srQ_tg-zE6O30pdXN_2M-w.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">裤子</figcaption></figure><p id="b9a0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，让我们对目标值y_train和y_test进行热编码。这是因为机器学习和深度学习算法需要数字输入和输出变量。一个整数和<strong class="iw hj">一个热编码</strong>用于将分类数据转换成整数数据。我们有10类图像。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="578c" class="lq jt hi lm b fi lr ls l lt lu">trainY = np_utils.to_categorical(y_train,10)<br/>testY = np_utils.to_categorical(y_test,10)</span></pre><p id="69b3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们用Keras层建立模型。在此模型中，我们将有2个Conv2D层，每个层有32个和64个过滤器，后面是大小为2 x 2的最大轮询层。使用<strong class="iw hj"> relu </strong>激活功能。我们还添加了一个比率为0.2的辍学正则化层，以防止任何过度拟合。最后，该模型有一个softmax层，输出10个必需的类。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="4eb9" class="lq jt hi lm b fi lr ls l lt lu">classifier = Sequential()<br/>classifier.add(Conv2D(filters=32, kernel_size=(3,3),strides=(1, 1), input_shape=(28,28,1), activation='relu'))<br/>classifier.add(MaxPooling2D(pool_size=(2,2)))<br/>classifier.add(Conv2D(filters=64, kernel_size=(3,3),strides=(1, 1), activation='relu'))<br/>classifier.add(MaxPooling2D(pool_size=(2,2)))<br/>classifier.add(Flatten())<br/>classifier.add(Dense(units=128,activation='relu'))<br/>classifier.add(Dropout(rate=0.2))<br/>classifier.add(Dense(units=10, activation='softmax'))</span></pre><p id="43d1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">对于我们的优化器，我们将使用Adam，我们想要的指标是准确性。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="175f" class="lq jt hi lm b fi lr ls l lt lu">classifier.compile(optimizer='adam',loss='categorical_crossentropy',metrics=['accuracy'])</span></pre><p id="1748" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们来看看我们到目前为止建立的模型。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="5d25" class="lq jt hi lm b fi lr ls l lt lu">classifier.summary()</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/00619d8336fac6aac38d013c81b910d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PQtiNL5SwjE0jOorEn3Hww.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">模型Keras</figcaption></figure><p id="23a2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来，我们训练模型并将训练数据存储在历史记录中。我已经训练了20个纪元，在训练集和验证集上分别获得了96%和91.4%的准确率。你总是可以增加历元的数量，也许还可以调整图层和过滤器的数量以获得更好的精确度。这是所有关于实验和探索，所以去吧，没有人能阻止你。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="b101" class="lq jt hi lm b fi lr ls l lt lu">history = classifier.fit(trainX, trainY,<br/> batch_size=128, epochs=20,<br/> verbose=2,<br/> validation_data=(testX, testY))</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/f5301b7e463deacc1719794de0c8cb5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IQZt54y7yKP4lsUlYoSCMw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">训练我们的模型</figcaption></figure><p id="e53e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">耶，现在是时候对新图像进行预测了。加载图像并将其传递给分类器。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="f0dc" class="lq jt hi lm b fi lr ls l lt lu">from keras.preprocessing import image<br/>import numpy as np<br/>test_img = image.load_img(‘Data\\Fashion_mnist\\bag.jpg’, target_size=(28, 28))<br/>test_img = image.img_to_array(test_img)<br/>test_img = test_img[:,:,1].reshape(1,28,28,1)<br/>test_img = test_img/255<br/>classifier.predict_classes(test_img)</span></pre><p id="abf7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这将输出一个包含分类值的数组，其中<strong class="iw hj"> 1 </strong>位于预测类的位置，其他为<strong class="iw hj"> 0 </strong>。</p><p id="c0bd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如[0，0，0，0，0，0，0，0，0，1，0]</p><p id="e051" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">你可以查阅这个表格来查阅这些课程。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/98f79988353504a2d84b76422d379ace.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*mZ2VcmXap0J6d1POdgdo0Q.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">时尚Mnist类</figcaption></figure><p id="7d73" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">耶，就这样。感谢您的耐心，并希望您喜欢阅读。非常欢迎您的宝贵反馈。快乐学习！！！。</p></div></div>    
</body>
</html>