<html>
<head>
<title>The Fashionable “Hello World” of Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深度学习的时髦“Hello World”</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/the-fashionable-hello-world-of-deep-learning-8b9e3d60a37c?source=collection_archive---------0-----------------------#2018-12-05">https://medium.com/analytics-vidhya/the-fashionable-hello-world-of-deep-learning-8b9e3d60a37c?source=collection_archive---------0-----------------------#2018-12-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="1333" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">是时候离开MNIST手写数字数据库，拥抱MNIST时尚数据库了。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/e1b58362497a1b3ce01742792d72f04c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JovqRzGJHqB1KgdU"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">由<a class="ae jn" href="https://unsplash.com/@nordwood?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">诺德伍德主题</a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><blockquote class="jo"><p id="e3fd" class="jp jq hi bd jr js jt ju jv jw jx jy dx translated">“如果在MNIST行不通，那就根本行不通”，他们表示。“嗯，如果它在MNIST奏效，它在其他人身上可能仍然会失败。”</p></blockquote><blockquote class="jz ka kb"><p id="730a" class="kc kd ke kf b kg kh ij ki kj kk im kl km kn ko kp kq kr ks kt ku kv kw kx jy hb bi translated"><strong class="kf hj">更新2021 </strong>:这篇文章是很久以前发表的。库的一些细节和特性可能已经改变。建议查看文档以了解相关细节</p></blockquote></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><p id="9677" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">在MNIST手写数字数据上训练模型是机器学习界的经典。它被认为是深度学习练习的切入点。</p><p id="84a7" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">MNIST手写数据库已经存在了相当长的时间，并已被深入研究。这是一组60，000幅训练图像，加上10，000幅测试图像，由美国国家标准与技术研究所(位于MNIST的NIST)在20世纪80年代汇编而成。目的是将手写数字(28 × 28像素)的灰度图像分为10类(0到9)。“求解”MNIST类似于深度学习的“Hello World”——这是你用来验证你的算法是否按预期工作的事情。在深度学习领域工作时，我们预计会反复遇到MNIST数据库。</p><h1 id="9451" class="ln lo hi bd lp lq lr ls lt lu lv lw lx io ly ip lz ir ma is mb iu mc iv md me bi translated">时尚-MNIST</h1><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mf"><img src="../Images/1851b5280097515f4f3a876912997c82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SX-WALvlXD8rBc3oZAuNiQ.png"/></div></div></figure><p id="8493" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated"><code class="du mg mh mi mj b"> <a class="ae jn" href="https://github.com/zalandoresearch/fashion-mnist" rel="noopener ugc nofollow" target="_blank">Fashion-MNIS</a>T</code>于2017年8月发布，作为原始<a class="ae jn" href="http://yann.lecun.com/exdb/mnist/" rel="noopener ugc nofollow" target="_blank"> MNIST数据集</a>的直接替代，用于机器学习算法的基准测试。它共享训练和测试分割的确切图像大小和结构，因为每个示例都是28x28灰度图像，与来自10个类别的标签相关联</p><h1 id="cdb4" class="ln lo hi bd lp lq lr ls lt lu lv lw lx io ly ip lz ir ma is mb iu mc iv md me bi translated"><a class="ae jn" href="https://github.com/zalandoresearch/fashion-mnist" rel="noopener ugc nofollow" target="_blank">需要更换</a></h1><p id="361e" class="pw-post-body-paragraph kc kd hi kf b kg mk ij ki kj ml im kl lh mm ko kp lj mn ks kt ll mo kw kx jy hb bi translated">仅仅因为一个模型在MNIST手写数据上表现良好，并不保证它在其他数据上也会表现良好。这主要是因为我们今天拥有的图像比MNIST数据库中的手写数字更复杂。</p><ul class=""><li id="0f17" class="mp mq hi kf b kg lf kj lg lh mr lj ms ll mt jy mu mv mw mx bi translated"><strong class="kf hj"> MNIST太简单了:</strong>据观察，卷积网络可以在MNIST数据上实现大约99%的准确性，这可能并不总是真实的情况。</li><li id="c8d1" class="mp mq hi kf b kg my kj mz lh na lj nb ll nc jy mu mv mw mx bi translated"><strong class="kf hj"> MNIST被滥用</strong></li><li id="d543" class="mp mq hi kf b kg my kj mz lh na lj nb ll nc jy mu mv mw mx bi translated"><strong class="kf hj"> MNIST不能代表现代的CV任务</strong>，后者往往更加复杂。</li></ul><h1 id="e906" class="ln lo hi bd lp lq lr ls lt lu lv lw lx io ly ip lz ir ma is mb iu mc iv md me bi translated">在时尚MNIST数据集上训练Keras中的神经网络</h1><blockquote class="jz ka kb"><p id="411f" class="kc kd ke kf b kg lf ij ki kj lg im kl km li ko kp kq lk ks kt ku lm kw kx jy hb bi translated">因为本文使用了Keras，所以要确保已经安装并运行了Keras。</p></blockquote><p id="8fe9" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">现在，让我们探索并使用时尚MNIST数据集来训练神经网络，以检测服装类别。</p><p id="f81d" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated"><em class="ke">本文仅作为时尚MNIST数据集的介绍。详细了解Keras如何训练网络，请参考</em> <a class="ae jn" href="https://towardsdatascience.com/my-journey-into-deeplearning-using-keras-part-1-67cbb50f65e6" rel="noopener" target="_blank"> <em class="ke">这里</em> </a> <em class="ke">。</em></p><p id="069b" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">有10类服装被指定了标签。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nd"><img src="../Images/e43d62ffc2179a7af2b013e9a3caf2b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:434/format:webp/1*CYWtWvXX2-JHg5ugN7J6jQ.png"/></div></figure><h2 id="bad1" class="ne lo hi bd lp nf ng nh lt ni nj nk lx lh nl nm lz lj nn no mb ll np nq md nr bi translated">1.在Keras中加载时尚MNIST数据集</h2><p id="fce0" class="pw-post-body-paragraph kc kd hi kf b kg mk ij ki kj ml im kl lh mm ko kp lj mn ks kt ll mo kw kx jy hb bi translated">时尚MNIST数据集<strong class="kf hj">预装在Keras </strong>的一组四个Numpy数组中。</p><pre class="iy iz ja jb fd ns mj nt nu aw nv bi"><span id="520c" class="ne lo hi mj b fi nw nx l ny nz">import keras<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>%matplotlib inline</span><span id="ecb5" class="ne lo hi mj b fi oa nx l ny nz">from keras.datasets import fashion_mnist<br/>(train_images, train_labels), (test_images, test_labels) = fashion_mnist.load_data()</span></pre><p id="74fb" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated"><strong class="kf hj">标签</strong>不包含在数据集中，因此我们可以创建一个label_names列表。</p><pre class="iy iz ja jb fd ns mj nt nu aw nv bi"><span id="08e4" class="ne lo hi mj b fi nw nx l ny nz">label_names = [‘T-shirt/top’, ‘Trouser’, ‘Pullover’, ‘Dress’, ‘Coat’, ‘Sandal’, ‘Shirt’, ‘Sneaker’, ‘Bag’, ‘Ankle boot’]</span></pre><h2 id="8ee1" class="ne lo hi bd lp nf ng nh lt ni nj nk lx lh nl nm lz lj nn no mb ll np nq md nr bi translated">2.数据探索</h2><p id="26ee" class="pw-post-body-paragraph kc kd hi kf b kg mk ij ki kj ml im kl lh mm ko kp lj mn ks kt ll mo kw kx jy hb bi translated">让我们看看训练和测试数据的形状。</p><pre class="iy iz ja jb fd ns mj nt nu aw nv bi"><span id="9f4f" class="ne lo hi mj b fi nw nx l ny nz">#Training Data<br/>train_images.shape<br/>(60000, 28, 28)<br/>len(train_labels) # Total no. of training images<br/>60000<br/>train_labels<br/>array([5, 0, 4, ..., 5, 6, 8], dtype=uint8)</span><span id="521a" class="ne lo hi mj b fi oa nx l ny nz">#Testing Data<br/>test_images.shape<br/>(10000, 28, 28)<br/>len(test_labels)<br/>10000<br/>test_labels<br/>array([7, 2, 1, ..., 4, 5, 6], dtype=uint8)</span></pre><ul class=""><li id="f7bf" class="mp mq hi kf b kg lf kj lg lh mr lj ms ll mt jy mu mv mw mx bi translated">训练数据由60，000幅图像组成，每幅图像由28 x 28像素表示。</li><li id="8c9d" class="mp mq hi kf b kg my kj mz lh na lj nb ll nc jy mu mv mw mx bi translated">同样，测试数据由10，000幅图像组成，每幅图像也由28 x 28像素表示。</li><li id="463a" class="mp mq hi kf b kg my kj mz lh na lj nb ll nc jy mu mv mw mx bi translated">测试和训练数据的标签是介于0和9之间的整数。</li></ul><h2 id="25d5" class="ne lo hi bd lp nf ng nh lt ni nj nk lx lh nl nm lz lj nn no mb ll np nq md nr bi translated">3.预处理数据</h2><p id="d8a4" class="pw-post-body-paragraph kc kd hi kf b kg mk ij ki kj ml im kl lh mm ko kp lj mn ks kt ll mo kw kx jy hb bi translated">数据在输入网络之前必须经过预处理。让我们探索一下训练集的图像。</p><pre class="iy iz ja jb fd ns mj nt nu aw nv bi"><span id="eccf" class="ne lo hi mj b fi nw nx l ny nz">plt.imshow(train_images[1])<br/>plt.grid(False)<br/>plt.colorbar()<br/>plt.show()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ob"><img src="../Images/284a0d2ac6036a25b42b969045792586.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*3V5k3Rch6KMYzQ_gGUxnQA.png"/></div></figure><p id="adab" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">颜色条显示0到255范围内的像素强度。我们将把这些值重新调整到0到1的范围内。</p><pre class="iy iz ja jb fd ns mj nt nu aw nv bi"><span id="8833" class="ne lo hi mj b fi nw nx l ny nz">#Rescaling test and train images</span><span id="1636" class="ne lo hi mj b fi oa nx l ny nz">train_images = train_images / 255.0</span><span id="c663" class="ne lo hi mj b fi oa nx l ny nz">test_images = test_images / 255.0</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es oc"><img src="../Images/7af9e21da56be20d88be0e54fd040e14.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*KLp6zhibUshvI_yZ9Nzx_A.png"/></div></figure><p id="f77f" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">浏览前30个训练集图像以确保图像已被缩放。</p><pre class="iy iz ja jb fd ns mj nt nu aw nv bi"><span id="1b99" class="ne lo hi mj b fi nw nx l ny nz">plt.figure(figsize=(8,10))<br/>for i in range(30):<br/>    plt.subplot(5,6,i+1)<br/>    plt.xticks([]) <br/>    plt.yticks([]) <br/>    plt.grid(False)<br/>    plt.imshow(train_images[i])   <br/>    plt.xlabel(label_names[train_labels[i]])</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es od"><img src="../Images/d2c9a474249aa1842756280a6c9197ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*aT3VV9OwdMnRWUi3tKknuA.png"/></div></figure><p id="2cb9" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">所有的图像确实被缩放。让我们现在去模型楼。</p><h2 id="312c" class="ne lo hi bd lp nf ng nh lt ni nj nk lx lh nl nm lz lj nn no mb ll np nq md nr bi translated">4.构建网络架构</h2><p id="dacb" class="pw-post-body-paragraph kc kd hi kf b kg mk ij ki kj ml im kl lh mm ko kp lj mn ks kt ll mo kw kx jy hb bi translated">我们将配置模型的层，然后继续编译模型。</p><ul class=""><li id="3999" class="mp mq hi kf b kg lf kj lg lh mr lj ms ll mt jy mu mv mw mx bi translated"><strong class="kf hj">设置图层</strong></li></ul><pre class="iy iz ja jb fd ns mj nt nu aw nv bi"><span id="696f" class="ne lo hi mj b fi nw nx l ny nz">from keras import models<br/>from keras import layers</span><span id="e6ec" class="ne lo hi mj b fi oa nx l ny nz">network = models.Sequential()</span><span id="d7f4" class="ne lo hi mj b fi oa nx l ny nz">network.add(layers.Dense(128, activation='relu', input_shape=(28 * 28,)))<br/>network.add(layers.Dense(10, activation='softmax'))</span></pre><p id="b6fd" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">该网络由一系列两个密集层组成。这些是紧密连接或完全连接的神经层。第一层有128个节点。第二层(也是最后一层)是一个10节点的softmax层，它返回10个概率分数的数组。每个节点包含一个分数，该分数指示当前图像属于10个类别之一的概率。</p><ul class=""><li id="dd07" class="mp mq hi kf b kg lf kj lg lh mr lj ms ll mt jy mu mv mw mx bi translated"><strong class="kf hj">编译模型</strong></li></ul><p id="afdb" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">模型构建完成后，我们进入编译阶段，该阶段主要包括三个基本要素:</p><ul class=""><li id="a089" class="mp mq hi kf b kg lf kj lg lh mr lj ms ll mt jy mu mv mw mx bi translated">损失函数:<strong class="kf hj"> <em class="ke">损失</em> </strong> <em class="ke"> </em>(预测值—实际值)<em class="ke"> </em>是我们在训练一个神经网络的过程中试图最小化的量。</li><li id="73ae" class="mp mq hi kf b kg my kj mz lh na lj nb ll nc jy mu mv mw mx bi translated">优化器:它根据损失函数决定网络如何更新</li><li id="e959" class="mp mq hi kf b kg my kj mz lh na lj nb ll nc jy mu mv mw mx bi translated">度量:测量模型的准确性。在这种情况下，我们将使用准确性。</li></ul><pre class="iy iz ja jb fd ns mj nt nu aw nv bi"><span id="7cab" class="ne lo hi mj b fi nw nx l ny nz">network.compile(optimizer='rmsprop',loss='categorical_crossentropy',<br/>metrics=['accuracy'])</span></pre><h2 id="d9fe" class="ne lo hi bd lp nf ng nh lt ni nj nk lx lh nl nm lz lj nn no mb ll np nq md nr bi translated">5.训练模型</h2><p id="0df9" class="pw-post-body-paragraph kc kd hi kf b kg mk ij ki kj ml im kl lh mm ko kp lj mn ks kt ll mo kw kx jy hb bi translated">为了开始训练，我们调用方法<code class="du mg mh mi mj b">network.fit</code>，即模型“适合”训练数据。</p><pre class="iy iz ja jb fd ns mj nt nu aw nv bi"><span id="ab8e" class="ne lo hi mj b fi nw nx l ny nz">network.fit(train_images, train_labels, epochs=5,batch_size=128)</span><span id="627a" class="ne lo hi mj b fi oa nx l ny nz">Epoch 1/5<br/>60000/60000 [==============================] - 3s 55us/step - loss: 0.5805 - acc: 0.7989<br/>Epoch 2/5<br/>60000/60000 [==============================] - 3s 44us/step - loss: 0.4159 - acc: 0.8507<br/>Epoch 3/5<br/>60000/60000 [==============================] - 3s 42us/step - loss: 0.3692 - acc: 0.8679<br/>Epoch 4/5<br/>60000/60000 [==============================] - 3s 45us/step - loss: 0.3403 - acc: 0.8767<br/>Epoch 5/5<br/>60000/60000 [==============================] - 3s 44us/step - loss: 0.3185 - acc: 0.8842</span></pre><p id="86ea" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">该模型在训练数据上达到大约<strong class="kf hj"> 0.88(或88%) </strong>的准确率。</p><h2 id="f109" class="ne lo hi bd lp nf ng nh lt ni nj nk lx lh nl nm lz lj nn no mb ll np nq md nr bi translated">6.模型评估</h2><p id="7662" class="pw-post-body-paragraph kc kd hi kf b kg mk ij ki kj ml im kl lh mm ko kp lj mn ks kt ll mo kw kx jy hb bi translated">我们在测试数据集上评估了模型的性能</p><pre class="iy iz ja jb fd ns mj nt nu aw nv bi"><span id="22af" class="ne lo hi mj b fi nw nx l ny nz">test_loss, test_acc = network.evaluate(test_images, test_labels)<br/>print('test_acc:', test_acc)</span><span id="75e4" class="ne lo hi mj b fi oa nx l ny nz">10000/10000 [==============================] - 0s 30us/step test_acc: 0.8683</span></pre><p id="ed89" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">测试集的准确率约为87%,这是训练数据集上较少的可视化——这是一个明显的过度拟合的例子。</p><h2 id="321a" class="ne lo hi bd lp nf ng nh lt ni nj nk lx lh nl nm lz lj nn no mb ll np nq md nr bi translated">7.做预测</h2><p id="2feb" class="pw-post-body-paragraph kc kd hi kf b kg mk ij ki kj ml im kl lh mm ko kp lj mn ks kt ll mo kw kx jy hb bi translated">现在让我们使用训练好的模型对一些图像进行预测。</p><pre class="iy iz ja jb fd ns mj nt nu aw nv bi"><span id="c674" class="ne lo hi mj b fi nw nx l ny nz">predictions = model.predict(test_images)</span></pre><p id="771d" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">让我们看看我们的模型对第10幅图像的预测。</p><pre class="iy iz ja jb fd ns mj nt nu aw nv bi"><span id="8cec" class="ne lo hi mj b fi nw nx l ny nz">predictions[10]</span><span id="360a" class="ne lo hi mj b fi oa nx l ny nz">array([9.7699827e-05, 5.6700603e-05, 1.0853803e-01, 1.0991561e-06, 8.7915897e-01, 4.5721102e-10, 1.2143801e-02, 1.0442269e-10, 3.1952586e-06, 4.5470620e-07], dtype=float32)</span></pre><p id="3170" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">预测是一个由10个数字组成的数组，代表不同类型服装的概率。我们还可以为列表中的第10项找到概率最高的标签。</p><pre class="iy iz ja jb fd ns mj nt nu aw nv bi"><span id="bb8d" class="ne lo hi mj b fi nw nx l ny nz">np.argmax(predictions[10])<br/>4</span></pre><p id="8f50" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">4对应于“<strong class="kf hj">外套</strong>因此，我们的模型预测第10件商品是一件外套。让我们检查一下这个预测的准确性。</p><pre class="iy iz ja jb fd ns mj nt nu aw nv bi"><span id="df4b" class="ne lo hi mj b fi nw nx l ny nz">test_labels[10]</span><span id="e069" class="ne lo hi mj b fi oa nx l ny nz">4</span></pre><p id="a9a2" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">事实上，它是4，即一个“外套。”</p><h1 id="628b" class="ln lo hi bd lp lq lr ls lt lu lv lw lx io ly ip lz ir ma is mb iu mc iv md me bi translated">分析预测</h1><p id="18cd" class="pw-post-body-paragraph kc kd hi kf b kg mk ij ki kj ml im kl lh mm ko kp lj mn ks kt ll mo kw kx jy hb bi translated">形象通过视觉化是最好的理解。让我们写一个函数，输出预测的图像和它属于那个类别的概率。</p><p id="6a2f" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">正确的预测标签为绿色，而不正确的预测标签为红色。该数字给出了预测标签的百分比。</p><p id="de4b" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">让我们看看第15幅图像，它的预测和概率。</p><pre class="iy iz ja jb fd ns mj nt nu aw nv bi"><span id="7496" class="ne lo hi mj b fi nw nx l ny nz">i = 15<br/>plt.figure(figsize=(8,3))<br/>plt.subplot(1,2,1)<br/>plot_image(i, predictions, test_labels, test_images)<br/>plt.subplot(1,2,2)<br/>plot_value_array(i, predictions,  test_labels)<br/>plt.xticks(range(10),class_names, rotation=90)<br/>plt.yticks(range(1))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es oe"><img src="../Images/b03d504354f5342f89c1c1d166ca3749.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*9Yn1iUasvw2R6YilzDzOiw.png"/></div></figure><p id="64b5" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">绿色标签表示“裤子”是正确的预测。</p><pre class="iy iz ja jb fd ns mj nt nu aw nv bi"><span id="24ed" class="ne lo hi mj b fi nw nx l ny nz">i = 1000<br/>plt.figure(figsize=(8,3))<br/>plt.subplot(1,2,1)<br/>plot_image(i, predictions, test_labels, test_images)<br/>plt.subplot(1,2,2)<br/>plot_value_array(i, predictions,  test_labels)<br/>plt.xticks(range(10),class_names, rotation=90)<br/>plt.yticks(range(0,1))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es of"><img src="../Images/5c972da7c632344d5a391f2d4829bcfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*d4Va4JJDBKasnd7emcs6hA.png"/></div></div></figure><p id="f5cb" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">对于第1000张图片，该模型以71%的概率预测到一件“<strong class="kf hj">衬衫</strong>”。然而，实际上，它是一件t恤/上衣。红色标签表示错误的预测，正确的标签写在错误标签旁边的括号中。</p><h2 id="4ac1" class="ne lo hi bd lp nf ng nh lt ni nj nk lx lh nl nm lz lj nn no mb ll np nq md nr bi translated">让我们再画几张图。</h2><pre class="iy iz ja jb fd ns mj nt nu aw nv bi"><span id="fd54" class="ne lo hi mj b fi nw nx l ny nz">num_rows = 5<br/>num_cols = 3<br/>num_images = num_rows*num_cols<br/>plt.figure(figsize=(5*num_cols, 2*num_rows))<br/>for i in range(num_images):<br/>  plt.subplot(num_rows, 2*num_cols, 2*i+1)<br/>  plot_image(i, predictions, test_labels, test_images)<br/>  plt.subplot(num_rows, 2*num_cols, 2*i+2)<br/>  plot_value_array(i, predictions, test_labels)<br/>  plt.xticks(range(10))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es og"><img src="../Images/f8dea7dd86593d09bf6ddc2f10f78a29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RnfwIuQWV2aogG9M7_2pxA.png"/></div></div></figure><p id="10f6" class="pw-post-body-paragraph kc kd hi kf b kg lf ij ki kj lg im kl lh li ko kp lj lk ks kt ll lm kw kx jy hb bi translated">对于大多数图像，我们的模型表现得非常好。然而，也有错误的预测被标为“红色”</p><h1 id="c9e2" class="ln lo hi bd lp lq lr ls lt lu lv lw lx io ly ip lz ir ma is mb iu mc iv md me bi translated">结论</h1><p id="8adb" class="pw-post-body-paragraph kc kd hi kf b kg mk ij ki kj ml im kl lh mm ko kp lj mn ks kt ll mo kw kx jy hb bi translated">时尚MNIST是对原始MNIST在数据复杂性和准确性方面的改进。自发布以来，它一直是这个领域的研究人员、学生和其他爱好者讨论的话题。<a class="ae jn" href="http://ai.tencent.com/ailab/index.html" rel="noopener ugc nofollow" target="_blank">晓寒——发布该数据集的高级科学家III @腾讯人工智能实验室</a>表示，“未来，我将继续维护时尚MNIST，让全球更多的人可以接触到它。不管你是研究人员，学生，教授，还是爱好者。欢迎你在论文、聚会、黑客马拉松、教程、课堂上使用时尚MNIST，甚至在T恤衫上使用<a class="ae jn" href="https://www.amazon.com/Computer-Data-Science-Machine-Learning/dp/B072LSQ8H5" rel="noopener ugc nofollow" target="_blank">。所以，开始尝试时尚版的MNIST吧。</a></p></div></div>    
</body>
</html>