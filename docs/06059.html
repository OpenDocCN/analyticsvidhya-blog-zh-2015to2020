<html>
<head>
<title>A Beginners Guide to Computer Vision (Part 5)- Scale Invariant Feature Transform (SIFT) Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">计算机视觉初学者指南(第5部分)-尺度不变特征变换(SIFT)第1部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-beginners-guide-to-computer-vision-part-5-scale-invariant-feature-transform-sift-part-1-6a0e676cbe1a?source=collection_archive---------16-----------------------#2020-05-10">https://medium.com/analytics-vidhya/a-beginners-guide-to-computer-vision-part-5-scale-invariant-feature-transform-sift-part-1-6a0e676cbe1a?source=collection_archive---------16-----------------------#2020-05-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e2fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">计算机科学史上被引用最多的论文之一。让我们从头开始学习并用python实现它。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="128f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经在我以前的文章中讨论过哈里斯兴趣点检测器。以防万一，如果你记不起来了，通读下面给出的文章。什么是SIFT？</p><div class="jk jl ez fb jm jn"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/a-beginners-guide-to-computer-vision-part-3-harris-interest-point-detection-15cdfb30104c"><div class="jo ab dw"><div class="jp ab jq cl cj jr"><h2 class="bd hj fi z dy js ea eb jt ed ef hh bi translated">计算机视觉初学者指南(三)——Harris兴趣点检测</h2><div class="ju l"><h3 class="bd b fi z dy js ea eb jt ed ef dx translated">不使用OpenCV完成Harris兴趣点检测算法及实现。</h3></div><div class="jv l"><p class="bd b fp z dy js ea eb jt ed ef dx translated">medium.com</p></div></div><div class="jw l"><div class="jx l jy jz ka jw kb kc jn"/></div></div></a></div><p id="b654" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SIFT是一个兴趣点检测器和描述符，该算法是由David Lowe开发的，其专利权属于不列颠哥伦比亚大学。这是计算机科学史上引用次数第四多的论文。SIFT的完整形式是<strong class="ih hj">尺度不变特征变换。</strong>名字本身就给了我们很多信息。SIFT是一种对尺度或任何仿射变换不变的检测器。它对噪声具有鲁棒性，对光照变化也不变。</p><p id="b489" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SIFT算法有四个主要步骤:1)尺度空间的极值检测，2)关键点定位，3)方向分配，4)关键点描述符</p><p id="4db6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文中的代码摘自这里的<a class="ae kd" href="https://github.com/robwhess/opensift" rel="noopener ugc nofollow" target="_blank">这里的</a>是用C++实现的。</p><h2 id="dae7" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">1)尺度空间的极值检测</h2><p id="6a5e" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated"><strong class="ih hj">兴趣点应该对尺度或仿射变换不变。这意味着，我们应该在不同的尺度上寻找兴趣点。</strong></p><figure class="lf lg lh li fd lj er es paragraph-image"><div class="er es le"><img src="../Images/1d13270a795b295b6fb8c27124f45dd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/0*Jiw2LlFR-By8DgG_.jpg"/></div></figure><p id="267f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看看上面的图片。由于透视效果，离相机较近的花比离相机较远的花尺寸大。我们需要检测相机附近和远处的花。</p><p id="6b53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你还记得我们在Marr-Hildreth边缘检测器中讨论的高斯(对数)滤波器的拉普拉斯算子吗？如果你不记得了，请浏览下面的链接。</p><div class="jk jl ez fb jm jn"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/a-beginners-guide-to-computer-vision-part-2-edge-detection-4f10777d5483"><div class="jo ab dw"><div class="jp ab jq cl cj jr"><h2 class="bd hj fi z dy js ea eb jt ed ef hh bi translated">计算机视觉初学者指南(第二部分)——边缘检测</h2><div class="ju l"><h3 class="bd b fi z dy js ea eb jt ed ef dx translated">了解边缘检测背后的算法及其实现。</h3></div><div class="jv l"><p class="bd b fp z dy js ea eb jt ed ef dx translated">medium.com</p></div></div><div class="jw l"><div class="ll l jy jz ka jw kb kc jn"/></div></div></a></div><p id="b276" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">高斯函数的拉普拉斯的形状会像一个倒置的墨西哥帽。看下图。</p><figure class="lf lg lh li fd lj er es paragraph-image"><div class="er es lm"><img src="../Images/09faab1417b35e7b01d1bb7d3dc07355.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*X0t6CI9Rol8dxvvZZElG9Q.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">来源:<a class="ae kd" href="https://www.crcv.ucf.edu/wp-content/uploads/2019/03/Lecture-6-SIFT.pdf" rel="noopener ugc nofollow" target="_blank">https://www . crcv . ucf . edu/WP-content/uploads/2019/03/Lecture-6-sift . pdf</a></figcaption></figure><p id="9cf0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们在X轴上有三个尺寸递增的斑点，在Y轴上有尺寸递增的高斯滤波器的拉普拉斯算子。如果解释响应，则与斑点尺寸和高斯滤波器的拉普拉斯算子的尺寸相关。</p><p id="01cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上面的直觉中，你可能会有一个想法，应用一个过滤器(一个西格玛)不会帮助你检测图像中的所有兴趣点。因此，我们生成一堆图像，这些图像是在应用具有递增sigma值的对数滤波器之后产生的。这一堆图像的离散函数会是这样的f (x，y，sigma)。当我们在金字塔格式中做同样的事情时，它被称为尺度空间。</p><h2 id="a56a" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">高斯差(DoG或D)是对数的近似值</h2><blockquote class="lr ls lt"><p id="6d59" class="if ig lu ih b ii ij ik il im in io ip lv ir is it lw iv iw ix lx iz ja jb jc hb bi translated">高斯差分函数提供了高斯尺度归一化拉普拉斯的近似</p></blockquote><p id="1220" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以从热扩散方程中清楚地理解这个关系，</p><figure class="lf lg lh li fd lj er es paragraph-image"><div class="er es ly"><img src="../Images/7320766640d156533b2e63f8e34f47a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:262/format:webp/1*XL-v_coMfLVcqwXHUFerYg.png"/></div></figure><p id="6a06" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用kσ和σ处附近标度的差异重写上述等式。</p><figure class="lf lg lh li fd lj er es paragraph-image"><div class="er es lz"><img src="../Images/16784bb92c0599db543f947e5965075e.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*sssm2QcDg7YeyD74-s7pFA.png"/></div></figure><p id="a66e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，</p><figure class="lf lg lh li fd lj er es paragraph-image"><div class="er es lz"><img src="../Images/96ed56a3b627d0e4a49ebfaae37ed079.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*6na7mke20M5c6iuz3hpRFw.png"/></div></figure><p id="fd57" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的等式表明，两个高斯图像之间的差可以近似高斯的拉普拉斯算子。我们利用这种现象来创造外部空间。看看下面的图片，更详细地了解它。</p><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="er es ma"><img src="../Images/1588a2e06ec26d90405d0f59f5e5bde9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*90tLG8ysi2dguPV4PWBHPA.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">来源:<a class="ae kd" href="https://link.springer.com/article/10.1023/B:VISI.0000029664.99615.94" rel="noopener ugc nofollow" target="_blank">https://link . springer . com/article/10.1023/B:visi . 0000029664 . 99615 . 94</a></figcaption></figure><p id="144a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Lowe建议对第一幅图像使用sigma值1.6，并通过将其乘以k(其关系在下面给出)来增加sigma，直到我们完成一个ocatve(堆栈)。当我们移动到金字塔的下一级时，我们调整图像的大小，这将是前一个堆栈顶部的2个图像。我们称这一叠图像为octave。这里有一个术语叫做区间数(s)，其值按建议值取为3。每个八度音程的图像数量的公式由关系s+3给出。</p><figure class="lf lg lh li fd lj er es paragraph-image"><div class="er es mf"><img src="../Images/cbc83f17e63357c0a7efcdafd219c5f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:138/format:webp/1*GV0lc47UXmCmAa8y9Fwv-A.png"/></div></figure><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="er es mg"><img src="../Images/790f58d57fbc55a1a64adfceda61ad77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jdgWlZWMY4julcHEjaxdeQ.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">第一级高斯尺度空间</figcaption></figure><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="er es mg"><img src="../Images/35d6950c714f806deb7f1385a5d24867.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7sMhfAxYtmoTxV7q4p-6VA.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">一级尺度空间</figcaption></figure><p id="fe99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">查看下面的代码片段，了解比例空间的生成。</p><figure class="lf lg lh li fd lj"><div class="bz dy l di"><div class="mh mi l"/></div></figure><h2 id="4ea6" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">局部极值检测</h2><p id="38bb" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">为了检测D(x，y，σ)的局部最大值和最小值，将每个样本点与其在当前图像中的八个邻居以及在上下尺度中的九个邻居进行比较。看下图。</p><figure class="lf lg lh li fd lj er es paragraph-image"><div class="er es mj"><img src="../Images/a1398d66c6fb720545ea8a89e01ed540.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*wfuaAq-gMJGpIVuAe-s_bg.png"/></div></figure><p id="c4a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">只有当它大于所有这些邻居或小于所有这些邻居时，它才被选为极值。</p><h2 id="1142" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">2)关键点定位</h2><p id="4c1e" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">我们分两个阶段改进这些极值:1)去除由于低对比度引起的不稳定极值点，以及2)去除不良的局部边缘响应。在进行关键点定位之前，关键点附近的像素应该被归一化。</p><h2 id="e520" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">去除由于低对比度引起的不稳定极值点</h2><p id="dcc9" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">我们将尺度空间中的一个级别表示为D(x，y，σ)。当我们用泰勒级数在样本点展开这个函数时。</p><figure class="lf lg lh li fd lj er es paragraph-image"><div class="er es mk"><img src="../Images/65e29eed9f37bf259c49e090289040ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*Nfr46cr0XuwBxzGUDFaXrw.png"/></div></figure><p id="d366" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中<strong class="ih hj"> x </strong> = [[x]，[y]，[σ]]。我们可以通过找到上述方程的导数并使其等于零来找到极值位置。这样做，我们将得到x，y和σ方向的位移矢量(x̂)。</p><figure class="lf lg lh li fd lj er es paragraph-image"><div class="er es ml"><img src="../Images/5b0bac567f5ea1b563912ce6f158f494.png" data-original-src="https://miro.medium.com/v2/resize:fit:342/format:webp/1*NGBizVDz0NPOJL5Mvliv7w.png"/></div></figure><p id="fdb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果偏移x̂在任何维度上都大于0.5，则意味着极值更靠近不同的采样点。在这种情况下，采样点会发生变化，并在该点附近执行插值。最终偏移x̂被添加到其采样点的位置，以获得极值位置的插值估计。极值D(x̂处的函数值)等于</p><figure class="lf lg lh li fd lj er es paragraph-image"><div class="er es mm"><img src="../Images/c15c4fa57d93be25b43c7380e38a0b2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/1*YieA0HQ4qe3336zlGIm-tQ.png"/></div></figure><p id="e6fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果D(x̂的值)小于0.03，该关键点将被拒绝。</p><h2 id="1116" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">去除不良的局部边缘响应</h2><p id="baa6" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">高斯差函数中定义不明确的峰值将在边缘上具有大的主曲率，但在垂直方向上具有小的主曲率。主曲率可通过2 × 2 Hessian矩阵H计算得出，该矩阵在关键点的位置和比例处计算得出:</p><figure class="lf lg lh li fd lj er es paragraph-image"><div class="er es mn"><img src="../Images/0bbd0e627efe0927b01509f960f4ada0.png" data-original-src="https://miro.medium.com/v2/resize:fit:346/format:webp/1*0KI_fS6UUc81W9_iMHeMSQ.png"/></div></figure><p id="760f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">H的特征值是d的主曲率的指标，我们已经在我的关于Harris兴趣点检测的文章中讨论了相同的概念。如果你不记得了，请浏览下面的链接。</p><div class="jk jl ez fb jm jn"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/a-beginners-guide-to-computer-vision-part-3-harris-interest-point-detection-15cdfb30104c"><div class="jo ab dw"><div class="jp ab jq cl cj jr"><h2 class="bd hj fi z dy js ea eb jt ed ef hh bi translated">计算机视觉初学者指南(三)——Harris兴趣点检测</h2><div class="ju l"><h3 class="bd b fi z dy js ea eb jt ed ef dx translated">不使用OpenCV完成Harris兴趣点检测算法及实现。</h3></div><div class="jv l"><p class="bd b fp z dy js ea eb jt ed ef dx translated">medium.com</p></div></div><div class="jw l"><div class="jx l jy jz ka jw kb kc jn"/></div></div></a></div><p id="1563" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">设α为最大值的特征值，β为较小值。然后，我们可以根据H的迹计算特征值之和，并根据行列式计算它们的乘积:</p><figure class="lf lg lh li fd lj er es paragraph-image"><div class="er es mo"><img src="../Images/5ba8d537888c6b6e0de6fb05c98f3a33.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*ofUzo_-A91Za4EgVKmAKGw.png"/></div></figure><p id="7fc8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">设r是最大特征值和较小特征值的比值。</p><figure class="lf lg lh li fd lj er es paragraph-image"><div class="er es mp"><img src="../Images/b6cbe643b998144515eeeec54b661215.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*4Z95jmHxTasgQhe7oPEVEg.png"/></div></figure><p id="b780" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果不满足下面给出的条件，我们将拒绝关键点。</p><figure class="lf lg lh li fd lj er es paragraph-image"><div class="er es mq"><img src="../Images/6162a262c7fdf679a66771ab63a1ab6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:332/format:webp/1*0_gCz_BTVJCGLkazAflJdg.png"/></div></figure><p id="4b9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">查看下面的代码片段，了解极值检测和定位。</p><figure class="lf lg lh li fd lj"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="84dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对在我大学门口拍的照片进行分析。我们将得到如下所示的结果。</p><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="er es mr"><img src="../Images/82f10008a6981b527a4c9de594eba70c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ygdbb1CWHq80SenPQCpRFw.png"/></div></div></figure><p id="a59c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们带着方向分配和描述符离开了。我将在这里结束这篇文章，并在下一部分继续剩余的主题。下面是本文中显示的代码的链接。</p><div class="jk jl ez fb jm jn"><a href="https://github.com/tbharathchandra/A-Beginners-Guide-to-Computer-Vision/blob/master/SIFT.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="jo ab dw"><div class="jp ab jq cl cj jr"><h2 class="bd hj fi z dy js ea eb jt ed ef hh bi translated">tbharathchandra/A-计算机视觉初学者指南</h2><div class="ju l"><h3 class="bd b fi z dy js ea eb jt ed ef dx translated">permalink dissolve GitHub是超过5000万开发人员的家园，他们一起工作来托管和审查代码，管理…</h3></div><div class="jv l"><p class="bd b fp z dy js ea eb jt ed ef dx translated">github.com</p></div></div><div class="jw l"><div class="ms l jy jz ka jw kb kc jn"/></div></div></a></div><p id="bb1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请继续关注更多关于计算机视觉的内容:)</p></div></div>    
</body>
</html>