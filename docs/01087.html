<html>
<head>
<title>Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逻辑回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/logistic-regression-f9845e1aca5e?source=collection_archive---------3-----------------------#2019-09-30">https://medium.com/analytics-vidhya/logistic-regression-f9845e1aca5e?source=collection_archive---------3-----------------------#2019-09-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/d404786fbbefd6094433f3cedfbfc93b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Emds3x9DryDDAIqfILvRyg.png"/></div></div></figure><p id="6e6f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">尽管被称为回归测量，但仍用于分类。逻辑回归是最基本和最流行的算法之一。它是回归分析的一种形式，使用连续和离散预测因子的混合来预测离散变量。</p><p id="c450" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">什么是分类问题？</strong></p><p id="79cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当自变量本质上是连续的，因变量是分类形式的，即在像正类和负类这样的类中时，我们将问题识别为分类问题。所有这些问题的答案都是绝对形式的，即是或否</p><p id="332b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">虽然，有时我们会遇到两个以上的类，但这仍然是一个分类问题。这些类型的问题被称为多类分类问题。</p><p id="04c8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">为什么不用线性回归？</strong></p><p id="67e4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">假设我们有一个肿瘤大小与其恶性程度的数据。由于这是一个分类问题，如果我们绘图，我们可以看到，所有的值将位于<strong class="is hj"> 0 </strong>和<strong class="is hj"> 1 </strong>。如果我们拟合最佳找到的回归线，通过假设阈值为0.5，该线做了合理的工作。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jo"><img src="../Images/547aaa389ce3cf74191ec13a57ac0138.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*IJ58JOQgFWYGXlWZ3ZLvaQ.png"/></div></figure><p id="c9e7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以确定x轴上的点，从该点开始，位于其左侧的所有值都被认为是负类，位于其右侧的所有值都是正类。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/1a662a9bee5bb001b18468bfac62911b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*55qxix69vVxhOnkVGcDZOQ.png"/></div></figure><p id="0f4d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是如果数据中有异常值呢？事情会变得一团糟。例如，对于0.5阈值，</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es ju"><img src="../Images/5d7f6ac2b0b808fcc328469dd4548836.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*8hK-7nA5YkqV2dvdjJhLtw.png"/></div></figure><p id="c67f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">即使我们拟合最佳回归曲线，也不足以确定我们可以用来区分阶级的任何点。它会把一些正面类的例子放到负面类里。绿色虚线(决策边界)将恶性肿瘤与良性肿瘤区分开来，但该线应该位于黄线处，黄线清楚地将阳性和阴性示例区分开来。因此，仅仅一个异常值就会扰乱整个线性回归预测。这就是逻辑回归发挥作用的地方。</p><p id="3548" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">问题</strong>:</p><p id="59c0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.当我们使用线性回归模型时，预测值是无界的-∞到∞。</p><p id="4feb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.但是概率值被限制在0和1之间。</p><p id="f054" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">解决方案</strong>:运行Logit转换。</p><p id="b77f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">什么是Logit转换，我们为什么需要它？</strong></p><p id="bf1e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Logit是一个转换，我们用它来转换我们的模型，使之成为一个线性模型。logit转换将直线转换为逻辑曲线。逻辑回归将逻辑曲线拟合到一组数据，其中因变量只能取值0和1。</p><p id="67f3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它取的是<strong class="is hj">‘比值比’的对数。</strong>比值比是一个统计术语，表示成功概率与失败概率之比。</p><p id="551e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">优势比= P/(1-P)</p><p id="a100" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">示例:如果成功概率= 0.75，则</p><p id="c65c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">故障概率= 1–0.75 = 0.25</p><p id="d803" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">优势比= (0.75/0.25)=3</p><p id="fe27" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">P和1-P的值会是多少？</p><p id="77a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">P/(1-P) —取值范围为0至∞。因为记住“Y的概率”只能取0到1的值。所以，</p><p id="996d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果P=0，P/(1-P)=(0/1)=0</p><p id="2cdc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果P=1，P/(1-P)=(1/0)= ∞时</p><p id="1e53" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们不采用“Y的概率”，而是采用“成功概率”的比值比，即“P/(1-P)”。现在，比值比可以取0到∞。</p><p id="e645" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是在线性回归模型中，预测值可以落在-∞到∞之间的任何地方。因此我们取log(P/(1-P))。</p><p id="7176" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Log(0) = -∞值</p><p id="dde9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Log(1) = ∞值</p><p id="caaf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">计算:</strong></p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jv"><img src="../Images/7a2f6ad1e6212eb46c098c694e666b55.png" data-original-src="https://miro.medium.com/v2/resize:fit:614/format:webp/1*pqlJNjD2t6hP2jwaSpc9UA.png"/></div></figure><p id="a000" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">逻辑回归算法</strong></p><p id="deab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如前所述，为了处理异常值，逻辑回归使用Sigmoid函数。逻辑函数是一个Sigmoid函数，它取0到1之间的任何实数值。它被定义为</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jw"><img src="../Images/b3911d46f059dcf6198ff5a5d10f0cb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:384/format:webp/1*c1hIxhrvWN0VBe1LJCWU9w.png"/></div></figure><p id="c6ef" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">而如果我们画出来，图形会是<strong class="is hj"> <em class="jx"> S </em> </strong>曲线，</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jy"><img src="../Images/e02347cc6f668163aa7f184106246358.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*2gBzZHb8M7nBMNWptd0DsA.png"/></div></figure><p id="c972" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们把<strong class="is hj"> <em class="jx"> t </em> </strong>看作一元回归模型中的线性函数。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jz"><img src="../Images/4cb401f485a7f5cb68328b055b88fc8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:244/format:webp/1*PuhmlppvhT1ASzjJ0jPQzQ.png"/></div></figure><p id="30d6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以，逻辑方程式会变成</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es ka"><img src="../Images/009fe34276a595f3a3020eecf4aafd77.png" data-original-src="https://miro.medium.com/v2/resize:fit:362/format:webp/1*uBx5x6yFA19CCShAV-J10g.png"/></div></figure><p id="519d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，当逻辑回归模型遇到异常值时，它会处理它。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jy"><img src="../Images/a12dc9de876caec0e487463938fc4c6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*AIC6TP2onSalHl_1obpeoQ.png"/></div></figure><p id="0add" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但有时它会根据异常值的位置将其y轴向左或向右移动。</p><p id="b23d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">Logistic回归模型的估计:</strong></p><p id="85a0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用一种称为“最大似然估计(MLE)”的技术来估计逻辑方程。</p><p id="dbaf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当误差项的基本分布是正态分布时，MLE估计类似于OLS(普通最小二乘)估计。</p><p id="9b34" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">像许多其他国家一样，OLS是MLE的一个特例。</p><p id="f3d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Y = mx + c</p><p id="16a8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> MLE直觉</strong>:</p><p id="3018" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">发现系数值(m &amp; c)使得它们最大化由模型描述的过程产生被观察的数据的可能性。</p><p id="80fa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">"未知参数的什么值使我们看到的数据最不令人惊讶？"</p><h1 id="9751" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak">优点</strong>:</h1><p id="af61" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">这是一种广泛使用的技术，因为它非常高效，不需要太多的计算资源，可解释性强，不需要缩放输入要素，不需要任何调整，易于正则化，并且输出校准良好的预测概率。</p><p id="eefe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">与线性回归一样，当您移除与输出变量无关的属性以及彼此非常相似(相关)的属性时，逻辑回归的效果会更好。因此，特征工程对于逻辑回归的性能起着重要的作用。逻辑回归的另一个优点是它非常容易实现，训练起来也非常有效。</p><h1 id="5c65" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">缺点:</h1><ul class=""><li id="c651" class="le lf hi is b it kz ix la jb lg jf lh jj li jn lj lk ll lm bi translated">识别独立变量</li><li id="c95d" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn lj lk ll lm bi translated">过度拟合模型</li><li id="4abb" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn lj lk ll lm bi translated">仅限于变量之间的线性关系</li><li id="1de1" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn lj lk ll lm bi translated">对异常值的敏感性</li><li id="4128" class="le lf hi is b it ln ix lo jb lp jf lq jj lr jn lj lk ll lm bi translated">大样本量</li></ul><h2 id="bd31" class="ls kc hi bd kd lt lu lv kh lw lx ly kl jb lz ma kp jf mb mc kt jj md me kx mf bi translated">Python实现:</h2><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/9e0a609f1a377b26c9a1884d7a9b6278.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CPFvxwQWQVeT_IP0oTb10Q.png"/></div></div></figure><p id="ba56" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">感谢您的阅读。</p></div></div>    
</body>
</html>