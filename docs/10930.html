<html>
<head>
<title>AWS Data Analytics — Kinesis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS 数据分析— Kinesis</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/aws-data-analytics-kinesis-c968b123c1b8?source=collection_archive---------8-----------------------#2020-11-09">https://medium.com/analytics-vidhya/aws-data-analytics-kinesis-c968b123c1b8?source=collection_archive---------8-----------------------#2020-11-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="661c" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">如何在 AWS 上移动数据？</h1><p id="cf65" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">3 个不同的类别</p><p id="e1f2" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> 1)实时</strong></p><ul class=""><li id="6046" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">Kinesis 数据流</li><li id="0417" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">简单缺省服务</li><li id="5b90" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">物联网</li></ul><p id="5b70" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> 2)近实时(反应行动)</strong></p><ul class=""><li id="3b70" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">Kinesis 数据消防软管</li><li id="a37c" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">数据库迁移服务</li></ul><p id="339a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> 3) </strong> <strong class="jf hj">批量—历史分析</strong></p><p id="618c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">注意:这通常在你想移动大量数据时调用</p><ul class=""><li id="3582" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">雪球</li><li id="4a73" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">数据管道</li></ul><h1 id="58d9" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">AWS KINESIS 概述</h1><ul class=""><li id="faa1" class="kg kh hi jf b jg jh jk jl jo ku js kv jw kw ka kl km kn ko bi translated">卡夫卡的替代</li><li id="de16" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">如果您想要收集数据，如应用程序日志、指标、物联网数据或点击流，这非常有用。</li><li id="2867" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">它集成了许多字符串处理框架，如 Spark 或 NiFi</li></ul><p id="4fa2" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> Kinesis 流:</strong>低延迟流</p><p id="f1c4" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> Kinesis 分析:</strong>使用 SQL 对数据流进行实时分析</p><p id="7310" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> Kinesis Firehose: </strong>将流加载到 s3、Redshift、ES、Splunk</p><h1 id="48c7" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">建筑运动学</h1><p id="9b50" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">循序渐进；</p><p id="fe15" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">来源:</strong>点击流、物联网、指标和日志</p><p id="aa9a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">来源转到<strong class="jf hj">亚马逊 Kinesis Streams </strong>如果你想进行分析、计算指标或发出警报，你应该使用<strong class="jf hj">亚马逊 Kinesis Analytics </strong>因此，如果你想存储或制作实时仪表板，你必须使用<strong class="jf hj">亚马逊 Kinesis Firehose </strong>和什么 Kinesis Firehose？实际上，它可以将数据传送到 S3、ES、Redshift 或 Splunk。</p><figure class="ky kz la lb fd lc er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es kx"><img src="../Images/b54ace58727bb5a0b865867c4c506f21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iDFsJb3Nwz8Vogpo.png"/></div></div></figure><h1 id="8a9c" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">Kinesis 流概述</h1><p id="a126" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">流被分成有序的碎片和分区。碎片的意思相当于分割。</p><p id="9620" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">例如:生产者-&gt; 3 *碎片(碎片-1，碎片-2，碎片-3 )-&gt;消费者</p><p id="9dc3" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">消费者用碎片读取数据。Kinesis Streams 不会永远存储您的数据，它只是默认存储 24 小时，所以你基本上只存储 1 天。但是，如果您的数据非常重要，您最多可以存储 7 天。</p><ul class=""><li id="32af" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">运动具有再加工、重放数据的能力。</li><li id="e847" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">多个应用程序可以使用同一个流</li><li id="4d86" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">这不是数据库！</li><li id="2eee" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">一旦数据被插入 kinesis，它不能被删除或不变性，它只是附加流</li></ul><h1 id="f5bf" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">Kinesis 流碎片</h1><ul class=""><li id="2914" class="kg kh hi jf b jg jh jk jl jo ku js kv jw kw ka kl km kn ko bi translated">一个流由许多不同的碎片或分区组成。</li><li id="41c6" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">i̇mportent 案正在开票！这么多碎片，这么多美元，这么多账单。您会收到每个分片供应的账单。</li><li id="ceb6" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">可用批处理或每条消息 put。</li><li id="14b8" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">碎片的数量可以随着时间的推移而演变，所以你可以在这些操作中 rashard 或合并。</li><li id="92a4" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">记录是按分片排序的</li></ul><p id="0d2a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">生产者-&gt; 3 *碎片(碎片-1，碎片-2，碎片-3 )-&gt;消费者。</p><p id="f0cd" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">这些碎片是我们的制作人做的？</p><p id="dd08" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">Kinesis 流记录</p><ul class=""><li id="2929" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">我们的生产者记录由数据块构成。数据 blob 序列化为最大 1MB 的字节，表示任何内容。</li><li id="3e97" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">记录键:帮助 kinesis 知道到达发送数据的碎片。就像用户 ID 一样。</li><li id="e244" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">序列号:它不是生产者发送的东西，而是摄入后由 kinesis 添加的东西。放入碎片中的每个记录的唯一标识符。</li></ul><p id="8a74" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">极限！</strong></p><ul class=""><li id="964c" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">生产者只能在每个分片写 1 mb 或 1000 条消息。例如，如果你有 10 个碎片，你会得到每秒 10mb 或 10k 的消息。</li><li id="6b81" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">如果超过了这个限制，就调用 ProvisionedThoughputException。</li></ul><p id="83d8" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">Kinesis 有两类消费者。</p><ol class=""><li id="85e9" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka lj km kn ko bi translated">消费者经典</li></ol><ul class=""><li id="e944" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">每秒 2 兆字节。以在所有消费者之间读取每个碎片。</li><li id="9f24" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">每个分片每秒 5 次 API 调用。</li></ul><p id="1801" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">2.消费者增强型扇出</p><ul class=""><li id="5209" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">没有 API 调用</li><li id="0349" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">每秒 2 兆字节。读取每个碎片，每个增强的消费者</li></ul><h1 id="e79d" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">Kinesis 生产者</h1><p id="13ff" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">第一个是 SDK(软件开发工具包)允许你写代码或使用 CLIA 直接发送数据到 Kinesis。第二个是 Kinesis 生产商(KP)第三个是 Kinesis 代理，这个代理基本上允许你得到一个日志文件。最后一部分是第三段。火花，水槽等。所有这些东西都会向 kinesis 发送数据。</p><p id="7e2c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> Kinesis 生产商 SDK </strong></p><ul class=""><li id="fa96" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">用过的腐肉(一种)和腐肉(多种)</li><li id="419e" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">PutRecords 使用批处理您可以将记录作为一个 HTTP 请求的一部分发送，因此您将记录保存在 HTTP</li><li id="ac26" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">如果超出限制，ProvisionedThoughputExceeded 就会超出。</li></ul><p id="b197" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">管理:</p><ul class=""><li id="821f" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">AWS 物联网</li><li id="4e99" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">云观察</li><li id="ec5f" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">Kinesis 数据分析</li></ul><p id="6f5e" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> AWS Kinesis 异常</strong></p><ul class=""><li id="f9b0" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">ProvisionedThoughputExceeded:超过任何碎片的 MB/s 或 TPS</li><li id="8440" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">分区中的错误键</li></ul><p id="bde9" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">异常的基本解决方案</p><ul class=""><li id="b2df" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">后退重试</li><li id="618b" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">增加碎片</li></ul><p id="f58e" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> Kinesis 制作人库</strong></p><p id="df71" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">同步和异步 API 但是在异步中 butter 性能，可以用 CloudWatch 进行监视。非常重要的机制是配料，因此配料分为两部分，第一部分是收集，第二部分是聚集。</p><p id="61e4" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在同一个 PutRecords API 中收集记录并写入多个碎片</p><p id="40ca" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在一条记录中存储多条记录的总延迟能力超过每秒 1000 条记录。极限最大极限为 1mb/秒。</p><p id="56bc" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">重要的事情:例如，你有 3 部分数据 20KB- 30 KB- 200KB，所有这些数据分别在 3 毫秒，5 毫秒，6 毫秒，实际上所有这些数据小于 1mb，你可以使用 PutRecords API 调用一次。但是怎么做呢？RecordMaxBufferdTime 引入了一些延迟(默认为 100 毫秒)。基本上，你是说我愿意等待 100ms，所以这是在更高效的代价上增加了一点点迟到。</p><p id="761b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">最后一部分是 Kinesis 代理，因此该代理监控日志文件并将它们发送到 kinesis 数据流，它构建在顶层 KPL (Kinesis Producer Library)上，从多个目录写入，代理处理文件旋转、检查点和失败后重试，并向 CloudWatch 发出指标进行监控</p><h1 id="a971" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">Kinesis 消费者经典</h1><p id="eac1" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">蒸汽无处不在，例如 Lambda、Firehose、Spark、SDK、client 等。</p><p id="8415" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">经典的 kine sis——记录由消费者从碎片中进行投票。每个碎片总共有 2 MB。它是如何工作的？消费者与例如 shard-1 通话并说嘿伙计！GetRecords()和 shard-1 说 ok buddy 这是给你的“数据”。GetRecords 返回高达 10 mb 的数据，然后节流 5 秒。或者你可以得到多达 10，000 条记录。每秒最多 5 次 getrecords api 调用 200 毫秒。</p><p id="acc7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">重要提示:如果 5 个客户端使用同一个分片，意味着每个客户端每秒可以轮询一次。小于 400kb/s</p><p id="cdc4" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> Kinesis 客户端库</strong></p><p id="f19e" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">阅读来自 Kinesis 制作人的记录。</p><p id="f192" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在一个组中与多个消费者共享多个碎片，这就是碎片发现。</p><p id="54bc" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">关卡未来恢复进度！因此，如果应用程序停止运行并重新启动，它能够准确地记住最后一次使用的位置，以便继续运行。</p><p id="4951" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">那么，检查点和所有碎片发现是如何工作的呢？</p><p id="6aa7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">基本上用的是一个测功机。DB 表来检查一段时间内的进度，并同步以查看谁将读取哪个碎片。因此 DynamoDB 将用于检查点，它在表中有一行用于每个碎片的消费。</p><p id="8aff" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> Kinesis 连接器库</strong></p><p id="497e" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">Kinesis 数据流输出用于将数据写入 S3、DynamoDb、Redshift 或 ES。这个连接器运行在 EC2 上，这是必须的！</p><p id="3f15" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> Kinesis 增强扇出</strong></p><p id="9cfe" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">正在研究 KCL 2.0 和 lambda。什么是 kinesis 增强扇出，所以每个消费者将获得每秒 2 mb 的碎片。它看起来和以前很相似，但不是完全一样的东西。生产者进入 Kinesis 数据流，消费者使用 SubscribeToShard()，所以我们只是开始，仅此而已。不再拉了。这意味着，如果我们总共有 20 个消费者，那么每个碎片的速度将达到 40mb/s。不再有 2mb 的限制！！原因是 kinesis 通过 http/2 将数据推送给消费者。减少 70 毫秒延迟。</p><p id="e2ca" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">增强版与标准版消费者</strong></p><p id="f25f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">标准消费者使用低数量 1–2–3 bla bla，可承受 200 毫秒延迟，最大限度降低成本</p><p id="741b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">增强型是针对相同流的多个消费者应用程序，低延迟 70 毫秒。每个数据流使用增强扇出的默认限制为 5 个用户。</p><p id="7c74" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> Kinesis 操作- &gt;添加碎片</strong></p><p id="f5df" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">也称为分片分割，可用于增加流容量(每个分片 1mb/s 数据),如果有 10 个分片，则每秒 10mb。</p><p id="385e" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">可以用来分割“热碎片”</p><p id="029c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">那么当你分裂一个碎片时会发生什么呢？旧碎片已经关闭，将从数据中删除。</p><p id="c07f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">例如，我们有 3 个碎片和所有相同的空间。</p><p id="7580" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">|碎片 1|碎片 2|碎片 3|</p><p id="eb4b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">让我们想象一下，shard-2 非常热，我们希望分割它以增加 shard-2 的这个关键空间的吞吐量。所以我们要做拆分操作，将要发生的是碎片 4，已经创建和碎片 5。</p><p id="80c0" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">|碎片 1 <strong class="jf hj"> |碎片 4 |碎片 5| </strong>碎片 3|</p><p id="c3cf" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">因此，只要 shard-2 中的数据没有过期，它就可以使用，但过期后，它就会消失。</p><p id="666c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> Kinesis 操作- &gt;合并碎片</strong></p><p id="8e35" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">降低流容量并节省成本，可用于将两个流量较低的分片分组。</p><p id="edc0" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">同样，旧碎片会根据数据到期时间关闭并删除。</p><p id="abbf" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">|碎片 1 <strong class="jf hj"> |碎片 4 |碎片 5| </strong>碎片 3|</p><p id="6e32" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">例如，我们合并了碎片-1 和碎片-4，因为没有得到这么多的流量，所以我们可以将它们合并在一起，节省一些成本。</p><p id="c1c5" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">| <strong class="jf hj">碎片-6| </strong>碎片-5 <strong class="jf hj"> | </strong>碎片-3|</p><p id="76b3" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">那么，比如说自动缩放。</p><ul class=""><li id="cc53" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">自动缩放不是 kinesis 的固有特性</li><li id="7cd6" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">使用<strong class="jf hj"> UpdateShardCount </strong>改变 kinesis 中碎片数量的 API 调用</li><li id="b1b3" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">我们可以用 AWS Lambda 实现自动缩放</li></ul><p id="80d0" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">注意事项:</p><ul class=""><li id="3fa5" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">重共享不能并行进行。你需要计划和能力以防万一。</li></ul><p id="f0c9" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">还有不要做那个单子！</strong></p><ul class=""><li id="869c" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">针对一个流，将您当前的碎片数量增加一倍以上</li><li id="94eb" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">在一个流中扩展到 500 多个碎片</li><li id="77bd" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">扩展到超过您帐户的碎片限制</li></ul><p id="421f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">这就是说，规模重建不能并行进行，基本上每个碎片的重建都需要几秒钟。</p><p id="d017" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> Kinesis 安全</strong></p><ul class=""><li id="2ee6" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">使用 IAM 控制访问/授权</li><li id="198c" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">HTTP 端点中的加密</li><li id="b534" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">使用 KMS 的静态加密</li><li id="f985" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">VPC 可用于 VPC 境内的变身</li></ul><h1 id="0fcc" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">自动气象站驱动数据消防软管</h1><ul class=""><li id="62da" class="kg kh hi jf b jg jh jk jl jo ku js kv jw kw ka kl km kn ko bi translated">完全托管服务，无需管理</li><li id="1861" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">近乎实时！(60 秒延迟)好吧，但是为什么呢？当你看到批处理时，有一个 60 秒。如果您的批次未满，则延迟最小，因此我们无法保证数据会立即到达目的地。</li><li id="1a80" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">将数据加载到 S3、ES、Splunk、Redshift</li><li id="f51e" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">自动缩放</li><li id="f43c" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">从 json 到 parquet 的数据转换(仅 s3)</li><li id="01c3" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">数据转换 AWS Lambda csv -&gt; json</li><li id="a876" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">压缩 GZIP，拉链，爽快</li><li id="fd2a" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">只有 GZIP 的数据被进一步载入红移</li><li id="d52c" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">Spark 或 Kinesis 客户端库无法读取 Kinesis 数据 Firehose</li></ul><p id="6a7d" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">SDK、Kinesis 代理、Kinesis 数据流、云观察、物联网将数据发送到 kinesis firehose，firehose 能够进行一些转换，然后我们可以使用 lambda 函数，我们将其存储在 s3、ES、splank、redshift 上</p><p id="81b2" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">缓冲区大小是 32 mb，时间是 2 分钟，如果达到它的刷新。</p><p id="27af" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> Kinesis 数据流与消防软管</strong></p><p id="9016" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">流</p><ul class=""><li id="e278" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">准备编写定制代码(生产者/消费者)</li><li id="fee7" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">实时</li><li id="2086" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">必须管理缩放(合并/拆分)</li><li id="fcd0" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">数据存储 1–7 天</li></ul><p id="fb3b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">消防水龙带</p><ul class=""><li id="3697" class="kg kh hi jf b jg kb jk kc jo ki js kj jw kk ka kl km kn ko bi translated">完全托管发送到 s3、es、splkunk、红移</li><li id="8fff" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">使用 lambda 的无服务器数据转换</li><li id="14a6" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">接近实时</li><li id="1bff" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">自动缩放</li><li id="b281" class="kg kh hi jf b jg kp jk kq jo kr js ks jw kt ka kl km kn ko bi translated">没有数据存储</li></ul></div></div>    
</body>
</html>