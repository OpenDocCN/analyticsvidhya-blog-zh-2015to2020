# RNN å¯¹ GRU å¯¹ LSTM

> åŸæ–‡ï¼š<https://medium.com/analytics-vidhya/rnn-vs-gru-vs-lstm-863b0b7b1573?source=collection_archive---------0----------------------->

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†è®©ä½ å…ˆäº†è§£ RNNã€GRU å’Œ LSTM çš„ç†è®ºï¼Œç„¶åæˆ‘å°†å‘ä½ å±•ç¤ºå¦‚ä½•ç”¨ä»£ç å®ç°å’Œä½¿ç”¨å®ƒä»¬ã€‚

å·²ç»æœ‰å¾ˆå¤šå…³äºè¿™äº›è¯é¢˜çš„å¸–å­äº†ã€‚ä½†æ˜¯åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘æƒ³å€ŸåŠ©ä»£ç æä¾›æ›´å¥½çš„ç†è§£å’Œæ¯”è¾ƒã€‚

è®©æˆ‘ä»¬ä» RNN å¼€å§‹å§ï¼

## **é€’å½’ç¥ç»ç½‘ç»œ**

é€’å½’ç¥ç»ç½‘ç»œ(RNN)è®¾è®¡ç”¨äºå¤„ç†åºåˆ—æ•°æ®ã€‚é¡ºåºæ•°æ®(å¯ä»¥æ˜¯æ—¶é—´åºåˆ—)å¯ä»¥æ˜¯æ–‡æœ¬ã€éŸ³é¢‘ã€è§†é¢‘ç­‰å½¢å¼ã€‚

RNN ä½¿ç”¨åºåˆ—ä¸­å…ˆå‰çš„ä¿¡æ¯æ¥äº§ç”Ÿå½“å‰çš„è¾“å‡ºã€‚ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸€ç‚¹ï¼Œæˆ‘ä¸¾äº†ä¸€ä¸ªä¾‹å¥ã€‚

> â€œæˆ‘çš„ç­æ˜¯æœ€å¥½çš„ç­ã€‚â€

**å½“æ—¶( *T0 )*** *ï¼Œ*ç¬¬ä¸€æ­¥å°±æ˜¯æŠŠ*æˆ‘çš„*è¿™ä¸ªè¯é¦ˆå…¥ç½‘ç»œã€‚RNN äº§ç”Ÿä¸€ä¸ªè¾“å‡ºã€‚

**å½“æ—¶( *T1 )*** *ï¼Œ*ç„¶ååœ¨ä¸‹ä¸€æ­¥æˆ‘ä»¬è¾“å…¥å•è¯*â€œclassâ€*å’Œä¸Šä¸€æ­¥çš„æ¿€æ´»å€¼ã€‚ç°åœ¨ RNN æœ‰äº†â€œæˆ‘çš„ T21â€å’Œâ€œé˜¶çº§â€è¿™ä¸¤ä¸ªè¯çš„ä¿¡æ¯ã€‚

è¿™ä¸ªè¿‡ç¨‹ä¸€ç›´æŒç»­åˆ°å¥å­ä¸­çš„æ‰€æœ‰å•è¯éƒ½è¢«è¾“å…¥ã€‚ä½ å¯ä»¥çœ‹ä¸‹é¢çš„åŠ¨ç”»æ¥å½¢è±¡åŒ–ç†è§£ã€‚

![](img/e459911825166c117446cf4a0f7b6b30.png)

RNN çš„å·¥ä½œæµç¨‹ã€‚

åœ¨**æœ€åä¸€æ­¥**ï¼ŒRNN å…·æœ‰å…³äºæ‰€æœ‰å…ˆå‰å•è¯çš„ä¿¡æ¯ã€‚

> ***æ³¨æ„:*** *åœ¨ RNN* å±‚ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„æƒé‡å’Œåå·®éƒ½æ˜¯ç›¸åŒçš„ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹ RNN å•å…ƒçš„æ¶æ„ã€‚å®ƒæ¥å—ä¸Šä¸€æ­¥çš„è¾“å…¥å’Œå½“å‰è¾“å…¥ã€‚è¿™é‡Œ *tanh* æ˜¯æ¿€æ´»åŠŸèƒ½ï¼Œä»£æ›¿ *tanh* ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–æ¿€æ´»åŠŸèƒ½ã€‚

![](img/e06915a18d57cca600a0328bb4a97a2c.png)

RNN åŸºç¡€å»ºç­‘

**ğŸ’¡** RNN é¢ä¸´çŸ­æœŸè®°å¿†é—®é¢˜ã€‚è¿™æ˜¯ç”±äºæ¶ˆå¤±æ¢¯åº¦é—®é¢˜é€ æˆçš„ã€‚éšç€ RNN å¤„ç†çš„æ­¥éª¤è¶Šæ¥è¶Šå¤šï¼Œå®ƒæ¯”å…¶ä»–ç¥ç»ç½‘ç»œæ¶æ„æ›´å®¹æ˜“é­å—æ¶ˆå¤±æ¢¯åº¦çš„å½±å“ã€‚

**é—®:ä»€ä¹ˆæ˜¯æ¶ˆå¤±æ¸å˜é—®é¢˜ï¼Ÿ**

**ç­”:**åœ¨ RNN è®­ç»ƒç½‘ç»œä½ é€šè¿‡æ—¶é—´åå‘ä¼ æ’­ï¼Œåœ¨æ¯ä¸€æ­¥è®¡ç®—æ¢¯åº¦ã€‚æ¢¯åº¦ç”¨äºæ›´æ–°ç½‘ç»œä¸­çš„æƒé‡ã€‚å¦‚æœå‰ä¸€å±‚å¯¹å½“å‰å±‚çš„å½±å“å¾ˆå°ï¼Œé‚£ä¹ˆæ¢¯åº¦å€¼ä¹Ÿå¾ˆå°ï¼Œåä¹‹äº¦ç„¶ã€‚å¦‚æœå‰ä¸€å±‚çš„æ¢¯åº¦è¾ƒå°ï¼Œåˆ™å½“å‰å±‚çš„æ¢¯åº¦å°†æ›´å°ã€‚å½“æˆ‘ä»¬åå‘ä¼ æ’­æ—¶ï¼Œè¿™ä½¿å¾—æ¢¯åº¦æŒ‡æ•°åœ°ç¼©å°ã€‚è¾ƒå°çš„æ¢¯åº¦æ„å‘³ç€å®ƒä¸ä¼šå½±å“é‡é‡çš„å¢åŠ ã€‚å› æ­¤ï¼Œç½‘ç»œä¸ä¼šäº†è§£æ—©æœŸè¾“å…¥çš„å½±å“ã€‚ä»è€Œå¯¼è‡´çŸ­æœŸè®°å¿†é—®é¢˜ã€‚

![](img/018181521a6c35459804cd73e864eca6.png)

RNN çš„éšè—çŠ¶æ€

> ä¸»è¦çš„é—®é¢˜æ˜¯ï¼Œå¯¹ RNN æ¥è¯´ï¼Œè¦å­¦ä¼šåœ¨å¤šä¸ªæ—¶é—´æ­¥é•¿å†…ä¿å­˜ä¿¡æ¯å¤ªéš¾äº†ã€‚åœ¨æ™®é€šçš„ RNNï¼Œéšè—çš„å·æ­£ä¸æ–­åœ°è¢«**æ”¹å†™ã€‚**

æœ‰ç‹¬ç«‹å†…å­˜çš„ RNN æ€ä¹ˆæ ·ï¼Ÿ

**æ¶ˆå¤±æ¸å˜è§£å†³æ–¹æ¡ˆ**

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸¤ä¸ªä¸“é—¨ç‰ˆæœ¬çš„ RNN è¢«åˆ›é€ å‡ºæ¥ã€‚å®ƒä»¬æ˜¯ 1) GRU(é—¨æ§å¾ªç¯å•å…ƒ)2) LSTM(é•¿çŸ­æœŸè®°å¿†)ã€‚å‡è®¾æœ‰ä¸¤ä¸ªå¥å­ã€‚ç¬¬ä¸€å¥æ˜¯â€œæˆ‘çš„ ***çŒ«*** æ˜¯â€¦â€¦å¥¹ ***æ˜¯*** ç—…äº†ã€‚â€ï¼Œç¬¬äºŒä¸ªæ˜¯â€œçŒ«çš„*â€¦..ä»–ä»¬ ***éƒ½*** ç—…äº†ã€‚â€åœ¨å¥å­çš„ç»“å°¾ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦é¢„æµ‹å•è¯" ***"è¢«"/"è¢«"*" T25 "ï¼Œç½‘ç»œå°±å¾—è®°ä½èµ·å§‹å•è¯" ***"çŒ«"/"çŒ«"*** ã€‚å› æ­¤ï¼ŒLSTM å’Œ GRU åˆ©ç”¨å­˜å‚¨å•å…ƒæ¥å­˜å‚¨é•¿åºåˆ—ä¸­å‰å‡ ä¸ªè¯çš„æ¿€æ´»å€¼ã€‚ç°åœ¨ ***ç›–èŒ¨*** çš„æ¦‚å¿µè¿›å…¥ç”»é¢ã€‚ç½‘å…³ç”¨äºæ§åˆ¶ç½‘ç»œä¸­çš„ä¿¡æ¯æµã€‚é—¨èƒ½å¤Ÿå­¦ä¹ åºåˆ—ä¸­çš„å“ªäº›è¾“å…¥æ˜¯é‡è¦çš„ï¼Œå¹¶å°†å®ƒä»¬çš„ä¿¡æ¯å­˜å‚¨åœ¨å­˜å‚¨å•å…ƒä¸­ã€‚ä»–ä»¬å¯ä»¥ä¼ é€’é•¿åºåˆ—çš„ä¿¡æ¯ï¼Œå¹¶åˆ©ç”¨å®ƒä»¬è¿›è¡Œé¢„æµ‹ã€‚***

## *é—¨æ§å¾ªç¯å•ä½*

*GRU çš„å·¥ä½œæµç¨‹ä¸ RNN ç›¸åŒï¼Œä½†ä¸åŒä¹‹å¤„åœ¨äº GRU åˆ†éƒ¨çš„å†…éƒ¨è¿ä½œã€‚è®©æˆ‘ä»¬çœ‹çœ‹å®ƒçš„æ¶æ„ã€‚*

*![](img/d5e516fd4ba44edd35320d94a9462702.png)*

*GRU åŸºç¡€å»ºç­‘*

*åœ¨ GRU å†…éƒ¨ï¼Œå®ƒæœ‰ä¸¤ä¸ªé—¨ 1)é‡ç½®é—¨ 2)æ›´æ–°é—¨*

*é—¨åªä¸è¿‡æ˜¯ç¥ç»ç½‘ç»œï¼Œæ¯ä¸ªé—¨éƒ½æœ‰è‡ªå·±çš„æƒé‡å’Œåå·®(ä½†ä¸è¦å¿˜è®°ä¸€å±‚ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„æƒé‡å’Œåå·®éƒ½æ˜¯ç›¸åŒçš„)ã€‚*

*![](img/63de82fb91d912826a0a2a190bc927e0.png)*

*GRU çš„é—¨å’Œç»†èƒæ€å…¬å¼*

***æ›´æ–°é—¨***

*æ›´æ–°é—¨å†³å®šæ˜¯å¦åº”è¯¥ç”¨å€™é€‰çŠ¶æ€(å½“å‰æ¿€æ´»å€¼)æ›´æ–°å•å…ƒçŠ¶æ€ã€‚*

***å¤ä½é—¨***

*å¤ä½é—¨ç”¨äºå†³å®šå…ˆå‰çš„å•å…ƒçŠ¶æ€æ˜¯å¦é‡è¦ã€‚æœ‰æ—¶åœ¨ç®€å•çš„ GRU ä¸­ä¸ä½¿ç”¨å¤ä½é—¨ã€‚*

***å€™é€‰å•å…ƒæ ¼***

*å®ƒåªæ˜¯ç®€å•åœ°ä¸ RNN çš„éšè—çŠ¶æ€(æ¿€æ´»)ç›¸åŒã€‚*

***æœ€ç»ˆå•å…ƒçŠ¶æ€***

*æœ€ç»ˆå•å…ƒçŠ¶æ€å–å†³äºæ›´æ–°é—¨ã€‚å®ƒå¯ä»¥ç”¨å€™é€‰çŠ¶æ€æ›´æ–°ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨ã€‚ä»ä¸Šä¸€ä¸ªå•å…ƒæ ¼çŠ¶æ€ä¸­åˆ é™¤ä¸€äº›å†…å®¹ï¼Œå¹¶å†™å…¥ä¸€äº›æ–°çš„å•å…ƒæ ¼å†…å®¹ã€‚*

> *åœ¨ GRU ä¸­ï¼Œæœ€ç»ˆå•å…ƒçŠ¶æ€ä½œä¸ºæ¿€æ´»ç›´æ¥ä¼ é€’åˆ°ä¸‹ä¸€ä¸ªå•å…ƒã€‚*

*åœ¨ GRUï¼Œ*

*   *å¦‚æœé‡ç½®ä¸ºæ¥è¿‘ 0ï¼Œåˆ™å¿½ç•¥å…ˆå‰çš„éšè—çŠ¶æ€(å…è®¸æ¨¡å‹ä¸¢å¼ƒå°†æ¥ä¸ç›¸å…³çš„ä¿¡æ¯)ã€‚*
*   *å¦‚æœ gamma(æ›´æ–°é—¨)æ¥è¿‘ 1ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¸å¤šæ­¥éª¤åœ¨è¯¥å•å…ƒä¸­å¤åˆ¶ä¿¡æ¯ï¼*
*   *ä¼½ç›æ§åˆ¶ç€è¿‡å»çš„çŠ¶æ€ç°åœ¨åº”è¯¥æœ‰å¤šé‡è¦ã€‚*

## *é•¿çŸ­æœŸè®°å¿†*

*ç°åœ¨ä½ çŸ¥é“äº† RNN å’Œ GRUï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ç®€å•åœ°å¿«é€Ÿäº†è§£ä¸€ä¸‹ LSTM æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚LSTMs ä¸ GRU çš„éå¸¸ç›¸ä¼¼ï¼Œå®ƒä»¬ä¹Ÿæ˜¯ä¸ºäº†è§£å†³æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ã€‚é™¤äº† GRUï¼Œè¿™é‡Œè¿˜æœ‰ 2 ä¸ªé—¨ 1)å¿˜è®°é—¨ 2)è¾“å‡ºé—¨ã€‚*

*é¦–å…ˆï¼Œçœ‹çœ‹å®ƒçš„æ¶æ„ã€‚*

*![](img/311f654732f45ffa9edb7902c7e099ef.png)*

*LSTM åŸºç¡€å»ºç­‘*

*ç°åœ¨ï¼Œçœ‹çœ‹å®ƒå†…éƒ¨çš„æ“ä½œã€‚*

*![](img/990dccd6ed85876cf13146d68b922342.png)*

*LSTM çš„é—¨å’Œç»†èƒæ€å…¬å¼*

*ä» GRUï¼Œä½ å·²ç»çŸ¥é“äº†é™¤äº†é—å¿˜é—¨å’Œè¾“å‡ºé—¨ä¹‹å¤–çš„æ‰€æœ‰å…¶ä»–æ“ä½œã€‚*

> *æ‰€æœ‰ 3 ä¸ªé—¨(è¾“å…¥é—¨ã€è¾“å‡ºé—¨ã€é—å¿˜é—¨)éƒ½ä½¿ç”¨ sigmoid ä½œä¸ºæ¿€æ´»å‡½æ•°ï¼Œå› æ­¤æ‰€æœ‰é—¨çš„å€¼éƒ½åœ¨ 0 å’Œ 1 ä¹‹é—´ã€‚*

***å¿˜è®°å¤§é—¨***

*å®ƒæ§åˆ¶ç€ä»ä»¥å‰çš„ç»†èƒçŠ¶æ€ä¸­å“ªäº›è¢«ä¿ç•™ï¼Œå“ªäº›è¢«é—å¿˜ã€‚ç”¨å¤–è¡Œäººçš„è¯æ¥è¯´ï¼Œå®ƒå°†å†³å®šåº”è¯¥ä¿ç•™å¤šå°‘æ¥è‡ªå…ˆå‰çŠ¶æ€çš„ä¿¡æ¯ï¼Œå¹¶å¿˜è®°å‰©ä½™çš„ä¿¡æ¯ã€‚*

***è¾“å‡ºé—¨***

*å®ƒæ§åˆ¶å•å…ƒæ ¼çš„å“ªäº›éƒ¨åˆ†è¾“å‡ºåˆ°éšè—çŠ¶æ€ã€‚å®ƒå°†å†³å®šä¸‹ä¸€ä¸ªéšè—çŠ¶æ€æ˜¯ä»€ä¹ˆã€‚*

*å”·ï¼ç†è®ºåˆ°æ­¤ä¸ºæ­¢ï¼Œç°åœ¨è®©æˆ‘ä»¬å¼€å§‹ç¼–ç ã€‚*

*æˆ‘é‡‡ç”¨èˆªç©ºä¹˜å®¢æ•°æ®é›†ï¼Œå¹¶åœ¨æ•°æ®é›†ä¸Šæä¾›æ‰€æœ‰ 3 ä¸ª(RNNã€GRUã€LSTM)æ¨¡å‹çš„æ€§èƒ½ã€‚*

> *æˆ‘çš„åŠ¨æœºæ˜¯è®©æ‚¨ç†è§£å¹¶çŸ¥é“å¦‚ä½•åœ¨ä»»ä½•æ•°æ®é›†ä¸Šå®ç°è¿™äº›æ¨¡å‹ã€‚ç®€å•æ¥è¯´ï¼Œæˆ‘å¹¶ä¸å…³æ³¨éšè—å±‚çš„ç¥ç»å…ƒæ•°é‡æˆ–ç½‘ç»œçš„å±‚æ•°(æ‚¨å¯ä»¥ç©ç©è¿™äº›æ¥è·å¾—æ›´å¥½çš„å‡†ç¡®æ€§)ã€‚*

***å…³äºæ•°æ®é›†**:*

*è¯¥æ•°æ®é›†æä¾›äº†ç‰¹å®šæœˆä»½ä¹˜åç¾å›½èˆªç©ºå…¬å¸èˆªç­çš„äººæ•°è®°å½•ã€‚å®ƒæœ‰ 142 ä¸ªæœˆçš„è®°å½•ã€‚å®ƒæœ‰ä¸¤åˆ—â€œæœˆâ€å’Œâ€œä¹˜å®¢æ•°é‡â€ã€‚ä½†åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘æƒ³ä½¿ç”¨å•å˜é‡æ•°æ®é›†ã€‚ä»…ä½¿ç”¨â€œä¹˜å®¢æ•°é‡â€ã€‚*

*å¯¼å…¥æ‰€æœ‰å¿…éœ€çš„åº“å’Œæ•°æ®é›†ã€‚*

```
*import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, LSTM,GRU,SimpleRNN
from sklearn.preprocessing import MinMaxScalerdf = pd.read_csv('airline-passengers.csv')
df.head()
df.drop(['Month'],axis=1,inplace=True)
dataset = np.array(df)
dataset.reshape(-1,1)*
```

*ä¸ºäº†å¯è§†åŒ–æ•°æ®é›†ï¼Œ`plt.plot(dataset)`*

*![](img/1d3f1be313858981106fbf6410b2b9b0.png)*

*ä¹˜å®¢æ•°é‡(Y è½´)ä¸æœˆæ•°(X è½´)*

*å®ƒæ˜¾ç¤ºä¹˜å®¢æ•°é‡åœ¨å‡ ä¸ªæœˆå†…å‘ˆçº¿æ€§å¢é•¿ã€‚*

*å¦‚æœæ‰€æœ‰æ•°æ®éƒ½ç»è¿‡ç¼©æ”¾ï¼Œæœºå™¨å­¦ä¹ æ¨¡å‹/ç¥ç»ç½‘ç»œçš„æ•ˆæœä¼šæ›´å¥½ã€‚*

```
*scaler = MinMaxScaler()
dataset = scaler.fit_transform(dataset)*
```

*å°†æ•°æ®åˆ’åˆ†ä¸ºè®­ç»ƒå’Œæµ‹è¯•ã€‚æˆ‘å°†æ•°æ®é›†åˆ†æˆ(75%çš„è®­ç»ƒå’Œ 25%çš„æµ‹è¯•)ã€‚åœ¨æ•°æ®é›†ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ç¬¬**â€˜I-1â€™**ä¸ªå€¼æ¥ä¼°è®¡ç¬¬**â€˜Iâ€™**ä¸ªå€¼ã€‚æ‚¨ä¹Ÿå¯ä»¥é€šè¿‡å– i-1ï¼Œi-2ï¼Œi-3â€¦æ¥å¢åŠ è¾“å…¥åºåˆ—çš„é•¿åº¦ï¼Œä»¥é¢„æµ‹ç¬¬**â€˜Iâ€™**ä¸ªå€¼ã€‚*

```
*train_size = int(len(dataset) * 0.75)
test_size = len(dataset) - train_size
train=dataset[:train_size,:]
test=dataset[train_size:142,:]
def getdata(data,lookback):
    X,Y=[],[]
    for i in range(len(data)-lookback-1):
        X.append(data[i:i+lookback,0])
        Y.append(data[i+lookback,0])
    return np.array(X),np.array(Y).reshape(-1,1)
lookback=1
X_train,y_train=getdata(train,lookback)
X_test,y_test=getdata(test,lookback)
X_train=X_train.reshape(X_train.shape[0],X_train.shape[1],1)
X_test=X_test.reshape(X_test.shape[0],X_test.shape[1],1)*
```

*æˆ‘åˆ¶ä½œäº†åªæœ‰ä¸¤å±‚çš„åºåˆ—æ¨¡å‹ã€‚å›¾å±‚:*

1.  *ç®€å•çš„ RNN/GRU/LSTM*
2.  *è‡´å¯†å±‚*

*åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ç”¨çš„æ˜¯ LSTMã€‚æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–ä¸¤ä¸ªï¼Œåªéœ€å°†ä¸‹é¢ä»£ç (ç¬¬ 2 è¡Œ)ä¸­çš„â€œLSTMâ€æ›¿æ¢ä¸ºâ€œSimpleRNNâ€/â€œGRUâ€ã€‚*

```
*model=Sequential()
model.add(**LSTM**(5,input_shape=(1,lookback)))
model.add(Dense(1))
model.compile(loss='mean_squared_error',optimizer='adam')*
```

*åœ¨ LSTM å±‚ï¼Œæˆ‘ä½¿ç”¨äº† 5 ä¸ªç¥ç»å…ƒï¼Œè¿™æ˜¯ç¥ç»ç½‘ç»œçš„ç¬¬ä¸€å±‚(éšè—å±‚)ï¼Œå› æ­¤ input_shape æ˜¯æˆ‘ä»¬å°†ä¼ é€’çš„è¾“å…¥çš„å½¢çŠ¶ã€‚*

*![](img/c14c787fb1ad41661fd34591dc75514d.png)*

*ç¥ç»ç½‘ç»œæ¦‚è¿°*

*ç°åœ¨ï¼Œæ¨¡å‹å·²ç»å‡†å¤‡å¥½äº†ã€‚æ‰€ä»¥å¼€å§‹è®­ç»ƒæ¨¡å‹å§ã€‚*

```
*model.fit(X_train, y_train, epochs=50, batch_size=1)
y_pred=model.predict(X_test)
y_test=scaler.inverse_transform(y_test)
y_pred=scaler.inverse_transform(y_pred)*
```

*æœ€åï¼Œå¯è§†åŒ–çœŸå®å€¼å’Œé¢„æµ‹ç»“æœã€‚*

```
*plt.figure(figsize=(14,5))
plt.plot(y_test, label = 'Real number of passengers')
plt.plot(y_pred, label = 'Predicted number of passengers')
plt.ylabel('# passengers')
plt.legend()
plt.show()*
```

*![](img/80d42d9603e66ef86db1efc5e9c2d2c8.png)*

*ä¹˜å®¢(Y è½´)ä¸æ ·æœ¬æ•°é‡(X è½´)*

*å¯¹äºæ­¤æ•°æ®é›†å’Œä½¿ç”¨ 50 ä¸ªå†å…ƒçš„ç®€å•ç½‘ç»œï¼Œæˆ‘å¾—åˆ°äº†ä»¥ä¸‹å‡æ–¹è¯¯å·®å€¼ã€‚*

```
*from sklearn.metrics import mean_squared_error
mean_squared_error(y_test,y_pred)*
```

*ç®€å•çš„ RNN:3000
GRU:2584
LSTM:2657*

## ***æ€»ç»“***

*åœ¨äº†è§£äº†è¿™ 3 ä¸ªæ¨¡å‹åï¼Œæˆ‘ä»¬å¯ä»¥è¯´ RNN å¯¹åºåˆ—æ•°æ®è¡¨ç°è‰¯å¥½ï¼Œä½†æœ‰çŸ­æœŸè®°å¿†é—®é¢˜(å¯¹äºé•¿åºåˆ—)ã€‚è¿™å¹¶ä¸æ„å‘³ç€æ€»æ˜¯ä½¿ç”¨ GRU/LSTMã€‚ç®€å• RNN æœ‰å…¶è‡ªèº«çš„ä¼˜åŠ¿(è®­ç»ƒé€Ÿåº¦æ›´å¿«ï¼Œè®¡ç®—æˆæœ¬æ›´ä½)ã€‚*