<html>
<head>
<title>How to build custom dataloader for your own dataset in PyTorch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在PyTorch中为自己的数据集构建自定义数据加载器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-build-custom-dataloader-for-your-own-dataset-ae7fd9a40be6?source=collection_archive---------1-----------------------#2019-08-27">https://medium.com/analytics-vidhya/how-to-build-custom-dataloader-for-your-own-dataset-ae7fd9a40be6?source=collection_archive---------1-----------------------#2019-08-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="846c" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">这篇文章将为你简化数据加载。希望您将学会如何轻松地制作定制的数据加载器，并能够在任何类型的数据集中实现。</h2></div><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es iy"><img src="../Images/ef01448f74760308d9f62979fc9b427f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B7KOAZnUU6ioNnK3YD9UyQ.jpeg"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">图片:<a class="ae jo" href="https://www.google.com/url?sa=i&amp;rct=j&amp;q=&amp;esrc=s&amp;source=images&amp;cd=&amp;ved=2ahUKEwjCq5Ge_KPkAhUnIbcAHQdkAe4QjRx6BAgBEAQ&amp;url=https%3A%2F%2Fslideslive.com%2F38917690%2Fmultitask-learning-in-the-wilderness&amp;psig=AOvVaw0VNdt9Ejig18GAFXnXGxe5&amp;ust=1567026896623996" rel="noopener ugc nofollow" target="_blank">谷歌</a></figcaption></figure><p id="7b42" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">当我第一次开始我的计算机视觉之旅时，自定义数据加载也让我大吃一惊&amp;现在我想起来，这里似乎缺少了一些细节&amp;这可以在理解上产生很大的差异，这显然会反映在代码中。因此，我决定策划一个小帖子来总结我所学到的一切&amp;如果它对你有所帮助，哪怕是最小的帮助，我也会认为这个帖子是一个胜利。</p><p id="abe6" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">那么，让我们开始吧。</p><p id="8b68" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">我将在Pytorch做一个多标签分类。这里使用的数据集来自http://people.duke.edu/~sf59/Chiu_BOE_2014_dataset.htm<a class="ae jo" href="http://people.duke.edu/~sf59/Chiu_BOE_2014_dataset.htm" rel="noopener ugc nofollow" target="_blank"/></p><p id="1e66" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">数据集已被调整为具有以下模式:</p><p id="dcb0" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated"><strong class="jr hj">数据集:</strong></p><ul class=""><li id="101d" class="kl km hi jr b js jt jv jw jy kn kc ko kg kp kk kq kr ks kt bi translated"><strong class="jr hj">训练→图像|标签(1类-2类-3类)</strong></li><li id="12fb" class="kl km hi jr b js ku jv kv jy kw kc kx kg ky kk kq kr ks kt bi translated"><strong class="jr hj">测试→图像|标签(1类-2类-3类)</strong></li></ul><figure class="iz ja jb jc fd jd"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="ac42" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">现在让我们创建自己的定制数据加载器，</p><figure class="iz ja jb jc fd jd"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="a569" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">首先，<strong class="jr hj">我们将加载图像的&amp;标签路径。</strong>然后我们将创建对应于每一类&amp;图像的矩阵，这样我们将有n数组给定形状、顺序和数据类型的0。<br/>因此，因为我有3个类，所以我为标签创建了3个矩阵&amp;我有一组原始图像(即我们的基本事实)，因此我们将为其创建一个矩阵。</p><p id="6ad6" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated"><strong class="jr hj"> <em class="lb">还有，你一定注意到了这些值(61，496，768)，它们是什么意思</em> </strong> <em class="lb">？</em></p><p id="526b" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">→你一定已经猜到496*768是图像的尺寸&amp;我在每个文件夹中都有61张图像。</p><figure class="iz ja jb jc fd jd"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="cd3a" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">现在，我们需要做的就是遍历每张图片并存储它们的文件路径，这样我们以后就可以很容易地访问它们。<br/>所以，这里我有图像的路径&amp;所有3个类的标签路径，正如你可以看到我们的自定义数据集加载器将返回图像，标签1，标签2，标签3</p><p id="dacf" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">imread()将读取图像。图像应位于工作目录中，或者应给出图像的完整路径，如<a class="ae jo" href="https://docs.opencv.org/3.0-beta/doc/py_tutorials/py_gui/py_image_display/py_image_display.html" rel="noopener ugc nofollow" target="_blank">文档</a>中所示。</p><figure class="iz ja jb jc fd jd"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="80fe" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">现在，您可以通过将路径传递给数据集中的train &amp; test集合来加载您的train &amp; test集合。</p><figure class="iz ja jb jc fd jd er es paragraph-image"><div class="er es lc"><img src="../Images/15061f5a5a432480c97f5fd924ed9fac.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*cGefMV1zTmWpX8iUmuqorg.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">我使用这个定制数据加载器创建的模型的最终产品</figcaption></figure><p id="f3bc" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">接下来，您需要做的就是加载您自己的模型或者使用预先训练好的模型&amp;代码训练和测试部分！</p><p id="a45b" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">我希望这篇文章能让你的概念有点清晰&amp;帮助你理解如果提供了自定义数据集，如何加载数据。最后，您可以查看PyTorch数据实用程序文档页面，其中有其他的类和函数可供练习，这是一个很有价值的实用程序库。</p></div></div>    
</body>
</html>