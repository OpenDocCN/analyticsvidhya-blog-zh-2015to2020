<html>
<head>
<title>Decision Tree intuitive explanation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">决策树直观解释</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/decision-tree-intuitive-explanation-7e820b399541?source=collection_archive---------3-----------------------#2019-09-21">https://medium.com/analytics-vidhya/decision-tree-intuitive-explanation-7e820b399541?source=collection_archive---------3-----------------------#2019-09-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="3bf7" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><em class="hi">scikit-learn库中决策树的解释和实现</em></p></blockquote><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es jh"><img src="../Images/98e0e284d3d6662a4974cf3469c407c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*40FbolZhx558x8K4EGVQVg.jpeg"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">感谢托尼·万<a class="jx jy ge" href="https://medium.com/u/2053395ac335?source=post_page-----7e820b399541--------------------------------" rel="noopener" target="_blank"> Unsplash </a></figcaption></figure><p id="630f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated"><strong class="il hj">什么是决策树？</strong></p><p id="9379" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">让我们从一个简单的例子开始</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es kc"><img src="../Images/de51675f22f2152577649cc0bd7ef103.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*hCAgvTiw6tGNiQNWlzbRsQ.png"/></div></figure><p id="d4a3" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">决策树提出一个问题，并根据答案进行分类，如上图所示。它问<strong class="il hj">“你累了吗？”</strong>如果<strong class="il hj">是</strong>则<strong class="il hj">休眠</strong>否则<strong class="il hj">播放</strong>。也可以解释为If-else条件。这些条件可以进一步扩展为</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es kc"><img src="../Images/bdf570435f31892e586accad157e6d24.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*Rr2S_gTp1JGmpg-JLe79lA.png"/></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">如果<strong class="bd kd">“想玩吗？”</strong>然后<strong class="bd kd">蟋蟀</strong>其他的<strong class="bd kd">学习</strong></figcaption></figure><p id="5f8f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated"><strong class="il hj">决策树</strong>是这种算法的一个非常典型的例子，因为这种算法的基本范例是遵循一组<strong class="il hj"> if-else </strong>条件，以便对提供给它的数据产生感觉，并从中学习。</p><p id="eb92" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">顶层节点称为<strong class="il hj">根节点</strong>，其后没有<strong class="il hj">分裂</strong>的节点称为<strong class="il hj">叶节点</strong>。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es kc"><img src="../Images/a73d335b933210a012bda101ba09a1b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*O5IEkefW3_VQ9H-825rwtA.png"/></div></figure><p id="02b3" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">现在让我们举一个不太简单的例子并进行分类。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es ke"><img src="../Images/f4e8eda3d262fa17ec9b45abd2af2008.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*637OMoJPSUP5z8QxZzpu9g.png"/></div></figure><p id="bc44" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">这里给出了14天的数据，根据特征<strong class="il hj">{‘展望’，‘温度’，‘湿度’，‘风’}</strong>我们需要对人是否会打网球进行分类<strong class="il hj">。</strong></p><p id="2aca" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">但是我们如何选择首先分割哪个特征呢？。我们需要<strong class="il hj">最能分离目标({ '打网球' })的特征。</strong></p><p id="c33c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">但是我们如何知道哪个特征最好地分割目标，为此我们引入了一个术语叫做<strong class="il hj">‘杂质’</strong>，杂质衡量特征的同质性。衡量杂质最常用的方法是<strong class="il hj">、【基尼系数】和【基尼熵】。</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es kf"><img src="../Images/66c61fb4bc82e6b6f0b56e35bed3dfba.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*x5W_NTWoNeSTexV2PsFICQ.png"/></div></figure><p id="60f2" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">让我们用基尼指数来计算杂质，假设有一个类似于<strong class="il hj"> {“情绪”} </strong>的特征，如果一个人的情绪很好，他就会不顾其他条件去玩。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es kg"><img src="../Images/873c238982beb7db9cf54a8cb96b89a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:358/format:webp/1*gimRaTUnOZt3ihqueYSWPw.png"/></div></figure><p id="ad37" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">那么这将是最好的分割特征。为什么？</p><p id="4000" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">如果我们在<strong class="il hj">情绪</strong>上分裂，那么对于情绪= <strong class="il hj">【好】</strong>，【打网球】类永远是<strong class="il hj">【是】</strong>，对于情绪= <strong class="il hj">【坏】</strong>，永远是<strong class="il hj">【否】。这变成了一个简单的<strong class="il hj"> If-else </strong>条件。这里我们有14行，每一行我们保留一个类别标签的记录，即'<strong class="il hj">是</strong>或'<strong class="il hj">否</strong>'出现的次数。</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es kh"><img src="../Images/df3024d169ad092f4641fdfb28f7fdba.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*UOdE4hs9wsBBg0rYh8sJgQ.png"/></div></figure><p id="2411" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">我们的理想特征'<strong class="il hj">情绪'</strong>有两个值'<strong class="il hj">好</strong>'和'<strong class="il hj">坏</strong>'，对于每个值，我们拆分<strong class="il hj">“打网球”类</strong>并计算G.I，取它们的<strong class="il hj">加权平均值</strong>以找到最终的G.I，表示为G.I(情绪|打网球)。上述基尼系数公式可以简单地表示为-</p><p id="c728" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated"><strong class="il hj"> G.I=1- prob('是')- prob('否')</strong></p><p id="ab95" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">g1=1-(9/9) -(0/9) = 0，g2 =1-(5/5) -(0/5) = 0</p><p id="9300" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">G.我(心情|打网球)= 9/14 * G1+5/14 * G2 = 9/14 * 0+5/14 * 0 = 0</p><p id="0813" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">因此，我们得到的杂质为0，这是理想的，<strong class="il hj">因此，杂质越低，特征越好地分离目标类。</strong></p><h1 id="87c1" class="ki kj hi bd kd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated"><strong class="ak">现在为了决定根节点，我们为四个特征中的每一个计算G . I-</strong></h1><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es lf"><img src="../Images/1bdf5f422d4ca64969eb73cac15a77e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*ZyxbXfPyfGB2TL0WzD8qug.png"/></div></figure><p id="6fbd" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">g1 = 1- (2/5) - (3/5) = 12/25 = 0.48，</p><p id="8180" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">g2 = 1- (0/4) - (4/4) = 0</p><p id="cefe" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">g3 = 1- (2/5) - (3/5) = 12/25 = 0.48，现在计算g1、g2、g3的<strong class="il hj">加权平均值。</strong></p><p id="1c91" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated"><strong class="il hj"> G.I(展望|打网球)</strong>= 5/14 * G1+4/14 * G2+5/14 * G3 =<strong class="il hj">0.342</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es lg"><img src="../Images/7fd35881239dd1ecd6e65219b0973945.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*k0_ElPleE56wbEocLRx70Q.png"/></div></figure><p id="c30e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">g1 = 1- (3/4) - (1/4) = 0.107</p><p id="8950" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">g2 = 1- (2/6) - (4/6) = 0.190</p><p id="e867" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">g3 = 1- (1/4) - (3/4) = 0.107</p><p id="7db3" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated"><strong class="il hj"> G.I(临时|打网球)</strong>= 4/14 * G1+6/14 * G2+4/14 * G3 =<strong class="il hj">0.404</strong></p><p id="ffbe" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated"><strong class="il hj">同理G.I(湿度|打网球)= 0.367，G.I(风力|打网球)= 0.82。</strong></p><p id="7899" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">在所有的<strong class="il hj">G . I(Outlook |打网球)中最低的</strong>，所以这是我们的<strong class="il hj">根节点。</strong></p><p id="c080" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">我们的树看起来像-</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es lh"><img src="../Images/9d9801f6ba397acc593f9dfa7d2aa0d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*Hfnq_4D3vKBKpAbNBhe8GQ.png"/></div></figure><p id="11b2" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">重新排列行，我们的桌子变成了</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es li"><img src="../Images/5407339230eab954d8c84c871ed75f77.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*6urLkJzXJYlqVS6r7eQ2Yw.png"/></div></figure><p id="1c9e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated"><strong class="il hj">如前所述，我们将计算{ '温度'，'湿度'，'风' } </strong>的G.I</p><p id="0da8" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">打开<strong class="il hj">“温度”</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es lj"><img src="../Images/fc9c944094c288c13f941881785ed1ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*JYRuiPAKRMF4sJQp8yNM1g.png"/></div></figure><p id="bb5d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">g1 = 1- (2/2) =0</p><p id="154a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">g2 = 1- (1/2) - (1/2) = 0.5</p><p id="206c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">g3 = 1- (1) = 0</p><p id="7569" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">现在<strong class="il hj"> G.I(温度|晴)</strong>= 2/5 * G1+2/5 * G2+1/5 * G3 =<strong class="il hj">0.2</strong></p><p id="97a2" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">打开<strong class="il hj">“湿度”</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es lk"><img src="../Images/cda5f7b53fd8ff3dc350a3cc0f7bd1eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*QeoeMgJ9Ho5-A-Hv8qGiJA.png"/></div></figure><p id="3157" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">g1 = 1- (2/2) = 0</p><p id="aff8" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">g2 = 1- (3/3) = 0</p><p id="1fb8" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">G.I <strong class="il hj">(湿度|晴天)</strong> = 2/5*g1 + 3/5*g2 = <strong class="il hj"> 0 </strong></p><p id="1b61" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">同理G.I <strong class="il hj">(风|晴)= 0.466 </strong></p><p id="3786" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">因此选择<strong class="il hj">【湿度】</strong>。</p><p id="1801" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">现在我们的树看起来像</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es ll"><img src="../Images/f33fb8abcc354b46f460c47906e4abf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*0azESy-PYH5IiayV2gsrOA.png"/></div></figure><p id="138c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated"><strong class="il hj">现在，我们将尝试分割“阴天”,以检查我们是否可以减少G.I </strong></p><p id="4550" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">但是我们观察到，每当<strong class="il hj">【展望】</strong>是<strong class="il hj">【阴天】</strong> <strong class="il hj">打网球？</strong>永远是<strong class="il hj">‘是’。这意味着我们不需要进一步分割这个节点。</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ll"><img src="../Images/de2d618cef7e98a003af8a307368e9a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*bzHuSqlr1mNjQ5O4mzN38A.png"/></div></div></figure><p id="be2e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">同样，我们计算-</p><p id="4f11" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated"><strong class="il hj"> G.I(温度|多雨)= 0.466 </strong></p><p id="1d33" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated"><strong class="il hj"> G.I(湿度|多雨)= 0.466 </strong></p><p id="5fbf" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated"><strong class="il hj"> G.I(风|雨)= 0 </strong></p><p id="1657" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">因此我们在<strong class="il hj">‘风’</strong>上分开，我们最后的树是-</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es lm"><img src="../Images/8224d25729184d46ce0429832df2e002.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*kZLswQZLS534-ywsULylIQ.png"/></div></div></figure><h1 id="fdef" class="ki kj hi bd kd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated"><strong class="ak">现在我们将看看如何使用sci-kit学习库在Python中使用决策树进行预测</strong></h1><p id="70b4" class="pw-post-body-paragraph ii ij hi il b im ln io ip iq lo is it jz lp iw ix ka lq ja jb kb lr je jf jg hb bi translated">首先我们加载数据，我已经将上面的表保存为“table.xlsx”。我们用熊猫来装载。</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="ls lt l"/></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es lu"><img src="../Images/d489784dd9c265d0fc50e6ac9e7a1225.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hnxv9KpG_zlt2xF5ylWUgA.png"/></div></div></figure><p id="ea76" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">但是由于我们的数据是分类的，我们不能直接把它输入到DecisionTreeClassifier()中，首先我们需要<strong class="il hj">把分类数据编码成数字数据</strong>。因此，我们应用<strong class="il hj">标签编码</strong>，现在标签编码转换这些数据，因为它为特征中的每个类别分配一个唯一的编号</p><p id="a1f4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">像<strong class="il hj">‘展望’</strong>特征有3个类别<strong class="il hj">{‘晴天’，‘阴天’，‘雨天’}</strong>所以这三个类别将被分配唯一的编号<strong class="il hj"> { 2，1，0} </strong>，<strong class="il hj">这些编号不需要按顺序</strong>。所以我们给我们的数据贴上标签编码-</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="ls lt l"/></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es lv"><img src="../Images/12e84136ea7304b3487acbb2e80d90d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BxCOVwM1p8m2vBjVQFwGmQ.png"/></div></div></figure><p id="e243" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">现在我们可以应用逆变换并验证我们的数据</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="ls lt l"/></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es lw"><img src="../Images/66569ef33879ced57a7f4d8df05eaa5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XGUxxHtvzvW-MMZeIY5MAg.png"/></div></div></figure><p id="1eb3" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">其他编码也可用于不同类型的编码，参见<a class="ae lx" rel="noopener" href="/data-design/visiting-categorical-features-and-encoding-in-decision-trees-53400fa65931">这里的</a>。</p><p id="810a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">我们现在将这些数据分为训练数据和训练目标</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="ls lt l"/></div></figure><p id="b4f0" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">现在我们从sklearn.tree导入决策树分类器</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="ls lt l"/></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ly"><img src="../Images/884e8f1fa56c5dd7c1b9b41a67bd7231.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C-EOFcsfokd-81N8VxUkeQ.png"/></div></div></figure><p id="c93c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">在决策树分类器中，我们可以改变许多参数</p><p id="7813" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated"><strong class="il hj">标准</strong> : <em class="ik">字符串，可选(default="gini") </em></p><p id="dfa5" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">衡量分割质量的函数。支持的标准是<strong class="il hj">“基尼”</strong>用于<strong class="il hj">基尼杂质</strong>和<strong class="il hj">“熵”</strong>用于<strong class="il hj">信息增益</strong>。</p><p id="2ba5" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated"><strong class="il hj"> max_depth </strong> : <em class="ik"> int或None，可选(默认=None) </em></p><p id="4f36" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">树的最大深度。如果没有，则扩展节点，直到所有叶子都是纯的，或者直到所有叶子包含少于min_samples_split样本。<strong class="il hj">最大深度越高，过度拟合的可能性越大。</strong></p><p id="09f9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated"><strong class="il hj">min _ samples _ split</strong>:<em class="ik">int，float，可选(默认值=2) </em></p><p id="f2cd" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">分割内部节点所需的最小样本数:</p><ul class=""><li id="6c5a" class="lz ma hi il b im in iq ir jz mb ka mc kb md jg me mf mg mh bi translated">如果是int，那么把min_samples_split作为最小数。</li><li id="dbfe" class="lz ma hi il b im mi iq mj jz mk ka ml kb mm jg me mf mg mh bi translated">如果是float，那么min_samples_split是一个分数，ceil(min _ samples _ split * n _ samples)是每次拆分的最小样本数。</li></ul><p id="7794" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated"><strong class="il hj">min _ weight _ fraction _ leaf</strong>:<em class="ik">float，可选(默认=0。)</em></p><p id="dfff" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">要求位于叶节点的权重总和(所有输入样本)的最小加权分数。当未提供sample_weight时，样本具有相等的权重。</p><p id="1497" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated"><strong class="il hj"> max_features </strong> : <em class="ik"> int，float，string或None，可选(默认=None) </em></p><p id="773e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">寻找最佳分割时要考虑的特征数量，如果“自动”，那么<strong class="il hj">max _ features = sqrt(n _ features)</strong></p><p id="9cb4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">现在，我们使用刚刚构建的树进行分类</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="ls lt l"/></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es mn"><img src="../Images/43126ef94c6571f0b9b088fe65d82e4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*_iMkrjIuWkHBSzC-QVcS7Q.png"/></div></figure><p id="521e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">0代表“否”, 1代表“是”</p></div><div class="ab cl mo mp gp mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="hb hc hd he hf"><h1 id="f9ed" class="ki kj hi bd kd kk mv km kn ko mw kq kr ks mx ku kv kw my ky kz la mz lc ld le bi translated">predict_proba方法如何作用于决策树</h1><p id="faa4" class="pw-post-body-paragraph ii ij hi il b im ln io ip iq lo is it jz lp iw ix ka lq ja jb kb lr je jf jg hb bi translated">这个方法返回一个形状为<strong class="il hj"> (n_samples，n_classes) </strong>的数组，包含样本属于哪个类的概率值。</p><p id="a4ba" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">这些概率值有助于我们更好地理解模型，它们有助于我们绘制ROC-AUC曲线。</p><p id="871b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">我们现在将看到<a class="ae lx" href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html#sklearn.tree.DecisionTreeClassifier.predict_proba" rel="noopener ugc nofollow" target="_blank"><strong class="il hj"><em class="ik">predict _ proba</em></strong></a>如何在决策树分类器上工作</p><p id="7077" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">首先，让我们将max_depth限制为3，并用sklearn的Graph-Viz可视化树。</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="ls lt l"/></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es na"><img src="../Images/d90bce00f2e18a67c6439ab2cb7fa9fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*qR3SY_WgdOXkhvZj9hGXgQ.png"/></div></figure><p id="0fcf" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">对于每个叶节点，predict_proba计算每个类标签的样本分数，从而返回两列。这里，第一列表示分类标签“否”的概率，第二列表示“是”的概率。因此，我们需要第二列的值。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nb"><img src="../Images/3e872d8ade0b93a5e3f48d07e9084ba4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jZY8vi3B9OSfEE-3e5PXCA.jpeg"/></div></div></figure><p id="29fb" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">进一步的类别概率计算如下-</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nc"><img src="../Images/926165f3865fcca4c15bcd4fc6891413.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y9J50d6BDcT3gVFgjmg-iQ.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">作者- <a class="ae lx" href="https://rpmcruz.github.io/machine%20learning/2018/02/09/probabilities-trees.html" rel="noopener ugc nofollow" target="_blank">里卡多·克鲁兹</a></figcaption></figure><p id="291c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">现在我们用这个公式来计算概率值-</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="ls lt l"/></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es nd"><img src="../Images/21b2d7e571c7d8c93301829f8612dba6.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*iePXYZuzMDyoTyXJGo3aYQ.png"/></div></figure><p id="5b21" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">现在让我们试着预测我们的第一行——其中展望=2，温度=1，湿度= 0，风= 1。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es na"><img src="../Images/b4095133740d636b28a8ff3cef14bb4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*PTciXJYo8kJ8TGnx_Pjd9Q.png"/></div></figure><p id="3f50" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">这里在<strong class="il hj">根节点</strong>我们一共拆分了14个点，<strong class="il hj">【5，9】</strong>代表总训练点数，<strong class="il hj"> 5 </strong>有目标标签<strong class="il hj">【0】(【打网球】=否)</strong>和<strong class="il hj"> 9 </strong>有标签<strong class="il hj">【1】(【打网球】=是)</strong></p><p id="4658" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">类似地，我们看到，在这个叶节点中，所有值都属于<strong class="il hj">相同的类，即“0”</strong>，因此类为<strong class="il hj">“0”的概率是1，而为“1”的概率是0。</strong></p><p id="442f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">类似地，如果我们试图计算第四点的概率值，其中<strong class="il hj">前景=1，温度=2，湿度= 0，风= 1。</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es na"><img src="../Images/5b6033fb225723fb3b9baec3e7cc9b2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*QsnF81wQgY5kADFRx9__WQ.png"/></div></figure><p id="28c4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated">这里，在这个叶节点中有两个值，一个属于<strong class="il hj">类“0”</strong>，另一个属于<strong class="il hj">“1”</strong>。现在，属于“0”的<strong class="il hj">类的概率是1/(1+1) = 0.5，属于“1”的类的概率是1/(1+1) = 0.5。类似地，我们可以计算所有点的概率值。</strong></p><p id="38a7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated"><strong class="il hj">参考文献</strong></p><ul class=""><li id="c40f" class="lz ma hi il b im in iq ir jz mb ka mc kb md jg me mf mg mh bi translated"><a class="ae lx" href="https://www.appliedaicourse.com/lecture/11/applied-machine-learning-online-course/3075/regression-using-decision-trees/4/module-4-machine-learning-ii-supervised-learning-models" rel="noopener ugc nofollow" target="_blank">应用人工智能课程</a></li><li id="8844" class="lz ma hi il b im mi iq mj jz mk ka ml kb mm jg me mf mg mh bi translated">《StatQuest:决策树》作者:乔希·斯塔默</li></ul><p id="da38" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jz iv iw ix ka iz ja jb kb jd je jf jg hb bi translated"><em class="ik">感谢阅读，如果您需要代码或数据，请访问我的github。</em></p></div></div>    
</body>
</html>