# 减少登革热的危险:使用机器学习对新加坡历史登革热和气候数据预测未来登革热的爆发

> 原文：<https://medium.com/analytics-vidhya/diminishing-the-dengue-danger-predicting-future-dengue-outbreaks-using-machine-learning-on-b4dc560219b8?source=collection_archive---------21----------------------->

![](img/c814d5ce6801aa99dce84311b388f75a.png)

伊蚊照片来自[https://www . shape . com . SG/health/warning-over-10000-登革热-病例-报告-新加坡-年份/](https://www.shape.com.sg/health/warning-over-10000-dengue-cases-reported-singapore-year/)

# 介绍

登革热已被世界卫生组织(世卫组织)确定为全球最严重的蚊媒疾病。在过去几十年中，全球登革热发病率增长了 30 倍。生活在热带和亚热带气候的人最容易感染登革热，这是世界上一半人口面临的风险。有四种类型的登革热病毒血清型(或“毒株”)，因此一个人最多可被登革热病毒感染四次。由于没有与登革热相关的特殊治疗，早期检测以防止携带病毒的 T2 伊蚊的繁殖是减少登革热暴发的最有效方法。

自从登革热疫情在近十年前袭击新加坡以来，由国家环境局(NEA)发起的“五步消灭蚊子”运动已为每个新加坡居民所知。事实上，登革热疫情和登革热病例激增在新加坡时有报道，特别是考虑到我们的赤道气候非常有利于蚊子的繁殖。还有对死水的被动监测，死水是这些致命害虫的潜在滋生地。登革热在 2005 年成为新加坡的焦点，并成为日常话题，当时共有超过 14，000 例登革热病例。由于登革热患者的大量涌入，这造成了医院床位的短缺。自那以来，登革热病毒一直是一个持续的公共问题，2019 年报告的病例超过 16，000 例。

![](img/92a052d39abfc650ebd88bd1e79d867d.png)

图一。按年份分列的每周病例数趋势(2015 年至 2019 年)

# 目标

我们项目的目标是基于(1)新加坡不同地点的降雨量和(2)温度测量值，(3)人口增长和(4)时间序列效应来预测登革热病例数。我们的模型将预测未来八周内每周的登革热病例数。我们认为，预测每周结果比预测每日结果更为理想，这样可以减少结果值的变化，因为我们还可以获得每周的登革热病例数。它还将大大降低机器学习所需的计算能力，从而节省时间。使用决策树和神经网络，我们的目标是产生一个强大的预测模型，预测未来八周内即将发生的登革热病例数。

# 我们的数据集

由于新加坡各部委能够收集重要的相关数据，我们能够利用大量的高质量数据来完成这个项目。在新加坡，所有医疗从业人员和临床实验室必须在诊断后 24 小时内向卫生部(MOH)报告所有临床疑似和实验室确认的登革热病例(根据《传染病法》第 7 节)。

我们的完整数据集由 2011 年 8 月 13 日至 2019 年 11 月 23 日(433 周)的每周面板数据组成。我们挑选了以下特征作为确定登革热病例预测的重要变量——新加坡不同地点的每周降雨量(50 个地点)和温度(15 个地点)数据以及新加坡的年度人口。人口数据被插值到一年中的个别周，以便于与其他周数据一起处理。

我们想要预测的因变量是未来 8 周内每周的登革热病例数。

使用这些数据的基本原理如下:

1.  天气数据(即降雨量和温度):这些是影响*伊蚊* *埃及伊蚊*和*伊蚊* *白纹伊蚊*繁殖的因素，因此与有人感染登革热的风险有关。高温为蚊子的繁殖提供了一个有利的环境，也导致了蚊子更具攻击性的进食行为。相反，高降雨量导致积水的可能性更大，这些积水可能不受控制，例如在私人住宅的屋顶，这为蚊子的繁殖创造了完美的条件。
2.  我们还纳入了新加坡的人口趋势，以调查人口规模的变化是否会导致这些年来登革热病例数量的显著变化。我们希望能够解释这些年来由于人口增长而导致的登革热病例增加的部分。

![](img/f921b6a4dfd65ecde0a111d6d2c42482.png)

图二。不同住户类型的登革热趋势(2004 年至 2016 年)

![](img/562c218f87e2eafc552dacb8940b8e9d.png)

图 3。原始数据包括每周登革热病例、人口(线性插值)以及新加坡各气象站的降雨量和温度

# 数据预处理方法

***处理高度相关的数据***

![](img/c0f17924fe42379165fa11e401f43f17.png)

图 4。雨量站相关矩阵

查看上面图 4 中的相关图，我们观察到许多雨量站和温度站彼此高度相关。这是有道理的，考虑到新加坡的陆地面积小，应该使该岛的大部分地区在大气上是同质的。基于地理位置，相关结果是符合逻辑的，正如预期的那样，因为像 Dhoby Ghaut 和 Somerset(都位于新加坡南部地区)这样的位置具有非常相似的降雨趋势。值得注意的是，在原始数据集中(可追溯到 2000 年)有很大比例的降雨量或温度数据缺失。这就是为什么我们将我们正在使用的数据范围缩小到八年。然后，我们在这 8 年的范围内，根据相关方法替换掉缺失的降雨量或温度值。

***特征提取创建树状图聚类***

鉴于温度和降雨特征之间的高度相关性，我们希望减少温度和降雨特征的数量。然而，我们仍然希望保留我们的模型解释登革热病例变异性的能力。因此，我们通过特征提取进行降维，以处理高度相关的特征并防止过度拟合。

我们建立了两个树状图，分别代表每周降雨量和温度。树状图基于两个位置之间的成对相关距离(1 减相关)。从这些结果中，我们得到了 **11 个降雨簇和 4 个温度簇**来代表新加坡不同地区的降雨和温度趋势。

![](img/d54eded6097d18e2cfefbada5ca201c7.png)

图 5。温度簇的树状图

![](img/86859021f7543605982bc52cbec2a255.png)

图 6。降雨簇的树状图

***处理缺失数据***

数据集中有几处缺失数据。对于某些气象站，数据集中没有长时间的降雨和温度数据。考虑到降雨的局部性，我们使用最近气象站(同一聚类内)的**降雨量值来估算降雨量。我们认为，与用其他统计数据(如各雨量站 8 年的平均降雨量)代替缺失值相比，这样做可以更准确地反映降雨量/温度趋势。**

***特征雨量、温度等值的归一化***

为了确定 11 个降雨组和 4 个温度组的每周温度或降雨量，我们取每个组内所有温度或降雨量值的平均值。对聚类内所有站点的每周数据进行平均，生成每周温度和降雨量的聚类平均值。为了说明这一点，哈提卜和森巴旺气象站的温度形成了第三组。因此，聚类 3 的周温度将是这两个站的平均周温度。

然后，我们将数据集分为训练集(从 2011 年 8 月 13 日到 2018 年 3 月 17 日)和测试集(从 2018 年 3 月 24 日到 2019 年 11 月 23 日)。然后，我们在训练集中对每个温度或降雨量聚类的值进行标准化。用于归一化训练集的中值和范围也用于归一化测试集值。使用的公式如下所述。

![](img/3c7ca6affd75c045bc97b8949a6e9b14.png)

我们对聚类值进行了标准化，以最小化所用值的大小，这将加快神经网络的学习速度，并防止在运行神经网络时由于数字过大而出现任何错误。

***特征选择***

对于特征的初步选择，我们使用了利用 XGBoost 算法的回归树。我们从一组初始变量开始特征选择，这些变量包括:

*   T+8 时(即未来八周)的登革热水平
*   T+0 时的登革热水平(即当周= 0 时)
*   从时段 T-3(即过去三周)到 T+0，每个降雨群的最大值和平均值
*   从时段 T-12 到 T-4 的每个温度群的最小值

使用从 T-3 到 T+0 期间的每个降雨群的平均值背后的想法是，这三周的降雨量可以预测未来八周的登革热爆发。这个范围(T-3 到 T+0)是在考虑了*伊蚊*的生命周期和登革热病毒的潜伏期(病毒在人类身上引起症状所需的时间)后选择的。在与水接触后，蚊子卵大约需要三周时间才能长成一只成年蚊子，导致受感染的人出现症状。重要的是，伊蚊数量的这一初始峰值可能会导致在八周的预测窗口内产卵量呈指数增长，这将有助于预测登革热病例的峰值。

至于温度聚类，选择 T-12 到 T-4 期间每个温度聚类的最小值，因为我们从理论上认为过去 12 周的最低温度可以预测 8 周后的更高温度。这也是因为疫情通常发生在 6 月至 10 月期间，6 月通常是一年中最热的月份。我们希望预测温度的上升，因为它会导致病毒在蚊子体内的复制时间缩短，即减少蚊子感染人类的时间。蚊子更具攻击性的进食行为进一步加剧了这种情况，增加了受感染蚊子感染人类的可能性。总之，在疾病爆发期间较高的温度*是一个重要的预测因素。我们很想看得更远一点(即 T-15)，但由于担心严重缺乏试验数据，我们不能这样做。*

# 模型结构

***使用回归树的初始发现***

我们首先在初始变量集上运行回归树参数的优化。我们使用回归树进行特征提取，只是因为它速度很快。最适合我们数据的参数如下。使用这些优化值，我们开始减少聚类的数量，以便在我们继续使用神经网络时将维数灾难降至最低。聚类的减少如下进行:

1.  使用初始结果(使用所有温度和降雨量聚类)作为基准。要注意的结果是均方误差(MSE)、训练预测、测试预测和滞后相关性。
2.  移除属于最小降雨量组的变量，该组位于新加坡的最末端，例如组 1 和组 2。
3.  看一下比较的基准。如果它们表现相同，或者模型在没有移除变量的情况下表现更好，那么它们将从后续要测试的模型中移除。这是为了创建一个尽可能小的模型。如果情况比之前的结果更糟，那么该集群将被重新添加到模型中。
4.  如果有一轮没有完成(即测试损失线没有穿过培训损失线)，则增加回合数
5.  这是迭代执行的，并且使用相同的方法来选择有用的温度聚类。
6.  最后一组变量的任何变化都被添加到模型中进行测试。像以前一样，如果结果与之前测试的模型相同或更差，则变量被移除。

基于我们的初始变量集的回归树的最佳参数如下:[轮数= 20；树的最大深度= 1250；学习率= 0.1；平行树的数量= 10；子采样= 0.1，按树进行列采样= 1]。然后我们发现我们的最佳参数是:

*T-4 至 T-1、T-8 至 T-5 的平均登革热水平& T-9 至 T-12
T-4 至 T-1 的平均区分登革热值& T-9 至 T-12
T+0
人口水平最大值和 T-3 至 T+0 的平均值降雨群 2、4、5、6、7、8、9、10 和 11
T-7 至 T-4 的平均值和最小值& T*

我们的回归树模型的结果(平方误差为 0.12095 *)* 如下所示:

![](img/44ded132609df5913012b68660017a93.png)![](img/2dba1e561f91e16effd3fcb89410a406.png)![](img/400e07fb222b28321a4266969849aa5b.png)

***深度学习模型构建***

深度学习模型使用的指标类似于回归树模型中使用的指标。在这一点上，提到我们决定不使用验证集是有用的，因为我们的数据集中数据点的数量很少。相反，我们将仅依靠欧几里德损失以及测试预测图来确定我们的模型是否表现良好。此外，当我们查看 2017-2018 年的登革热水平时，它基本持平。因此，我们认为即使我们做了一个验证集，它也会包含大部分的值。这可能会给我们一个错误的印象，即我们的模型实际上做得有多好，因为 2019 年的登革热水平开始波动，甚至达到峰值。*重要的是，我们可能已经优化了模型以适应没有峰值(对应于爆发)的验证集*。考虑到时间，我们决定只进行欧几里德损失和测试预测。当然，我们也考虑到了滞后。

我们的模型性能基准是持久性损失，在我们的测试数据集中计算为 0.015698。使用测试集登革热值计算得分。这是我们 Excel 中的一列，作为 T+0 值。在相邻的一栏中，我们复制并粘贴了从 T+8 开始的登革热数值。这一列作为我们的 T+8 值。T+0 和 T+8 柱的突出端被截断。之后，我们计算新列中两列的平方差。在一个单独的单元中，我们对所有平方差的和进行平均，并将该平均值除以 2，以获得持续性损失。

# 深度学习方法论

然后，我们将注意力转移到神经网络，从回归树阶段获得最后一组特征。也许神经网络对更复杂模式的泛化能力会让我们做出更准确的预测。

我们对一个简单的三层神经网络进行了初步测试，该网络只有 3 种配置:16、32 或 64 个节点。这是考虑到时间的因素。我们使用 Adam 优化器对每个配置运行 10，000 次迭代。整个过程重复 5 次，以确保初始权重不会导致过度偏差或过度优化的结果。我们的训练标签是 T+8 的登革热水平。

最好的结果是:

*测试损失:0.0060406
输入个数:36
迭代次数:10000
优化算法:亚当
最顶层感知器个数:128
神经网络层数:3*

![](img/5b136ec34a860c4a486bc4df898ff9aa.png)![](img/bdcb6faef04ecc3ed44c39f9362ea9b6.png)![](img/b26f5e651db8fa3a21a42cc824aea4ef.png)

结果还不错，但我们想要更好的。此外，在真正的峰值之后，预测中出现了第二个峰值，这是登革热水平的一个错误峰值。我们希望尽可能地消除或最小化这种错误的尖峰。

通过我们对神经网络的第二轮优化，我们试验了具有 3、4 或 5 层的更大的神经网络。从那里，我们还发现一个参数显著改善了我们的结果，这就是登革热等级 T-4 到 T-1 的第二个差分顺序*。因此，我们的最终参数集是:*

*平均 T-4 到 T-1，T-8 到 T-5 & T-9 到 T-12 的登革热水平
平均 T-4 到 T-1 的登革热水平的一阶微分值& T-9 到 T-12 的登革热水平的二阶微分值
平均 T-4 到 T-1 的登革热水平的二阶微分值
T+0 的人口水平
T-3 到 T+0 的最大值和平均值对于降雨群 2、4、5、6、6*

我们还将这些结果与使用更大的 6、7 和 8 层神经网络的结果进行了比较。在较大的神经网络中测试的节点大小是相同的，即 32、64 和 128。我们还尝试使用 SGD 优化器代替 Adam 优化器。然而，更简单的神经网络和亚当优化器仍然是最好的。我们进行了 20 次重复的最终分析，以获得最佳结果，如下所示:

*测试损失:* 0.00453716
*神经网络层数:4
最顶层感知器数:64
输入数:37
迭代次数:10000
优化算法:Adam*

![](img/5259b21e5bec25a9bbe150967162c8af.png)![](img/b5f7c09cdfc6513f1a00ffb4b3ab304f.png)![](img/750badd22de546d78d4f892774b94733.png)![](img/8ec6c75a5aa500812845e8cfc1b4a4b3.png)![](img/077f06d0ac255ebe69ed61fb1293a1d4.png)

通过获得 0.00453716 的*损失分数，我们的模型超过持久性大约 0.01，这是持久性损失的三分之一。*

从我们的训练预测曲线来看，似乎我们当前的变量集不允许模型估计该数据集中存在的峰值。这被视为训练似乎在较低的登革热水平上发生得相当好，但是当实际登革热水平达到峰值时，我们的模型总是不能预测较高的登革热水平。这表明我们的模型中缺乏信息。转到测试预测曲线，该曲线实际上拟合得相当好。对于低登革热水平，预测值与实际值相差不太远，并且登革热病例的峰值被合理地预测为滞后 0(这太棒了！).尽管我们的预测未能预测到比登革热病例实际值更多的登革热病例，这将是有利的，但它仍然能够预测登革热病例的高峰。初始峰值之后出现的第二个较小的峰值也应考虑在内。我们认为可能会有第二个高峰，但由于 NEA 在此期间进行了更多的干预，例如增加雾化，所以没有出现，尽管这只是一个理论。

# 使用我们模型的潜在风险

如果对我们的模型结果有一个警告，我们相信我们的模型不太能够过度预测(这是我们想要实现的)。使用这种模式的组织应自行决定将这种趋势通知相应的医疗保健专业人员，并建议他们预测更多的病例。此外，由于测试集中的登革热峰值预测值低于实际值，我们无法确定我们的模型是否能够准确预测极端疫情爆发时的登革热水平。也许我们的模型可以预测登革热病例的阈值，但我们需要更多的数据来确定这种阈值是否存在。

此外，鉴于该模型是基于新加坡的数据开发的，当用于与新加坡特征相似的地区时，谨慎的做法是相信该模型的准确性。应该考虑的一些特征是:新加坡的面积(751.2 平方公里)不可避免地影响降雨和温度模式、人口密度以及时空移动模式。

# 结论和评论

总的来说，我们认为我们做得很好，达到测试分数低、预测模式可接受和滞后模式可接受的最佳状态并不容易。仅使用四个变量的不同变化也获得了良好的模型分数:登革热水平、新加坡人口水平、温度和降雨量。

在不负面改变结果的情况下找到相关变量是很困难的。我们试图结合谷歌搜索“登革热”的趋势来观察它是否是一个重要的预测变量，但结果是混合的。此外，谷歌搜索趋势和疫情本身之间的相关性和因果关系没有得到广泛研究，因此我们最终决定放弃。

我们还认为，通过加入更多变量(由于网上可用数据有限，我们无法做到这一点)，进一步调整模型组件，可以进一步改进该模型。对神经网络结构的变化进行更多的实验，以及为训练阶段提供更多的数据，也有助于改进模型。

然而，我们已经开发了一种神经网络模型，能够相当准确地预测登革热水平。展望未来，我们相信可以利用更高质量的数据创建更好的登革热预测模型，例如登革热血清型、*伊蚊*种群水平等。—这有助于解释登革热水平的差异。额外的数据可能会增强我们的模型和当前的一组变量，我们建议这些变量在预测登革热暴发中是有用的。

*作者:贝妮塔，克拉伦斯，理查德，文浩，玉子*