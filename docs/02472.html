<html>
<head>
<title>Extract Transform Load (ETL) for Books to Scrape</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">提取转换负载(ETL)以供图书抓取</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/extract-transform-load-etl-for-books-to-scrape-b0ff5f83095d?source=collection_archive---------6-----------------------#2019-12-18">https://medium.com/analytics-vidhya/extract-transform-load-etl-for-books-to-scrape-b0ff5f83095d?source=collection_archive---------6-----------------------#2019-12-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="3103" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用Python库从网站上抓取图书信息。</p><h1 id="ec26" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">使用Python进行Web抓取</h1><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/f15483ae1bea067508247b3d2a765379.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V9ekUE14xEowkH9mGhqBFQ.png"/></div></div></figure></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h1 id="55a7" class="jd je hi bd jf jg ku ji jj jk kv jm jn jo kw jq jr js kx ju jv jw ky jy jz ka bi translated">什么是网页抓取？</h1><p id="96f9" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">网络抓取是从网站提取数据的过程。所有的工作都是由一段叫做“刮刀”的代码来完成的。首先，它向特定网站发送“GET”查询。然后，它根据收到的结果解析HTML文档。完成后，scraper会在文档中搜索您需要的数据，并最终将其转换为指定的格式。</p></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h1 id="808c" class="jd je hi bd jf jg ku ji jj jk kv jm jn jo kw jq jr js kx ju jv jw ky jy jz ka bi translated">什么是ETL？</h1><p id="17c9" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">ETL是当今数据驱动营销的基础，即使它是一个你不太听说的缩写。它本质上将分析部分与之前的所有东西分开。</p><p id="911a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它代表提取、转换和加载，本质上描述了一个三步过程。</p></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h2 id="91a1" class="le je hi bd jf lf lg lh jj li lj lk jn iq ll lm jr iu ln lo jv iy lp lq jz lr bi translated"><strong class="ak">提取</strong></h2><p id="48f8" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">提取数据是指从特定来源获取数据，并以收集所有相关数据的方式进行。为了ETL能够很好地工作，数据需要直接来自源，并且是以最原始的形式。</p><p id="7cf1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本教程使用的网站是Books to scrap(【http://books.toscrape.com/】T2)。这是一个合法进行网络抓取的网站。</p><p id="7a72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们开始收集数据之前，我们需要确定哪些数据需要收集。网站上提供了以下信息:</p><ul class=""><li id="f39f" class="lt lu hi ih b ii ij im in iq lv iu lw iy lx jc ly lz ma mb bi translated">书名</li><li id="cb7f" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated">价格</li><li id="b46d" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated">有效性</li><li id="175b" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated">图像</li><li id="1b59" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated">种类</li><li id="9715" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated">等级</li></ul><p id="cc18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们仅采用选定的信息来执行收集过程，这些信息包括:</p><ul class=""><li id="2ea7" class="lt lu hi ih b ii ij im in iq lv iu lw iy lx jc ly lz ma mb bi translated">书名</li><li id="82f5" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated">价格</li><li id="1221" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated">有效性</li><li id="dfb2" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated">种类</li><li id="1f8f" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated">等级</li></ul></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><p id="e735" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">在主页上查找图书网址。</strong></p><p id="114a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一步:获取主页的内容</p><p id="92c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第二步:在主页上找到图书的网址</p><p id="7226" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第3步:通过添加其他子标签在树中更深入地挖掘</p><p id="8fc1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤4:通过相加得到“href”值。get("href ' ')到上一步</p><p id="c5f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤5:使用findAll()函数一次性收集主网页上所有产品的URL。</p><p id="6aaa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">在主页上查找图书类别的网址。</strong></p><p id="cd11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">尝试检索不同产品类别对应的URL:</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es mh"><img src="../Images/24de5cfa2e05464ee669b4add64feb83.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/format:webp/1*I8yTvxYn99oMjb-FQ_Spnw.png"/></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">检查HTML代码</figcaption></figure><p id="ba32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过检查，我们可以看到HTML代码遵循相同的URL模式，即“目录/类别/书籍”。</p><p id="228a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以使用BeautifulSoup来匹配包含此模式的URL，以便更容易地检索类别URL。</p><p id="05b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">刮去所有书籍数据</strong></p><p id="368e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们知道如何在给定的页面中找到书籍的链接。如果所有的书都显示在同一页上，就很容易进行刮擦。然而，这个网站在多个页面上展示产品。我们可以在主页的底部看到，有50个产品页面和一个按钮“下一步”进入下一页。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mm"><img src="../Images/a9de38f407534ae89d0d47f2eea1fdd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z0M4bkbicdHhm-IqZi3tTA.png"/></div></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">主页的结尾</figcaption></figure><p id="06ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在接下来的页面上，还有一个“上一页”按钮，可以返回到上一个产品页面。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mn"><img src="../Images/083d5f24ad74ea6765c334e0e74829fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YuaUqyIq2ITNSj5WcZftIw.jpeg"/></div></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">第二页结束</figcaption></figure><p id="3d7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">获取所有页面的网址</strong></p><p id="3907" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了获取所有产品的网址，我们需要能够通过所有的网页。为此，我们可以反复查看所有“下一步”按钮。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es mo"><img src="../Images/596f4f5ad813435dd3058f601424706b.png" data-original-src="https://miro.medium.com/v2/resize:fit:566/format:webp/1*PaUYzkLE7o_BQl5cSKhIvg.png"/></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">检查HTML代码</figcaption></figure><p id="397a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们在匹配“页面”时有两个结果，我们应该采用第二个结果，因为它将对应于下一页。对于第一页和最后一页，我们将只有一个结果，因为我们将有“下一页”按钮或“上一页”按钮。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es mp"><img src="../Images/897c4fbe612bd1e54f9c7707bd296e75.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*szPS-eexJoocFDYy9dH9dA.jpeg"/></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">成功管理的URL的一些例子</figcaption></figure><p id="936d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们成功地获得了50页的网址。有趣的是，这些页面的URL是高度可预测的。我们可以通过将“page-X.html”递增到50来创建这个列表。</p><p id="88e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个解决方案在这个例子中是可行的，但是如果页面数量发生变化(例如，如果网站决定在每页上打印更多的产品，或者如果目录发生变化)，这个解决方案就不再可行了。</p><p id="c3b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一种解决方案是增加这个值，直到我们得到一个404页面。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es mq"><img src="../Images/091d8ea5834d7dfa6af5b72d03edb321.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*KtxCTWn9IiP6WEO8VvM6jQ.png"/></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">显示404错误页面的页面</figcaption></figure><p id="a4c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们可以看到，试图转到第51页实际上会导致404错误。</p><p id="257c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">幸运的是，请求的结果有一个非常有用的属性，可以向我们显示HTML请求的返回状态。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es mr"><img src="../Images/98fdd232e2be0273541403a774bf90eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:490/format:webp/1*v9Rb8bdFWJjlHdQ4TRkwqA.jpeg"/></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">状态代码的示例</figcaption></figure><p id="0faa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">代码200表示没有错误。404代码告诉我们没有找到该页面。</p><p id="7634" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以使用这些信息来获取所有页面的URL:我们应该迭代直到得到404代码。</p><p id="d1be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们试试这个方法:</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ms"><img src="../Images/9ea0de87d5d3928ed82572c528b64390.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*XMGNGUdfTM5G5LWXy_RICg.jpeg"/></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">使用另一种方法成功管理的URL的一些示例</figcaption></figure><p id="09b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们设法使用这个更简单的方法获得相同的URL。</p><p id="1c9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">获取所有产品的网址</strong></p><p id="b17c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，下一步是获取每个页面的所有产品URL。这一步非常简单，因为我们已经有了所有页面的列表和从页面获取产品URL的功能。</p><p id="a4db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们遍历页面并应用我们的函数:</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es mt"><img src="../Images/cb16a07d4e68c5a6f216328bef79915a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*b7uC9JCuRSjE9yVvv8Gf4g.jpeg"/></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">产品URL的一些例子</figcaption></figure><p id="f270" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们终于得到了1000本书的网址。这对应于网站上显示的号码。</p><p id="fee6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">获取产品数据</strong></p><p id="1ea7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后一步是收集每个产品的数据。让我们先来看看产品页面上的信息是如何组织的:</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mu"><img src="../Images/e0d5ffe80820be28b22a8310927e8ab0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0tp-4ZN1cMmL0vQS7HTJLQ.png"/></div></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">产品页面</figcaption></figure><p id="5446" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以很容易地检索到每本书的大量信息:</p><ul class=""><li id="e797" class="lt lu hi ih b ii ij im in iq lv iu lw iy lx jc ly lz ma mb bi translated">书名</li><li id="620b" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated">价格</li><li id="5fa5" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated">种类</li><li id="83a9" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated">等级</li><li id="1403" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated">有效性</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mv"><img src="../Images/6aee98d21face3703055960762498620.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NWPqBV2g-DCYjBBrIur6gg.jpeg"/></div></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">结果数据框架</figcaption></figure></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h2 id="c928" class="le je hi bd jf lf lg lh jj li lj lk jn iq ll lm jr iu ln lo jv iy lp lq jz lr bi translated"><strong class="ak">变换</strong></h2><p id="455d" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">转换数据需要剥离数据的各种格式，进行清理和协调。换句话说，它需要变得易于最终用户阅读。在此过程中，确保尽可能高的数据质量至关重要，包括检测和删除重复数据，并将数据分类到相关的预定类别中。</p><p id="efb4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">书名</strong></p><p id="0802" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于书名信息，我们抓取产品名称的数据，并存储在带有命名名称的列表中。本节中应用的数据处理是将书名改为大写。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mw"><img src="../Images/dd790e7df004413016f91f092101b731.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bXxC3tdXpaSnn9S3aToTnQ.jpeg"/></div></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">书名的数据框架</figcaption></figure><p id="fb6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">价格</strong></p><p id="2cc2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">而对于价格，我们抓取价格并将数据存储在价格中。在列表中，我们只能存储字符串的数据类型，这意味着我们可以在列表中进行计算。我们已经将prices中的数据类型从string改为float，并将其存储在名为new_price_list的新列表中。创建了一个名为currency的列表，它是new_price_list列表的副本，以便我们可以进行计算。本节中应用的将英镑( )转换为马来西亚林吉特(RM)的数据处理过程。数据将存储在currency_RM列表中。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es mx"><img src="../Images/1dd33ebcb4fd1dafe40e201c38a3fcfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/1*IYnkSXICd3w9KD8kSqEv7w.jpeg"/></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">价格数据框架</figcaption></figure><p id="2a71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">产品类别</strong></p><p id="548d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于产品类别的信息，我们将其抓取并存储在名为categories的列表中。我们发现产品类别已经重复。在这一部分，我们通过删除重复的产品类别并将其存储在名为new_categories的列表中来进行数据处理。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es my"><img src="../Images/7943ab111041656a4121f1dcd8a8ee81.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*lzlwmif065OIa36D8Bz0hg.jpeg"/></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">没有重复的数据框架产品类别的一些示例</figcaption></figure><p id="b871" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还应用了另一种数据处理方法，即删除产品类别中的数字，并按字母顺序存储列表。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es mz"><img src="../Images/8a7695a72d66f1276d87c3f220b71225.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*_xGzimuONdCdgv1t3TKBvg.jpeg"/></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">无重复的数据框架排序产品类别的一些示例</figcaption></figure><p id="b21c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">评级</strong></p><p id="845d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在rating部分，我们抓取数据并存储在名为ratings的列表中。评级列表将数据类型更改为字符串，并将数据保存在名为string_ratings的列表中。number_ratings列表是通过copy()方法创建的。创建一个名为new_number_ratings的列表，将评级转换为数值。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es na"><img src="../Images/6ec4cfa18f34eb38e86acd961170ae39.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*Wdk8TF5F_ijfWzdr22EtQQ.jpeg"/></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">按数字排列的评级数据框架</figcaption></figure><p id="b3b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">可用库存</strong></p><p id="e811" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于可用的库存信息，我们抓取数据并存储在名为nb_in_stock的列表中。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es nb"><img src="../Images/2b9a316bb7ae1cf0b7690130fc6992b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*GKSkP7po6RyxuibWXUNnTA.jpeg"/></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">数据框库存可用，带编号</figcaption></figure><p id="8491" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将数据类型从string更改为int，并将其存储在一个名为new_stock的新列表中。使用copy()方法创建了一个名为stock_ava的列表，以便于数据处理。</p><p id="1d30" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建一个名为stock_available的列表来存储库存可用性数据。本节中应用的数据处理是，如果可用库存数量大于1，它将显示“可用库存”。如果可用库存数量等于1，将显示“最后一个库存”。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es nc"><img src="../Images/a8a5a7d1fb64741d1ee8ee161f60351a.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/format:webp/1*ZlLuiDfiwvrFnZ-FiupxGQ.jpeg"/></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">数据框库存可用性</figcaption></figure><p id="06e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">使用饼图</strong>进行库存可用性的数据可视化</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es nd"><img src="../Images/9eeb885871825bb73ab6c698adf2c9be.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*Y0NiO3gihjHrFQHAAKlHcA.jpeg"/></div></figure></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h2 id="962d" class="le je hi bd jf lf lg lh jj li lj lk jn iq ll lm jr iu ln lo jv iy lp lq jz lr bi translated">负荷</h2><p id="084d" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">最后，您的ETL工具将帮助协调您的数据并将其加载到目标位置，这本质上是一个商业智能(BI)或数据库工具的选择。您可以在那里找到它，为您的分析做好准备。</p><p id="a37c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在完成所有的数据处理和数据清理后，将其保存在数据帧中，因为它很容易进行分析和由Python库(pandas)读取。</p><p id="7639" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用来保存数据帧的命令的一个例子。csv格式:</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ne"><img src="../Images/b4133b1bd97919ed5e2176824f4a8e10.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*OYa4WuED4LNf_BJXL8c6GA.jpeg"/></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">用于保存书名数据帧的命令。逗号分隔值（csv）文件格式</figcaption></figure></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="nf ng l"/></div><figcaption class="mi mj et er es mk ml bd b be z dx translated">此刮擦中使用的代码</figcaption></figure></div></div>    
</body>
</html>