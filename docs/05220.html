<html>
<head>
<title>3 Ways to Test Any Application Effectively with PyTest</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PyTest有效测试任何应用程序的3种方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/3-ways-to-test-any-application-effectively-with-pytest-35f2e99b2a1a?source=collection_archive---------13-----------------------#2020-04-14">https://medium.com/analytics-vidhya/3-ways-to-test-any-application-effectively-with-pytest-35f2e99b2a1a?source=collection_archive---------13-----------------------#2020-04-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b76d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除了最琐碎的计算机程序之外，所有的程序都需要测试来证明程序确实如你所愿。测试软件有许多不同的方法，术语有时会令人困惑和重叠。对于每一种测试方法，要记住的最重要的事情是你要测试的<strong class="ih hj">范围</strong>:问问你自己，你是应该孤立地测试一小部分代码，单个应用程序或服务，还是许多服务的交互来形成一个整体解决方案？通常，您需要在开发周期的不同阶段在多个范围内进行测试。</p><h1 id="2e41" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">为什么选择PyTest？</h1><blockquote class="kb"><p id="c383" class="kc kd hi bd ke kf kg kh ki kj kk jc dx translated">Python是编写功能测试的优秀语言，不管你的应用程序是用什么语言编写的。</p></blockquote><p id="5dc2" class="pw-post-body-paragraph if ig hi ih b ii kl ik il im km io ip iq kn is it iu ko iw ix iy kp ja jb jc hb bi translated">对于单元测试——孤立地测试一个代码单元，比如一个包、模块或类——你为单元测试选择的框架将会受到你为测试代码选择的语言的强烈影响(如果不是指定的话)。尽管有用，但是单元测试本身是不够的。即使你完全理解并测试了所有软件单元的接口，当它们连接在一起时，复杂的和潜在的意想不到的行为仍然会出现——这被称为“突现现象”，经常出现在<a class="ae kq" href="https://en.wikipedia.org/wiki/Emergence" rel="noopener ugc nofollow" target="_blank">自然世界</a>以及理论过程中，如<a class="ae kq" href="https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life" rel="noopener ugc nofollow" target="_blank">康威的生命游戏</a>。驯服这种复杂性是功能测试的切入点。</p><p id="9cc8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">功能测试包括运行应用程序或服务，发送一些受控的输入，并检查在合理的时间内是否收到预期的输出。对于后端服务，您可以在服务的监听地址上发送一个网络请求，并等待预期的响应；对于UI应用程序，您可能会单击UI中的一个项目，然后等待屏幕上呈现一些特定的文本。尽管功能测试可以由人工测试人员手动执行，但是自动化测试有许多优点——一旦编写好，脚本化测试在CI中反复运行就很便宜，可以捕捉回归或发现大多数时候都有效的特性。</p><p id="fbe8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Python是编写功能测试的优秀语言，不管你的应用程序是用什么语言编写的。Python被设计成易于学习，所以即使它不是你的主要语言，你也不应该觉得用它来读和写测试是个问题。因为python是一种高级动态语言，所以代码可能非常简洁，可读性强，没有类型声明或内存管理的混乱。最后，Python非常适合需要大量IO交互的任务，并且有许多很棒的库用于联网(例如<a class="ae kq" href="https://requests.readthedocs.io/en/master/" rel="noopener ugc nofollow" target="_blank">请求</a>、<a class="ae kq" href="https://scapy.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> scapy </a>)或控制用户输入(例如<a class="ae kq" href="https://pexpect.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank">PE expect</a>、<a class="ae kq" href="https://selenium-python.readthedocs.io/" rel="noopener ugc nofollow" target="_blank"> selenium </a>)。</p><p id="48b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Python自带了一个用于单元测试的内置库，但是对于python单元测试和一般功能测试，我强烈推荐看一下<a class="ae kq" href="https://docs.pytest.org/en/latest/" rel="noopener ugc nofollow" target="_blank"> PyTest </a>。不像许多其他框架需要你学习一种方法调用的子语言，使用PyTest你可以简单地以你期望的方式使用builtin <code class="du ks kt ku kv b">assert</code>语句。PyTest能够分析代码中的断言语句，并给出有用的调试信息，说明断言失败的原因，而不是简单地告诉你“断言失败”。PyTest还提供了<a class="ae kq" href="https://docs.pytest.org/en/latest/fixture.html" rel="noopener ugc nofollow" target="_blank"> fixtures </a>作为一个强大的工具来处理设置和删除您正在测试的应用程序和服务，以及连接测试客户端。</p><p id="1173" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当开发一个新特性时，当你在应用程序代码中发现并修复错误时，你通常会想要编写、运行并重新运行你的测试。减少迭代循环的时间和摩擦对于保持快节奏和减少挫折是很重要的。当然，您选择的应用程序语言的构建时间是一个问题，但是您如何使用您的测试框架也很重要。在这里，我将简要介绍三种不同的方法。</p><h1 id="f8ab" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">从终端</h1><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/61488f4f011b63d8af745f4011ac7d9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VSK59443i0IYmEUHwZxnlg.png"/></div></div></figure><p id="f110" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行PyTest最常见的方式可能是从终端运行。对于大多数项目，您可以简单地从repo的根目录运行<code class="du ks kt ku kv b">pytest</code>来在一个批处理中运行您的所有测试——PyTest将自动找到所有名称以<code class="du ks kt ku kv b">test</code>开头的模块，并运行以<code class="du ks kt ku kv b">test</code>开头的函数和方法。运行所有的测试可能需要一段时间，所以您可以像<code class="du ks kt ku kv b">pytest path/to/your/test.py</code>一样通过文件路径指定单独的测试脚本。可以像<code class="du ks kt ku kv b">pytest path/to/your/test.py::test_func</code>或<code class="du ks kt ku kv b">pytest path/to/your/test.py::TestClass::test_method</code>那样指定一个类的单个函数或方法。<code class="du ks kt ku kv b">-k</code>参数也可以用于运行所有匹配给定表达式的测试，因此<code class="du ks kt ku kv b">pytest -k abc</code>将运行名称中任何地方带有“abc”的所有测试。</p><p id="0db5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然许多开发人员喜欢他们的终端，但在较大的项目中，当您需要键入较长的路径、测试名称并冒着打错字的风险时，它会有麻烦。此外，当运行许多测试时，在终端输出的许多屏幕中向上滚动以找到特定测试的失败细节可能会有点痛苦。图形解决方案可以帮助克服这两个限制。</p><h1 id="c6a2" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">来自你的IDE: PyCharm</h1><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es li"><img src="../Images/27020cb150fb69ecbd6c69c5aa2d64af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J4Zzr6lQK5cgxiKl4jixcA.png"/></div></div></figure><p id="e672" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行测试的第二种方式是从您的IDE中。上面展示的是PyCharm(免费社区版)，这是一个流行的全功能Python开发IDE。在settings(工具-&gt; Python集成工具-&gt;测试)中首次将PyTest设置为默认测试运行程序后，您可以通过上下文菜单(或键盘快捷键)从文件资源管理器窗格(左侧)中的目录或模块运行测试。或者，您可以通过打开测试文件并单击编辑器窗格(右侧)中的绿色运行图标来运行特定的测试函数、类或方法。这两种方法都将运行所选的测试，并在测试运行器窗格(底部)中向您返回结果。结果被排列成一棵树，允许您快速挖掘并找到特定测试失败的详细原因。</p><p id="93aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与终端相比，PyCharm提供了一个更友好的界面，既可以选择运行哪些测试，也可以浏览测试结果。另一方面，如果您主要不是python开发人员，您可能不希望为了编写测试而安装和学习全新的IDE，那么在用于应用程序开发的同一编辑器或IDE中编写测试就不太需要上下文切换。尽管有些人喜欢他们的ide，但是从头开始学习时，他们可能是复杂的野兽，而且通常使用一个能做好一件事的程序比使用一个代表多功能瑞士军刀的程序更好。</p><h1 id="2fa7" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">运行PyTests的独立UI</h1><p id="54ee" class="pw-post-body-paragraph if ig hi ih b ii lj ik il im lk io ip iq ll is it iu lm iw ix iy ln ja jb jc hb bi translated">因此，最理想的是有一个友好的图形用户界面来运行测试，这不需要您安装和学习特定于Python的IDE。这就是<a class="ae kq" href="https://pypi.org/project/pytest-commander/" rel="noopener ugc nofollow" target="_blank"> pytest-commander </a>能帮你的地方。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lo"><img src="../Images/179fd2f9f0231fa1f887cc5f137afa94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4C3ctIZ8YaQ7xOGSAjkg8A.png"/></div></div></figure><p id="b99f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该工具通过在您的web浏览器中运行的web应用程序进行控制。它提供了您的测试模块以及它们包含的测试函数、类和方法的树形视图。测试可以单独运行(并重新运行),也可以按类或模块分组，之后您可以深入研究并探索结果。使用python包管理器<code class="du ks kt ku kv b">pip</code>入门很简单:</p><pre class="kx ky kz la fd lp kv lq lr aw ls bi"><span id="d5ac" class="lt je hi kv b fi lu lv l lw lx">pip install pytest-commander<br/>pytest_commander path/to/your/tests</span></pre><p id="c22e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当服务器启动时，您应该会自动看到一个浏览器窗口打开，web应用程序正在运行，准备进行测试。</p><p id="a91b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我承认这里有我个人的兴趣—我开发了这个工具！因此，如果您有任何问题或改进建议，请不要犹豫，在<a class="ae kq" href="https://github.com/ryanc414/pytest_commander" rel="noopener ugc nofollow" target="_blank"> github </a>上提出问题。</p><h1 id="8d55" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">概括起来</h1><p id="9464" class="pw-post-body-paragraph if ig hi ih b ii lj ik il im lk io ip iq ll is it iu lm iw ix iy ln ja jb jc hb bi translated">我们已经看到Python和PyTest如何适用于用任何语言编写的应用程序的功能测试。从您的终端运行测试是一种快速而简单的开始方式，但是对于从大量测试中选择和分析结果来说，可能会感到笨拙。像PyCharm这样的IDE为编写Python代码、运行测试等提供了一个全包，但是对于那些已经有了自己喜欢的编辑器或IDE的其他语言的开发者来说，可能就没有吸引力了。所以由<a class="ae kq" href="https://pypi.org/project/pytest-commander/" rel="noopener ugc nofollow" target="_blank"> pytest-commander </a>提供的独立UI可以为轻松的测试提供一个更轻量级的解决方案。</p></div></div>    
</body>
</html>