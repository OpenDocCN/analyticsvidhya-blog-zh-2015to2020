# 机器学习的特征工程

> 原文：<https://medium.com/analytics-vidhya/feature-engineering-for-machine-learning-dce6298e9ab4?source=collection_archive---------13----------------------->

## 增强模型的深思熟虑的人类工作

大多数机器学习示例假设特征(**描述要建模的输入的变量)**是给定的或容易确定的；然而，现实世界可能并非如此。研究和包含增强的功能在新兴和高级模型中是必不可少的；比如精准医疗、自动驾驶汽车、无人机、5G /物联网(IoT)等。到 2020 年底，预计将有超过 310 亿台设备接入互联网，到 2025 年将超过 750 亿台[【1】](#_ftn1)。鉴于数据和智能处理器的冲击，也许特征工程将成为数据科学的发展分支。

在机器学习的上下文中，特征是输入，特征工程通常被描述为:

> 从现有的输入功能中创建新的输入功能[【2】](#_ftn2)。
> 
> 使用数据的领域知识来创建使机器学习算法工作的特征的过程(Amit shek har)[【3】](#_ftn3)。
> 
> 想出特性是困难的、耗时的，并且需要专业知识。‘应用机器学习’基本上是特色工程(吴恩达)[【4】](#_ftn4)。

深度学习、自学式学习和自动特征生成模型对于消除手动设计特征的需求非常有用。机器学习算法还会根据性能对功能进行优先排序和折扣。然而，额外的功能，选择或设计，可能会在先进的应用程序的差异。

上面列出的第三个特征来自吴恩达，特别适用于当前和发展中的应用程序。传统的建模包括“这里是输入 X 和标记的输出 y，现在在给定一些新的 X 的情况下，提出预测 y 的模型”。这可能还不够。例如，全自动驾驶汽车的技术推动了特征工程的使用——将来自相机、雷达、激光雷达、GPS 和众多传感器的输入结合到机器学习功能中。5G 的实施将为自主技术带来更多的投入和功能；例如，交通控制和安全功能可能会将自动驾驶技术推向第 5 级(完全自动驾驶)类别，以供通用。这可能包括设备和相关特征；例如用于检测泥土或砾石道路的传感器和特征等。或者用于确定附近物体不仅仅是一辆车而是一辆织布车(醉酒司机)的特征。而且，许多分析师会认为 5G *(以及相关功能)*是无处不在的自主性[【5】](#_ftn5)的一个要求。用于医学发现、诊断和精准医疗的机器学习中的许多新兴应用都适合这种具有高级功能的更全面的建模。

图 1 提供了特征选择和工程如何适应机器学习整体流程的简化视图。

![](img/fc7a5461eb63a19da1efbd4dc638f71b.png)

图一。机器学习的一般流程

特征选择和特征工程有时可以互换使用；然而，人们可能会认为特征工程更复杂或更有创造性；例如，在自动驾驶车辆应用中，对附近车辆摆动的检测和反应。“编织”(可能是一个范围)的定义和量化将是一个工程特征。

一些算法将在数学上减少或优化维度(特征的数量和特定特征的重要性)，以优化特定情况下的性能[【6】](#_ftn6)；然而，对于这些算法，从一开始就假定包含了一个全面的特征集。

特征工程是提高算法性能的深思熟虑的人工工作。下面的例子说明了一些应用。

**例 1。放射学**

在放射学中，机器学习被用于图像诊断(计算机视觉可以看到更多细节)。然而，还有许多可以改进的地方；特别是在上下文、解释、敏感性和判断方面:

> 在临床实践中，一个放射科医师可能不希望由于结核病的高临床影响而错过该病例，因此会将具有细微/非特异性结核病发现的病例注释为阳性，而另一个放射科医师可能不希望过度呼叫结核病，而是可能寻找该疾病特有的更典型的体征[【7】](#_ftn7)。

将图像建模与来自 DNA 测序、生物标记、患者人口统计、临床历史(病历)和其他因素的特征相结合，可以改善诊断和治疗中的预测。这种方法正在一些精确医疗应用中使用:

> 高通量技术的最新发展加速了来自多个来源的大量组学数据的积累:基因组、表观基因组、转录组、蛋白质组、代谢组等。传统上，使用统计学和机器学习方法来孤立地分析来自每个来源(例如基因组)的数据。多组学和临床数据的综合分析是新的生物医学发现和精准医学进步的关键。[【第八期】](#_ftn8)

上述引文中使用的术语“组学”代表[整体]情况和要求。医学上的定义是:“对代表某种完整集合的大量数据的分析，尤其是细胞、器官或有机体中的蛋白质、脂质或代谢物等分子的完整集合”[【9】](#_ftn9)。

当我写这篇文章时(2020 年 2 月)，一个团队刚刚开发出(在几周内)机器学习，从 CT 肺部扫描中诊断冠状病毒，并随后寻找由冠状病毒引起的肺炎的迹象。在初步[阳性]扫描后，医生会进行其他检查和实验室测试，以确认疾病的诊断。该系统部署在中国的 34 家医院，用于审查超过 32，000 个病例[【10】](#_ftn10)。来自伍斯特理工学院的另一组科学家很快(在几周内)绘制出了用于靶向治疗的 3D 图像。而且，许多其他团体也在合作研究这种疾病。

医学诊断对假阴性(例如癌症存在但未被诊断)和假阳性(例如癌症不存在但被如此诊断)高度敏感。对算法进行调整以校正欠拟合和过拟合情况可以改善这些情况下的模型性能。第二个选项是寻找可以被选择或设计以使算法更全面的特征。

**例二。NFL 足球比赛预测**

我们做了一个样本，从头到尾，机器学习项目，预测 2019 赛季的 NFL 比赛[【12】](#_ftn12)。在这个项目中，从网络上搜集关键统计数据，比如四分卫排名，并直接用作特征。这些数据输入了一个算法，该算法对大约 16 场比赛进行了每周预测。

为了发挥创造力，我们设计了一些特征，比如“动力”。如何定义和测量动量？在本例中，动量被定义为在前五场比赛中的胜率与预计胜率之比。另一个工程化的特性来自于前一年排名前 100 的玩家名单。我们还根据球队轮换和伤病情况每周调整这些数据。这 100 大特性的影响微乎其微。将该功能分为两个功能(前 25 名玩家和其他 75 名玩家)产生了显著的差异。最终，我们只保留了前 25 名玩家的功能(“游戏改变者”)，而放弃了 75 名玩家的功能。

**例三。DNA 和个性化医疗**

目前，正在进行机器学习和 DNA 方面的工作；例如，将患者数据转化为成功的疗法(精准医疗)[【13】](#_ftn13)[【14】](#_ftn14)。患者数据来自 DNA 中 30 亿个碱基(A、C、G、T)的基因组。例如，存在于许多癌症类型中的基因 TP53 长度超过 1000 个碱基，并在这些模型中用作特征。科学家们还发现 DNA 链的几何形状和拓扑结构(松弛对紧密对介于两者之间)以及细胞、蛋白质和其他因素的几何形状会影响细胞行为。例如，密集的细胞可能有助于解释为什么一些癌症肿瘤留在原地，而另一些则破裂并扩散到全身。将几何和拓扑分类为特征在精确医疗的机器学习中可能变得很重要:

> 大多数大规模研究只关注生物系统的一个特定方面；例如，全基因组关联研究(GWAS)侧重于与测量表型相关的遗传变异。然而，复杂的生物学现象可能涉及许多生物学方面，包括内在的和外在的，因此，不能用单一的数据类型来完全解释。正因如此，不同数据类型的综合分析越来越受到关注[【16】](#_ftn16)。

图 2 显示了 DNA 结构和潜在的几何特征。更多的主题专业知识和实验建模可以决定这些功能的有效性以及在什么情况下有效。具有高级 3D 几何和拓扑特征的机器学习可能有助于确定靶向治疗、病毒、基因编辑和精确药物的模块化和细胞行为。

![](img/5ee39b4bddfbb6c34e4ef106281a30ce.png)

图二。DNA 和潜在的几何特征

**例 4。传感器数据到[数学对象]功能**

图 3 包含来自监测神经状况的传感器的样本数据。传感器数据是数字的，但是非常类似于模拟数据，因为每秒钟发生数百次读取。根据这些传感器，在不同时间对不同反应进行分类的数学对象被创建为如图 3 所示的特征。这些特征与机器学习模型的其他特征相结合。

![](img/0b61c51597497d106b4ac9ec34a654cf.png)

图 3。数学对象(特征)的传感器数据

这种类型的特征工程师可以应用于 5G 或物联网应用的模拟数据或传感器数据。理想情况下，在边缘(靠近源)将传感器数据转换为数学对象是可取的，可编程芯片和边缘技术将在与 5G 和物联网(到 2025 年将有 750 亿台设备)相关的机器学习应用中变得更加主导[【17】](#_ftn17)。

**特色工程——如何衡量成功**

如何知道特性集是否完整，或者是否需要一些额外的工程或创造性？在 NFL 的例子中，在训练模型中，预测的准确性每周都有显著变化。研究这种变化揭示了变化的特殊原因(非随机的)，这是探索可能补偿的功能的好机会(例如，我们改变了一个功能以考虑受伤和暂停的球员)。因此，一种方法是查看训练数据的表现——不仅仅是准确性，还有变化的分布和特殊原因。如果整体精度不尽如人意，额外的功能可能会有所帮助。

你也可以看看假阴性和假阳性；尤其是在大多数医学模型中，如果灵敏度非常重要。针对欠拟合和过拟合调整算法可能会有所帮助。附加特征也可以改进模型。

自动驾驶汽车的训练和测试已经进行了数百万英里。然而，令人讨厌的假设性问题依然存在。先进的虚拟和增强现实系统(用于模拟等)可以增强测量；例如，提高测量的准确性、成本、速度和全面性，以及生成和解决假设。

**特征工程中的伦理和法律问题**

特征工程会引入偏差(这会影响性能，但也会导致道德和法律问题)。例如，排除某些特征(有意或无意)会影响模型。有些偏见可能是道德上的，有些偏见可能只是与绩效相关。例如，在 NFL 预测中，忽略防守球队排名或其他变量可能会影响对防守强的球队的预测。这与其说是道德问题，不如说是绩效问题；它确实说明了偏见是如何在特征选择中发挥作用的。如果申请涉及批准贷款或雇用个人，偏见可能会产生绩效、道德和法律方面的影响。

面部识别是一个流行的伦理话题，在这种情况下，在选择训练和测试数据时会引入偏见。也就是说，输入是否恰当地代表了要建模的人群？特征选择也会引入偏差。例如，假设创建了一个模型，训练(或测试)准确率为 90%。从表面上看，90%可能看起来不错，但这只是一个平均值。假设一个种族的准确率为 85%，另一个种族的准确率为 95%。附加的特征工程也许能够解决这种类型的问题。重点是要仔细检查结果。

如果自动驾驶汽车检测到附近的汽车，但没有像人类一样检测到它或对它做出反应(醉酒司机)，可能会发生严重碰撞。“编织”可能是一个工程特征，可能有一系列的值和相应的动作。

伦理、法律和责任问题将在面部识别、隐私、金融科技、医疗和自主应用的许多方面占据主导地位。

**结论**

关于人工智能:“不是谁有最好的算法谁就赢了。而是谁拥有的数据最多。”[【18】](#_ftn18)而特性工程就是对那些数据的最佳利用。功能是否全面(如编织附近的汽车)？模型是否有偏差(面部识别)？背景和人口是否被恰当地表示(医学)？涉及 3D 几何、模拟数据、传感器数据、物联网数据及其组合的不断发展的应用也需要特征工程的进步。

随着 5G、物联网和 750 亿设备的出现，数据增长将以倍数而非百分比来衡量。想想一架无人机飞行的数据量。这些数据将给特征工程带来巨大压力，即过滤、减少和优化数据的意义和使用的能力。人们可能会怀疑特征工程将成为数据科学一个独立的学科或分支。

技术和机会是如此令人兴奋。应用程序和行业之间已经或可以进行大量的转换。*想象一下*用于自动驾驶的 3D 标签[【19】](#_ftn19)可以如何用于无人机、机器人、增强现实，或许还可以在各个层面绘制人体。

特征工程可能是一门艺术，也是一门科学，需要工程和领域的专业知识；无论是足球、生物、医学、金融、环境还是商业。特征工程影响机器学习应用的性能、伦理甚至法律问题。但是，最重要的是，特征工程影响了机器学习应用和人工智能的未来和增强。

[【1】](#_ftnref1)霍尔维茨，l .(2019 年 7 月 19 日)。物联网的未来迷你指南:蓬勃发展的物联网市场继续思科。来源:[https://www . Cisco . com/c/en/us/solutions/internet-of-things/future-of-IOT . html](https://www.cisco.com/c/en/us/solutions/internet-of-things/future-of-iot.html)

[【2】](#_ftnref2)“什么是特征工程？”。精英数据科学。检索于 2020 年 2 月 10 日，来自:[https://elitedatascience.com/feature-engineering](https://elitedatascience.com/feature-engineering)

Shekhar，2018 年 2 月 14 日)。什么是机器学习的特征工程？Medium.com。检索于 2020 年 2 月 10 日，来自:[https://medium . com/minworks/what-is-feature-engineering-for-machine-learning-d8ba 3158 d97a](/mindorks/what-is-feature-engineering-for-machine-learning-d8ba3158d97a)

[【4】](#_ftnref4)伽斯·安德鲁。“通过大脑模拟的机器学习和人工智能”。斯坦福大学。[https://ai . Stanford . edu/~ ang/slides/deep learning-mar 2013 . pptx](https://ai.stanford.edu/~ang/slides/DeepLearning-Mar2013.pptx)

[【5】](#_ftnref5)桑德斯，2019 年 11 月 4 日)。为什么 5G 是自动驾驶汽车的关键技术。ZDNet。检索自:[https://www . zdnet . com/article/why-5g-is-a-critical-technology-for-autonomous-vehicles/](https://www.zdnet.com/article/why-5g-is-a-crucial-technology-for-autonomous-vehicles/)

[【6】](#_ftnref6)主成分分析(PCA)。

[【7】](#_ftnref7)Chan，s .&Siegel，E. L. (2019)。机器学习会终结放射学作为蓬勃发展的医学专业的生存能力吗？。英国放射学杂志，92(1094)，20180416。[https://doi.org/10.1259/bjr.20180416](https://doi.org/10.1259/bjr.20180416)检索自:[https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6404816/](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6404816/)

[【8】](#_ftnref8)Mirza，Bilal 等《生物医学大数据的机器学习与整合分析》。*基因* vol. 10，2 87。2019 年 1 月 28 日，doi:10.3390/genes10020087。检索自:Mirza，Bilal 等《生物医学大数据的机器学习和综合分析》。*基因*第 10 卷，2 期 87 页。2019 年 1 月 28 日，doi:10.3390/genes10020087

[【9】](#_ftnref9)组学。医学词典。资料来源:https://medical-dictionary.thefreedictionary.com/omics

t .西蒙尼特(2020 年 2 月 26 日)。中国医院部署人工智能帮助诊断新冠肺炎。连线。来源:[https://www . wired . com/story/Chinese-hospitals-deploy-ai-help-diagnose-新冠肺炎/](https://www.wired.com/story/chinese-hospitals-deploy-ai-help-diagnose-covid-19/)

[【11】](#_ftnref11)伍斯特理工学院。(2020 年 2 月 10 日)。WPI 研究人员与全球科学家分享冠状病毒的 3D 路线图。来源:[https://www . wpi . edu/news/wpi-研究员-股票-3d-路线图-冠状病毒-科学家-全球](https://www.wpi.edu/news/wpi-researcher-shares-3d-roadmap-coronavirus-scientists-worldwide)

安永会计师事务所(2020 年 2 月 9 日)。NFL 预测-从机器学习模型到预测。检索自:https://medium.com/@raymond.ernst/c789d18cf800?source = friends _ link&sk = 45398303 f1 cf 50 a 4 FD 58 d0ae 73 EB 4 dfe

[【13】](#_ftnref13)艾德克尔，特雷。2020 年 2 月 2 日。“用于精确诊断和治疗的癌症人工智能模型”。加州大学圣地亚哥分校医学系教授，圣地亚哥舰队科学中心。

[【14】](#_ftnref14)大数据能力在推进精准医疗方面的重要性怎么强调都不为过。2020 年 2 月 10 日检索自:[https://precision health . um system . edu/research/features/big-data . html](https://precisionhealth.umsystem.edu/research/features/big-data.html)

【波普金，g . 2016 年 8 月 16 日。堵塞的细胞暴露了癌症的物理现象。广达杂志。检索自:[https://www . quanta magazine . org/jamked-cells-expose-the-physics-of-cancer-2016 08 16](https://www.quantamagazine.org/jammed-cells-expose-the-physics-of-cancer-20160816)

[【16】](#_ftnref16)徐，c，杰克逊，S.A .机器学习与复杂生物数据。 *Genome Biol* **20，** 76 (2019)。https://doi.org/10.1186/s13059-019-1689-0。

霍维茨，同上。

Ng，安德鲁。“通过大脑模拟的机器学习和人工智能”。斯坦福大学。[https://ai . Stanford . edu/~ ang/slides/deep learning-mar 2013 . pptx](https://ai.stanford.edu/~ang/slides/DeepLearning-Mar2013.pptx)

[[19]](#_ftnref19)Suba，2020 年 3 月 4 日)。特斯拉 3D 标签是自动驾驶的下一个大飞跃。特斯拉拉提。来源:[https://www . Tesla rati . com/Tesla-3d-labeling-auto pilot-reliability-big-leap/](https://www.teslarati.com/tesla-3d-labeling-autopilot-reliability-big-leap/)