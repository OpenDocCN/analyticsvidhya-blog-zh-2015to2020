<html>
<head>
<title>Dog Breed Classifier: How to build a face detector, dog detector &amp; breed classifier using CNN and Transfer Learning?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç‹—å“ç§åˆ†ç±»å™¨:å¦‚ä½•åˆ©ç”¨CNNå’Œè¿ç§»å­¦ä¹ æ„å»ºäººè„¸æ£€æµ‹å™¨ã€ç‹—æ£€æµ‹å™¨&amp;å“ç§åˆ†ç±»å™¨ï¼Ÿ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/dog-breed-classifier-how-to-build-a-dog-detector-breed-classifier-using-cnn-from-scratch-and-ee97696d2073?source=collection_archive---------10-----------------------#2020-05-06">https://medium.com/analytics-vidhya/dog-breed-classifier-how-to-build-a-dog-detector-breed-classifier-using-cnn-from-scratch-and-ee97696d2073?source=collection_archive---------10-----------------------#2020-05-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4777" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æœ¬æ–‡æ¦‚è¿°äº†<em class="jd"> Kaggleçš„</em> <strong class="ih hj"> <em class="jd">çŠ¬ç§åˆ†ç±»å™¨</em> </strong>é¡¹ç›®ï¼Œæ°å¥½æ˜¯è‘—åçš„è§†è§‰é¡¹ç›®ä¹‹ä¸€ï¼</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/b27c2d88ece12c08613758a3d6dfd993.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*Lgl_gdw_mJbuJoXyt7WDpQ.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">æ­¤å¤„å·²å»ºå†…å®¹æ¦‚è¿°ï¼</figcaption></figure><h2 id="5efe" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated">æ¦‚è¿°:</h2><p id="da73" class="pw-post-body-paragraph if ig hi ih b ii kl ik il im km io ip iq kn is it iu ko iw ix iy kp ja jb jc hb bi translated">äººç±»åœ¨è§†è§‰æ–¹é¢éå¸¸ä¼˜ç§€ï¼Œæˆ‘ä»¬çš„å¤§è„‘åœ¨è§†è§‰è¯†åˆ«æ–¹é¢éå¸¸å¼ºå¤§ã€‚ç»™ä¸€åªç‹—ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°å‘ç°å®ƒçš„å“ç§ï¼Œå”¯ä¸€çš„æ¡ä»¶æ˜¯ä½ å¿…é¡»çŸ¥é“è¿™ä¸ªæ˜Ÿçƒä¸Šæ‰€æœ‰çš„ç‹—å“ç§ï¼ç°åœ¨è¿™å¯¹äºä¸€ä¸ªæ­£å¸¸äººæ¥è¯´æ˜¯ä¸€ä¸ªç›¸å½“å…·æœ‰æŒ‘æˆ˜æ€§çš„ä»»åŠ¡ã€‚å‡è®¾ä½ å–œæ¬¢ä¸€ä¸ªç‰¹å®šçš„ç‹—å“ç§(æ¯”å¦‚è¯´æ‹‰å¸ƒæ‹‰å¤š)ï¼Œæƒ³æ”¶å…»ä¸€åªåŒä¸€å“ç§çš„ç‹—ï¼Œä½ å»å•†åº—æŠŠä½ å¯çˆ±çš„æ–°æœ‹å‹å¸¦å›å®¶ã€‚ä½ æ€ä¹ˆçŸ¥é“è¿™æ˜¯ä¸æ˜¯ä½ å¾—åˆ°çš„æ­£ç¡®çš„ç‹—å“ç§ï¼Ÿå¾ˆå¤šæ—¶å€™ï¼Œäººç±»å¾ˆéš¾è¯†åˆ«ç‹—çš„å“ç§ã€‚ä¾‹å¦‚ï¼Œå¦‚ä½•å¯¹ä¸‹é¢ç»™å‡ºçš„ä¸¤åªç‹—çš„å›¾ç‰‡è¿›è¡Œåˆ†ç±»ã€‚</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kq"><img src="../Images/c6de42c1dc861928c734edf541f401a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*6O5AL_ZlYRnz6Vd4vXZlew.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">æ³¨æ„ä¸¤å¼ å›¾ç‰‡çš„å“ç§åç§°ï¼</figcaption></figure><p id="3d22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨ï¼Œè¿™ä¸¤ä¸ªæ€ä¹ˆæ ·ï¼Ÿ</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kr"><img src="../Images/12075f5d71b49dff16db06947000eb16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*-pIY0qXLbJCsEo57U0Am4w.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">ä¸¤åªç‹—éƒ½æœ‰å·æ¯›ï¼Œå¾ˆéš¾è¾¨è®¤ï¼Œå¯¹å§ï¼Ÿï¼</figcaption></figure><p id="8eac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨ï¼Œè¿™å¼ å›¾ç‰‡ä¸Šçš„å“ç§æ˜¯ä»€ä¹ˆï¼Ÿï¼Ÿ</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ks"><img src="../Images/1339f7a69d69ff3c3bc843909fee8eb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/1*uoqiCCEbNebVsIBXzGwOgQ.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">è¿™ç®—æ˜¯ç‹—çš„å½¢è±¡å—ï¼Ÿæ˜¯å•Šï¼äººå˜ç‹—:p</figcaption></figure><p id="91ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä¸Šé¢ç»™å‡ºçš„å›¾åƒä¸æ˜¯ä¸€åªç‹—ï¼Œè€Œæ˜¯ä¸€å¼ åŒ–äº†å¦†çš„äººè„¸(ã€Šæ˜Ÿçƒå¤§æˆ˜ã€‹çš„è™šæ„äººç‰©ä¸˜å·´å¡)ã€‚è¿™ä¸ªé¡¹ç›®è¿˜å°†å¸¦ä½ é€šè¿‡äººè„¸æ£€æµ‹å’Œè¯†åˆ«ä¸ç»™å®šäººè„¸æœ€ç›¸ä¼¼çš„ç‹—å“ç§ï¼å¬èµ·æ¥å¾ˆæœ‰è¶£ï¼Œå¯¹å§ï¼Ÿï¼ğŸ˜„</p><p id="93a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ‰€ä»¥ï¼Œè¿™æˆäº†ä¸€é¡¹è‰°éš¾çš„å·¥ä½œã€‚è¿™å°±æ˜¯æœºå™¨å­¦ä¹ /æ·±åº¦å­¦ä¹ çš„éœ€æ±‚å‡ºç°çš„æ—¶å€™ã€‚è®¡ç®—æœºè§†è§‰å¸®åŠ©ä½ å»ºç«‹æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œä½ è®­ç»ƒä¸€ä¸ªæ¨¡å‹æ¥è¯†åˆ«ç‹—çš„å“ç§ï¼è¿™è®©ä½ çš„å·¥ä½œå˜å¾—ç®€å•ï¼<a class="ae kx" href="https://cs231n.github.io/convolutional-networks/" rel="noopener ugc nofollow" target="_blank"> <em class="jd"> CNN </em> </a>æ˜¯æ·±åº¦å­¦ä¹ é¢†åŸŸçš„ä¸€é¡¹å·¨å¤§å‘æ˜ï¼Œè¿™æ¨åŠ¨äº†è§†è§‰è¯†åˆ«é¢†åŸŸçš„å¤§é‡åº”ç”¨ã€‚æˆ‘å°†å¸¦æ‚¨äº†è§£å¦‚ä½•ä½¿ç”¨Pytorchä»å¤´å¼€å§‹æ„å»ºCNNï¼Œå¹¶åˆ©ç”¨ä¸€äº›æµè¡Œçš„CNNæ¶æ„æ¥å®Œæˆæˆ‘ä»¬çš„å›¾åƒåˆ†ç±»ä»»åŠ¡ï¼</p></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><p id="f1e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¯¥é¡¹ç›®åˆ†ä¸ºä¸åŒçš„é˜¶æ®µï¼Œå¦‚åŠ è½½å’Œé¢„å¤„ç†æ•°æ®ï¼Œäººè„¸æ£€æµ‹ï¼Œç‹—æ£€æµ‹ï¼Œå“ç§åˆ†ç±»ã€‚ä½ å¯ä»¥åœ¨æˆ‘çš„<a class="ae kx" href="https://github.com/s-nilesh" rel="noopener ugc nofollow" target="_blank"> <em class="jd"> GitHub </em> </a>ä¸Šæ‰¾åˆ°ä»£ç ã€‚</p></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h2 id="79d6" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated">æ•°æ®é›†å’Œè¾“å…¥</h2><ul class=""><li id="1432" class="lf lg hi ih b ii kl im km iq lh iu li iy lj jc lk ll lm ln bi translated">è¾“å…¥:è¯¥é¡¹ç›®çš„è¾“å…¥ç±»å‹å¿…é¡»æ˜¯å›¾åƒã€‚</li></ul><p id="2600" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">æ•°æ®é›†:</em></p><ul class=""><li id="69f2" class="lf lg hi ih b ii ij im in iq lo iu lp iy lq jc lk ll lm ln bi translated"><strong class="ih hj"> <em class="jd">äººå½¢å›¾åƒ</em> </strong>:äººå½¢å›¾åƒåˆ†å¸ƒåœ¨<strong class="ih hj"> 5749ä¸ªæ–‡ä»¶å¤¹</strong>ä¸­ï¼Œä»¥ç±»ä¼¼â€œæœ±ä¸½å®‰_æ‘©å°”â€ã€â€œä¸¹_é˜¿å…‹ç½—ä¼Šå¾·â€ç­‰äººå½¢åç§°å‘½åã€‚æ€»å…±æœ‰<strong class="ih hj"> 13233å¼ </strong>äººè„¸å›¾åƒã€‚å›¾åƒåœ¨æ–‡ä»¶å¤¹ä¸­åˆ†å¸ƒä¸å‡åŒ€ã€‚é“¾æ¥åˆ°æ•°æ®é›†çš„è¶…é“¾æ¥æ˜¯<a class="ae kx" href="https://s3-us-west-1.amazonaws.com/udacity-aind/dog-project/lfw.zip" rel="noopener ugc nofollow" target="_blank"> <em class="jd">è¿™é‡Œçš„</em> </a>ã€‚</li><li id="c633" class="lf lg hi ih b ii lr im ls iq lt iu lu iy lv jc lk ll lm ln bi translated"><strong class="ih hj"> <em class="jd">ç‹—å›¾åƒ</em> </strong>:ç‹—å›¾åƒåˆ†å¸ƒåœ¨ä¸‰ä¸ªä¸»æ–‡ä»¶å¤¹ä¸­ï¼Œåˆ†åˆ«å‘½åä¸ºâ€œtrainâ€ã€â€œT16â€ã€â€œtestâ€å’Œâ€œvalidâ€ï¼Œç”¨äºè®­ç»ƒã€æµ‹è¯•å’ŒéªŒè¯ã€‚æ­¤å¤–ï¼Œæ‰€æœ‰è¿™äº›æ–‡ä»¶å¤¹å†æ¬¡è¢«åˆ†é…åˆ°ä»£è¡¨ç‹—å“ç§çš„<strong class="ih hj"> 133ä¸ªæ–‡ä»¶å¤¹</strong>ä¸­ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„ç‹—æ•°æ®é›†æœ‰133ç±»ï¼Œå³å“ç§(â€œç’â€ï¼Œâ€œæ¯”ç†ŠçŠ¬_å¼—é‡Œæ–¯â€ï¼Œç­‰ç­‰)ã€‚é“¾æ¥åˆ°æ•°æ®é›†çš„è¶…é“¾æ¥æ˜¯<a class="ae kx" href="https://s3-us-west-1.amazonaws.com/udacity-aind/dog-project/dogImages.zip" rel="noopener ugc nofollow" target="_blank"> <em class="jd">è¿™é‡Œçš„</em> </a>ã€‚</li></ul><p id="7133" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">å…³äºæ•°æ®çš„ä¿¡æ¯:</em></p><pre class="jf jg jh ji fd lw lx ly lz aw ma bi"><span id="1746" class="jq jr hi lx b fi mb mc l md me">Total number of <strong class="lx hj">human face images: 13233</strong><br/>Total number of <strong class="lx hj">human face folders: 5749</strong><br/>Total numner of folders in 'dog_images:' 3<br/>Folders in 'dog_images': train,test,valid<br/><strong class="lx hj">Total folders(breed classes) </strong>in 'train, test, valid' <strong class="lx hj">133</strong><br/>Total images in /dog_images/<strong class="lx hj">train : 6680</strong><br/>Total images in /dog_images/<strong class="lx hj">test : 836</strong><br/>Total images in /dog_images/<strong class="lx hj">valid : 835</strong></span></pre><p id="a978" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">è®­ç»ƒæ•°æ®é›†ä¸­ç‹—å“ç§çš„åˆ†å¸ƒ(å¹³å‡æ¯ç±»50.22ä¸ªæ ·æœ¬):</em>ç±»åˆ«åç§°ä¸å¯è§ï¼Œä½†æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯ç±»çš„å¹³å‡æ ·æœ¬ï¼Œç”±å¹³è¡Œäºç±»åˆ«è½´çš„é»‘çº¿è¡¨ç¤ºã€‚</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mf"><img src="../Images/bd796cd39ccb399ea6e517ff94150069.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*LKopScgCQNSCCEPADkuiig.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">æ˜¾ç¤ºè®­ç»ƒæ•°æ®é›†ä¸­<strong class="bd js">å›¾åƒåˆ†å¸ƒçš„æŸ±çŠ¶å›¾ï¼Œæ¯ä¸ªæŸ±çŠ¶å›¾ä»£è¡¨ä¸€ä¸ªçŠ¬ç§ã€‚</strong></figcaption></figure></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h2 id="7321" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated">äººè„¸æ£€æµ‹</h2><p id="8985" class="pw-post-body-paragraph if ig hi ih b ii kl ik il im km io ip iq kn is it iu ko iw ix iy kp ja jb jc hb bi translated">æˆ‘ç”¨äº†<a class="ae kx" href="https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_objdetect/py_face_detection/py_face_detection.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> OpenCVçš„Haarçº§è”åˆ†ç±»å™¨</strong> </a> <strong class="ih hj"> </strong>æ¥æ£€æµ‹äººè„¸ã€‚è¿™ä¸ªOpenCVçš„åˆ†ç±»å™¨åœ¨è®¸å¤šå¸¦æœ‰æ­£ç‚¹(æœ‰è„¸)å’Œè´Ÿç‚¹(æ²¡æœ‰è„¸)æ ‡ç­¾çš„å›¾åƒä¸Šè¢«è®­ç»ƒã€‚detectMultiScaleè¿”å›åŒä¸€å›¾åƒä¸­æ‰€æœ‰æ£€æµ‹åˆ°çš„é¢çš„4ä¸ªè¾¹ç•Œæ¡†åæ ‡å€¼çš„åˆ—è¡¨ã€‚å¯¹äºæ‰€æœ‰äººè„¸æ£€æµ‹ç®—æ³•ï¼Œå°†RGBå›¾åƒè½¬æ¢ä¸ºç°åº¦å›¾åƒæ˜¯ä¸€ç§æ ‡å‡†åšæ³•ï¼Œå› æ­¤è¯·ç¡®ä¿è½¬æ¢æ‚¨çš„å›¾åƒã€‚</p><pre class="jf jg jh ji fd lw lx ly lz aw ma bi"><span id="de21" class="jq jr hi lx b fi mb mc l md me">import cv2<br/>face_cascade = cv2.CascadeClassifier('haarcascade_frontalface.xml')</span><span id="579c" class="jq jr hi lx b fi mg mc l md me">def face_detector(img_path):<br/>    img = cv2.imread(img_path)<br/>    gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)<br/>    faces = face_cascade.detectMultiScale(gray)<br/>    return len(faces) &gt; 0  #returns bool</span></pre><blockquote class="mh mi mj"><p id="15e1" class="if ig jd ih b ii ij ik il im in io ip mk ir is it ml iv iw ix mm iz ja jb jc hb bi translated"><strong class="ih hj">æ¨¡å‹æ€§èƒ½</strong> : Haarçº§è”åˆ†ç±»å™¨åœ¨æ•°æ®ä¸Šæœ‰å¾ˆå¥½çš„æ€§èƒ½</p></blockquote><pre class="jf jg jh ji fd lw lx ly lz aw ma bi"><span id="772a" class="jq jr hi lx b fi mb mc l md me">Percentage of <em class="jd">human faces detected in human images</em> data: <strong class="lx hj">98.74<br/></strong>Percentage of <em class="jd">human faces detected in dog images </em>data(incorrect detections): <strong class="lx hj">10.83</strong></span></pre><p id="ca3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å“ˆå°”çº§è”åˆ†ç±»å™¨ç»™å‡ºçš„æ ·æœ¬ç»“æœ:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mn"><img src="../Images/1a0c4f4310bb608820a69d4701aca650.png" data-original-src="https://miro.medium.com/v2/resize:fit:566/format:webp/1*605BiOgsvpBOqXSl-N0z-g.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">ç”¨å·¦ä¸Šè§’çš„åæ ‡å’Œè¾¹ç•Œæ¡†çš„é«˜åº¦ã€å®½åº¦æ¥æ£€æµ‹ä¸€ä¸ªé¢</figcaption></figure></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h2 id="6e21" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated">ç‹—æ£€æµ‹</h2><p id="077a" class="pw-post-body-paragraph if ig hi ih b ii kl ik il im km io ip iq kn is it iu ko iw ix iy kp ja jb jc hb bi translated">æˆ‘ä»¬ç°åœ¨éœ€è¦è®¾è®¡ä¸€ä¸ªç‹—æ¢æµ‹å™¨ã€‚æˆ‘ä½¿ç”¨è¿ç§»å­¦ä¹ æ¥å®Œæˆè¿™é¡¹ä»»åŠ¡ã€‚æˆ‘å°è¯•ä½¿ç”¨äº†<em class="jd"> VGG16å’ŒResNet50 </em>é¢„è®­ç»ƒæ¨¡å‹ï¼Œåˆ†åˆ«åœ¨1000ç±»ImageNetæ•°æ®çš„<em class="jd"> 10Må›¾åƒä¸Šè¿›è¡Œè®­ç»ƒã€‚æˆ‘å·²ç»ä»<em class="jd">ç«ç‚¬æ¥åŠ›</em>ä¸‹è½½äº†è¿™ä¸ªæ¨¡å‹ã€‚VGG16  <strong class="ih hj">æ¨¡å‹</strong>åœ¨æˆ‘ä»¬çš„ç‹—æ•°æ®é›†ä¸Šè¡¨ç°æ›´å¥½ã€‚æˆ‘ä»¬éœ€è¦åŠ è½½å’Œè½¬æ¢æ‰€éœ€æ ¼å¼çš„å›¾åƒ(ä¾‹å¦‚ï¼Œå›¾åƒå¤§å°ï¼Œè½¬æ¢ä¸ºRGBï¼Œæ ‡å‡†åŒ–æ•°æ®)ã€‚<em class="jd">è¿™ä¸ªâ€œload_transform_imageâ€å‡½æ•°ä¹Ÿåœ¨æµ‹è¯•ä¸€å¹…å›¾åƒçš„æœ€ç»ˆå·¥ä½œæµç¨‹ä¸­ä½¿ç”¨</em>ã€‚è¿˜åˆ¶ä½œäº†ä¸€ä¸ªç‹—æ£€æµ‹å™¨ï¼Œå¦‚æœåœ¨ä¼ é€’ç»™è¯¥å‡½æ•°çš„å›¾åƒä¸­æ£€æµ‹åˆ°ç‹—ï¼Œåˆ™è¿”å›<em class="jd">â€œçœŸâ€ã€‚ä»¥ä¸‹æ˜¯ä»£ç :</em></em></p><pre class="jf jg jh ji fd lw lx ly lz aw ma bi"><span id="8f2b" class="jq jr hi lx b fi mb mc l md me"><strong class="lx hj">import</strong> <strong class="lx hj">torch<br/>from</strong> <strong class="lx hj">PIL</strong> <strong class="lx hj">import</strong> <strong class="lx hj">Image</strong><br/><strong class="lx hj">import</strong> <strong class="lx hj">torchvision.transforms</strong> <strong class="lx hj">as</strong> <strong class="lx hj">transforms<br/>import</strong> <strong class="lx hj">torchvision.models</strong> <strong class="lx hj">as</strong> <strong class="lx hj">models</strong></span><span id="f43f" class="jq jr hi lx b fi mg mc l md me"><em class="jd"># define VGG16 model</em><br/>VGG16 = models.vgg16(pretrained=<strong class="lx hj">True</strong>)</span><span id="e0da" class="jq jr hi lx b fi mg mc l md me"><em class="jd"># check if CUDA is available</em><br/>use_cuda = torch.cuda.is_available()</span><span id="8a22" class="jq jr hi lx b fi mg mc l md me"><em class="jd"># move model to GPU if CUDA is available</em><br/><strong class="lx hj">if</strong> use_cuda:<br/>    VGG16 = VGG16.cuda()</span><span id="a5e4" class="jq jr hi lx b fi mg mc l md me"><strong class="lx hj">def</strong> load_transform_image(img_path):<br/>    '''<br/>    Used load &amp; transform image for prediction on single image<br/>    '''</span><span id="9384" class="jq jr hi lx b fi mg mc l md me">img = Image.open(img_path).convert('RGB')<br/>    normalize = transforms.Normalize(<br/>                        mean=[0.485, 0.456, 0.406],<br/>                        std=[0.229, 0.224, 0.225])  <br/>    img_transform = transforms.Compose([<br/>                        transforms.Resize(size=(224, 224)),    <br/>                        transforms.ToTensor(),<br/>                        normalize])<br/>    img = img_transform(img)[:3,:,:].unsqueeze(0)<br/>    <strong class="lx hj">return</strong> img</span><span id="58bb" class="jq jr hi lx b fi mg mc l md me"><strong class="lx hj">def</strong> VGG16_predict(img_path):<br/>    <em class="jd">'''</em><br/><em class="jd">    Use pre-trained VGG-16 model to obtain index corresponding to </em><br/><em class="jd">    predicted ImageNet class for image at specified path</em><br/><em class="jd">    </em><br/><em class="jd">    Args:</em><br/><em class="jd">        img_path: path to an image</em><br/><em class="jd">        </em><br/><em class="jd">    Returns:</em><br/><em class="jd">        Index corresponding to VGG-16 model's prediction</em><br/><em class="jd">    '''</em></span><span id="ab36" class="jq jr hi lx b fi mg mc l md me">    image = load_transform_image(img_path)<br/>    <strong class="lx hj">if</strong> use_cuda:<br/>        image = image.cuda()<br/>    output = VGG16(image)<br/>    <strong class="lx hj">return</strong> torch.max(output,1)[1].item()</span><span id="54c2" class="jq jr hi lx b fi mg mc l md me"><strong class="lx hj">def</strong> dog_detector(img_path):<br/>    prediction = VGG16_predict(img_path)<br/>    <strong class="lx hj">return</strong> (prediction&gt;=151 <strong class="lx hj">and</strong> prediction&lt;=268)</span></pre><p id="9525" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">è‡ªå®šä¹‰å›¾åƒä¸Šdog_detectorçš„ç»“æœ:</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mo"><img src="../Images/e61223bda0fd16061090ce5a27fac905.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*ys0Oq92dKpvQgxtfoDRUaA.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">dog_detectorçš„æ­£ç¡®é¢„æµ‹</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mp"><img src="../Images/6aa4f573bb89cf5ec09a14268df39667.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*6OhzvvK0vG-xDIWx-ALDpA.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">dog_detectorçš„æ­£ç¡®é¢„æµ‹</figcaption></figure><blockquote class="mh mi mj"><p id="6a7d" class="if ig jd ih b ii ij ik il im in io ip mk ir is it ml iv iw ix mm iz ja jb jc hb bi translated"><strong class="ih hj">æ¨¡å‹æ€§èƒ½</strong>:ä¸ºäº†èŠ‚çœæ—¶é—´ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ä¸¤ä¸ªæ•°æ®é›†ä¸­çš„å‰100å¹…å›¾åƒè¿›è¡Œæ£€æµ‹ã€‚</p></blockquote><pre class="jf jg jh ji fd lw lx ly lz aw ma bi"><span id="2f65" class="jq jr hi lx b fi mb mc l md me">Percentage of <em class="jd">dogs detected in human image data</em>(incorrect detections): 1.0%<br/>Percentage of <em class="jd">dogs detected in dog image data</em>: 100.0%</span></pre><p id="7ae0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä½ å¯ä»¥å°è¯•ä¸åŒçš„æ¶æ„ï¼Œæ¯”å¦‚Inception-v3ã€ResNetsã€GoogleNetç­‰ç­‰</p></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h2 id="6cce" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated">æ•°æ®åŠ è½½å™¨</h2><p id="23ed" class="pw-post-body-paragraph if ig hi ih b ii kl ik il im km io ip iq kn is it iu ko iw ix iy kp ja jb jc hb bi translated">æˆ‘ä»¬éœ€è¦ä¸ºè®­ç»ƒæ¨¡å‹å‡†å¤‡æ•°æ®ã€‚æˆ‘å·²ç»æŒ‰ç…§è®­ç»ƒå’Œæµ‹è¯•æˆ‘ä»¬çš„æ¨¡å‹æ‰€éœ€çš„æ ¼å¼æ‰§è¡Œäº†æ•°æ®è§„èŒƒåŒ–ã€æ‹†åˆ†å’Œæ’åˆ—ï¼åœ¨è®­ç»ƒä½ çš„ç¥ç»ç½‘ç»œæ—¶ï¼Œæ•°æ®æ‰©å……æ˜¯ä¸€ä¸ªé‡è¦çš„å› ç´ ï¼Œè¿™ä¸ºä½ çš„æ¨¡å‹å¢åŠ äº†æ›´å¤šçš„é²æ£’æ€§ï¼Œå¹¶ä½¿å®ƒä»æˆ‘ä»¬æ•°æ®çš„ä¸åŒå˜åŒ–ä¸­å­¦ä¹ ã€‚åŸºæœ¬ä¸Šï¼Œæ•°æ®æ‰©å……æœ‰åŠ©äºå¢åŠ æ•°æ®çš„å˜åŒ–ã€‚ç»™å‡ºäº†ç”Ÿæˆæ•°æ®åŠ è½½å™¨çš„ä»£ç ã€‚</p><pre class="jf jg jh ji fd lw lx ly lz aw ma bi"><span id="c856" class="jq jr hi lx b fi mb mc l md me"><strong class="lx hj">import</strong> <strong class="lx hj">os</strong><br/><strong class="lx hj">from</strong> <strong class="lx hj">torchvision</strong> <strong class="lx hj">import</strong> <strong class="lx hj">datasets</strong><br/><strong class="lx hj">import</strong> <strong class="lx hj">torchvision.transforms</strong> <strong class="lx hj">as</strong> <strong class="lx hj">transforms</strong></span><span id="0bb9" class="jq jr hi lx b fi mg mc l md me"><em class="jd">data_dir</em> = '/data/dog_images/'<br/><em class="jd">train_dir</em> = os.path.join(data_dir, 'train/')<br/><em class="jd">valid_dir</em> = os.path.join(data_dir, 'valid/')<br/><em class="jd">test_dir</em> = os.path.join(data_dir, 'test/')</span><span id="ca52" class="jq jr hi lx b fi mg mc l md me"><em class="jd">normalize</em> = transforms.Normalize(mean=[0.485, 0.456, 0.406],<br/>                                 std=[0.229, 0.224, 0.225])</span><span id="8b2e" class="jq jr hi lx b fi mg mc l md me"><em class="jd">preprocess_data</em> = {'train': transforms.Compose([<br/>                                 transforms.RandomResizedCrop(224),<br/>                                 transforms.RandomHorizontalFlip(),<br/>                                 transforms.ToTensor(),<br/>                                 normalize]),<br/>                   'valid': transforms.Compose([<br/>                                 transforms.Resize(256),<br/>                                 transforms.CenterCrop(224),<br/>                                 transforms.ToTensor(),<br/>                                 normalize]),<br/>                   'test': transforms.Compose([<br/>                                 transforms.Resize(size=(224,224)),<br/>                                 transforms.ToTensor(), <br/>                                 normalize])}</span><span id="bb40" class="jq jr hi lx b fi mg mc l md me"><em class="jd">train_data</em> = datasets.ImageFolder(<br/>                          train_dir, <br/>                          transform=preprocess_data['train'])<br/><em class="jd">valid_data</em> = datasets.ImageFolder(<br/>                          valid_dir,<br/>                          transform=preprocess_data['valid'])<br/><em class="jd">test_data</em> = datasets.ImageFolder(<br/>                          test_dir, <br/>                          transform=preprocess_data['test'])</span><span id="2c16" class="jq jr hi lx b fi mg mc l md me"><strong class="lx hj"><em class="jd">batch_size</em></strong> = 20<br/><em class="jd">num_workers</em> = 0<br/><strong class="lx hj"><em class="jd">train_loader</em></strong> = torch.utils.data.DataLoader(train_data,<br/>                                           batch_size=batch_size, <br/>                                           num_workers=num_workers,<br/>                                           shuffle=<strong class="lx hj">True</strong>)<br/><strong class="lx hj"><em class="jd">valid_loader</em></strong> = torch.utils.data.DataLoader(valid_data,<br/>                                           batch_size=batch_size, <br/>                                           num_workers=num_workers,<br/>                                           shuffle=<strong class="lx hj">False</strong>)<br/><strong class="lx hj"><em class="jd">test_loader</em></strong> = torch.utils.data.DataLoader(test_data,<br/>                                           batch_size=batch_size, <br/>                                           num_workers=num_workers,<br/>                                           shuffle=<strong class="lx hj">False</strong>)<br/><strong class="lx hj"><em class="jd">loaders_scratch</em></strong> = {<br/>    'train': train_loader,<br/>    'valid': valid_loader,<br/>    'test': test_loader<br/>}</span></pre><p id="fb7b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¿™æ ·ç°åœ¨æˆ‘ä»¬å°±æœ‰äº†<strong class="ih hj"> <em class="jd">ã€è®­ç»ƒ_åŠ è½½å™¨ã€‘</em></strong><strong class="ih hj"><em class="jd">æœ‰æ•ˆ_åŠ è½½å™¨</em> </strong>å’Œ<strong class="ih hj"> <em class="jd">æµ‹è¯•_åŠ è½½å™¨</em> </strong>ï¼Œæ•°æ®æŒ‰ç…§å®šä¹‰çš„<em class="jd">é¢„å¤„ç†</em>å’Œ<em class="jd">æ•°æ®æ‰©å……</em>æ­¥éª¤æ‰¹é‡å­˜å‚¨ã€‚æ•°æ®å‡†å¤‡ä¸­æ‰§è¡Œçš„æ­¥éª¤è¯´æ˜:</p><ul class=""><li id="1871" class="lf lg hi ih b ii ij im in iq lo iu lp iy lq jc lk ll lm ln bi translated">æˆ‘å¯¹<em class="jd">è®­ç»ƒæ•°æ®</em>ä½¿ç”¨äº†<strong class="ih hj"><em class="jd">randomresizedcrop</em></strong>ï¼Œå®ƒå°†æ‰€æœ‰è®­ç»ƒå›¾åƒçš„å¤§å°è°ƒæ•´ä¸º(224ï¼Œ224)ï¼Œå®ƒè¿˜å¯¹åŸå§‹å›¾åƒè¿›è¡Œäº†éšæœºè£å‰ªï¼Œä»¥ä¾¿æˆ‘ä»¬çš„æ¨¡å‹èƒ½å¤Ÿå­¦ä¹ æ•°æ®ä¸­çš„å¤æ‚å˜åŒ–ã€‚æˆ‘å·²ç»ä½¿ç”¨<strong class="ih hj"><em class="jd">RandomHorizontalFlip</em></strong>(p = . 5)æ°´å¹³ç¿»è½¬äº†æ•°æ®ï¼Œè¿™å°†æ°´å¹³ç¿»è½¬ä¸€åŠå›¾åƒï¼Œä»¥ç»™åŸå§‹è®­ç»ƒæ•°æ®æ·»åŠ æ›´å¤šå˜åŒ–ã€‚trainæ–‡ä»¶å¤¹ä¸­å‡ ä¹æ‰€æœ‰çš„å›¾åƒéƒ½æ˜¯ç›´çš„(ç‹—ä»¥ç›´çš„æ–¹å¼æ’åˆ—),æ‰€ä»¥ä½¿ç”¨æ°´å¹³ç¿»è½¬è€Œä¸æ˜¯å‚ç›´ç¿»è½¬æ›´æ˜æ™ºã€‚æˆ‘è¿˜ä½¿ç”¨<strong class="ih hj"> <em class="jd">æ ‡å‡†å½’ä¸€åŒ–</em> </strong>å½’ä¸€åŒ–äº†å›¾åƒä¸­çš„æ‰€æœ‰é€šé“ã€‚</li><li id="bf28" class="lf lg hi ih b ii lr im ls iq lt iu lu iy lv jc lk ll lm ln bi translated">ä½¿ç”¨å¤§å°ä¸º(224ï¼Œ224)çš„<strong class="ih hj"> <em class="jd">ä¸­å¿ƒè£å‰ª</em> </strong>ç”¨äº<em class="jd">éªŒè¯æ•°æ®</em>ï¼Œå› ä¸ºå¤§å¤šæ•°å›¾åƒçš„ä¸­å¿ƒéƒ½æœ‰ä¸€å¼ ç‹—è„¸ï¼Œå› æ­¤è¿™å°†æœ‰åŠ©äºæé«˜éªŒè¯çš„å‡†ç¡®æ€§ï¼</li><li id="14c4" class="lf lg hi ih b ii lr im ls iq lt iu lu iy lv jc lk ll lm ln bi translated"><strong class="ih hj"> <em class="jd">è°ƒæ•´å¤§å°</em> </strong> <em class="jd">æµ‹è¯•å›¾åƒ</em>åˆ°(224ï¼Œ224)<em class="jd">è¿™é‡Œæ²¡æœ‰åšå…¶ä»–å˜æ¢</em>ï¼Œå› ä¸ºæˆ‘ä»¬å°†åœ¨åŸå§‹æ•°æ®ä¸Šæµ‹è¯•æˆ‘ä»¬çš„æ¨¡å‹</li></ul></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h2 id="fd17" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated">çŠ¬ç§åˆ†ç±»</h2><p id="d8ba" class="pw-post-body-paragraph if ig hi ih b ii kl ik il im km io ip iq kn is it iu ko iw ix iy kp ja jb jc hb bi translated">ä¸ºäº†è¿™ä¸ªä»»åŠ¡ï¼Œè®©æˆ‘ä»¬åœ¨<em class="jd"> Pytorch </em>ä¸­ä»å¤´å¼€å§‹æ„å»ºæˆ‘ä»¬è‡ªå·±çš„<em class="jd">CNN</em>ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªReluæ¿€æ´»çš„3å±‚CNNã€‚å¯¹æ¯ä¸€å±‚ä½¿ç”¨ä¸åŒçš„å†…æ ¸å¤§å°ã€æ­¥å¹…ã€å¡«å……å’Œæœ€å¤§æ± ï¼ŒåŸå§‹å›¾åƒçš„å¤§å°(224ï¼Œ224)å·²å‡å°‘åˆ°(7ï¼Œ7)ï¼ŒåŸå§‹æ·±åº¦3å·²è½¬æ¢ä¸º128: (224ï¼Œ224ï¼Œ3) <strong class="ih hj"> - &gt; </strong> (7ï¼Œ7ï¼Œ128)ã€‚è¿™æ ·æˆ‘ä»¬å°±ä»ç»™å®šçš„å›¾åƒä¸­æå–å‡ºäº†ç©ºé—´ç‰¹å¾ï¼æˆ‘ä»¬å¢åŠ æ·±åº¦æˆ–æ·»åŠ æ›´å¤šè¿‡æ»¤å™¨ï¼Œä»¥ä¾¿ç½‘ç»œå¯ä»¥å­¦ä¹ å›¾åƒä¸­æ›´é‡è¦çš„ç‰¹å¾ï¼Œå¹¶æ›´å¥½åœ°è¿›è¡Œå½’çº³ã€‚</p><blockquote class="mh mi mj"><p id="88d7" class="if ig jd ih b ii ij ik il im in io ip mk ir is it ml iv iw ix mm iz ja jb jc hb bi translated">æ¨¡å‹æ¶æ„:</p></blockquote><pre class="jf jg jh ji fd lw lx ly lz aw ma bi"><span id="ad85" class="jq jr hi lx b fi mb mc l md me"><strong class="lx hj">import</strong> <strong class="lx hj">torch.nn</strong> <strong class="lx hj">as</strong> <strong class="lx hj">nn</strong><br/><strong class="lx hj">import</strong> <strong class="lx hj">torch.nn.functional</strong> <strong class="lx hj">as</strong> <strong class="lx hj">F</strong></span><span id="1a9d" class="jq jr hi lx b fi mg mc l md me"><em class="jd"># define the CNN architecture</em><br/><strong class="lx hj">class</strong> <strong class="lx hj">Net</strong>(nn.Module):<br/>    <strong class="lx hj">def</strong> __init__(self):<br/>        super(Net, self).__init__()<br/>        <em class="jd"># Conv Layers</em><br/>        self.conv1 = nn.Conv2d(3, 32, 3, stride=2, padding=1)<br/>        self.conv2 = nn.Conv2d(32, 64, 3, stride=2, padding=1)<br/>        self.conv3 = nn.Conv2d(64, 128, 3, padding=1)<br/>        <em class="jd"># maxpool</em><br/>        self.pool = nn.MaxPool2d(2, 2)<br/>        <em class="jd"># fc layers</em><br/>        self.fc4 = nn.Linear(7*7*128, 2048)<br/>        self.fc5 = nn.Linear(2048, 512)<br/>        self.fc6 = nn.Linear(512, 133)    <em class="jd">#number of classes = 133</em><br/>        <em class="jd"># dropout </em><br/>        self.dropout = nn.Dropout(0.25)    <em class="jd">#dropout of 0.25</em><br/>        <em class="jd"># batchNorm layers</em><br/>        self.batch_norm = nn.BatchNorm1d(512)<br/>    <br/>    <strong class="lx hj">def</strong> forward(self, x):<br/>        <em class="jd">## Define forward behavior</em><br/>        x = F.relu(self.conv1(x))<br/>        x = self.pool(x)<br/>        x = F.relu(self.conv2(x))<br/>        x = self.pool(x)<br/>        x = F.relu(self.conv3(x))<br/>        x = self.pool(x)<br/>        <br/>        <em class="jd"># flatten</em><br/>        x = x.view(-1, 7*7*128)<br/>        x = self.dropout(x)<br/>        x = F.relu(self.fc4(x))<br/>        x = self.dropout(x)<br/>        x = F.relu(self.batch_norm(self.fc5(x)))<br/>        x = self.dropout(x)<br/>        x = self.fc6(x)<br/>        <strong class="lx hj">return</strong> x</span><span id="942f" class="jq jr hi lx b fi mg mc l md me"><em class="jd"># instantiate the CNN</em><br/>model_scratch = Net()</span><span id="f000" class="jq jr hi lx b fi mg mc l md me"><em class="jd"># move tensors to GPU if CUDA is available</em><br/><strong class="lx hj">if</strong> use_cuda:<br/>    model_scratch.cuda()</span></pre><p id="3f20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä½¿ç”¨äº†<strong class="ih hj"> <em class="jd">äº¤å‰ç†µæŸå¤±</em> </strong>ä½œä¸º<strong class="ih hj"> <em class="jd"> </em> </strong>ä¸€ä¸ª<strong class="ih hj"> <em class="jd">ä»£ä»·å‡½æ•°</em> </strong>å’Œ<strong class="ih hj"> <em class="jd">äºšå½“</em> </strong>ä½œä¸º<strong class="ih hj"> <em class="jd">ä¼˜åŒ–å™¨</em> </strong>ï¼Œä½ å¯ä»¥åœ¨<strong class="ih hj"> PyTorch </strong> <a class="ae kx" href="https://pytorch.org/docs/stable/nn.html#loss-functions" rel="noopener ugc nofollow" target="_blank"> <em class="jd">è¿™é‡Œ</em> </a>å’Œå„ç§ä¼˜åŒ–å™¨ä¸­é˜…è¯»æ›´å¤šå…³äºäº¤å‰ç†µæŸå¤±çš„å®ç°</p><p id="8a99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨ä½äºç‹—å›¾åƒæ•°æ®é›†ä¸­çš„è®­ç»ƒæ•°æ®ä¸Šä»¥æ‰¹é‡å¤§å°20è®­ç»ƒäº†50ä¸ªæ—¶æœŸä¹‹åï¼Œæˆ‘å¾—åˆ°äº†`<strong class="ih hj"> <em class="jd">è®­ç»ƒæŸå¤±</em></strong><em class="jd">:</em><strong class="ih hj"><em class="jd">4.1504</em></strong>å’Œ`<strong class="ih hj"> <em class="jd">éªŒè¯æŸå¤±</em></strong><em class="jd">:</em><strong class="ih hj"><em class="jd">3.7211</em></strong></p><blockquote class="mh mi mj"><p id="8adb" class="if ig jd ih b ii ij ik il im in io ip mk ir is it ml iv iw ix mm iz ja jb jc hb bi translated"><strong class="ih hj">è¯¥è½¦å‹(model_scratch)åœ¨æµ‹è¯•æ•°æ®ä¸Šçš„è¡¨ç°</strong>:</p></blockquote><pre class="jf jg jh ji fd lw lx ly lz aw ma bi"><span id="ab29" class="jq jr hi lx b fi mb mc l md me">Test Loss: 3.820199<br/>Test Accuracy: 10% (89/836)</span></pre><p id="9cdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ¥ä¸‹æ¥ï¼Œä¸ºäº†èŠ‚çœæ—¶é—´å¹¶è·å¾—æ›´å¥½çš„æ€§èƒ½ï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨<em class="jd">è½¬ç§»å­¦ä¹ </em>å’Œ<strong class="ih hj"> <em class="jd">å¾®è°ƒ</em> </strong>æˆ‘ä»¬è®­ç»ƒæ•°æ®ä¸Šè½¬ç§»çš„æ¨¡å‹æƒé‡ã€‚<strong class="ih hj"> <em class="jd"> ResNet-101 </em> </strong>è¢«é€‰ä¸ºæœ¬æ¬¡<em class="jd">åˆ†ç±»ä»»åŠ¡</em>çš„<strong class="ih hj"> <em class="jd"> </em> </strong>ã€‚</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es mq"><img src="../Images/cb4e9a74e4e85bc3bcaf856c01444e54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sgm2uv_luh1Ak2FnAmdtCw.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx translated"><strong class="bd js">å‰©ä½™å—ï¼Œæ˜¾ç¤ºè·³è¿‡è¿æ¥ï¼</strong></figcaption></figure><p id="94cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">é€‰æ‹©ResNet </em>çš„ç†ç”±:</p><ul class=""><li id="c437" class="lf lg hi ih b ii ij im in iq lo iu lp iy lq jc lk ll lm ln bi translated">ä¼—æ‰€å‘¨çŸ¥ï¼ŒResNetsåœ¨å›¾åƒåˆ†ç±»ä¸­è¡¨ç°çªå‡ºã€‚ResNetæ˜¯ç”¨â€œ<strong class="ih hj"> <em class="jd">â€å‰©ä½™å—</em> </strong>æ„å»ºçš„ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯å±‚é—´çš„<em class="jd">è·³è¿‡è¿æ¥</em>ã€‚è¿™åœ¨åˆå§‹å±‚å’Œæœ€ç»ˆå±‚ä¹‹é—´åˆ›å»ºäº†ä¸€ä¸ª<em class="jd">èº«ä»½è¿æ¥</em>ï¼Œé™ä½äº†<em class="jd">æ¶ˆå¤±å’Œçˆ†å‘æ¢¯åº¦é—®é¢˜</em>çš„é£é™©ï¼Œè¿™ä¹Ÿæœ‰åŠ©äºé™ä½è®­ç»ƒæ•°æ®ä¸Š<em class="jd">æ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆ</em>çš„é£é™©ï¼Resnet101æ˜¯ä¸€ä¸ª101å±‚æ·±åº¦ç¥ç»ç½‘ç»œï¼Œå› æ­¤ä»å›¾åƒä¸­æ•è·<em class="jd">ç²’åº¦ç©ºé—´ä¿¡æ¯</em>ã€‚CNNä¸ºæ¯å¹…è¾“å…¥å›¾åƒæä¾›äº†æ›´å¥½çš„ç‰¹å¾è¡¨ç¤ºï¼Œæ®‹å·®å—äº§ç”Ÿçš„èº«ä»½è¿æ¥ä½¿å¾—æ¢¯åº¦æµå˜å¾—å®¹æ˜“ï¼Œå› æ­¤ResNetæœ‰åŠ©äºæé«˜åˆ†ç±»ä»»åŠ¡</li><li id="89bc" class="lf lg hi ih b ii lr im ls iq lt iu lu iy lv jc lk ll lm ln bi translated">æˆ‘è¿˜å°†<em class="jd">é¢„è®­ç»ƒResnet </em>çš„<strong class="ih hj"> <em class="jd">ç§»é™¤äº†</em></strong><strong class="ih hj"><em class="jd">æœ€åä¸€ä¸ªå…¨è¿æ¥å±‚</em> </strong>ï¼Œå¹¶åœ¨æœ€åæ·»åŠ äº†æˆ‘ä»¬çš„<strong class="ih hj">è‡ªå®šä¹‰</strong> <em class="jd">å…¨è¿æ¥</em>ï¼Œè¿™æ˜¯ä¸ºäº†è¾“å‡º<strong class="ih hj"><em class="jd">133</em></strong><strong class="ih hj"><em class="jd">å¤§å°çš„çŸ¢é‡</em> </strong>ã€‚</li></ul><blockquote class="mh mi mj"><p id="e2b7" class="if ig jd ih b ii ij ik il im in io ip mk ir is it ml iv iw ix mm iz ja jb jc hb bi translated">æ¨¡å‹æ¶æ„:</p></blockquote><pre class="jf jg jh ji fd lw lx ly lz aw ma bi"><span id="cc0a" class="jq jr hi lx b fi mb mc l md me"><strong class="lx hj">import</strong> <strong class="lx hj">torchvision.models</strong> <strong class="lx hj">as</strong> <strong class="lx hj">models</strong><br/><strong class="lx hj">import</strong> <strong class="lx hj">torch.nn</strong> <strong class="lx hj">as</strong> <strong class="lx hj">nn</strong></span><span id="313a" class="jq jr hi lx b fi mg mc l md me"><em class="jd">model_transfer</em> = models.resnet101(pretrained=<strong class="lx hj">True</strong>)</span><span id="07e1" class="jq jr hi lx b fi mg mc l md me"><strong class="lx hj">for</strong> param <strong class="lx hj">in</strong> model_transfer.parameters():<br/>    param.requires_grad = <strong class="lx hj">False</strong></span><span id="a8d1" class="jq jr hi lx b fi mg mc l md me"><em class="jd">#replacing last fc with custom fully-connected layer which should output 133 sized vector</em><br/><strong class="lx hj"><em class="jd">model_transfer.fc</em></strong><em class="jd"> = nn.Linear(2048, 133, bias=</em><strong class="lx hj"><em class="jd">True</em></strong><em class="jd">)</em></span><span id="33ef" class="jq jr hi lx b fi mg mc l md me"><em class="jd">#extracting fc parameters</em><br/>fc_parameters = model_transfer.fc.parameters()         <br/><strong class="lx hj">for</strong> param <strong class="lx hj">in</strong> fc_parameters:<br/>    param.requires_grad = <strong class="lx hj">True</strong></span></pre><p id="a1cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨è®­ç»ƒäº†ä»…ä»…20ä¸ªå†å…ƒä¹‹åï¼Œæ‰¹é‡å¤§å°ä¸º20çš„è®­ç»ƒæ•°æ®ä½äºç‹—å›¾åƒæ•°æ®é›†ä¸­ï¼Œå…¶`<em class="jd">è®­ç»ƒæŸå¤±=</em><strong class="ih hj"><em class="jd">1.4732</em></strong>å’Œ`<em class="jd">éªŒè¯æŸå¤±=</em><strong class="ih hj"><em class="jd">0.9333</em></strong>`ã€‚å¦‚æœè®­ç»ƒæ›´å¤šçš„çºªå…ƒï¼ŒæŸå¤±å°†å‡å°‘ï¼Œæ¨¡å‹å°†ä»æ•°æ®ä¸­å­¦ä¹ å°½å¯èƒ½å¤šçš„ä¸œè¥¿ï¼</p><blockquote class="mh mi mj"><p id="ecf5" class="if ig jd ih b ii ij ik il im in io ip mk ir is it ml iv iw ix mm iz ja jb jc hb bi translated"><strong class="ih hj">æ¨¡å‹æ€§èƒ½</strong>æµ‹è¯•æ•°æ®:æˆ‘é€‰æ‹©äº†<strong class="ih hj">ç²¾åº¦</strong>å’Œ<strong class="ih hj">å¬å›</strong>æ•°ä½œä¸ºè¯„ä»·æŒ‡æ ‡ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬çš„æ•°æ®æœ‰ä¸å¹³è¡¡ï¼Œç²¾ç¡®å›å¿†æ€»æ˜¯ç»™æˆ‘ä»¬ä¸€ä¸ªå¾ˆå¥½çš„æ¨¡å‹æ€§èƒ½æ¦‚è¿°ï¼</p></blockquote><pre class="jf jg jh ji fd lw lx ly lz aw ma bi"><span id="6d77" class="jq jr hi lx b fi mb mc l md me">from <strong class="lx hj">sklearn.metrics</strong> import <strong class="lx hj">confusion_matrix</strong>, <strong class="lx hj">precision_recall_fscore_support</strong></span><span id="09ea" class="jq jr hi lx b fi mg mc l md me"><em class="jd">cm</em> = <strong class="lx hj">confusion_matrix</strong>(ground_truths, predictions)</span><span id="8ddc" class="jq jr hi lx b fi mg mc l md me"><strong class="lx hj"><em class="jd">precision</em></strong> = np.mean(<strong class="lx hj">precision_recall_fscore_support</strong>(ground_truths, predictions)[0])</span><span id="9e8d" class="jq jr hi lx b fi mg mc l md me"><strong class="lx hj"><em class="jd">recall</em></strong> = np.mean(<strong class="lx hj">precision_recall_fscore_support</strong>(ground_truths, predictions)[1])</span></pre><blockquote class="mr"><p id="0d84" class="ms mt hi bd mu mv mw mx my mz na jc dx translated">å“ç§åˆ†ç±»å™¨ç²¾åº¦æ•°:<em class="nb"> 0.8039343488 </em></p><p id="c4a2" class="ms mt hi bd mu mv nc nd ne nf ng jc dx translated">å“ç§åˆ†ç±»å™¨å¬å›ç¼–å·:<em class="nb"> 0.78137904284 </em></p></blockquote><p id="00e5" class="pw-post-body-paragraph if ig hi ih b ii nh ik il im ni io ip iq nj is it iu nk iw ix iy nl ja jb jc hb bi translated">ä¸‹é¢ç»™å‡ºäº†æ‰€æœ‰æµ‹è¯•æ•°æ®é¢„æµ‹çš„æ··æ·†çŸ©é˜µï¼Œä¸å®¹æ˜“é˜…è¯»/å¯è§†åŒ–ï¼Œä½†æ‚¨å¯ä»¥é›†ä¸­åœ¨ä¸€äº›æš—ç‚¹ä¸Šï¼Œåœ¨é‚£é‡Œæ‚¨å¯ä»¥åˆ†æåœ¨å…¶ä»–ç±»ä¸­è¢«é”™è¯¯åˆ†ç±»çš„ç±»ã€‚</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es nm"><img src="../Images/8494147eba477415f2f3c39d4066c988.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*gKbfwOS1Pv2KalADSJoXEQ.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">æ··æ·†çŸ©é˜µ</figcaption></figure></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h2 id="f127" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated">ç»“æœ</h2><p id="be91" class="pw-post-body-paragraph if ig hi ih b ii kl ik il im km io ip iq kn is it iu ko iw ix iy kp ja jb jc hb bi translated">ç°åœ¨æ˜¯æµ‹è¯•æˆ‘ä»¬çš„å·¥ä½œæµç¨‹(è¿·ä½ ç®¡é“)çš„æ—¶å€™äº†ï¼ä¸‹é¢æ˜¯æˆ‘ä»¬çš„å·¥ä½œæµç¨‹äº§ç”Ÿçš„ä¸€äº›æœ‰è¶£çš„ç»“æœï¼ä¹‹å‰æ¨¡å‹çœ‹ä¸åˆ°ä»»ä½•å›¾åƒ(çœŸå®ä¸–ç•Œç”¨æˆ·æä¾›çš„å›¾åƒ)ã€‚</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es nn"><img src="../Images/570b350cfdd137306ea01b32aafc48b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*ahKrI5xL-LDHwIqobbTXSA.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated"><strong class="bd js">å®Œå…¨è¯†åˆ«çš„ç‹—ï¼Œå…·æœ‰æ­£ç¡®çš„å“ç§åˆ†ç±»</strong></figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es no"><img src="../Images/76c44404059592db96a346190781386f.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*igTHL0_T5VfQT1IFEIidPA.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated"><strong class="bd js">ç‹—ç‹—å“ç§åˆ†ç±»çš„æç¬‘ç¼–è¾‘ç‹—å½¢è±¡ï¼</strong></figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/b27c2d88ece12c08613758a3d6dfd993.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*Lgl_gdw_mJbuJoXyt7WDpQ.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated"><strong class="bd js">å®Œå…¨è¯†åˆ«çš„ç‹—ï¼Œå…·æœ‰æ­£ç¡®çš„å“ç§åˆ†ç±»</strong></figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es np"><img src="../Images/f9e7cc9006c66c34869b4e7a6cb4b8a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*vzE5UT6VCwbCz12pNp5KNw.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated"><strong class="bd js">å®Œç¾çš„äººè„¸è¯†åˆ«ï¼Œäº§ç”Ÿæœ€åƒç‹—çš„å“ç§ï¼</strong></figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es nq"><img src="../Images/e03c07a3074e6b3ec303e62c151ea0c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*GGNe6ltxu4COeuNLMMkmsg.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated">æ²¡æœ‰æ£€æµ‹åˆ°ä»»ä½•ä¸œè¥¿ï¼é”™è¯¯æ£€æµ‹ï¼Œäººç±»å­˜åœ¨ã€‚</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es nr"><img src="../Images/cb36b80f4467d277897b870757931dba.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*N_1qysIIDudGzkiuYQJOQA.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated"><strong class="bd js">å®Œå…¨è¯†åˆ«çš„ç‹—ï¼Œå“ç§åˆ†ç±»æ­£ç¡®</strong></figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ns"><img src="../Images/e94d72ae6102bc8f85d781249357c481.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*PhykrSwi8L2cNNvGVQUxEA.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx translated"><strong class="bd js">æ²¡æœ‰æ£€æµ‹åˆ°ä»»ä½•ä¸œè¥¿ï¼å¤ªæ£’äº†ï¼</strong></figcaption></figure></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h2 id="2a43" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated">ä¸°å¯Œ</h2><ul class=""><li id="672b" class="lf lg hi ih b ii kl im km iq lh iu li iy lj jc lk ll lm ln bi translated">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯¹æ›´å¤šæ•°æ®è¿›è¡ŒåŸ¹è®­ä¼šæœ‰æ‰€å¸®åŠ©ï¼Œè€Œä¸”æ•°æ®çš„<em class="jd">å¢åŠ </em>å¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©ï¼Œä¾‹å¦‚è£å‰ªå›¾åƒä»¥çº æ­£åŒºåŸŸå¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©ã€‚</li><li id="1f05" class="lf lg hi ih b ii lr im ls iq lt iu lu iy lv jc lk ll lm ln bi translated">åœ¨dog_images/trainä¸­æ‹¥æœ‰å®Œç¾çš„æ ‡ç­¾å’Œæ›´å¤šçš„æ•°æ®è‚¯å®šä¼šæœ‰æ‰€å¸®åŠ©ã€‚è¿˜æ‰‹åŠ¨æ·»åŠ ä¸€äº›<em class="jd">å˜åŒ–</em> ( <em class="jd">å™ªå£°</em>)åˆ°æ•°æ®ä¸­ï¼Œä¾‹å¦‚æ·»åŠ è™šå‡å›¾åƒæˆ–åœ¨äººç±»æ•°æ®é›†ä¸­çœ‹èµ·æ¥åƒç‹—çš„äººç±»å›¾åƒã€‚</li><li id="6b1d" class="lf lg hi ih b ii lr im ls iq lt iu lu iy lv jc lk ll lm ln bi translated"><em class="jd">è¶…å‚æ•°è°ƒæ•´</em>æ€»æ˜¯æœ‰å¸®åŠ©çš„ï¼:)</li><li id="1ba2" class="lf lg hi ih b ii lr im ls iq lt iu lu iy lv jc lk ll lm ln bi translated">ä½¿ç”¨ä¸€ä¸ªæ›´å¼ºå¤§çš„é¢„å…ˆè®­ç»ƒè¿‡çš„æ¨¡å‹å¯èƒ½ä¹Ÿä¼šæœ‰æ‰€å¸®åŠ©ï¼</li></ul></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h2 id="6016" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated"><strong class="ak">ç»“è®º</strong></h2><p id="ab4c" class="pw-post-body-paragraph if ig hi ih b ii kl ik il im km io ip iq kn is it iu ko iw ix iy kp ja jb jc hb bi translated">æˆ‘è¦æ¢ç´¢å¤§èŒƒå›´çš„æ•°æ®ã€‚æ‘†å¼„æ•°æ®å’Œä»é›¶å¼€å§‹åˆ›å»ºæ¨¡å‹éå¸¸æœ‰è¶£ï¼CNNæ˜¯æœºå™¨å­¦ä¹ é¢†åŸŸçš„é‡è¦å‘æ˜ã€‚éœ€è¦æ³¨æ„çš„ä¸€ä¸ªè¦ç‚¹æ˜¯ï¼Œç°ä»£æ·±åº¦å­¦ä¹ æ¡†æ¶å¦‚ä½•ä½¿æˆ‘ä»¬çš„å·¥ä½œå˜å¾—ç®€å•ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å°‘é‡(éå¸¸å°‘)è¡Œä»£ç æ¥è®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹ã€‚ç”¨è¿‡PyTorchï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„ç¼–ç¨‹æ¡†æ¶ï¼å¿…é¡»äº†è§£è¿ç§»å­¦ä¹ å¦‚ä½•åœ¨æˆ‘ä»¬çš„åº”ç”¨ä¸­å¸®åŠ©æˆ‘ä»¬ã€‚</p><p id="f2d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¦ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„æœ‰è¶£çš„äº‹æƒ…æ˜¯ï¼Œä¸€ä¸ªè®­ç»ƒæœ‰ç´ çš„æ¨¡å‹(æœºå™¨)æœ‰æ—¶åœ¨æ¦‚æ‹¬ç‰¹å¾æ–¹é¢ç”šè‡³æ¯”äººåšå¾—æ›´å¥½ã€‚</p></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><p id="b8ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¦‚æœä½ è§‰å¾—æˆ‘çš„<a class="ae kx" href="https://github.com/s-nilesh/Dog-Breed-Classifier" rel="noopener ugc nofollow" target="_blank">ä»£ç </a>æœ‰ç”¨å¹¶æå‡ºæ”¹è¿›å»ºè®®ï¼Œè¯·éšæ„ä½¿ç”¨ã€‚è¯·é¼“æŒï¼Œè°¢è°¢ï¼</p></div></div>    
</body>
</html>