<html>
<head>
<title>Setting Up Local Spark Development Environment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">建立本地Spark开发环境</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/setting-up-local-spark-development-environment-41fc6e91b426?source=collection_archive---------17-----------------------#2020-01-02">https://medium.com/analytics-vidhya/setting-up-local-spark-development-environment-41fc6e91b426?source=collection_archive---------17-----------------------#2020-01-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/98ef6df7881d92dc3c95273085156ac2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*X8jqJp0tiWdHWuFQ"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">萨法尔·萨法罗夫在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="1d56" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">本文档描述了如何在本地机器上设置数据工程师的开发环境，以便在不需要任何云基础设施的情况下进行本地数据开发和测试。</p><p id="28e7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 1。安装和配置智能集成开发环境:</strong></p><p id="09df" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从<a class="ae iu" href="https://www.jetbrains.com/idea/download/" rel="noopener ugc nofollow" target="_blank">https://www.jetbrains.com/idea/download/</a>下载IntelliJ社区版，复制到一个像~/software/这样的文件夹。</p><p id="9db6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用所有默认设置安装下载的IntelliJ软件。出现提示时，将软件移至“应用程序”(适用于Mac安装)</p><h2 id="2119" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">2.安装和配置git:</h2><p id="be75" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">对于Mac用户来说，安装git最简单的方法是使用“自制”软件包管理器。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="33c7" class="jt ju hi ky b fi lc ld l le lf">brew install git</span></pre><p id="46fc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">否则git软件可以从<a class="ae iu" href="http://www.git-scm.com/" rel="noopener ugc nofollow" target="_blank">www.git-scm.com</a>安装并手动安装。</p><h2 id="f2a5" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">3.为github配置SSH密钥对:</h2><p id="26ca" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">Github(或Stash/Gitlab等。)可以用作git的存储库管理器。Git库可以在https://github.com/xxx/<a class="ae iu" href="https://github.com/xxx/" rel="noopener ugc nofollow" target="_blank">查看。但是要从github克隆或拉一个存储库到本地，需要建立一个SSH隧道。也可以使用带有https的Git存储库链接，但这需要在每次与github交互时进行身份验证，这很烦人。</a></p><p id="eb2b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是创建SSH密钥对并将其添加到~/的步骤。ssh文件夹。这将创建一个ssh密钥对、一个私钥文件(id_rsa)和一个公钥文件(id_rsa.pub)</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="2127" class="jt ju hi ky b fi lc ld l le lf">ssh-keygen -t rsa -C “your_email@xxx.com”</span><span id="935d" class="jt ju hi ky b fi lg ld l le lf">ssh-add ~/.ssh/id_rsa</span></pre><figure class="kt ku kv kw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/cef66e689161217cca0370a393e07d52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4w_YHKp3xpPS2-Y20r5NBA.png"/></div></div></figure><p id="9da6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从id_rsa.pub复制公钥，粘贴到<a class="ae iu" href="https://github.com/settings/keys" rel="noopener ugc nofollow" target="_blank"> github </a>中，如下图所示。</p><h2 id="c85e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">4.下载Apache Spark:</h2><p id="a7fd" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">从<a class="ae iu" href="https://spark.apache.org/downloads.html" rel="noopener ugc nofollow" target="_blank">https://spark.apache.org/downloads.html</a>下载Apache Spark版本2.0.2(或更高版本)，使用选项“为Apache Hadoop 2.7和更高版本预构建”。</p><p id="21ce" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用Mac终端解压缩下载的文件</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="ae50" class="jt ju hi ky b fi lc ld l le lf">tar -xzvf spark-2.0.2-bin-hadoop2.7.tgz</span></pre><p id="d8d2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将提取的文件夹复制到如下位置:~/software/</p><h2 id="8676" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">5.下载并安装Java SDK:</h2><p id="4fe7" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">从<a class="ae iu" href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" rel="noopener ugc nofollow" target="_blank">http://www . Oracle . com/tech network/Java/javase/downloads/JDK 8-downloads-2133151 . html</a>下载并安装Java SDK 8</p><p id="211f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">选择合适的操作系统。</p><h2 id="d716" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">6.下载并安装Hadoop:</h2><p id="8dfc" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">从<a class="ae iu" href="https://archive.apache.org/dist/hadoop/core/hadoop-2.7.2/" rel="noopener ugc nofollow" target="_blank">https://archive.apache.org/dist/hadoop/core/hadoop-2.7.2/</a>下载Apache Hadoop构建版本(二进制)</p><p id="1ec6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将提取的文件夹复制到如下位置:~/software/</p><h2 id="4080" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">7.下载并安装配置单元:</h2><p id="f349" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">从https://archive.apache.org/dist/hive/hive-1.2.1/<a class="ae iu" href="https://archive.apache.org/dist/hive/hive-1.2.1/" rel="noopener ugc nofollow" target="_blank">下载Apache Hive构建版本(二进制)</a></p><p id="4931" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将提取的文件夹复制到如下位置:~/software/</p><h2 id="0cdf" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">8.配置bash配置文件、主目录和路径:</h2><p id="f2d4" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">转到主目录，将下面的命令添加到。bash_profile文件。根据需要更改下面的路径。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="0d27" class="jt ju hi ky b fi lc ld l le lf">export HADOOP_HOME=/Users/xxx/Softwares/hadoop-2.7.2<br/>export JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_161.jdk/Contents/Home<br/>export SPARK_HOME=/Users/xxx/Softwares/spark-2.0.2-bin-hadoop2.7<br/>export PYTHONPATH=${SPARK_HOME}/python:${PYTHONPATH}<br/>export HIVE_HOME=/Users/xxx/Softwares/apache-hive-1.2.1-bin<br/>export PATH=${HADOOP_HOME}/bin:${SPARK_HOME}/bin:${HIVE_HOME}/bin:${PATH}</span></pre><p id="dec3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">可以用来查找JAVA SDK的安装位置，并将路径显式设置为JAVA_HOME</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="11ae" class="jt ju hi ky b fi lc ld l le lf">echo $(/usr/libexec/java_home)</span></pre><p id="5c7d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦添加了这些命令。bash_profile文件需要源代码。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="9e89" class="jt ju hi ky b fi lc ld l le lf">source .bash_profile</span></pre><h2 id="b6d7" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">9.验证安装:</h2><p id="2d48" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">此时，java、hadoop、git、hive和spark应该可以在本地Mac终端的任何位置正常工作。如果有错误，请核实并采取纠正措施。</p><h2 id="7185" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">10.创建git分支并克隆一个存储库:</h2><p id="7934" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">由于SSH隧道是在步骤3中建立的，所以可以使用来自本地终端的git克隆将存储库克隆到特定的分支。</p><p id="6a14" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">特定项目的Git SSH url可以在github中找到(例如git clone—recurse-sub modules git @ github . com:XXX/XXX . git)</p><p id="05c0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">导航到将要克隆存储库的特定目录，并发出一个git克隆。</p><p id="51d4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这将把代码从git下载到本地。此时，需要为变更跟踪创建一个单独的“分支”。一旦本地的变更被提交，该变更可以被合并到更高顺序的分支。</p><p id="b0c3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本地git存储库目录中，发出下面的命令来创建并签出一个新的分支。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="2d5c" class="jt ju hi ky b fi lc ld l le lf">git checkout master</span><span id="4c29" class="jt ju hi ky b fi lg ld l le lf">git remote update -p</span><span id="e4e2" class="jt ju hi ky b fi lg ld l le lf">git pull origin master</span><span id="56fb" class="jt ju hi ky b fi lg ld l le lf">git checkout -b example_branch</span></pre><p id="1710" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这将首先使本地git主分支与远程同步，并从那里创建一个新分支。这样做是为了确保所有新的开发工作都是在最新的主副本之上开始的。</p><h2 id="aee6" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">11.创建虚拟环境并安装项目需求:<a class="ae iu" href="https://ghdocs.grubhub.com/architecture/systems/Data/marketingdataintegration-docs/installation/#11-create-virtual-environment-and-install-project-requirements" rel="noopener ugc nofollow" target="_blank"> </a></h2><p id="d804" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">需要为项目创建一个虚拟环境，其中可以安装项目特定的python包。这特别有帮助，因为大多数时候用户可能没有root权限来将包添加到基本python安装中，这也有助于保持基本安装的整洁和独立。</p><p id="5dd1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">可以从IntelliJ或Mac终端创建虚拟环境。</p><p id="5ff7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从IntelliJ转到项目结构→ SDK，然后单击+号创建虚拟环境并将其分配给项目。</p><p id="1e4c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要从终端创建和激活虚拟环境，请发出以下命令:</p><p id="6acd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du li lj lk ky b">pip install virtualenvvirtualenv venvsource ./venv/bin/activate</code></p><p id="db1e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此时，项目可能需要一些额外的python包或依赖项。对于源代码和测试代码，它们可能已经在requirement.txt和test_requirements.txt文件中列出(或者以不同的名称列出)</p><p id="3ed0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">来安装这些-</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="5b09" class="jt ju hi ky b fi lc ld l le lf">pip install -r requirements.txt</span><span id="0e42" class="jt ju hi ky b fi lg ld l le lf">pip install -r test_requirements.txt</span></pre><p id="73e0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这将安装所有的项目和测试需求。检查是否有任何错误，如果有，请解决这些错误。</p><h2 id="36b6" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">12.安装git自动完成</h2><p id="7517" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">安装git autocomplete可能是个好主意，这样可以节省发出完整git命令的时间。</p><p id="3dc1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于MacOs，可以按如下方式安装，如果已经安装了git，请删除“git ”:</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="564f" class="jt ju hi ky b fi lc ld l le lf">brew install git bash-completion</span></pre><h2 id="98aa" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">13.在中添加别名。bash_profile</h2><p id="23a7" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">创建经常发出的命令、EMR/EC ssh命令等的别名。in ~/。bash_profile。这些非常方便，让我们不必记住特定的ip地址，发出完整的命令等等。</p><p id="a73a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一些例子是:</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="f49c" class="jt ju hi ky b fi lc ld l le lf">alias azkaband=’sshpass -p {password} ssh xxx@dev-azkaban.xxx.com -o “StrictHostKeyChecking no”’</span><span id="31ea" class="jt ju hi ky b fi lg ld l le lf">alias azkabanp=’sshpass -p {password} ssh xxx@azkaban.xxx.com -o “StrictHostKeyChecking no”’</span><span id="3898" class="jt ju hi ky b fi lg ld l le lf">alias foxy_d_gedid=’sshpass -p {password} ssh -ND 8157 xxx@dev-xxx.xxx.com’</span></pre><p id="0902" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">非常基本的指令集，但是在设置新的开发环境时非常方便！</p></div></div>    
</body>
</html>