<html>
<head>
<title>Using Classification Models To Build A Bank Insitution Term Deposit Predictive Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用分类模型构建银行机构定期存款预测模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/classification-models-7d0849c613cb?source=collection_archive---------35-----------------------#2020-08-29">https://medium.com/analytics-vidhya/classification-models-7d0849c613cb?source=collection_archive---------35-----------------------#2020-08-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="4e9d" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">概述</strong></h1><p id="4e78" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这个项目的目标是预测客户是否会认购银行定期存款。这些数据是从<a class="ae kb" href="http://archive.ics.uci.edu/ml/datasets/Bank+Marketing" rel="noopener ugc nofollow" target="_blank"> UCI ML </a>网站上下载的，关于这些数据的更多细节可以从该网站上阅读。</p><p id="6b40" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">本文将重点关注在将数据输入模型之前对其进行的预处理。我们还将重点评估不同型号的不同性能指标，并选择最佳指标。探索性数据分析可以在这个<a class="ae kb" href="https://public.tableau.com/profile/ken.mbaya#!/vizhome/BankInstitutionTermDepositPredictiveModelDataExploration/Story1" rel="noopener ugc nofollow" target="_blank"> tableau仪表盘</a>上找到。这个项目的代码可以在这里找到<a class="ae kb" href="https://github.com/kenmbelenzi/BankInstitutionTermDepositPredictiveModel" rel="noopener ugc nofollow" target="_blank"/>。</p><h1 id="4e98" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">预处理</strong></h1><h2 id="4a13" class="kh ig hi bd ih ki kj kk il kl km kn ip jo ko kp it js kq kr ix jw ks kt jb ku bi translated"><strong class="ak">编码</strong></h2><p id="f6a6" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">为了在数据上运行模型，我们必须将所有非数字特征转换为数字特征。有两种方法可以做到这一点:一个热编码和标签编码。</p><p id="7733" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">在<strong class="jf hj">一个热编码</strong>中，为特征列中的每个唯一值创建一个新列。但是，这种方法增加了列的数量，因此在具有许多唯一值的列中使用它时必须小心，因为它可能会导致维数灾难。下面我们使用一个热编码来编码我们所有的分类列。</p><figure class="kv kw kx ky fd kz"><div class="bz dy l di"><div class="la lb l"/></div></figure><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es lc"><img src="../Images/c270ad77da4f31cecd3abb66e0a90667.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-xRl69RnSsV1yWt7KbyI-w.png"/></div></div></figure><p id="4adf" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">在<strong class="jf hj">标签编码</strong>中，不同的数字被分配给每个唯一值，而不创建额外的列。这种技术适用于具有有意义的顺序的数据。由此产生的一个潜在问题是，模型假设标签大小代表权重，即2大于1或0。</p><figure class="kv kw kx ky fd kz"><div class="bz dy l di"><div class="la lb l"/></div></figure><h2 id="bdf1" class="kh ig hi bd ih ki kj kk il kl km kn ip jo ko kp it js kq kr ix jw ks kt jb ku bi translated"><strong class="ak">缩放数据</strong></h2><p id="3761" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">由于数据有多个测量速率，我们必须使用最小最大缩放器来缩放数据。这将所有特性标准化为0到1之间的值。</p><figure class="kv kw kx ky fd kz"><div class="bz dy l di"><div class="la lb l"/></div></figure><h2 id="6e49" class="kh ig hi bd ih ki kj kk il kl km kn ip jo ko kp it js kq kr ix jw ks kt jb ku bi translated"><strong class="ak">将数据分为训练集和测试集</strong></h2><figure class="kv kw kx ky fd kz"><div class="bz dy l di"><div class="la lb l"/></div></figure><h1 id="ce0b" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">阶级不平衡</h1><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es lj"><img src="../Images/d0910601b8969e0d46ad46ca6a73e2d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iArW8goEi6c1EzhUcuUwTQ.png"/></div></div></figure><p id="9d60" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">从上面的图中我们可以看到，数据集是高度不平衡的。说不的人数明显多于赞成的人数。这可能导致模型中的偏差，因为大多数数据属于一个组。类别不平衡可以通过使用<strong class="jf hj">综合次要过采样技术(SMOTE)来解决。</strong></p><h2 id="1541" class="kh ig hi bd ih ki kj kk il kl km kn ip jo ko kp it js kq kr ix jw ks kt jb ku bi translated"><strong class="ak">重击</strong></h2><p id="0c5b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">SMOTE是一种过采样技术，它在现有少数实例之间合成新的少数实例。在我们的例子中，SMOTE将为yes组创建新的实例，以便平衡数据。</p><figure class="kv kw kx ky fd kz"><div class="bz dy l di"><div class="la lb l"/></div></figure></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><h1 id="3428" class="if ig hi bd ih ii lr ik il im ls io ip iq lt is it iu lu iw ix iy lv ja jb jc bi translated"><strong class="ak">创建模型</strong></h1><p id="befa" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">用于解决分类问题的模型有逻辑回归、随机森林分类器、Xgboost、决策树和MLP分类器。我使用Kfold作为交叉验证技术。</p><figure class="kv kw kx ky fd kz"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="854f" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">模型评估</strong></p><p id="76cb" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">我使用以下指标来评估模型的性能:准确度、精确度、召回率、曲线下面积(AUC)和F1值。</p><p id="283e" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">准确度</strong></p><p id="8349" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">准确度是正确预测的观测值与总观测值的比率。然而，人们可能会认为我们的模型具有高精度是好的，但人们必须使用其他参数来真正评估您的模型的性能。</p><p id="5973" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">精密</strong></p><p id="210b" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">精度是正确预测的正观测值与总预测正观测值的比率。它回答了这样一个问题:在所有被贴上“是/否”标签的人中，有多少人实际上对定期存款持“是/否”态度。</p><p id="85d1" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">召回</strong></p><p id="4774" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">召回率是正确预测的正面观察与实际课堂中所有观察的比率——是的。它回答了这个问题，在所有回答“是/否”的人中，我们正确标记了多少。</p><p id="95d8" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj"> F1得分</strong></p><p id="adc6" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">这是准确率和召回率的加权平均值。</p><p id="a502" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj"> AUC </strong></p><p id="fede" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">这是ROC曲线下的面积</p><p id="af12" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">下表显示了我们每个型号的表现</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es lw"><img src="../Images/bc34fd6636f06c59962ab1ed6ec5b82a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FzgjfPgRLiqVtk6Qs_Upyw.png"/></div></div></figure><h2 id="71be" class="kh ig hi bd ih ki kj kk il kl km kn ip jo ko kp it js kq kr ix jw ks kt jb ku bi translated">结论</h2><p id="6316" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">使用的前3个模型是逻辑回归、Xgboost和MLP分类器。与其他模型相比，这些模型具有最高的ROC_AUC、精确度和召回率。</p><h2 id="e6e6" class="kh ig hi bd ih ki kj kk il kl km kn ip jo ko kp it js kq kr ix jw ks kt jb ku bi translated">推荐</h2><p id="691d" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">为了提高模型性能，我们可以做一些超参数调整和特征减少。这将在以后的博客中完成。</p></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><p id="08a7" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">感谢我在10academy的所有同学和导师，感谢他们的支持和激励。我把这些放在一起作为第三批<a class="ae kb" href="http://10academy.org/" rel="noopener ugc nofollow" target="_blank">10academy.org</a>培训的一部分。</p></div></div>    
</body>
</html>