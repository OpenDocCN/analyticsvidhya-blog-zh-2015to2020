<html>
<head>
<title>Implementing an end-to-end Machine Learning Project with Deployment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过部署实施端到端机器学习项目</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/implementing-an-end-to-end-machine-learning-project-with-deployment-fedaf5125487?source=collection_archive---------13-----------------------#2020-07-10">https://medium.com/analytics-vidhya/implementing-an-end-to-end-machine-learning-project-with-deployment-fedaf5125487?source=collection_archive---------13-----------------------#2020-07-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7e14" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嘿，大家好！我是萨扬坦·古普塔，目前在高通公司做工程师，有两年多的工作经验。</p><p id="bd58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如今，几乎每个人都熟悉这个术语——“机器学习和人工智能”。它在全球范围内的需求、要求和应用呈指数级增长，这使得它成为过去5-6年中需要学习的一项基本技能。在本文中，我将介绍一个端到端的机器学习项目，从数据清理和预处理一直到部署。那么，让我们开始吧！！</p><p id="94b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们先来了解一下什么是机器学习或者数据科学管道！</p><h1 id="810c" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><em class="kb">机器学习管道:</em></h1><p id="85f4" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">一般来说，任何数据科学项目都有5个<strong class="ih hj">主要</strong>步骤。统称为数据科学项目的生命周期</p><ol class=""><li id="f79f" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">数据分析</li><li id="d099" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated">特征工程</li><li id="05cf" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated">离群点去除</li><li id="5dfc" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated">模型结构</li><li id="5dcc" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated">模型部署</li></ol><p id="a94d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以建立一个数据科学管道，其中每个步骤都可以独立运行，然后最终集成在一起，创建一个完整的数据科学项目。</p><h1 id="64a6" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><strong class="ak">关于项目:</strong></h1><p id="7a7c" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">继续这个项目，这个项目是关于<strong class="ih hj">预测印度班加罗尔</strong>、<strong class="ih hj">基于各种因素的房屋销售价格，如位置、平方英尺、BHK的数量、浴室等</strong>。这个项目的数据集取自Kaggle ( <a class="ae kv" href="https://www.kaggle.com/amitabhajoy/bengaluru-house-price-data" rel="noopener ugc nofollow" target="_blank">链接</a>)。正如你们中的一些人可能已经猜到的，这是一个回归问题，所以我们必须相应地解决。在开始一个接一个的步骤之前，让我们先看看最终项目的UI，这将是我们的输出</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/b899df3e4388cbe20c54828d02530367.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*-cyfPyGoY9i63NqZhxw5Vw.gif"/></div></div></figure><p id="5bf9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">Heroku上的项目链接</strong>:<a class="ae kv" href="https://house-price-predictor-app.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://house-price-predictor-app.herokuapp.com/</a></p><p id="6356" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Github回购:</strong><a class="ae kv" href="https://github.com/babai95/Bangalore_house_price_prediction_end_to_end_with_Deployment" rel="noopener ugc nofollow" target="_blank">https://Github . com/babai 95/Bangalore _ house _ price _ prediction _ end _ to _ end _ with _ Deployment</a></p><p id="598d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从步骤开始。在开始之前，我必须说这不是解决这个问题的唯一方法。有多种方法可以解决这个问题，其中一些肯定会比这个更好、更有效、精确度更高。我想向你们展示的是一个完整的端到端的方式来完成一个ML项目。如果你对这个项目有任何疑问，请随时在Linkedin上联系我。<strong class="ih hj">我的Linkedin个人资料</strong>:【https://www.linkedin.com/in/sayantan-gupta-779a23125/】T4</p><p id="6fce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么，让我们开始吧！！</p><ol class=""><li id="33d5" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated"><strong class="ih hj">数据分析:</strong></li></ol><p id="b340" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1.1导入库</strong></p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es li"><img src="../Images/822af5dedfe0ed59cd96c5925377958b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uglXd7NWVVMAxY_RfsjKYA.png"/></div></div></figure><p id="c4ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导入所有需要的库:Pandas、numpy、matplotlib。将显示选项设置为“display.max_columns ”,以确保无论何时查看数据集，都能看到所有列，即数据集中的所有要素。然后</p><p id="4d54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.2 <strong class="ih hj">获取数据集并检查其基本信息</strong></p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lj"><img src="../Images/ee811850c3b3810511d83a9ca75b9baa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kAiRWUdnvedV2kRAddmWPQ.png"/></div></div></figure><p id="15ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">读取数据集csv文件并获取其形状。正如我们所看到的，形状是(13320，9)，这意味着它有13320条记录和9个特征。如果我们看到dataset.head()，我们将看到数据集中的前5条记录。然后我们使用info()函数查看数据集信息。我们可以看到总共有9列(特征)。其中3个是数据类型“float64”，它们是数字特征，而6个是数据类型“object”，它们是分类特征。我们还可以看到其中非空值的数量。</p><p id="4af6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1.3特征分析</strong></p><p id="f517" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是你正在做的任何项目所涉及的领域知识发挥作用的地方。拥有良好的领域知识有助于您判断是否应该删除任何您认为对预测相关特性(此处为销售价格)不重要的列。在这种情况下，我们可以选择“可用性”,因为它通常不会影响房屋的销售价格。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es lk"><img src="../Images/a6440bbe057d9e2f4be233d04103514b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*fmqBeEls1kY12Rq27DejLQ.png"/></div></figure><p id="374b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个简短的数据分析，现在我们可以转到特征工程</p><p id="4af3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。特征工程</strong></p><p id="f530" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2.1从所有特征中移除空值</strong></p><p id="ef67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是整个数据科学流程中最重要的步骤之一。首先，我们使用isnull()检查所有列的空值总和。sum()函数</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es ll"><img src="../Images/4cc062e6acffd6c813f8afa50551aa14.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*dycn1TLJDbFGUZOma6NGmw.png"/></div></figure><p id="033b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一般来说，我们可以删除那些空值数量超过所有记录的50%的列。在这种情况下，我们可以将阈值视为13320的50%，即6660。这里没有一列的空值数量超过6660。然而，我们可以看到“society”与其他相比有相当高数量的空值(5502)。因此，数据集中存在比例失调，最好删除“社会”。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es lm"><img src="../Images/7fd71504123f1af0428c9df429c774bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*-fRWetjGLRKSHxUVsq_ruA.png"/></div></figure><p id="4367" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将首先分离数值列和分类列，然后删除它们各自的空值，因为对于数值列和分类列，删除空值的过程是不同的。首先让我们对数值特征执行此操作:</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es ln"><img src="../Images/0799818608ac63024f78f00e973cc9fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6R_pJcQiJnjQnISeSRlRDQ.png"/></div></div></figure><p id="a59e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先使用python中的list comprehension找到所有数字特征:<strong class="ih hj">numeric _ features =[feature for feature in dataset . columns if dataset[feature]。dtype！= 'O']。</strong>如上所述，数值特征是那些dtype不是object('O ')的特征，所以我们可以利用这个性质，得到所有的数值特征。对于一个特定的数字特性，我们将使用fillna()函数用该列中所有值的平均值来替换它的空值。我们将对所有的数字特征都这样做。接下来，我们移除分类特征的空值</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lo"><img src="../Images/99e4eb52fa2f16d27d98e2a507b89e60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l_XF6_TwJOmbmHSdN43W7A.png"/></div></div></figure><p id="df5b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用列表理解，我们找到分类特征，使用属性dtype = object("O ")作为分类特征。现在，对于一个特定的分类特性，我们将使用fillna()函数用该列中的模式替换<strong class="ih hj">的空值。众数是数据中最常见的值。我们将对所有的分类特征都这样做。现在所有的空值都被删除了。</strong></p><p id="8e31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2.2处理分类特征，删除冗余或意外值</strong></p><p id="f071" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们仔细观察数据集，我们会发现一些特征具有冗余值。例如:在BHK的功能，两个BHK和两个卧室类别都在那里。我们必须将它们合并到一个类别中，否则我们的机器学习模型会将它们视为不同的类别，这是不正确的。让我们从找到所有分类特征的唯一类别开始:</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es lp"><img src="../Images/242104070f32869a373290253901e3ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*4NYtYiBzr8Ajf7Y8vFREEg.png"/></div></figure><p id="e04d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于area_type，没有多余的类别</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es lq"><img src="../Images/f1e7d6fa6589637434892d3ba7c4b0ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*g-eNWNjM_a3CBwvCKbQn7g.png"/></div></figure><p id="ce07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于位置，看起来也没有多余的类别</p><p id="b48a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于“尺寸”功能，我们可以看到像2BHK和2卧室，4 BHK和4卧室等多余的类别。因此，我们可以创建一个没有这些冗余类别的新列。对于尺寸，分类为2 BHK、2卧室、3 BHK等，因此最好只保留第一个数字，即2、3、4等，作为“尺寸”功能中BHK的数量。为此，我们可以在“”的基础上拆分字符串，只考虑第一部分，即卧室的数量</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lr"><img src="../Images/c3d0558da36169bd4be969fe92adcf4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0hUqc7GMR6EfakUcHPuyig.png"/></div></div></figure><p id="2ccb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于“total_sqft”功能，它是一个数字，但仍然是一种分类数据类型。我们需要将其转换为浮点数据类型。但是首先让我们检查冗余值</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es ls"><img src="../Images/eb13e414a0a04ff423b25b87f4f4976e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*OtCE_wrlHCJhqMrTB_R7TQ.png"/></div></figure><p id="a408" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们从上面看到的，一些值的范围类似于“1133–1384”。在这种情况下，我们应该考虑两个区间的平均值，然后将其类型化为float</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lt"><img src="../Images/f4b2dc68298ba29ddbab96471b31bbd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YzlIhKNOcnf0V3rNpQF5sQ.png"/></div></div></figure><p id="96b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上面我们可以看到，在某些情况下“convert_range_to_float”函数会返回Null。因此，我们需要删除这个空值，并用平均值代替它</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lu"><img src="../Images/97ed515d21f4d4fc7f45008794d13df6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kFaMxn-4G2CgmI1J8ggk1g.png"/></div></div></figure><p id="b6a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要引入一个新功能“每平方英尺的价格”这是进行特征工程时要考虑的一个非常重要的特征。我们将在后面看到它的用法，同时删除异常值</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lv"><img src="../Images/805f52a40a58411597a8b6da90d4b9ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_4r2Tg4hyF9HDEiFfaIcdQ.png"/></div></div></figure><p id="5285" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2.3处理罕见的分类值</strong></p><p id="6e4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有一些特征，例如位置，有许多类别。如果我们看到独特类别的总数:-&gt;</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es lw"><img src="../Images/3a8b23a0bcbef87ef24f79c0bf5932ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*s7zIgkhhBnqLrnTPnlCJTw.png"/></div></figure><p id="691f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“位置”中有1305个唯一类别，一个热编码将创建额外的1304个特征(列)，从而在很大程度上增加数据集的大小，这根本不可行。这种由于一个热门编码而引入如此多新功能的现象被称为<strong class="ih hj">维度诅咒</strong>，我们需要避免它。为此，我们需要执行<strong class="ih hj">降维</strong>。一种技术是用一个标签标记所有罕见的分类特征(例如:“其他”)。稀有类别是出现次数非常少的类别(我们可以将阈值保持为1%，即出现次数少于记录总数1%的类别被视为稀有类别)</p><p id="bb9e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们做<strong class="ih hj">数据集[‘位置’]。value_counts() </strong>，我们将看到许多类别出现的次数非常少- &gt;</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lx"><img src="../Images/5c6cdd361e8be98224b50bd8edda01d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*XttEJKMM_3uPvSEr-qBVSA.png"/></div></div></figure><p id="325a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要将所有这些罕见的类别合并成一个类别。对于“位置”，我们可以将阈值计数保持为30。之后，我们可以应用lambda函数将所有这些类别视为值计数小于30的“other_loc”</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es ly"><img src="../Images/d67b59e8d3f934b4463b9a00072ee736.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YkzdhPZ9dTqbQgTSbHKuXA.png"/></div></div></figure><p id="10b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3。异常值去除</strong></p><p id="8f97" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">异常值是那些具有异常高或异常低值的观察值。它们不符合该特性的预期值范围。应该删除异常值，以便整个数据均匀分布。</p><p id="4381" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样，没有固定的方法来删除异常值。一切都基于数据洞察力、领域专业知识以及数据分析师/科学家如何分析数据，因此很明显，消除异常值的方法将因人而异。</p><p id="e6cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以从每间卧室的总面积开始考虑。考虑到一间卧室的面积阈值为300平方英尺</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es lz"><img src="../Images/909498cf33729ec8bda8111d0dc22dd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*k_lctQzPhde2z93ANjiTBw.png"/></div></figure><p id="2380" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上面，我们可以看到一些不寻常的数据(6 bhk有1020总平方英尺，8 bhk有600平方英尺等。).这些是错误的数据，因此是异常值，可以直接删除</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es ma"><img src="../Images/96fb8864ab8b85824c93d69fe4e3acdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*hmYGxCqaKiJfs7wNbUbmSg.png"/></div></figure><p id="67f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在考虑每平方的价格。制成每平方米价格。英尺可能太低或太高。第一，我们需要检查每平方英尺功能价格的描述</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es mb"><img src="../Images/e8d5fc786c4cdde7c0be0421cc122153.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*x83fsIgGAQjEpIjsLjNijg.png"/></div></div></figure><p id="c1cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，最小值是267，最大值是176470。最小值非常小。最大值非常高，如果区域的fi非常高，这是可能的。但是，当我们建立一个通用模型时，我们会将高于某个阈值的值视为异常值并删除它们</p><p id="1d02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们绘制每平方英尺价格特征的直方图</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es mc"><img src="../Images/40946827f2c6b36238297ddb4bcc6089.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*xn_9aJ7sX7jzvSv3qgj8hw.png"/></div></figure><p id="8105" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上面的曲线中，我们可以看到“每平方英尺的价格”遵循正态分布。由于它遵循正态分布，我们可以应用标准差方法来消除该特征的异常值</p><p id="0a12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">剔除异常值的标准差法</strong></p><p id="7f9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有3个要点，均值，下限，上限。如果特性值介于下限和上限之间，则不是异常值。否则它就是一个离群值。一般我们考虑3个标准差为下限和上限。这意味着下限=均值— 3*(1个标准差)，上限=均值+ 3(*(1个标准差)。</p><p id="b77e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这种情况下，对于每平方英尺价格功能，平均值= 6312，1标准偏差= 4177。如果我们对下限应用3个标准差，下限将是负的。因此，在这种情况下，我们必须考虑下限和上限的1个标准差</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es md"><img src="../Images/b30b0893ef30747ccba64175eb69d8da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zt4M88zwDNyGJ_FumLh04A.png"/></div></div></figure><p id="8b95" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，谈到浴室，一个2 BHK的房子有5或6个浴室是不寻常的，所以这些是离群值。因此，我们可以考虑，如果浴室的数量大于卧室的数量+ 2，那么它是一个异常值，并删除它们。阳台也是一样</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es me"><img src="../Images/8ad9522958a6df3dc974a58cb6da1b8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZShrCClUu8dbPrBCgkGI5g.png"/></div></div></figure><p id="4268" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为BHK剔除异常值。让我们首先在“Hebbal”位置的“总平方英尺”和“每平方英尺价格”之间绘制一个散点图</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es mf"><img src="../Images/1c34cdea21ee9ca3047f97980cc26876.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eresgY9d5NyR6VNkxv8gOQ.png"/></div></div></figure><p id="9847" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面高亮的圆圈里(虽然看起来不像是圆圈！XD)，我们看到，对于相同的总平方英尺，每平方英尺2 BHK的价格高于3 BHK。由于各种因素，这是可能的。然而，由于我们在这里建立了一个通用模型，所以我们可以制定一个通用规则:如果BHK北部的每平方英尺价格低于BHK(n-1)的每平方英尺平均价格，那么它是一个异常值，应该被删除。</p><p id="a498" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">实现方法</strong>:维护一个字典，其中key = BHK号码，value = BHK每平方英尺的平均价格。现在创建一个numpy数组，其中包含BHK北部每平方英尺价格低于BHK n-1每平方英尺平均价格的指数。最终删除所有这些索引</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es mg"><img src="../Images/f795221c0b8a795bcb187b9e45eda255.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xfq1DdeVKuSF5BJP8A9E8w.png"/></div></div></figure><p id="a05a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果我们绘制“赫布巴尔”位置的散点图:-&gt; 1</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es mh"><img src="../Images/936650a6af71767de2e10e806c63b470.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*jpdOPNKXXV4FCYinEtagAg.png"/></div></figure><p id="8c4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的图中，我们看到在突出显示的圆圈中，离群点被移除。现在所有的离群值都被删除了。因为每平方英尺价格列仅用于删除异常值，所以我们可以删除它</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es mi"><img src="../Images/72f6a244495d174879eadfeb7ef0401d.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*lAz6C9EBk5oczMLpzfr0DA.png"/></div></figure><p id="0a08" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 4。模型构建</strong></p><p id="6f17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于我们的机器学习模型只理解数字，所以我们需要首先将所有的分类特征转换为数字特征。我们可以使用一个热编码来实现。对“区域类型”和“位置”特征进行一次热编码</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es mj"><img src="../Images/1810976625e13b4433a6e811d1693756.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*Yg5P0ZU3v6Px_09x7IOx3A.png"/></div></figure><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es mk"><img src="../Images/fc575336493f60067ad280d32a634983.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*ALQaIPvB4_okrRCerWwo9Q.png"/></div></figure><p id="50a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在模型已经准备好接受训练了。在训练集中，Xtrain是没有因变量“价格”的数据集，ytrain只包含因变量“价格”。让我们首先尝试一下<strong class="ih hj">网格搜索CV，</strong>，这是scikit learn的一个API，它尝试了多个模型，并给出了提供最佳分数的模型</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es ml"><img src="../Images/f37580c2d458a99d34ee77e1ac124311.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6vroK_hH3n7P3juPAnySUg.png"/></div></div></figure><p id="da6c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们比较了使用3种不同算法的3个模型-&gt;线性回归、Lasso回归和决策树回归。我们看到使用线性回归的模型在这3个模型中表现最好</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es mm"><img src="../Images/c9afcebec5c9ad3d44d9f73711c51539.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*Ia9iJUKaO7-6lp7IsZfoMA.png"/></div></div></figure><p id="4f69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，让我们在最终模型中使用线性回归。首先使用train_test_split将整个数据分成训练集和测试集，并对训练集应用线性回归。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es mn"><img src="../Images/7a96b60696760256aff69f219cc36d5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1kEqLoA0hqCbA3IPiwicwA.png"/></div></div></figure><p id="f765" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们得了0.85分，相当不错。我们还使用混洗分裂的K-fold交叉验证来随机化数据。对于所有的劈叉，我们得到了超过0.85的分数</p><p id="8aaf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们用我们的模型来预测价格。我们编写了一个函数，它将所需的参数作为输入，并将预测价格作为输出</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es mo"><img src="../Images/9c7b3d3bf22bcc36268a311db1d8b0be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*IWFpu2szf-KY8IdDCJa2Zg.png"/></div></figure><p id="94d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们预测如下:</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es mp"><img src="../Images/0109d242bcf5abdc36b669d140794d99.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*id7asHMTGEJO4prnLgXneg.png"/></div></figure><p id="e93a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些是以10万卢比为单位的价格。因此，我们终于完成了模型构建。现在，我们将模型保存到pickle文件中，以便以后我们可以直接使用这个已经训练好的模型，而无需再次训练它。这个pickle文件只包含线性回归的权重和系数，而不是实际的全部数据。因此它的大小非常小，大约只有3KB。我们还将所有的列(特性)存储到一个json文件中。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es mq"><img src="../Images/b769be7b11fcb725455df39a0770473e.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*4Yu_l7lDEjqC3OhqJuUwfQ.png"/></div></figure><p id="faba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，这个pickle文件和json文件将被我们的Python flask服务器使用，我们将在下面讨论模型部署</p><p id="5216" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 5。模型部署</strong></p><p id="9029" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用Python Flask server，它将作为一个后端服务器来提供前端客户端将请求的所有必需数据。前端部分是用基本的HTML和CSS编写的(这里不讨论了，大家可以参考我的Github库中的所有代码)。我们已经使用Jquery对后端Flask服务器进行get和post调用来检索数据。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es mr"><img src="../Images/fb8ff61f6a9805b9a007d3d65dbe9b38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*T4YYxhPjOqeA4mPPUUK7Ew.png"/></div></figure><p id="edb9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的部分没有“获取”调用我们的后端服务器来检索位置和区域类型，所以当网站页面被加载时，所有的位置和区域类型都已经预先填充在一个下拉菜单中。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es ms"><img src="../Images/1571f01283a0e3428a0fb0c1fc4abc9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*5LFezCY3tsDB1c5dGUjBMA.png"/></div></figure><p id="ac5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些函数:getbath()、getbhk()和get阳台()获取用户在网站中输入的数据，并基于元素id存储这些数据。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es mt"><img src="../Images/6f0a24b66eacdab9f4c68eae955647df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6fSRTOrW4w35SMzgCsHsGA.png"/></div></div></figure><p id="98a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个函数estimate()是主要函数，它获取用户在网站中输入的所有数据，然后对我们的后端服务器进行“post”调用，以获取房子的最终售价</p><p id="f5b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是我们的app.py文件的代码，它通过Flask server运行。永远记住，我们项目的执行将从这个文件app.py开始</p><ol class=""><li id="5f61" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">初始化flask服务器并加载模型和列。</li></ol><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es mu"><img src="../Images/6b59842112e54c9f54c24ea9650f3372.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*dfuC1lsa9m2zDLiYSqxVig.png"/></div></figure><p id="859b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.将主屏幕重定向到我们的HTML文件“home.html”</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es mv"><img src="../Images/72052a4859ba2750b97938b6163ac7c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*-bEe8kKJe1bsC4-9vVs_lA.png"/></div></figure><p id="0a3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.当“get”调用完成时，返回位置和区域类型，以在加载时用所有位置和区域类型预填充网站</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es mw"><img src="../Images/09559ade3f9ed005607448e3a5ebe9e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*sqBrMsWyG32GDYzbUoe_-Q.png"/></div></figure><p id="cd43" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.使用用户提供的所有必需输入参数完成“post”调用后，返回最终预测价格</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es mx"><img src="../Images/d3e40b1d98730b4aa3981f354434c0ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*wvFJyQ2vttZq1bOXg_JOaw.png"/></div></figure><p id="1842" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.现在在main中运行Flask应用程序，保持调试模式为真</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es my"><img src="../Images/f3d47667fcb9efb1c99eed64d08733c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:538/format:webp/1*ni0fTX0AW7gBPClWE_hW6g.png"/></div></figure><p id="7e35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当您运行这个文件时，您将在localhost中看到您的输出。但是其他人看不到您的项目，除非您将它部署在某个应用程序中。为此我们将使用Heroku。为了在Heroku中部署，除了所有这些文件，我们还需要另外两个文件，Procfile和requirements.txt</p><p id="10da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Procfile内容</strong> - &gt; web: gunicorn app:app</p><p id="821d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，第一个应用程序是将首先执行的文件的名称，这里是app.py。第二个应用程序是Flask服务器的名称</p><p id="d4b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> requirements.txt - &gt; </strong>这是一个文本文件，包含了所有导入的库及其版本。<strong class="ih hj"> </strong>为了生成requirements.txt，转到项目文件夹，在Windows Power Shell/命令提示符下，键入:</p><p id="8ab7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> pip冻结&gt; requirements.txt </strong></p><p id="99a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在创建一个Github存储库，并将所有这些文件添加到您的repo中。之后，从Heroku连接你的Github Repo，给一个合适的app名，然后部署。您可以看到您部署的网站并与其他人共享。就是这样！！恭喜你。你的端到端ML项目完成了！</p></div></div>    
</body>
</html>