<html>
<head>
<title>Integrating Rasa Open Source Chatbot Into Unity [Part 2] : The Visuals</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Rasa开源聊天机器人集成到Unity中[第2部分]:视觉效果</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/integrating-rasa-open-source-chatbot-into-unity-part-2-the-visuals-f67a915a4b2d?source=collection_archive---------6-----------------------#2020-03-17">https://medium.com/analytics-vidhya/integrating-rasa-open-source-chatbot-into-unity-part-2-the-visuals-f67a915a4b2d?source=collection_archive---------6-----------------------#2020-03-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/edecb15e05108c69905e6b235fe7c920.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HiaMracyD_tDayxZSC9zPg.png"/></div></div></figure><p id="6ec0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">大家好！在<a class="ae jo" rel="noopener" href="/@divyangpradeep/integrating-rasa-open-source-chatbot-into-unity-part-1-the-connection-9ba582c804cd">上一篇文章</a>中，我们在Unity中创建了一个聊天机器人，并发送/接收来自它的响应。在定制连接器和POST请求的帮助下，我们在两者之间创建了一个链接，并在控制台中打印了结果。</p><p id="5f7c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是在控制台中查看响应一点也不好玩！我们甚至不能打出我们的信息，也没有必要每次都发“嗨”，不是吗？为了解决这个问题，我们将在这部分教程中创建一个简单的UI。这个项目的源代码可以在<a class="ae jo" href="https://github.com/retrogeek46/Rasa-Unity" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h2 id="633a" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">介绍</h2><p id="634a" class="pw-post-body-paragraph iq ir hi is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">我们将创建一个窗口，输入领域，滚动窗口，发送按钮，并在红蓝聊天气泡渲染的消息。我们最终的设置看起来会像这样-</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es kp"><img src="../Images/398824298acc9322dfcb6a9663eb62c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*QumXcYD1WZaY0D-w0ucx9A.gif"/></div></figure><h2 id="02ec" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">资产和预制构件</h2><p id="6ce4" class="pw-post-body-paragraph iq ir hi is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">我们将需要聊天气泡和预置的图像，将在渲染消息时实例化。你可以在这里了解更多关于预置<a class="ae jo" href="https://www.youtube.com/watch?v=H1OkG3a1w-o" rel="noopener ugc nofollow" target="_blank">的信息</a>。</p><p id="b239" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个<a class="ae jo" href="https://github.com/retrogeek46/Rasa-Unity/blob/master/Unity/Rasa/Assets/Art/Chat%20Bubbles.psd" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj"> psd文件</strong> </a>有聊天消息气泡的艺术。我们将导入它作为精灵和<a class="ae jo" href="https://docs.unity3d.com/Manual/9SliceSprites.html" rel="noopener ugc nofollow" target="_blank"><strong class="is hj">9-拼接</strong> </a>它来创建我们的聊天泡泡预设。</p><p id="2fa3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦我们的精灵在编辑器中被分割，我们将命名为<strong class="is hj">用户泡泡</strong>和<strong class="is hj">机器人泡泡</strong>。</p><figure class="kq kr ks kt fd ij"><div class="bz dy l di"><div class="ku kv l"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">导入为精灵，9切片，然后重命名</figcaption></figure><p id="0411" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了创建预设，我们将首先创建一个UI <strong class="is hj">图像对象</strong>(右键单击并选择UI下)，然后附加一个空的游戏对象。这个空的游戏对象将被命名为<strong class="is hj">消息</strong>，并将包含任何要在气泡内渲染的组件(文本、图像等)。父<strong class="is hj">图像对象</strong>将使用我们刚刚创建的<strong class="is hj"> User_Bubble </strong>和<strong class="is hj"> Bot_Bubble </strong>来设置其精灵。</p><figure class="kq kr ks kt fd ij"><div class="bz dy l di"><div class="ku kv l"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">创建聊天气泡预设</figcaption></figure><h2 id="31d5" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">有魔力的剧本</h2><p id="b89d" class="pw-post-body-paragraph iq ir hi is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">为了在我们的UI对象中实现逻辑，我们将创建一个名为<strong class="is hj"> BotUI </strong>的新C#脚本。它将有从用户/机器人话语创建预设的方法，设置/更新它们的位置，并根据响应的类型向空的<strong class="is hj">消息</strong>对象添加组件。</p><figure class="kq kr ks kt fd ij"><div class="bz dy l di"><div class="la kv l"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">博推. cs</figcaption></figure><h2 id="8995" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">创建游戏对象</h2><p id="359a" class="pw-post-body-paragraph iq ir hi is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">需要的游戏对象是<strong class="is hj">游戏管理器</strong>(已经在上一部分中创建好了)<strong class="is hj">输入框</strong>、<strong class="is hj">发送按钮</strong>(也是上一部分中出现的)和一个<strong class="is hj">滚动视图</strong>。</p><p id="4872" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将首先创建这些实例，然后根据需要调整它们的大小。在滚动视图中，我们将<strong class="is hj">禁用水平滚动</strong>并<strong class="is hj">删除相关的子对象</strong>。您还可以<strong class="is hj">增加滚动灵敏度</strong>以使滚动更加灵敏</p><figure class="kq kr ks kt fd ij"><div class="bz dy l di"><div class="ku kv l"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">添加游戏对象</figcaption></figure><h2 id="8ea4" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">图像支持</h2><p id="d0ba" class="pw-post-body-paragraph iq ir hi is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">Rasa还可以发送<strong class="is hj">图片链接作为回复</strong>。为了渲染这些图像，我们需要将一个<strong class="is hj">精灵渲染器组件</strong>添加到我们聊天气泡的<strong class="is hj">消息</strong>子组件中，并用一个从图像链接创建的<strong class="is hj"> Texture2D对象</strong>填充它。</p><p id="4c15" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为此，我们将首先创建一个POST请求并检索图像数据。一旦完成，我们将创建一个<strong class="is hj">渲染纹理</strong>，因为只有它们可以使用从POST请求接收的字节数据来填充。使用<strong class="is hj">渲染纹理</strong>我们将创建我们想要的<strong class="is hj">纹理2D </strong>，调整它的大小，然后应用到聊天气泡。</p><p id="1176" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因为聊天气泡已经被渲染了，我们需要刷新我们的气泡位置，以便在图像被加载后考虑它们的新尺寸。因此，在呈现图像后，我们将调用<strong class="is hj">RefreshChatBubblePosition()</strong>方法。</p><p id="f29c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">纹理方法将在一个名为<strong class="is hj"> Utils.cs </strong>的新脚本中编写。我们还将把Json助手类从<strong class="is hj">网络管理器</strong>脚本移到这个新脚本中。</p><p id="455f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们新的<strong class="is hj">网络管理器</strong>和<strong class="is hj">实用程序</strong>脚本如下-</p><figure class="kq kr ks kt fd ij"><div class="bz dy l di"><div class="la kv l"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">网络管理器</figcaption></figure><figure class="kq kr ks kt fd ij"><div class="bz dy l di"><div class="la kv l"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">Utils.cs</figcaption></figure><h2 id="bd98" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">关联脚本和对象</h2><p id="c260" class="pw-post-body-paragraph iq ir hi is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">要使用我们刚刚创建的脚本，我们需要将它添加到我们的场景中，并连接必要的游戏对象。将<strong class="is hj"> BotUI </strong>脚本附加到<strong class="is hj"> GameManager </strong>对象，并将各自的游戏对象拖到脚本变量上。</p><figure class="kq kr ks kt fd ij"><div class="bz dy l di"><div class="ku kv l"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">连线游戏对象和脚本</figcaption></figure><p id="69f2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们只需运行场景并与机器人对话。我将相机颜色改为白色以给出不同的外观，你可以通过改变主相机下<strong class="is hj">相机组件</strong>的<strong class="is hj">背景</strong>颜色值来试验不同的东西。</p><figure class="kq kr ks kt fd ij er es paragraph-image"><div class="er es kp"><img src="../Images/398824298acc9322dfcb6a9663eb62c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*QumXcYD1WZaY0D-w0ucx9A.gif"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">支持图像的用户界面</figcaption></figure><h2 id="4cf7" class="jp jq hi bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">结论</h2><p id="250c" class="pw-post-body-paragraph iq ir hi is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">我们在Rasa-Unity项目中添加了一个用户界面，并增加了图像渲染支持。我们解决方案的一些缺点是</p><ul class=""><li id="587a" class="lb lc hi is b it iu ix iy jb ld jf le jj lf jn lg lh li lj bi translated">消息之间没有动画/延迟</li><li id="9ba4" class="lb lc hi is b it lk ix ll jb lm jf ln jj lo jn lg lh li lj bi translated">按回车键不能发送信息，必须按发送键</li></ul></div><div class="ab cl lp lq gp lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hb hc hd he hf"><p id="3daf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在下一部分中，我们将研究呈现更多的响应类型，并在mood bot的基础上构建，以便它可以使用自定义元数据响应触发Unity函数，并平滑UI。</p></div></div>    
</body>
</html>