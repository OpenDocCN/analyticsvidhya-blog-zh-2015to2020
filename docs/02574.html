<html>
<head>
<title>SQL for Analysts — A challenge a day — Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向分析师的SQL每天的挑战—第2部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/sql-for-analysts-a-challenge-a-day-part-2-fcc549f10cb9?source=collection_archive---------18-----------------------#2019-12-23">https://medium.com/analytics-vidhya/sql-for-analysts-a-challenge-a-day-part-2-fcc549f10cb9?source=collection_archive---------18-----------------------#2019-12-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/798cd39361f88acb2581fea0f4747328.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bC2Ta1is4xVlQbux"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">由<a class="ae iu" href="https://unsplash.com/@martinsanchez?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马丁·桑切斯</a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><blockquote class="iv iw ix"><p id="b0f0" class="iy iz ja jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">嗨伙计们！欢迎来到“<em class="hi">分析师SQL</em>”系列。本系列将通过真实的场景来练习分析师面临的常见挑战/问题。本系列将涵盖中级到高级的挑战，因此如果您不精通SQL的基础知识或语法，我建议您使用一些其他资源来逐步提高。我将使用MySQL来应对这些挑战，所以我建议您也使用MySQL。该系列没有任何特定的顺序，所以你可以从任何部分开始，并尝试解决挑战。</p><p id="20a2" class="iy iz ja jb b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw hb bi translated">也就是说，让我们开始吧。快乐学习！</p></blockquote><p id="f38d" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated"><strong class="jb hj">挑战:</strong></p><p id="c69e" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">创建一个循环赛，每个队只和其他队比赛一次。</p><p id="9cfb" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">下面是我们正在处理的数据的快照:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es ka"><img src="../Images/0eb09e62a43ceae5f4e27966e1b6cbe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:292/format:webp/1*_brvXqNHxJfqNzsUI9uWSQ.png"/></div></figure><p id="a8be" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">最终输出应该是这样的:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es kf"><img src="../Images/bdc80a90f304b24fdde132e3ba3b42ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/format:webp/1*ZTlb720lNZydwWSWC5R1aQ.png"/></div></figure><p id="3316" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">此外，下面是创建表并将上述数据添加到表中的代码:</p><pre class="kb kc kd ke fd kg kh ki kj aw kk bi"><span id="a595" class="kl km hi kh b fi kn ko l kp kq">create table team_list (<br/> teamname varchar(20),<br/> id int);<br/> <br/> insert into team_list values<br/> (‘India’, 1),<br/> (‘Australia’,2),<br/> (‘England’,3),<br/> (‘West Indies’, 4);</span></pre><p id="ec6e" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated"><strong class="jb hj">解决方案:</strong></p><p id="71b7" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">在这个问题中，我们将创建一个装置，每个队只与其他队比赛一次。下面是我们将应用的逻辑:</p><ul class=""><li id="2fc1" class="kr ks hi jb b jc jd jg jh jx kt jy ku jz kv jw kw kx ky kz bi translated">自我加入数据集，让两组队伍一起玩- <code class="du la lb lc kh b">from_team </code>和<code class="du la lb lc kh b">away_team</code></li><li id="282a" class="kr ks hi jb b jc ld jg le jx lf jy lg jz lh jw kw kx ky kz bi translated">然而，这将意味着球队最终只能自己比赛。因此，我们必须确保团队使用的id不是他们自己的id。这给了我们:</li></ul><pre class="kb kc kd ke fd kg kh ki kj aw kk bi"><span id="0851" class="kl km hi kh b fi kn ko l kp kq">select <br/>a.teamname as from_team,a.id as from_id, <br/>b.teamname as away_team, b.id as away_id <br/>from <br/>team_list a join team_list b <br/>where a.id&lt;&gt;b.id;</span></pre><ul class=""><li id="4e80" class="kr ks hi jb b jc jd jg jh jx kt jy ku jz kv jw kw kx ky kz bi translated">然而，在这种情况下，由于顺序的原因，这两个队仍然会每隔一个队进行两次比赛，一次是作为起点队，一次是作为终点队。因此，我们可以通过确保来自团队的id始终小于离开团队的id来防止这种情况。</li></ul><p id="4ee1" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">使用一个公共表表达式来封装步骤2中的结果，我们可以将最终查询写成:</p><pre class="kb kc kd ke fd kg kh ki kj aw kk bi"><span id="ee52" class="kl km hi kh b fi kn ko l kp kq">with cte as (<br/> select <br/> a.teamname as from_team,a.id as from_id, <br/> b.teamname as away_team, b.id as away_id <br/> from <br/> team_list a join team_list b <br/> where a.id&lt;&gt;b.id<br/> )<br/>select * from cte <br/>where from_id&lt;away_id;</span></pre><p id="0370" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">正如你从结果中看到的，因为我们有4支球队，所以在循环赛中只有6场比赛。</p></div><div class="ab cl li lj gp lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hb hc hd he hf"><p id="2656" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">如果您有兴趣解决更多问题，您可以在以下位置找到更多挑战:</p><p id="8b57" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">往期挑战—<a class="ae iu" rel="noopener" href="/analytics-vidhya/sql-for-analysts-a-challenge-a-day-part-1-71ed725156e0">https://medium . com/analytics-vid hya/SQL-for-analysts-a-challenge-a-day-part-1-71ed 725156 E0？</a></p><p id="9f42" class="pw-post-body-paragraph iy iz hi jb b jc jd je jf jg jh ji jj jx jl jm jn jy jp jq jr jz jt ju jv jw hb bi translated">下一个挑战—<a class="ae iu" rel="noopener" href="/analytics-vidhya/sql-for-analysts-a-challenge-a-day-part-3-f46c0df54ce8">https://medium . com/analytics-vid hya/SQL-for-analysts-a-challenge-a-day-part-3-f 46 c 0 df 54 ce 8</a></p></div></div>    
</body>
</html>