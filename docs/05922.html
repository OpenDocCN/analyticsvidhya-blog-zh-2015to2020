<html>
<head>
<title>Getting Started with NVIDIA DeepStream-5.0</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NVIDIA DeepStream-5.0入门</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/getting-started-with-nvidia-deepstream-5-0-8a05d061c4ee?source=collection_archive---------0-----------------------#2020-05-06">https://medium.com/analytics-vidhya/getting-started-with-nvidia-deepstream-5-0-8a05d061c4ee?source=collection_archive---------0-----------------------#2020-05-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4b06976fcc8471682e4231d70c189fe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PcyZlp6-aRCI0e16puZrNA.png"/></div></div></figure><p id="eab7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我的<a class="ae jo" rel="noopener" href="/@karthickai/using-gstreamer-plugin-to-extract-detected-object-from-nvidia-deepstream-104879cc7154">上一篇文章</a>之后，我收到了写关于如何开始使用NVIDIA DeepStream的文章的请求。</p><p id="6be5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">NVIDIA DeepStream发布了5.0版本，支持DGPU和JETSON设备的新功能。你可以在https://developer.nvidia.com/deepstream-sdk<a class="ae jo" href="https://developer.nvidia.com/deepstream-sdk" rel="noopener ugc nofollow" target="_blank"><em class="jp"/></a>上找到更多关于NVIDIA DeepStream SDK的信息。</p><p id="2df1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇文章中，我将分享如何在基于DGPU的设备上安装NVIDIA DeepStream的详细步骤。</p><p id="852f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您必须安装以下组件:</p><p id="d9d3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jp"> Ubuntu 18.04 </em></p><p id="ce85" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jp"> GStreamer 1.14.1 </em></p><p id="a725" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jp">英伟达驱动440+ </em></p><p id="2059" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jp"> CUDA 10.2 </em></p><p id="2268" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jp">tensort 7.0或更高版本</em></p></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h2 id="836a" class="jx jy hi bd jz ka kb kc kd ke kf kg kh jb ki kj kk jf kl km kn jj ko kp kq kr bi translated"><strong class="ak"> 1。移除先前的DeepStream安装</strong></h2><p id="8e27" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">如果是第一次安装DeepStream，您可以跳过这一部分</p><p id="e0dd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">卸载DeepStream 3.0 </strong> <br/>要卸载任何以前安装的DeepStream 3.0库，请运行以下命令。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="1c79" class="jx jy hi lc b fi lg lh l li lj">sudo rm -rf /usr/local/deepstream /usr/lib/x86_64-linux-gnu/gstreamer-1.0/libnvdsgst_* \<br/>            /usr/lib/x86_64-linux-gnu/gstreamer-1.0/libgstnv* \<br/>            /usr/bin/deepstream*</span></pre><p id="b78e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">卸载DeepStream 4.0 </strong> <br/>要卸载任何以前安装的DeepStream 4.0库，请使用uninstall.sh脚本。</p><p id="9b69" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.打开位于/opt/NVIDIA/deepstream/deepstream/<br/>2中的uninstall.sh文件。将PREV_DS_VER设置为4.0 <br/> 3。以sudo的身份运行脚本。/uninstall.sh</p><p id="b726" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请注意，这将仅在等于或高于4.0的DeepStreamSDK版本上运行。</p><p id="effb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">移除NVIDIA驱动程序&amp; CUDA </strong> <br/>移除任何先前安装的NVIDIA驱动程序和CUDA库，以避免版本冲突</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="ccca" class="jx jy hi lc b fi lg lh l li lj">sudo apt purge *nvidia*<br/>sudo apt autoremove<br/>sudo apt autoremove --purge 'cuda*'</span></pre></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h2 id="3256" class="jx jy hi bd jz ka kb kc kd ke kf kg kh jb ki kj kk jf kl km kn jj ko kp kq kr bi translated">2.安装Gstreamer包</h2><p id="441f" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">在您的终端中运行以下命令</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="9b92" class="jx jy hi lc b fi lg lh l li lj">sudo apt install build-essential git</span><span id="f359" class="jx jy hi lc b fi lk lh l li lj">sudo apt install \<br/>libssl1.0.0 \<br/>libgstreamer1.0-0 \<br/>gstreamer1.0-tools \<br/>gstreamer1.0-plugins-good \<br/>gstreamer1.0-plugins-bad \<br/>gstreamer1.0-plugins-ugly \<br/>gstreamer1.0-libav \<br/>libgstrtspserver-1.0-0 \<br/>libjansson4</span></pre></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h2 id="4524" class="jx jy hi bd jz ka kb kc kd ke kf kg kh jb ki kj kk jf kl km kn jj ko kp kq kr bi translated">3.安装<em class="ll"> NVIDIA驱动440+ </em></h2><p id="2f89" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">将图形驱动程序添加到您的来源列表</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="2304" class="jx jy hi lc b fi lg lh l li lj">sudo add-apt-repository ppa:graphics-drivers/ppa<br/>sudo apt update<br/>sudo apt upgrade</span></pre><p id="245a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">检查将要安装的驱动程序:</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="0690" class="jx jy hi lc b fi lg lh l li lj">ubuntu-drivers devices</span></pre><p id="b1af" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">自动安装最新驱动程序</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="78bf" class="jx jy hi lc b fi lg lh l li lj">sudo ubuntu-drivers autoinstall</span></pre><p id="02e1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后重新启动机器:</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="de54" class="jx jy hi lc b fi lg lh l li lj">sudo reboot</span></pre><p id="2f81" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">启动后，您可以检查驱动程序的安装是否正确:</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="d10d" class="jx jy hi lc b fi lg lh l li lj">lsmod | grep nvidia</span></pre></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h2 id="6b6e" class="jx jy hi bd jz ka kb kc kd ke kf kg kh jb ki kj kk jf kl km kn jj ko kp kq kr bi translated">4.要安装CUDA 10.2+</h2><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="1e2b" class="jx jy hi lc b fi lg lh l li lj">wget <a class="ae jo" href="https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64/cuda-ubuntu1804.pin" rel="noopener ugc nofollow" target="_blank">https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64/cuda-ubuntu1804.pin</a></span><span id="ae20" class="jx jy hi lc b fi lk lh l li lj">sudo mv cuda-ubuntu1804.pin /etc/apt/preferences.d/cuda-repository-pin-600</span><span id="07c7" class="jx jy hi lc b fi lk lh l li lj">wget <a class="ae jo" href="http://developer.download.nvidia.com/compute/cuda/10.2/Prod/local_installers/cuda-repo-ubuntu1804-10-2-local-10.2.89-440.33.01_1.0-1_amd64.deb" rel="noopener ugc nofollow" target="_blank">http://developer.download.nvidia.com/compute/cuda/10.2/Prod/local_installers/cuda-repo-ubuntu1804-10-2-local-10.2.89-440.33.01_1.0-1_amd64.deb</a></span><span id="9fb0" class="jx jy hi lc b fi lk lh l li lj">sudo dpkg -i cuda-repo-ubuntu1804-10-2-local-10.2.89-440.33.01_1.0-1_amd64.deb</span><span id="7807" class="jx jy hi lc b fi lk lh l li lj">sudo apt-key add /var/cuda-repo-10-2-local-10.2.89-440.33.01/7fa2af80.pub</span><span id="0d41" class="jx jy hi lc b fi lk lh l li lj">sudo apt-get update</span><span id="25ac" class="jx jy hi lc b fi lk lh l li lj">sudo apt-get -y install cuda</span></pre></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h2 id="6e2f" class="jx jy hi bd jz ka kb kc kd ke kf kg kh jb ki kj kk jf kl km kn jj ko kp kq kr bi translated">5.要安装TensorRT 7.0</h2><p id="6195" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">从NVIDIA开发者中心下载TensorRT 7.0:</p><p id="4ba0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://developer.nvidia.com/nvidia-tensorrt-download" rel="noopener ugc nofollow" target="_blank">https://developer.nvidia.com/nvidia-tensorrt-download</a></p><p id="c383" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jp">tensort 7.0.0.11 Ubuntu 1804和CUDA 10.2 DEB本地回购包</em></p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="ec1b" class="jx jy hi lc b fi lg lh l li lj">cd ~/Downloads</span><span id="e0bb" class="jx jy hi lc b fi lk lh l li lj">sudo dpkg -i ./nv-tensorrt-repo-ubuntu1804-cuda10.2-trt7.0.0.11-ga-20191216_1-1_amd64.deb</span><span id="28d0" class="jx jy hi lc b fi lk lh l li lj">sudo apt-key add /var/nv-tensorrt-repo-cuda10.2-trt7.0.0.11-ga-20191216/7fa2af80.pub</span><span id="ccf4" class="jx jy hi lc b fi lk lh l li lj">sudo apt-get update</span><span id="1bc5" class="jx jy hi lc b fi lk lh l li lj">sudo apt-get install tensorrt</span><span id="5535" class="jx jy hi lc b fi lk lh l li lj">sudo apt-get install uff-converter-tf</span></pre><p id="f15c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">验证安装。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="5113" class="jx jy hi lc b fi lg lh l li lj">dpkg -l | grep TensorRT</span></pre><h2 id="7b08" class="jx jy hi bd jz ka kb kc kd ke kf kg kh jb ki kj kk jf kl km kn jj ko kp kq kr bi translated">6.安装librdkafka</h2><p id="a506" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">为消息代理启用Kafka协议适配器</p><p id="f69a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从GitHub克隆librdkafka存储库:</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="d6f3" class="jx jy hi lc b fi lg lh l li lj">git clone <a class="ae jo" href="https://github.com/edenhill/librdkafka.git" rel="noopener ugc nofollow" target="_blank">https://github.com/edenhill/librdkafka.git</a></span></pre><p id="e1f8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">配置和构建库:</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="86e0" class="jx jy hi lc b fi lg lh l li lj">cd librdkafka</span><span id="d734" class="jx jy hi lc b fi lk lh l li lj">git reset --hard 7101c2310341ab3f4675fc565f64f0967e135a6a</span><span id="8498" class="jx jy hi lc b fi lk lh l li lj">./configure</span><span id="b4fa" class="jx jy hi lc b fi lk lh l li lj">make</span><span id="a08e" class="jx jy hi lc b fi lk lh l li lj">sudo make install</span></pre><p id="914e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将生成的库复制到deepstream目录:</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="1fcb" class="jx jy hi lc b fi lg lh l li lj">sudo mkdir -p /opt/nvidia/deepstream/deepstream-5.0/lib</span><span id="08f2" class="jx jy hi lc b fi lk lh l li lj">sudo cp /usr/local/lib/librdkafka* /opt/nvidia/deepstream/deepstream-5.0/lib</span></pre><h2 id="f421" class="jx jy hi bd jz ka kb kc kd ke kf kg kh jb ki kj kk jf kl km kn jj ko kp kq kr bi translated">7.要安装DeepStream SDK</h2><p id="b2a4" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">下载DeepStream 5.0 dGPU Debian包，DeepStream-5.0 _ 5 . 0 . 0–1 _ amd64 . deb<a class="ae jo" href="https://developer.nvidia.com/deepstream-getting-started" rel="noopener ugc nofollow" target="_blank">https://developer.nvidia.com/deepstream-getting-started</a></p><p id="2829" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后输入命令:</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="dea0" class="jx jy hi lc b fi lg lh l li lj">sudo apt-get install ./deepstream-5.0_5.0.0-1_amd64.deb</span></pre><h2 id="175d" class="jx jy hi bd jz ka kb kc kd ke kf kg kh jb ki kj kk jf kl km kn jj ko kp kq kr bi translated">8.运行deepstream-app进行测试</h2><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="2461" class="jx jy hi lc b fi lg lh l li lj">deepstream-app -c /opt/nvidia/deepstream/deepstream-5.0/samples/configs/deepstream-app/source4_1080p_dec_infer-resnet_tracker_sgie_tiled_display_int8.txt</span></pre><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/06c166d4427ff2f1060c7b829d9db848.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6YmRiscW_zcKe7jwusBI8w.png"/></div></div></figure><p id="e863" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您在运行deepstream-app时遇到以下问题:</p><p id="2e24" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> a) </strong>无法加载插件'/usr/lib/x86 _ 64-Linux-GNU/gstreamer-1.0/deepstream/libnvdsgst _ inferserver . so ':libtrtserver . so</p><p id="bcc7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">解决方案:</p><p id="6679" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">清除gstreamer缓存以查看实际问题</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="2038" class="jx jy hi lc b fi lg lh l li lj">rm -rf ~/.cache/gstreamer-1.0/</span></pre><p id="e002" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> b) </strong>错误:无法获得cuda设备计数</p><p id="e9cc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">解决方案:</p><p id="6040" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">启用所有GPU</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="70b1" class="jx jy hi lc b fi lg lh l li lj">sudo nvidia-xconfig --enable-all-gpus</span></pre><p id="bddf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">感谢阅读。</p><p id="515a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你有任何建议/问题，请在评论区告诉我们！</p></div></div>    
</body>
</html>