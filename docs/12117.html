<html>
<head>
<title>Building a Feature engineering pipeline and ML Model using PySpark</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 PySpark 构建特征工程管道和 ML 模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/building-a-feature-engineering-pipeline-and-ml-model-using-pyspark-7036375cd081?source=collection_archive---------7-----------------------#2020-12-31">https://medium.com/analytics-vidhya/building-a-feature-engineering-pipeline-and-ml-model-using-pyspark-7036375cd081?source=collection_archive---------7-----------------------#2020-12-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/edd95471e32eaaf22e33232c224c151e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rCKZZuOl_9pAcTOhqnNIlw.png"/></div></div></figure><p id="6168" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些天我们都在建立很多机器学习模型，但是如果数据集很大，你无法在本地处理它，或者你需要一些分布式计算来处理，并在更短的时间内进行特征工程，你会怎么办。想到的一件事就是<strong class="is hj">火花</strong>。</p><p id="2295" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">大多数数据科学家都熟悉 python，但 Spark 是在 scala 中，所以我们是要学习一门新的语言，还是我们只能用 Python 做一些事情。接下来是<strong class="is hj"> PySpark </strong>，一个 Spark 的 python 包装器，用 python 提供 spark 的功能，语法非常类似于 Pandas。</p><p id="8ff2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇博客中，我将介绍使用 PySpark 构建机器学习模型的步骤。对于这个项目，我们使用 Udacity 提供的名为 Sparkify 的音乐流媒体公司的事件数据。我们将创建一个 ML 模型来预测哪个客户可能会流失。</p><h1 id="21c6" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">数据探索</strong></h1><p id="91e7" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">该数据集包含 225 个客户的应用事件，包含他们在应用上执行的所有活动，该数据集看起来很小，因为它是完整数据集的子集。我使用这个小的子集是因为我不打算在这个过程中使用任何 EMR 集群，我将在 Udacity 提供的工作空间中执行它。因此，我们将处理这些大约 30 万个事件数据。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kr"><img src="../Images/18f8d139648683f98afdd76896ca76fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BUtD4UdYJAm-FMlvYy_Y0g.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">提供的数据集的架构。</figcaption></figure><p id="22bd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">页面栏似乎对我们非常重要，它讲述了用户与应用程序的所有交互。用户与应用程序的互动越少，客户离开的可能性就越大。下面是几页。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es la"><img src="../Images/8bd6c7b398b2632f79cd8656dd9d998e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zOc9ZgoJHoOOjcDV4b_nBw.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">页面数据</figcaption></figure><p id="dfe8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这样，我们就可以知道用户何时升级或取消订阅。</p><h2 id="4569" class="lb jp hi bd jq lc ld le ju lf lg lh jy jb li lj kc jf lk ll kg jj lm ln kk lo bi translated">定义流失</h2><p id="7cde" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">在对提供的数据进行了一些分析后，我想到了一个问题，即客户是否访问了“取消确认”页面。</p><p id="1781" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请查看以下页面，了解是否有用户访问过取消确认。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/214e3ce699366a810f5978015c757bb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2VU2YwlVuIrP2ZZQvmR78g.png"/></div></div></figure><p id="5d85" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面的图表清楚地显示，降级用户的活动比高级用户少得多。我根据上图为模型选择的页面是:</p><blockquote class="lq lr ls"><p id="e5f7" class="iq ir lt is b it iu iv iw ix iy iz ja lu jc jd je lv jg jh ji lw jk jl jm jn hb bi translated">主页</p><p id="a2a1" class="iq ir lt is b it iu iv iw ix iy iz ja lu jc jd je lv jg jh ji lw jk jl jm jn hb bi translated">添加到播放列表</p><p id="ccb8" class="iq ir lt is b it iu iv iw ix iy iz ja lu jc jd je lv jg jh ji lw jk jl jm jn hb bi translated">添加朋友</p><p id="9108" class="iq ir lt is b it iu iv iw ix iy iz ja lu jc jd je lv jg jh ji lw jk jl jm jn hb bi translated">赞同</p><p id="615e" class="iq ir lt is b it iu iv iw ix iy iz ja lu jc jd je lv jg jh ji lw jk jl jm jn hb bi translated">下一首歌</p></blockquote><p id="45a2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">性别一栏似乎也很重要，因为在搅拌或不搅拌的用户中有很大的差距。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/595eb4acc873c67f945753c67e27f2b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*reiUYxiq1thHWfgUJQSQwg.png"/></div></div></figure><h2 id="3910" class="lb jp hi bd jq lc ld le ju lf lg lh jy jb li lj kc jf lk ll kg jj lm ln kk lo bi translated">数据预处理:</h2><p id="e27b" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">在数据准备中，我检查了数据中的空值和重复值。从前面数据中的所有列中，我发现很少有列(在下一节中提到)用作我们模型的特征。我在需要的地方处理数据副本和空值。</p><p id="05e2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在数据准备期间，我面临的一个挑战是最初我为用户总量创建了每小时一次的窗口，但是在那种情况下，数据非常不平衡。然后，我尝试使用每周窗口大小在这些功能的基础上创建聚合，效果非常好。</p><p id="7e50" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是我们的数据经过一些清理和处理后的样子。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/68e4216d0ec8f8974a9350997eee324a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QwN0QqUEq-OGqqBBo6YmHQ.png"/></div></div></figure><h2 id="586b" class="lb jp hi bd jq lc ld le ju lf lg lh jy jb li lj kc jf lk ll kg jj lm ln kk lo bi translated">特征工程</h2><p id="0fb2" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">现在来看特征工程，我们将使用它来训练模型。</p><ol class=""><li id="d007" class="lz ma hi is b it iu ix iy jb mb jf mc jj md jn me mf mg mh bi translated">用户性别。</li><li id="9ac8" class="lz ma hi is b it mi ix mj jb mk jf ml jj mm jn me mf mg mh bi translated">在应用程序上的最后一次活动时，客户是否获得了付款。</li><li id="a4a8" class="lz ma hi is b it mi ix mj jb mk jf ml jj mm jn me mf mg mh bi translated">用户的平均会话长度。</li><li id="9a19" class="lz ma hi is b it mi ix mj jb mk jf ml jj mm jn me mf mg mh bi translated">最近 4 周会员资格的每周用户交互计数。</li></ol><p id="4f94" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">“ts”列包含以毫秒为单位的交互时间戳。首先，我将获得用户最后一次活动的周数。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/c9c5d07d5959235a891c0409d58fae18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vXxOnugl7X8qv_ELnrMz7w.png"/></div></div></figure><p id="df1b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我保持每周的交互次数，我用窗口函数来做。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/6a528eb81450961b893bde31f186cf5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OyTP6ctTxZOYVVX8JHm7xg.png"/></div></div></figure><p id="d089" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个<strong class="is hj">窗口</strong>函数与 Groupby 非常相似，它只为我们创建的窗口创建聚合，在上面的示例中，我们只使用上周的窗口。</p><p id="1e2c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此外，我在功能创建过程中使用了很多 UDF 的作品。T2 UDF T3 只是 PySpark 中的一个匿名函数，非常类似于 python 中的 lambda 函数。你可以在下图中找到一些。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/18284870795d9bbfec70cd47bc5feca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2TGdnoNAQiiBRijGG1wKRQ.png"/></div></div></figure><p id="3cb7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于平均会话长度，我首先根据 user_id 和 session_id 进行分组，并通过删除重复项来保留最大会话记录，我们为每个用户保留一行会话长度。下面是我编写的创建平均会话长度特性的方法。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/3831505d53c037525cce2025df65b7c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tJMtVnp-mO7xi3hlpBChtA.png"/></div></div></figure><p id="b5ef" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我创建了另一个窗口函数来获取用户在最后一次交互时的成员状态。下图显示了成员状态功能的代码。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/6360ec044fa5919127c64199fa5ddf5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jfzys2a6B57kwo_ruGk5Ig.png"/></div></div></figure><p id="df8b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了训练 ML 模型，它只需要数字输入，所以我使用下面的代码将成员身份和性别转换为数字值。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/9bc2b9fc5255535d44135c5cfd81b79e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BjnCxiMLOJT62MIWy5YI9A.png"/></div></div></figure><p id="8ee1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">生成特征后，下面是我们拥有的数据集的模式。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/630ec8ba1b1b7316b14a4560138bd99c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FDNIni_UUkQfw5DxtIPjpA.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">最终数据集架构</figcaption></figure><h1 id="1abf" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">建模</h1><p id="f995" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">spark 中机器学习模型的常用库有 ML 和 MLLib。我已经为这个项目使用了 ML，因为它是最新的一个。</p><p id="f66f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们已经拥有了将用于训练模型的所有特征，我已经使用了 Standardscaler 来标准化这些特征，并使用 80:20 分割来训练和测试数据集。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/66c8f610dac850fdc523f93cd17042fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UwJMEd8sfuRAbI8_FJ8N0Q.png"/></div></div></figure><p id="22e4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我在这个项目中使用了逻辑回归和随机森林分类器，你也可以尝试其他算法。这里我没有使用 boosting 算法，因为数据集非常小。</p><p id="3e4d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我使用 ml.tuning 库的 ParamGridBuilder 函数进行超参数调优。下面是我用于线性回归算法的配置。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/85920677ae327b08152c6222aac3de78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YmB8qMIbD4uNnmo9GAF6Sg.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">逻辑回归模型</figcaption></figure><p id="8dcf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">随机森林模型的配置</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/44aa27152ce9e3a9fb1a256ae1452dec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V7RKoOiuGzYoXl64S_Xd4g.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">随机森林分类器模型</figcaption></figure><p id="00f8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于逻辑回归，使用的<strong class="is hj">正则化参数</strong>为 0.1 和 0.2，<strong class="is hj">弹性网</strong>参数为 0.1 和 0.2，并且<strong class="is hj">最大迭代次数</strong>为 10，对于随机森林算法，我们使用每个节点的最小实例为 1 和 3，Gini 和熵作为杂质算法，并且树的数量为 20 或 30。</p><h1 id="64dd" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">指标:</h1><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/621246ce7fee3867aeb0a0cf5cc643ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bzCoCy4vh4El-WEo9bnl7A.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">逻辑回归模型的结果</figcaption></figure><figure class="ks kt ku kv fd ij er es paragraph-image"><div class="er es my"><img src="../Images/343a6ee3a0fac99520717ba488bcaf69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*HXaJLGVJQhYd9ssYiMJk7A.png"/></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">随机森林分类器在测试数据集上的结果</figcaption></figure><p id="0b45" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">选择正确的指标集来评估机器学习模型很重要，这里我选择了模型的 f1 分数和准确性作为评估指标。<strong class="is hj"> F1 分数</strong>基本上说明了一个机器学习模型有多健壮和精确，对于这些模型，我在 F1 分数的基础上做了超参数调优，只是为了改善模型的结果。</p><p id="cfef" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最初，我从<strong class="is hj">逻辑回归</strong>模型开始，我用几个参数进行了尝试，上面的截图显示了我从中获得的最佳结果，然后我认为<strong class="is hj">随机森林</strong>可以在这里给出更好的结果，在几个超参数<strong class="is hj">调整后，</strong>它领先于逻辑回归。</p><p id="f074" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">基于上述结果截图，我们可以说，与 F1 分数为 0.83 且准确率为 96%的逻辑回归相比，随机森林分类器在测试数据集上给出了更好的结果。</p><p id="eacd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">随机森林<strong class="is hj">比逻辑回归</strong>工作得更好，因为根据我所做的分析，最终的特征集只包含重要的特征，因为数据中的噪声更少，随机森林给了<strong class="is hj">比逻辑回归更好的结果</strong>。在数据准备过程中，我们删除了所有对模型预测客户流失没有帮助的特征。</p><h1 id="6bc5" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">特征重要性</h1><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mz"><img src="../Images/ddbbc6733828dce43e60b963d887fa97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tfdYIneqDrJCfbnE7n5EUg.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">逻辑回归模型的主要功能</figcaption></figure><p id="7776" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我使用了内置的 featureImportances 属性来获取最重要的特性，这使用了树中使用的变量的频率。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/496359fa8bef5e602c29077d6d34af00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XI7_wzx_V4oKa_5x1uzLPA.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx translated">随机森林分类器模型的主要特征</figcaption></figure><h2 id="50f9" class="lb jp hi bd jq lc ld le ju lf lg lh jy jb li lj kc jf lk ll kg jj lm ln kk lo bi translated">丰富</h2><p id="dce1" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">基于我对机器学习算法的了解，我想分享一些改进，这次我在一个小数据集上运行它，但当我们在一个更大的数据集上运行它时，我认为 boosting 算法会给出更好的结果，这里我没有使用任何 Boosting 算法，因为数据集很小，这与 Boosting 算法在小数据上的结果度量不相符。此外，在大型数据集中，我们可以使用每天的窗口，而不是我们在这个项目中使用的一周。</p><p id="c3f0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你是第一次在 pyspark 中编码，那么编码是很困难的，我建议你参考 PySpark 文档<a class="ae nb" href="https://spark.apache.org/docs/latest/api/python/index.html" rel="noopener ugc nofollow" target="_blank"><strong class="is hj"/></a>，它对我帮助很大，对于任何你可以搜索堆栈溢出的问题，我在那里找到了大多数解决方案。</p><h1 id="6636" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">结论</h1><p id="d99d" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">如果你已经使用 scikit-learn 建立了一个机器学习模型，那么使用 Pyspark 建立模型将会很容易，我觉得没有太大的区别。但对于第一次来说，这可能是一项艰巨的工作。我认为当我们在完整的数据集上使用这些 ML 模型时，它们也会给出相当好的结果。在群集上运行时，我们还可以尝试使用不同的超级参数。进一步的细节，你得查我的<a class="ae nb" href="https://github.com/gunanksood/Sparkify-ML_Pipeline" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj"> <em class="lt"> GitHub 库</em> </strong> </a></p><p id="b13b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我创建了这个博客，作为我的 Udacity 数据科学家 Nanodegree 项目的一部分。</p><p id="e0fa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请随时在 Linkedin 上与我联系。非常感谢你的阅读。</p></div></div>    
</body>
</html>