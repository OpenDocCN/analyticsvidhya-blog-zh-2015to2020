<html>
<head>
<title>H3: A hexagonal hierarchical geospatial indexing system developed by Uber Technologies</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">H3:由优步技术公司开发的六边形层次地理空间索引系统</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/h3-a-hexagonal-hierarchical-geospatial-indexing-system-developed-by-uber-technologies-eee3c5583875?source=collection_archive---------10-----------------------#2020-04-06">https://medium.com/analytics-vidhya/h3-a-hexagonal-hierarchical-geospatial-indexing-system-developed-by-uber-technologies-eee3c5583875?source=collection_archive---------10-----------------------#2020-04-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="c1de" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">什么是h3地理空间索引系统？</h1><p id="4895" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj"> H3 </strong>地理空间索引系统是一个多精度的六边形球体切片，使用分级线性索引进行索引。<strong class="jf hj"> H3核心库</strong>提供经纬度坐标与<strong class="jf hj"> H3 </strong>地理空间索引之间的转换功能。具体来说，主要的库入口点函数(在h3api.h中定义)提供了以下功能:</p><p id="73ba" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">给定一个纬度/经度点，在特定分辨率下找到包含<strong class="jf hj"> H3 </strong>单元格的索引。</p><p id="b78b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">给定一个<strong class="jf hj"> H3 </strong>索引，找到纬度/经度单元中心。</p><p id="eae3" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">给定一个<strong class="jf hj"> H3 </strong>索引，确定经纬度坐标中的单元格边界等等。</p><p id="64bb" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"><em class="kg">H3有哪些用例？</em>T15】</strong></p><p id="192f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">它有助于在经度和纬度的帮助下分析数据，或者基本上，我们可以坐标点，如城市中汽车的位置，可以通过分桶位置和各种选项将区域划分为桶或簇来完成，如使用表面网格划分区域或基于人类知识绘制区域。</p><p id="a089" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">一些基于人类知识的绘图区域的绘制:</strong></p><p id="43b1" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">对于不同的数据点，每次都很难计算数据的质心。</p><p id="3b6a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">分区的边缘并不确切。</p><p id="be64" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">如果我们对系统的理解发生变化，手动定义的分区可能需要更新。</p><p id="f38c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">手动定义大量分区可能非常昂贵和耗时。</p><p id="6a81" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">使用H3的优势</strong></p><p id="9858" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">H3为具有平滑梯度的数据点提供了规则的网格，并且能够测量数据点的单元之间的差异。网格系统有助于定义正确的单元形状。只有三种多边形是规则平铺的:三角形、正方形和六边形。其中，三角形和正方形有不同距离的邻居。三角形有三种不同的距离，正方形有两种不同的距离。对于六边形，所有的邻居都是等距的。这个特性允许更简单的运动分析。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es kh"><img src="../Images/9dec62f4eea91079eae3098ad3cbbebb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*Rjl5pGEDP5nHIVHUWfyJDw.png"/></div><figcaption class="kp kq et er es kr ks bd b be z dx translated"><strong class="bd ih">H3提供的不同网格系统</strong></figcaption></figure><p id="ea5f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><em class="kg">“H3地理空间索引系统是一个多精度的六边形球体切片，使用分级线性索引进行索引。”</em></p><p id="fa38" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">一些常用的H3 Python API</strong></p><p id="46b9" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> <em class="kg">。h3.edge_length <br/>。H3 . hex _ area<br/>H3 . geo _ to _ H3<br/>H3 . H3 _ to _ geo _ boundary<br/>H3 . H3 _ get _ resolution<br/>H3 . k _ ring _ distance<br/>H3 . H3 _ distance<br/>H3 . poly fill<br/>H3 . compact<br/>H3 . hex _ ring</em></strong></p><h1 id="2d92" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">可视化分桶位置的H3空间索引</h1><p id="9b7e" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj">步骤1 </strong>:准备位置<br/>的geojson数据<strong class="jf hj">步骤2 </strong>:将GeoJSON文件读入dataframe，删除几何为空的行。<br/> <strong class="jf hj">第三步</strong>:从几何坐标中提取纬度和经度作为单独的列。<br/> <strong class="jf hj">步骤4 </strong>:将数据可视化在原始数据的地图上。</p><h2 id="f49c" class="kt ig hi bd ih ku kv kw il kx ky kz ip jo la lb it js lc ld ix jw le lf jb lg bi translated">准备数据</h2><h2 id="1366" class="kt ig hi bd ih ku kv kw il kx ky kz ip jo la lb it js lc ld ix jw le lf jb lg bi translated">密码</h2><pre class="ki kj kk kl fd lh li lj lk aw ll bi"><span id="3966" class="kt ig hi li b fi lm ln l lo lp">def read_geojson_points(filepath):<br/>     with open(filepath) as f:<br/>        stops_geodata = json.load(f)</span><span id="d11b" class="kt ig hi li b fi lq ln l lo lp">df = pd.DataFrame(json_normalize(stops_geodata[‘features’]))<br/> n_rows_orig = df.shape[0]<br/>     df.dropna(subset=[“geometry.coordinates”], inplace = True, axis = 0)<br/> n_rows_clean = df.shape[0]<br/>     print(“Cleaning null geometries, eliminated “, n_rows_orig — n_rows_clean,<br/>“ rows out of the original “,n_rows_orig, “ rows”)<br/>     df[‘longitude’] = df[“geometry.coordinates”].apply(lambda x: x[0])<br/>     df[‘latitude’] = df[“geometry.coordinates”].apply(lambda x: x[1])<br/>     return df</span></pre><h2 id="2041" class="kt ig hi bd ih ku kv kw il kx ky kz ip jo la lb it js lc ld ix jw le lf jb lg bi translated">地图可视化</h2><p id="9903" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在地图上快速可视化原始数据<br/> <strong class="jf hj">代码</strong></p><pre class="ki kj kk kl fd lh li lj lk aw ll bi"><span id="d8a0" class="kt ig hi li b fi lm ln l lo lp">m = Map(location= [43.600378, 1.445478], zoom_start=11, tiles=”cartodbpositron”,attr= ‘© &lt;a href=”http://www.openstreetmap.org/copyright"&gt;OpenStreetMap&lt;/a&gt; contributors © &lt;a href=”http://cartodb.com/attributions#basemaps"&gt;CartoDB&lt;/a&gt;’)<br/>mc = MarkerCluster()<br/>for i,row in df_raw.iterrows():<br/>     mk = Marker(location=[row[“latitude”],row[“longitude”]])<br/>     mk.add_to(mc)<br/>mc.add_to(m)<br/>m.save(‘source/2_markers_busstops.html’)<br/>m</span></pre><h2 id="2e08" class="kt ig hi bd ih ku kv kw il kx ky kz ip jo la lb it js lc ld ix jw le lf jb lg bi translated">地图视图</h2><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es lr"><img src="../Images/c3c89b5967d5eb5302d82d69211f1eae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*4WZ8b2UD05gAMYOigaFmZg.png"/></div></figure><h2 id="df87" class="kt ig hi bd ih ku kv kw il kx ky kz ip jo la lb it js lc ld ix jw le lf jb lg bi translated">欲了解更多信息，请访问</h2><p id="7735" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><a class="ae ls" href="https://github.com/uber/h3/blob/master/docs/overview/mainpage.md" rel="noopener ugc nofollow" target="_blank">https://github . com/Uber/H3/blob/master/docs/overview/main page . MD</a></p></div></div>    
</body>
</html>