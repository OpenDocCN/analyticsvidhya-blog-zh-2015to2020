<html>
<head>
<title>Brick by Brick: Build a multi-page dashboard</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一砖一瓦:构建多页仪表板</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/brick-by-brick-build-a-multi-page-dashboard-37912dd7d9e6?source=collection_archive---------4-----------------------#2020-12-10">https://medium.com/analytics-vidhya/brick-by-brick-build-a-multi-page-dashboard-37912dd7d9e6?source=collection_archive---------4-----------------------#2020-12-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ebda" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第1部分:这是关于使用Plotly Dash逐步构建仪表板的系列文章的第一部分。我们从支架——页面的HTML结构开始。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/ffe18b85a26b801a05febfe5800454f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*WLt2a7gWQZqsvsfJ2Qz_tg.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">喜马拉雅蓝罂粟</figcaption></figure></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><blockquote class="jw jx jy"><p id="3792" class="if ig jz ih b ii ij ik il im in io ip ka ir is it kb iv iw ix kc iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">注:</em> </strong> <em class="hi">很大程度上要归功于</em><a class="ae kd" href="https://gabri-albini.medium.com/" rel="noopener"><strong class="ih hj"><em class="hi">Gabriele Albini</em></strong></a><em class="hi">他的关于构建</em> <a class="ae kd" href="https://towardsdatascience.com/create-a-professional-dasbhoard-with-dash-and-css-bootstrap-e1829e238fc5" rel="noopener" target="_blank"> <em class="hi">专业仪表盘</em> </a> <em class="hi">结构的项目帮助我开始了自己的Plotly Dash仪表盘之旅。我使用了他分享的HTML构建结构的元素，特别是创建函数的可重用HTML元素，如get_header和get_navbar。</em></p></blockquote><p id="8eb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当一个数据集被转换成你可以从中获得洞察力的图像时，它会变得更有意义。根据上下文组织这些图像，进一步增强了直观价值。仪表板是视觉效果的精选集合，可以最有效地传递关于底层数据集的最大信息。每张图片都充分说明了数据的一个方面。通过精心安排的视觉效果，可以通过一个设计良好的仪表板提供一条通向最终结论的探索路线。仪表板的另一个吸引人的方面是我们可以向用户提供交互元素。这使得用户可以专注于他们感兴趣的数据段。细分市场可以是一个时间跨度，一个区域，一个感兴趣的产品，一个比较选择，你得到要点…交互式可视化中的工具提示和平移功能对于将底层值与可视化表示联系起来非常有帮助。</p><p id="ce3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">AirBnB 内部的<a class="ae kd" href="http://insideairbnb.com/get-the-data.html" rel="noopener ugc nofollow" target="_blank">为这个仪表盘提供公开数据。当你向下滚动它的网站页面时，你将到达美国西雅图的信息。这是我们将要挖掘的数据。</a></p><p id="f335" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本系列的第一部分中，我们将决定并实现一个布局。根据Dash的文档:<a class="ae kd" href="https://dash.plotly.com/introduction" rel="noopener ugc nofollow" target="_blank"> Dash非常简单，你可以在一个下午内围绕你的Python代码绑定一个用户界面</a>。当我们开始分解数据并在数据中寻找关系时，我们需要将它们放在这个仪表板中。本文将着手创建显示布局。</p><h2 id="2132" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">目标</h2><p id="925f" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">我们的目标是一个仪表板布局如下所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es le"><img src="../Images/6952b77ee2aa20975bab4eaa3265a97f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*gn1xBPDIsN_jsrakiJGQwg.gif"/></div></div></figure></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h2 id="18ea" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">代码和下载</h2><p id="7275" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">这个系列的代码可以在这个<a class="ae kd" href="https://github.com/sjtalkar/SeriallyBuildDashboard" rel="noopener ugc nofollow" target="_blank"> Github repo找到。</a>该应用程序从Jupyter笔记本上运行。有。py (Python)文件，其中包含布局和数据操作的代码。我使用并强烈推荐Visual Studio代码来处理这些，因为有许多方便的扩展可用于格式化，这对于构建我们将在本文中完成的HTML DOM结构特别有帮助。</p><h2 id="9f51" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">装置</h2><p id="ee07" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">按照本文<a class="ae kd" rel="noopener" href="/plotly/introducing-jupyterdash-811f1f57c02e"> <strong class="ih hj"> <em class="jz">中的说明</em></strong></a><strong class="ih hj"><em class="jz">e</em></strong>从Jupyter笔记本上设置并运行Dash应用服务器。Github中的笔记本还列出了所使用的包及其版本，以帮助您开始使用。</p><h2 id="8199" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated"><strong class="ak">结构</strong></h2><p id="f217" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">标题栏声明该仪表板是一个租赁分析仪表板。它将包含一个图标来标记我们的仪表板。在标题下方的左侧，我们创建了一个包含过滤器的导航栏。目前，这些都是通用的下拉列表，包含三个选择，每周，每月和每年。随着项目的成熟，我们将使用各种类型的过滤器。在这个脚手架中定义过滤区域。</p><p id="0f91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">筛选器窗格的右侧是图表区。我把它分成了四行。第一行将保留给KPIs量表或带有汇总信息的卡片，以提供“一目了然”的关键汇总。</p><p id="cb62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们将通过地图、线条和条形聊天从不同角度分析数据。这将是绘图区。</p><p id="9c9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后在底部是页面导航链接的窄带。</p><h2 id="a589" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated"><a class="ae kd" href="https://dash.plotly.com/external-resources" rel="noopener ugc nofollow" target="_blank"> <strong class="ak">文件夹结构</strong> </a></h2><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lj"><img src="../Images/a999f342aa7ce2a32623d47f045db519.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oTTbcdVc1tGfYp2ebs6ujw.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">文件夹结构和文件</figcaption></figure><p id="793b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用引导有一个响应仪表板页面。为了设计各种HTML组件并使用Bootstrap的CSS，我们在app目录的根目录下创建了一个名为<code class="du lk ll lm ln b">assets</code>的文件夹。我们还将创建一个名为<code class="du lk ll lm ln b">data</code>的文件夹，其中包含我们从AirBnB网站内部收集的所有CSV数据。为了让Dash识别这种文件夹结构，请注意，创建应用程序时会在构造函数中包含__name__。</p><p id="d59d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kd" href="https://community.plotly.com/t/dash-app-does-not-load-assets-and-app-index-string/12178/10?u=chriddyp" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">重要:为什么需要在你的Dash构造函数中包含</strong> </a> <code class="du lk ll lm ln b"><a class="ae kd" href="https://community.plotly.com/t/dash-app-does-not-load-assets-and-app-index-string/12178/10?u=chriddyp" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">__name__</strong></a></code> <a class="ae kd" href="https://community.plotly.com/t/dash-app-does-not-load-assets-and-app-index-string/12178/10?u=chriddyp" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">。</strong> </a></p><p id="1af0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将在assets文件夹中存储其他元素，如图标和徽标图像。一旦遵循了这种文件夹结构，就可以通过调用来检索资产，这取决于资产文件夹中存在的图像文件。</p><pre class="je jf jg jh fd lo ln lp lq aw lr bi"><span id="6c76" class="ke kf hi ln b fi ls lt l lu lv">html.Img(src=app.get_asset_url("LogoForDashboard.png"),<br/>                                height="100%",width="auto")</span></pre></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h2 id="af4d" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated"><strong class="ak"> HTML </strong></h2><p id="be5a" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">我们将使用Bootstraps的样式来制作一个响应式仪表板，其中的元素会在页面调整大小时自动调整大小。你可以在这里了解更多关于Bootstrap的网格系统<a class="ae kd" href="https://getbootstrap.com/docs/4.0/layout/grid/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">。</strong> </a> <strong class="ih hj"> </strong>这将让您了解我们将文档分成的12个列宽的行。通过嵌套行和列，我们可以实现更精细的网格布局控制。该布局在名为layout_scaffold.py的文件中实现</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lw"><img src="../Images/484f48fa09c568863ab9c61f3d913d6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6bpWqY3JHPo_n6fjgijS0w.png"/></div></div></figure></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="29c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kd" href="https://dash.plotly.com/urls" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">多页面支持和URL路由</strong> </a> <strong class="ih hj"> <br/> </strong>我们将要构建的仪表盘有两个页面。第一个布局如上所示。随着项目的成熟，我们将添加到后面的页面，但我们现在将为路由到其他页面奠定基础。Dash将web应用呈现为“单页应用”。这意味着当用户导航应用程序时，应用程序不会完全重新加载，从而使浏览速度非常快。</p><p id="3f88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有两个组件帮助页面导航:<a class="ae kd" href="https://dash.plotly.com/dash-core-components/location" rel="noopener ugc nofollow" target="_blank"> dash_core_components。位置</a>和<a class="ae kd" href="https://dash.plotly.com/dash-core-components/link" rel="noopener ugc nofollow" target="_blank">仪表板_型芯_部件。链接</a>。注意在笔记本createdashboardscaffolding . ipynb中发送到回调的<strong class="ih hj">路径名</strong>的用法。</p><p id="9412" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lk ll lm ln b">Link</code>元素更新浏览器<em class="jz">的<code class="du lk ll lm ln b">pathname</code>而不刷新页面</em>。如果你使用一个<code class="du lk ll lm ln b">html.A</code>元素，那么<code class="du lk ll lm ln b">pathname</code>会更新，但是页面会刷新。您将在layout_scaffold.py文件中找到dcc Link元素。</p><p id="6de5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Dash中的回调始终遵循相同的结构，所以让我们来介绍一下它在URL路由中的应用。</p><p id="c040" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">整个应用程序布局在html.Div中包含一个输入元素和一个输出元素。</p><p id="d4cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们首先给<code class="du lk ll lm ln b">dash_core_components.Location.</code>分配一个id =‘url’(这是我们给id起的名字)。这是输入元素，也就是说，它将浏览器地址栏中的URL路径捕获到名为<strong class="ih hj"> pathname的组件属性中。</strong></p><pre class="je jf jg jh fd lo ln lp lq aw lr bi"><span id="0abc" class="ke kf hi ln b fi ls lt l lu lv">app.layout = html.Div([dcc.Location(id=’url’, refresh=False),<br/>                       html.Div(id=’page-content’)<br/>                      ])</span></pre><p id="bc5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出元素是id='page-content '的Div。</p><p id="8014" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接受该输入并返回输出的回调函数由函数decorator @app.callback修饰。dash.dependencies.Ouput和dash.dependencies.Input分别指定组件id(我们在上面声明的那些)和组件属性。对于输入，属性是路径名和html。Div元素，组件属性是<strong class="ih hj">子元素。</strong>下面的回调函数display_page发送了<strong class="ih hj"> pathname，</strong>用于将输出定向到我们在layout_scaffold.py文件中创建的HTML结构。您将在layout_scaffold.py文件中找到每个变量rental-main、rentaldrilldown和rentaldetails。</p><pre class="je jf jg jh fd lo ln lp lq aw lr bi"><span id="a465" class="ke kf hi ln b fi ls lt l lu lv"><a class="ae kd" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(dash.dependencies.Output('page-content', 'children'),<br/>              [dash.dependencies.Input('url', 'pathname')])<br/>def display_page(pathname):<br/>    if pathname == '/apps/rental-main':<br/>         return rental<br/>    elif pathname == '/apps/duration':<br/>         return duration<br/>    elif pathname == '/apps/rentaldetails':<br/>         return rentaldetails<br/>    else:<br/>        return rental<br/></span></pre></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="5a58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jz">进一步阅读请参考:</em> </strong> <br/> <a class="ae kd" href="https://community.plotly.com/t/what-is-the-meaning-of-the-children-property-and-where-to-get-the-property-list/7336/2" rel="noopener ugc nofollow" target="_blank">社区资源</a> <br/> <a class="ae kd" href="https://dash.plotly.com/layout" rel="noopener ugc nofollow" target="_blank"> Dash布局</a> <br/> <a class="ae kd" href="https://dash.plotly.com/basic-callbacks" rel="noopener ugc nofollow" target="_blank">基本Dash回调</a></p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h2 id="7c97" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">模块化布局</h2><p id="8648" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">使用我在<a class="ae kd" href="https://towardsdatascience.com/create-a-professional-dasbhoard-with-dash-and-css-bootstrap-e1829e238fc5" rel="noopener" target="_blank">这里</a>中介绍的方法，开始项目时，有“位置卡”(使用Dash Core Components卡元素创建)，作为最终将显示的图表的占位符。设计好的页面被分割成一个网格结构，网格结构中的行和列是在get_filterbar等函数中定义的，get _ filter bar返回一个包含筛选器和筛选器标签的多行div，get_KPIrow是将来用来保存KPI的行。这些元素已经放置在layout_scaffolding.py文件中。</p><p id="16ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">模块化网格的创建允许我们构建仪表板，一次一个网格单元。它还允许我们重用这些元素，减少编码工作。</p><p id="9017" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是用Visual Studio代码构建的layout_scaffolding.py的屏幕截图。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lx"><img src="../Images/a1f2ed6dd1dcf50dd313b3fde7eacc72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qJgeiJU_Ey3uZoJ9Bj7cPg.png"/></div></div></figure></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h2 id="de45" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">最后</h2><p id="a78e" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">为了在本地开发服务器上运行应用程序，我们使用下面的</p><pre class="je jf jg jh fd lo ln lp lq aw lr bi"><span id="ab8f" class="ke kf hi ln b fi ls lt l lu lv">app.run_server(debug=False)</span></pre><p id="975c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用内核-&gt;重启和全部运行来运行笔记本..<br/>你会收到一个运行你可以与之互动的应用程序的链接。<br/> Dash正在<a class="ae kd" href="http://127.0.0.1:8050/" rel="noopener ugc nofollow" target="_blank">上运行http://&lt;localhost IP address&gt;:8050/</a></p><p id="b43a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有关开发工具的更多信息，请访问此<a class="ae kd" href="https://dash.plotly.com/devtools" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">页面</strong> </a> <strong class="ih hj">。</strong></p><p id="964f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不要害羞！欢迎评论和提问。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><blockquote class="jw jx jy"><p id="417e" class="if ig jz ih b ii ij ik il im in io ip ka ir is it kb iv iw ix kc iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">预告</em> </strong></p></blockquote><p id="38b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本系列的第二部分中，我们将包括静态HTML地图，它具有工具提示和借助于leav的平移等交互性。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es ly"><img src="../Images/70064513671b6d5784be237e463aeb92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*s-R1XnCt9FOd1jwa_EgTjg.gif"/></div></div></figure></div></div>    
</body>
</html>